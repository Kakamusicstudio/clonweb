const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index47.js","js/i18next-vendor.js","js/index16.js","js/index17.js","js/qwen-chat-design.js","js/antd-vendor.js","css/index22.css","css/index7.css","js/setting.util.js","js/useUpgradePlan.hook.js","js/utils-vendor.js","js/lodash-vendor.js","js/index32.js","css/index26.css","js/index39.js","css/index41.css","js/index12.js","css/index8.css","js/useDynamicHeight.js","js/aliyun-rtc-sdk-vendor.js","js/qwen-chat-components.js","js/xlsx-vendor.js","js/ali-oss-vendor.js","css/index42.css","js/index31.js","js/index10.js","js/index18.js","css/index11.css","css/index9.css","js/index19.js","css/index10.css","css/index24.css","js/index43.js","js/index3.js","css/index2.css","js/index5.js","css/index3.css","js/index9.js","css/index.css","css/index35.css","js/index25.js","js/verifyEmail.util.js","css/index17.css","js/index26.js","css/index18.css","js/index.js","js/index2.js","js/index4.js","js/index27.js","css/index19.css","js/index28.js","css/index20.css","js/index6.js","js/index.h5.js","css/index12.css","js/index29.js","css/index21.css","js/index38.js","css/index32.css","js/index33.js","js/languages.js","js/useAudioSpeaker.hook.js","css/index25.css","js/index46.js","js/monaco-vendor.js","css/monaco-vendor.css","css/index39.css","js/index11.js","css/index4.css","js/index13.js","js/index14.js","css/index13.css","css/index5.css","js/index15.js","css/index6.css","js/index36.js","css/index29.css","js/index42.js","css/index34.css","js/index34.js","js/index.type.js","js/index22.js","css/index40.css","css/index27.css","js/index20.js","css/index14.css","js/index30.js","css/index23.css","js/index40.js","js/index41.js","css/index38.css","css/index33.css","js/index37.js","js/index24.js","css/index31.css","css/index30.css","js/index44.js","css/index36.css","js/ModelsContainer.js","css/ModelsContainer.css","js/AccountContainer.js","css/AccountContainer.css","js/index7.js","js/index21.js","css/index15.css","js/index35.js","css/index28.css","js/index23.js","css/index16.css","js/index45.js","css/index37.css","js/index8.js"])))=>i.map(i=>d[i]);
var e,t,n,i,a,o,s,r,l,c=Object.defineProperty,u=Object.defineProperties,d=Object.getOwnPropertyDescriptors,h=Object.getOwnPropertySymbols,p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,g=Reflect.get,v=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),y=e=>{throw TypeError(e)},b=Math.pow,x=(e,t,n)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,w=(e,t)=>{for(var n in t||(t={}))m.call(t,n)&&x(e,n,t[n]);if(h)for(var n of h(t))f.call(t,n)&&x(e,n,t[n]);return e},_=(e,t)=>u(e,d(t)),S=(e,t)=>{var n={};for(var i in e)m.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&h)for(var i of h(e))t.indexOf(i)<0&&f.call(e,i)&&(n[i]=e[i]);return n},C=(e,t,n)=>x(e,"symbol"!=typeof t?t+"":t,n),E=(e,t,n)=>t.has(e)||y("Cannot "+n),k=(e,t,n)=>(E(e,t,"read from private field"),n?n.call(e):t.get(e)),I=(e,t,n)=>t.has(e)?y("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),T=(e,t,n,i)=>(E(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),j=(e,t,n)=>new Promise((i,a)=>{var o=e=>{try{r(n.next(e))}catch(t){a(t)}},s=e=>{try{r(n.throw(e))}catch(t){a(t)}},r=e=>e.done?i(e.value):Promise.resolve(e.value).then(o,s);r((n=n.apply(e,t)).next())}),N=function(e,t){this[0]=e,this[1]=t},P=(e,t,n)=>{var i=(e,t,a,o)=>{try{var s=n[e](t),r=(t=s.value)instanceof N,l=s.done;Promise.resolve(r?t[0]:t).then(n=>r?i("return"===e?e:"next",t[1]?{done:n.done,value:n.value}:n,a,o):a({value:n,done:l})).catch(e=>i("throw",e,a,o))}catch(c){o(c)}},a=e=>o[e]=t=>new Promise((n,a)=>i(e,t,n,a)),o={};return n=n.apply(e,t),o[v("asyncIterator")]=()=>o,a("next"),a("throw"),a("return"),o},M=(e,t,n)=>(t=e[v("asyncIterator")])?t.call(e):(e=e[v("iterator")](),t={},(n=(n,i)=>(i=e[n])&&(t[n]=t=>new Promise((n,a,o)=>(t=i.call(e,t),o=t.done,Promise.resolve(t.value).then(e=>n({value:e,done:o}),a)))))("next"),n("return"),t);import{r as A,b as O,d as R,B as D,i as L,a as F,R as z,c as U,g as H,e as B,u as $,T as q,f as G,h as V}from"./i18next-vendor.js";import{r as W,d as Q,s as K,e as Y,F as X,M as J,h as Z,D as ee,I as te,P as ne,S as ie,i as ae,j as oe,k as se,l as re,m as le,n as ce,o as ue,p as de,q as he,t as pe,v as me,w as fe,B as ge,x as ve,y as ye,R as be,T as xe,b as we,u as _e}from"./antd-vendor.js";import{bV as Se,bP as Ce,bW as Ee,bX as ke,bY as Ie,bZ as Te,b_ as je,b$ as Ne,c0 as Pe,c1 as Me,c2 as Ae,c3 as Oe,c4 as Re,c5 as De,c6 as Le,bO as Fe,c7 as ze,c8 as Ue,c9 as He,ca as Be,cb as $e,cc as qe,cd as Ge,ce as Ve,cf as We,cg as Qe,bU as Ke,ch as Ye,ci as Xe,cj as Je,A as Ze,ck as et,cl as tt,bN as nt,cm as it,bT as at,bR as ot,bS as st}from"./qwen-chat-components.js";import{v as rt,A as lt,a as ct,b as ut,E as dt}from"./utils-vendor.js";import{J as ht,P as pt,I as mt,Q as ft,v as gt,c as vt,n as yt,a as bt,u as xt,$ as wt,r as _t,W as St,D as Ct,b as Et,d as kt}from"./qwen-chat-design.js";import{b as It,o as Tt,c as jt,e as Nt,f as Pt,g as Mt,m as At,i as Ot,h as Rt,j as Dt,d as Lt,t as Ft}from"./lodash-vendor.js";import{u as zt,w as Ut}from"./xlsx-vendor.js";import{A as Ht}from"./ali-oss-vendor.js";import{K as Bt,h as $t,U as qt,n as Gt,x as Vt,G as Wt,$ as Qt,k as Kt,p as Yt,_ as Xt}from"./aliyun-rtc-sdk-vendor.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Jt={exports:{}},Zt={},en=Symbol.for("react.transitional.element"),tn=Symbol.for("react.fragment");function nn(e,t,n){var i=null;if(void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),"key"in t)for(var a in n={},t)"key"!==a&&(n[a]=t[a]);else n=t;return t=n.ref,{$$typeof:en,type:e,key:i,ref:void 0!==t?t:null,props:n}}Zt.Fragment=tn,Zt.jsx=nn,Zt.jsxs=nn,Jt.exports=Zt;var an=Jt.exports,on={exports:{}},sn={},rn={exports:{}},ln={};!function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,o=e[i];if(!(0<a(o,t)))break e;e[i]=t,e[n]=o,n=i}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,o=e.length,s=o>>>1;i<s;){var r=2*(i+1)-1,l=e[r],c=r+1,u=e[c];if(0>a(l,n))c<o&&0>a(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[r]=n,i=r);else{if(!(c<o&&0>a(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,r=s.now();e.unstable_now=function(){return s.now()-r}}var l=[],c=[],u=1,d=null,h=3,p=!1,m=!1,f=!1,g=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function x(e){for(var a=n(c);null!==a;){if(null===a.callback)i(c);else{if(!(a.startTime<=e))break;i(c),a.sortIndex=a.expirationTime,t(l,a)}a=n(c)}}function w(e){if(f=!1,x(e),!m)if(null!==n(l))m=!0,S||(S=!0,_());else{var t=n(c);null!==t&&P(w,t.startTime-e)}}var _,S=!1,C=-1,E=5,k=-1;function I(){return!!g||!(e.unstable_now()-k<E)}function T(){if(g=!1,S){var t=e.unstable_now();k=t;var a=!0;try{e:{m=!1,f&&(f=!1,y(C),C=-1),p=!0;var o=h;try{t:{for(x(t),d=n(l);null!==d&&!(d.expirationTime>t&&I());){var s=d.callback;if("function"==typeof s){d.callback=null,h=d.priorityLevel;var r=s(d.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof r){d.callback=r,x(t),a=!0;break t}d===n(l)&&i(l),x(t)}else i(l);d=n(l)}if(null!==d)a=!0;else{var u=n(c);null!==u&&P(w,u.startTime-t),a=!1}}break e}finally{d=null,h=o,p=!1}a=void 0}}finally{a?_():S=!1}}}if("function"==typeof b)_=function(){b(T)};else if("undefined"!=typeof MessageChannel){var j=new MessageChannel,N=j.port2;j.port1.onmessage=T,_=function(){N.postMessage(null)}}else _=function(){v(T,0)};function P(t,n){C=v(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e||(E=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},e.unstable_scheduleCallback=function(i,a,o){var s=e.unstable_now();switch("object"==typeof o&&null!==o?o="number"==typeof(o=o.delay)&&0<o?s+o:s:o=s,i){case 1:var r=-1;break;case 2:r=250;break;case 5:r=1073741823;break;case 4:r=1e4;break;default:r=5e3}return i={id:u++,callback:a,priorityLevel:i,startTime:o,expirationTime:r=o+r,sortIndex:-1},o>s?(i.sortIndex=o,t(c,i),null===n(l)&&i===n(c)&&(f?(y(C),C=-1):f=!0,P(w,o-s))):(i.sortIndex=r,t(l,i),m||p||(m=!0,S||(S=!0,_()))),i},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}}(ln),rn.exports=ln;var cn=rn.exports,un=A,dn=W;function hn(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function pn(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function mn(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function fn(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function gn(e){if(mn(e)!==e)throw Error(hn(188))}function vn(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=vn(e)))return t;e=e.sibling}return null}var yn=Object.assign,bn=Symbol.for("react.element"),xn=Symbol.for("react.transitional.element"),wn=Symbol.for("react.portal"),_n=Symbol.for("react.fragment"),Sn=Symbol.for("react.strict_mode"),Cn=Symbol.for("react.profiler"),En=Symbol.for("react.provider"),kn=Symbol.for("react.consumer"),In=Symbol.for("react.context"),Tn=Symbol.for("react.forward_ref"),jn=Symbol.for("react.suspense"),Nn=Symbol.for("react.suspense_list"),Pn=Symbol.for("react.memo"),Mn=Symbol.for("react.lazy"),An=Symbol.for("react.activity"),On=Symbol.for("react.memo_cache_sentinel"),Rn=Symbol.iterator;function Dn(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=Rn&&e[Rn]||e["@@iterator"])?e:null}var Ln=Symbol.for("react.client.reference");function Fn(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===Ln?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case _n:return"Fragment";case Cn:return"Profiler";case Sn:return"StrictMode";case jn:return"Suspense";case Nn:return"SuspenseList";case An:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case wn:return"Portal";case In:return(e.displayName||"Context")+".Provider";case kn:return(e._context.displayName||"Context")+".Consumer";case Tn:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case Pn:return null!==(t=e.displayName||null)?t:Fn(e.type)||"Memo";case Mn:t=e._payload,e=e._init;try{return Fn(e(t))}catch(n){}}return null}var zn=Array.isArray,Un=un.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Hn=dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Bn={pending:!1,data:null,method:null,action:null},$n=[],qn=-1;function Gn(e){return{current:e}}function Vn(e){0>qn||(e.current=$n[qn],$n[qn]=null,qn--)}function Wn(e,t){qn++,$n[qn]=e.current,e.current=t}var Qn=Gn(null),Kn=Gn(null),Yn=Gn(null),Xn=Gn(null);function Jn(e,t){switch(Wn(Yn,t),Wn(Kn,e),Wn(Qn,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?cm(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=um(t=cm(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Vn(Qn),Wn(Qn,e)}function Zn(){Vn(Qn),Vn(Kn),Vn(Yn)}function ei(e){null!==e.memoizedState&&Wn(Xn,e);var t=Qn.current,n=um(t,e.type);t!==n&&(Wn(Kn,e),Wn(Qn,n))}function ti(e){Kn.current===e&&(Vn(Qn),Vn(Kn)),Xn.current===e&&(Vn(Xn),Zm._currentValue=Bn)}var ni=Object.prototype.hasOwnProperty,ii=cn.unstable_scheduleCallback,ai=cn.unstable_cancelCallback,oi=cn.unstable_shouldYield,si=cn.unstable_requestPaint,ri=cn.unstable_now,li=cn.unstable_getCurrentPriorityLevel,ci=cn.unstable_ImmediatePriority,ui=cn.unstable_UserBlockingPriority,di=cn.unstable_NormalPriority,hi=cn.unstable_LowPriority,pi=cn.unstable_IdlePriority,mi=cn.log,fi=cn.unstable_setDisableYieldValue,gi=null,vi=null;function yi(e){if("function"==typeof mi&&fi(e),vi&&"function"==typeof vi.setStrictMode)try{vi.setStrictMode(gi,e)}catch(t){}}var bi=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(xi(e)/wi|0)|0},xi=Math.log,wi=Math.LN2;var _i=256,Si=4194304;function Ci(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ei(e,t,n){var i=e.pendingLanes;if(0===i)return 0;var a=0,o=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var r=134217727&i;return 0!==r?0!==(i=r&~o)?a=Ci(i):0!==(s&=r)?a=Ci(s):n||0!==(n=r&~e)&&(a=Ci(n)):0!==(r=i&~o)?a=Ci(r):0!==s?a=Ci(s):n||0!==(n=i&~e)&&(a=Ci(n)),0===a?0:0!==t&&t!==a&&0===(t&o)&&((o=a&-a)>=(n=t&-t)||32===o&&4194048&n)?t:a}function ki(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ii(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ti(){var e=_i;return!(4194048&(_i<<=1))&&(_i=256),e}function ji(){var e=Si;return!(62914560&(Si<<=1))&&(Si=4194304),e}function Ni(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Pi(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Mi(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-bi(t);e.entangledLanes|=t,e.entanglements[i]=1073741824|e.entanglements[i]|4194090&n}function Ai(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-bi(n),a=1<<i;a&t|e[i]&t&&(e[i]|=t),n&=~a}}function Oi(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ri(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Di(){var e=Hn.p;return 0!==e?e:void 0===(e=window.event)?32:ff(e.type)}var Li=Math.random().toString(36).slice(2),Fi="__reactFiber$"+Li,zi="__reactProps$"+Li,Ui="__reactContainer$"+Li,Hi="__reactEvents$"+Li,Bi="__reactListeners$"+Li,$i="__reactHandles$"+Li,qi="__reactResources$"+Li,Gi="__reactMarker$"+Li;function Vi(e){delete e[Fi],delete e[zi],delete e[Hi],delete e[Bi],delete e[$i]}function Wi(e){var t=e[Fi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ui]||n[Fi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Cm(e);null!==e;){if(n=e[Fi])return n;e=Cm(e)}return t}n=(e=n).parentNode}return null}function Qi(e){if(e=e[Fi]||e[Ui]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Ki(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(hn(33))}function Yi(e){var t=e[qi];return t||(t=e[qi]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Xi(e){e[Gi]=!0}var Ji=new Set,Zi={};function ea(e,t){ta(e,t),ta(e+"Capture",t)}function ta(e,t){for(Zi[e]=t,e=0;e<t.length;e++)Ji.add(t[e])}var na,ia,aa=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),oa={},sa={};function ra(e,t,n){if(a=t,ni.call(sa,a)||!ni.call(oa,a)&&(aa.test(a)?sa[a]=!0:(oa[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var i=t.toLowerCase().slice(0,5);if("data-"!==i&&"aria-"!==i)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function la(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ca(e,t,n,i){if(null===i)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+i)}}function ua(e){if(void 0===na)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);na=t&&t[1]||"",ia=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+na+e+ia}var da=!1;function ha(e,t){if(!e||da)return"";da=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(a){var i=a}Reflect.construct(e,[],n)}else{try{n.call()}catch(o){i=o}e.call(n.prototype)}}else{try{throw Error()}catch(s){i=s}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(r){if(r&&i&&"string"==typeof r.stack)return[r.stack,i.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=i.DetermineComponentFrameRoot(),s=o[0],r=o[1];if(s&&r){var l=s.split("\n"),c=r.split("\n");for(a=i=0;i<l.length&&!l[i].includes("DetermineComponentFrameRoot");)i++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(i===l.length||a===c.length)for(i=l.length-1,a=c.length-1;1<=i&&0<=a&&l[i]!==c[a];)a--;for(;1<=i&&0<=a;i--,a--)if(l[i]!==c[a]){if(1!==i||1!==a)do{if(i--,0>--a||l[i]!==c[a]){var u="\n"+l[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=i&&0<=a);break}}}finally{da=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?ua(n):""}function pa(e){switch(e.tag){case 26:case 27:case 5:return ua(e.type);case 16:return ua("Lazy");case 13:return ua("Suspense");case 19:return ua("SuspenseList");case 0:case 15:return ha(e.type,!1);case 11:return ha(e.type.render,!1);case 1:return ha(e.type,!0);case 31:return ua("Activity");default:return""}}function ma(e){try{var t="";do{t+=pa(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function fa(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ga(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function va(e){e._valueTracker||(e._valueTracker=function(e){var t=ga(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){i=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ya(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=ga(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function ba(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var xa=/[\n"\\]/g;function wa(e){return e.replace(xa,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function _a(e,t,n,i,a,o,s,r){e.name="",null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+fa(t)):e.value!==""+fa(t)&&(e.value=""+fa(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?Ca(e,s,fa(t)):null!=n?Ca(e,s,fa(n)):null!=i&&e.removeAttribute("value"),null==a&&null!=o&&(e.defaultChecked=!!o),null!=a&&(e.checked=a&&"function"!=typeof a&&"symbol"!=typeof a),null!=r&&"function"!=typeof r&&"symbol"!=typeof r&&"boolean"!=typeof r?e.name=""+fa(r):e.removeAttribute("name")}function Sa(e,t,n,i,a,o,s,r){if(null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o&&(e.type=o),null!=t||null!=n){if(("submit"===o||"reset"===o)&&null==t)return;n=null!=n?""+fa(n):"",t=null!=t?""+fa(t):n,r||t===e.value||(e.value=t),e.defaultValue=t}i="function"!=typeof(i=null!=i?i:a)&&"symbol"!=typeof i&&!!i,e.checked=r?e.checked:!!i,e.defaultChecked=!!i,null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s&&(e.name=s)}function Ca(e,t,n){"number"===t&&ba(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Ea(e,t,n,i){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&i&&(e[n].defaultSelected=!0)}else{for(n=""+fa(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(i&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ka(e,t,n){null==t||((t=""+fa(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+fa(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Ia(e,t,n,i){if(null==t){if(null!=i){if(null!=n)throw Error(hn(92));if(zn(i)){if(1<i.length)throw Error(hn(93));i=i[0]}n=i}null==n&&(n=""),t=n}n=fa(t),e.defaultValue=n,(i=e.textContent)===n&&""!==i&&null!==i&&(e.value=i)}function Ta(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var ja=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Na(e,t,n){var i=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?i?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":i?e.setProperty(t,n):"number"!=typeof n||0===n||ja.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Pa(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(hn(62));if(e=e.style,null!=n){for(var i in n)!n.hasOwnProperty(i)||null!=t&&t.hasOwnProperty(i)||(0===i.indexOf("--")?e.setProperty(i,""):"float"===i?e.cssFloat="":e[i]="");for(var a in t)i=t[a],t.hasOwnProperty(a)&&n[a]!==i&&Na(e,a,i)}else for(var o in t)t.hasOwnProperty(o)&&Na(e,o,t[o])}function Ma(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Aa=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Oa=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ra(e){return Oa.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Da=null;function La(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Fa=null,za=null;function Ua(e){var t=Qi(e);if(t&&(e=t.stateNode)){var n=e[zi]||null;e:switch(e=t.stateNode,t.type){case"input":if(_a(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+wa(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var a=i[zi]||null;if(!a)throw Error(hn(90));_a(i,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)(i=n[t]).form===e.form&&ya(i)}break e;case"textarea":ka(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&Ea(e,!!n.multiple,t,!1)}}}var Ha=!1;function Ba(e,t,n){if(Ha)return e(t,n);Ha=!0;try{return e(t)}finally{if(Ha=!1,(null!==Fa||null!==za)&&(Vh(),Fa&&(t=Fa,e=za,za=Fa=null,Ua(t),e)))for(t=0;t<e.length;t++)Ua(e[t])}}function $a(e,t){var n=e.stateNode;if(null===n)return null;var i=n[zi]||null;if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(hn(231,t,typeof n));return n}var qa=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Ga=!1;if(qa)try{var Va={};Object.defineProperty(Va,"passive",{get:function(){Ga=!0}}),window.addEventListener("test",Va,Va),window.removeEventListener("test",Va,Va)}catch(kX){Ga=!1}var Wa=null,Qa=null,Ka=null;function Ya(){if(Ka)return Ka;var e,t,n=Qa,i=n.length,a="value"in Wa?Wa.value:Wa.textContent,o=a.length;for(e=0;e<i&&n[e]===a[e];e++);var s=i-e;for(t=1;t<=s&&n[i-t]===a[o-t];t++);return Ka=a.slice(e,1<t?1-t:void 0)}function Xa(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Ja(){return!0}function Za(){return!1}function eo(e){function t(t,n,i,a,o){for(var s in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Ja:Za,this.isPropagationStopped=Za,this}return yn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Ja)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Ja)},persist:function(){},isPersistent:Ja}),t}var to,no,io,ao={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oo=eo(ao),so=yn({},ao,{view:0,detail:0}),ro=eo(so),lo=yn({},so,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xo,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==io&&(io&&"mousemove"===e.type?(to=e.screenX-io.screenX,no=e.screenY-io.screenY):no=to=0,io=e),to)},movementY:function(e){return"movementY"in e?e.movementY:no}}),co=eo(lo),uo=eo(yn({},lo,{dataTransfer:0})),ho=eo(yn({},so,{relatedTarget:0})),po=eo(yn({},ao,{animationName:0,elapsedTime:0,pseudoElement:0})),mo=eo(yn({},ao,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),fo=eo(yn({},ao,{data:0})),go={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bo(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=yo[e])&&!!t[e]}function xo(){return bo}var wo=eo(yn({},so,{key:function(e){if(e.key){var t=go[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Xa(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?vo[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xo,charCode:function(e){return"keypress"===e.type?Xa(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Xa(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),_o=eo(yn({},lo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),So=eo(yn({},so,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xo})),Co=eo(yn({},ao,{propertyName:0,elapsedTime:0,pseudoElement:0})),Eo=eo(yn({},lo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),ko=eo(yn({},ao,{newState:0,oldState:0})),Io=[9,13,27,32],To=qa&&"CompositionEvent"in window,jo=null;qa&&"documentMode"in document&&(jo=document.documentMode);var No=qa&&"TextEvent"in window&&!jo,Po=qa&&(!To||jo&&8<jo&&11>=jo),Mo=String.fromCharCode(32),Ao=!1;function Oo(e,t){switch(e){case"keyup":return-1!==Io.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ro(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Do=!1;var Lo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Lo[e.type]:"textarea"===t}function zo(e,t,n,i){Fa?za?za.push(i):za=[i]:Fa=i,0<(t=Kp(t,"onChange")).length&&(n=new oo("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Uo=null,Ho=null;function Bo(e){Hp(e,0)}function $o(e){if(ya(Ki(e)))return e}function qo(e,t){if("change"===e)return t}var Go=!1;if(qa){var Vo;if(qa){var Wo="oninput"in document;if(!Wo){var Qo=document.createElement("div");Qo.setAttribute("oninput","return;"),Wo="function"==typeof Qo.oninput}Vo=Wo}else Vo=!1;Go=Vo&&(!document.documentMode||9<document.documentMode)}function Ko(){Uo&&(Uo.detachEvent("onpropertychange",Yo),Ho=Uo=null)}function Yo(e){if("value"===e.propertyName&&$o(Ho)){var t=[];zo(t,Ho,e,La(e)),Ba(Bo,t)}}function Xo(e,t,n){"focusin"===e?(Ko(),Ho=n,(Uo=t).attachEvent("onpropertychange",Yo)):"focusout"===e&&Ko()}function Jo(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $o(Ho)}function Zo(e,t){if("click"===e)return $o(t)}function es(e,t){if("input"===e||"change"===e)return $o(t)}var ts="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function ns(e,t){if(ts(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var a=n[i];if(!ni.call(t,a)||!ts(e[a],t[a]))return!1}return!0}function is(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function as(e,t){var n,i=is(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=is(i)}}function os(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?os(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ss(e){for(var t=ba((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=ba((e=t.contentWindow).document)}return t}function rs(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ls=qa&&"documentMode"in document&&11>=document.documentMode,cs=null,us=null,ds=null,hs=!1;function ps(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;hs||null==cs||cs!==ba(i)||("selectionStart"in(i=cs)&&rs(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},ds&&ns(ds,i)||(ds=i,0<(i=Kp(us,"onSelect")).length&&(t=new oo("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=cs)))}function ms(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var fs={animationend:ms("Animation","AnimationEnd"),animationiteration:ms("Animation","AnimationIteration"),animationstart:ms("Animation","AnimationStart"),transitionrun:ms("Transition","TransitionRun"),transitionstart:ms("Transition","TransitionStart"),transitioncancel:ms("Transition","TransitionCancel"),transitionend:ms("Transition","TransitionEnd")},gs={},vs={};function ys(e){if(gs[e])return gs[e];if(!fs[e])return e;var t,n=fs[e];for(t in n)if(n.hasOwnProperty(t)&&t in vs)return gs[e]=n[t];return e}qa&&(vs=document.createElement("div").style,"AnimationEvent"in window||(delete fs.animationend.animation,delete fs.animationiteration.animation,delete fs.animationstart.animation),"TransitionEvent"in window||delete fs.transitionend.transition);var bs=ys("animationend"),xs=ys("animationiteration"),ws=ys("animationstart"),_s=ys("transitionrun"),Ss=ys("transitionstart"),Cs=ys("transitioncancel"),Es=ys("transitionend"),ks=new Map,Is="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ts(e,t){ks.set(e,t),ea(t,[e])}Is.push("scrollEnd");var js=new WeakMap;function Ns(e,t){if("object"==typeof e&&null!==e){var n=js.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ma(t)},js.set(e,t),t)}return{value:e,source:t,stack:ma(t)}}var Ps=[],Ms=0,As=0;function Os(){for(var e=Ms,t=As=Ms=0;t<e;){var n=Ps[t];Ps[t++]=null;var i=Ps[t];Ps[t++]=null;var a=Ps[t];Ps[t++]=null;var o=Ps[t];if(Ps[t++]=null,null!==i&&null!==a){var s=i.pending;null===s?a.next=a:(a.next=s.next,s.next=a),i.pending=a}0!==o&&Fs(n,a,o)}}function Rs(e,t,n,i){Ps[Ms++]=e,Ps[Ms++]=t,Ps[Ms++]=n,Ps[Ms++]=i,As|=i,e.lanes|=i,null!==(e=e.alternate)&&(e.lanes|=i)}function Ds(e,t,n,i){return Rs(e,t,n,i),zs(e)}function Ls(e,t){return Rs(e,null,null,t),zs(e)}function Fs(e,t,n){e.lanes|=n;var i=e.alternate;null!==i&&(i.lanes|=n);for(var a=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(i=o.alternate)&&(i.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(a=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,a&&null!==t&&(a=31-bi(n),null===(i=(e=o.hiddenUpdates)[a])?e[a]=[t]:i.push(t),t.lane=536870912|n),o):null}function zs(e){if(50<Lh)throw Lh=0,Fh=null,Error(hn(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Us={};function Hs(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bs(e,t,n,i){return new Hs(e,t,n,i)}function $s(e){return!(!(e=e.prototype)||!e.isReactComponent)}function qs(e,t){var n=e.alternate;return null===n?((n=Bs(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Gs(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Vs(e,t,n,i,a,o){var s=0;if(i=e,"function"==typeof e)$s(e)&&(s=1);else if("string"==typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,n,Qn.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case An:return(e=Bs(31,n,t,a)).elementType=An,e.lanes=o,e;case _n:return Ws(n.children,a,o,t);case Sn:s=8,a|=24;break;case Cn:return(e=Bs(12,n,t,2|a)).elementType=Cn,e.lanes=o,e;case jn:return(e=Bs(13,n,t,a)).elementType=jn,e.lanes=o,e;case Nn:return(e=Bs(19,n,t,a)).elementType=Nn,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case En:case In:s=10;break e;case kn:s=9;break e;case Tn:s=11;break e;case Pn:s=14;break e;case Mn:s=16,i=null;break e}s=29,n=Error(hn(130,null===e?"null":typeof e,"")),i=null}return(t=Bs(s,n,t,a)).elementType=e,t.type=i,t.lanes=o,t}function Ws(e,t,n,i){return(e=Bs(7,e,i,t)).lanes=n,e}function Qs(e,t,n){return(e=Bs(6,e,null,t)).lanes=n,e}function Ks(e,t,n){return(t=Bs(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Ys=[],Xs=0,Js=null,Zs=0,er=[],tr=0,nr=null,ir=1,ar="";function or(e,t){Ys[Xs++]=Zs,Ys[Xs++]=Js,Js=e,Zs=t}function sr(e,t,n){er[tr++]=ir,er[tr++]=ar,er[tr++]=nr,nr=e;var i=ir;e=ar;var a=32-bi(i)-1;i&=~(1<<a),n+=1;var o=32-bi(t)+a;if(30<o){var s=a-a%5;o=(i&(1<<s)-1).toString(32),i>>=s,a-=s,ir=1<<32-bi(t)+a|n<<a|i,ar=o+e}else ir=1<<o|n<<a|i,ar=e}function rr(e){null!==e.return&&(or(e,1),sr(e,1,0))}function lr(e){for(;e===Js;)Js=Ys[--Xs],Ys[Xs]=null,Zs=Ys[--Xs],Ys[Xs]=null;for(;e===nr;)nr=er[--tr],er[tr]=null,ar=er[--tr],er[tr]=null,ir=er[--tr],er[tr]=null}var cr=null,ur=null,dr=!1,hr=null,pr=!1,mr=Error(hn(519));function fr(e){throw wr(Ns(Error(hn(418,"")),e)),mr}function gr(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[Fi]=e,t[zi]=i,n){case"dialog":Bp("cancel",t),Bp("close",t);break;case"iframe":case"object":case"embed":Bp("load",t);break;case"video":case"audio":for(n=0;n<zp.length;n++)Bp(zp[n],t);break;case"source":Bp("error",t);break;case"img":case"image":case"link":Bp("error",t),Bp("load",t);break;case"details":Bp("toggle",t);break;case"input":Bp("invalid",t),Sa(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),va(t);break;case"select":Bp("invalid",t);break;case"textarea":Bp("invalid",t),Ia(t,i.value,i.defaultValue,i.children),va(t)}"string"!=typeof(n=i.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===i.suppressHydrationWarning||tm(t.textContent,n)?(null!=i.popover&&(Bp("beforetoggle",t),Bp("toggle",t)),null!=i.onScroll&&Bp("scroll",t),null!=i.onScrollEnd&&Bp("scrollend",t),null!=i.onClick&&(t.onclick=nm),t=!0):t=!1,t||fr(e)}function vr(e){for(cr=e.return;cr;)switch(cr.tag){case 5:case 13:return void(pr=!1);case 27:case 3:return void(pr=!0);default:cr=cr.return}}function yr(e){if(e!==cr)return!1;if(!dr)return vr(e),dr=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||dm(e.type,e.memoizedProps)),t=!t),t&&ur&&fr(e),vr(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(hn(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){ur=_m(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}ur=null}}else 27===n?(n=ur,ym(e.type)?(e=Sm,Sm=null,ur=e):ur=n):ur=cr?_m(e.stateNode.nextSibling):null;return!0}function br(){ur=cr=null,dr=!1}function xr(){var e=hr;return null!==e&&(null===Ch?Ch=e:Ch.push.apply(Ch,e),hr=null),e}function wr(e){null===hr?hr=[e]:hr.push(e)}var _r=Gn(null),Sr=null,Cr=null;function Er(e,t,n){Wn(_r,t._currentValue),t._currentValue=n}function kr(e){e._currentValue=_r.current,Vn(_r)}function Ir(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Tr(e,t,n,i){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var o=a.dependencies;if(null!==o){var s=a.child;o=o.firstContext;e:for(;null!==o;){var r=o;o=a;for(var l=0;l<t.length;l++)if(r.context===t[l]){o.lanes|=n,null!==(r=o.alternate)&&(r.lanes|=n),Ir(o.return,n,e),i||(s=null);break e}o=r.next}}else if(18===a.tag){if(null===(s=a.return))throw Error(hn(341));s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),Ir(s,n,e),s=null}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===e){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}}function jr(e,t,n,i){e=null;for(var a=t,o=!1;null!==a;){if(!o)if(524288&a.flags)o=!0;else if(262144&a.flags)break;if(10===a.tag){var s=a.alternate;if(null===s)throw Error(hn(387));if(null!==(s=s.memoizedProps)){var r=a.type;ts(a.pendingProps.value,s.value)||(null!==e?e.push(r):e=[r])}}else if(a===Xn.current){if(null===(s=a.alternate))throw Error(hn(387));s.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push(Zm):e=[Zm])}a=a.return}null!==e&&Tr(t,e,n,i),t.flags|=262144}function Nr(e){for(e=e.firstContext;null!==e;){if(!ts(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Pr(e){Sr=e,Cr=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Mr(e){return Or(Sr,e)}function Ar(e,t){return null===Sr&&Pr(e),Or(e,t)}function Or(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Cr){if(null===e)throw Error(hn(308));Cr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Cr=Cr.next=t;return n}var Rr="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Dr=cn.unstable_scheduleCallback,Lr=cn.unstable_NormalPriority,Fr={$$typeof:In,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zr(){return{controller:new Rr,data:new Map,refCount:0}}function Ur(e){e.refCount--,0===e.refCount&&Dr(Lr,function(){e.controller.abort()})}var Hr=null,Br=0,$r=0,qr=null;function Gr(){if(0===--Br&&null!==Hr){null!==qr&&(qr.status="fulfilled");var e=Hr;Hr=null,$r=0,qr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Vr=Un.S;Un.S=function(e,t){"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===Hr){var n=Hr=[];Br=0,$r=Op(),qr={status:"pending",value:void 0,then:function(e){n.push(e)}}}Br++,t.then(Gr,Gr)}(0,t),null!==Vr&&Vr(e,t)};var Wr=Gn(null);function Qr(){var e=Wr.current;return null!==e?e:lh.pooledCache}function Kr(e,t){Wn(Wr,null===t?Wr.current:t.pool)}function Yr(){var e=Qr();return null===e?null:{parent:Fr._currentValue,pool:e}}var Xr=Error(hn(460)),Jr=Error(hn(474)),Zr=Error(hn(542)),el={then:function(){}};function tl(e){return"fulfilled"===(e=e.status)||"rejected"===e}function nl(){}function il(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(nl,nl),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw sl(e=t.reason),e;default:if("string"==typeof t.status)t.then(nl,nl);else{if(null!==(e=lh)&&100<e.shellSuspendCounter)throw Error(hn(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw sl(e=t.reason),e}throw al=t,Xr}}var al=null;function ol(){if(null===al)throw Error(hn(459));var e=al;return al=null,e}function sl(e){if(e===Xr||e===Zr)throw Error(hn(483))}var rl=!1;function ll(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function cl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ul(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function dl(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,2&rh){var a=i.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),i.pending=t,t=zs(e),Fs(e,null,n),t}return Rs(e,i,t,n),zs(e)}function hl(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Ai(e,n)}}function pl(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var a=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?a=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?a=o=t:o=o.next=t}else a=o=t;return n={baseState:i.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:i.shared,callbacks:i.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var ml=!1;function fl(){if(ml){if(null!==qr)throw qr}}function gl(e,t,n,i){ml=!1;var a=e.updateQueue;rl=!1;var o=a.firstBaseUpdate,s=a.lastBaseUpdate,r=a.shared.pending;if(null!==r){a.shared.pending=null;var l=r,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((r=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===r?u.firstBaseUpdate=c:r.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=a.baseState;for(s=0,u=c=l=null,r=o;;){var h=-536870913&r.lane,p=h!==r.lane;if(p?(uh&h)===h:(i&h)===h){0!==h&&h===$r&&(ml=!0),null!==u&&(u=u.next={lane:0,tag:r.tag,payload:r.payload,callback:null,next:null});e:{var m=e,f=r;h=t;var g=n;switch(f.tag){case 1:if("function"==typeof(m=f.payload)){d=m.call(g,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(h="function"==typeof(m=f.payload)?m.call(g,d,h):m))break e;d=yn({},d,h);break e;case 2:rl=!0}}null!==(h=r.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=a.callbacks)?a.callbacks=[h]:p.push(h))}else p={lane:h,tag:r.tag,payload:r.payload,callback:r.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,s|=h;if(null===(r=r.next)){if(null===(r=a.shared.pending))break;r=(p=r).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}null===u&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null===o&&(a.shared.lanes=0),yh|=s,e.lanes=s,e.memoizedState=d}}function vl(e,t){if("function"!=typeof e)throw Error(hn(191,e));e.call(t)}function yl(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)vl(n[e],t)}var bl=Gn(null),xl=Gn(0);function wl(e,t){Wn(xl,e=gh),Wn(bl,t),gh=e|t.baseLanes}function _l(){Wn(xl,gh),Wn(bl,bl.current)}function Sl(){gh=xl.current,Vn(bl),Vn(xl)}var Cl=0,El=null,kl=null,Il=null,Tl=!1,jl=!1,Nl=!1,Pl=0,Ml=0,Al=null,Ol=0;function Rl(){throw Error(hn(321))}function Dl(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ts(e[n],t[n]))return!1;return!0}function Ll(e,t,n,i,a,o){return Cl=o,El=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Un.H=null===e||null===e.memoizedState?Xc:Jc,Nl=!1,o=n(i,a),Nl=!1,jl&&(o=zl(t,n,i,a)),Fl(e),o}function Fl(e){Un.H=Yc;var t=null!==kl&&null!==kl.next;if(Cl=0,Il=kl=El=null,Tl=!1,Ml=0,Al=null,t)throw Error(hn(300));null===e||Mu||null!==(e=e.dependencies)&&Nr(e)&&(Mu=!0)}function zl(e,t,n,i){El=e;var a=0;do{if(jl&&(Al=null),Ml=0,jl=!1,25<=a)throw Error(hn(301));if(a+=1,Il=kl=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}Un.H=Zc,o=t(n,i)}while(jl);return o}function Ul(){var e=Un.H,t=e.useState()[0];return t="function"==typeof t.then?Vl(t):t,e=e.useState()[0],(null!==kl?kl.memoizedState:null)!==e&&(El.flags|=1024),t}function Hl(){var e=0!==Pl;return Pl=0,e}function Bl(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function $l(e){if(Tl){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Tl=!1}Cl=0,Il=kl=El=null,jl=!1,Ml=Pl=0,Al=null}function ql(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Il?El.memoizedState=Il=e:Il=Il.next=e,Il}function Gl(){if(null===kl){var e=El.alternate;e=null!==e?e.memoizedState:null}else e=kl.next;var t=null===Il?El.memoizedState:Il.next;if(null!==t)Il=t,kl=e;else{if(null===e){if(null===El.alternate)throw Error(hn(467));throw Error(hn(310))}e={memoizedState:(kl=e).memoizedState,baseState:kl.baseState,baseQueue:kl.baseQueue,queue:kl.queue,next:null},null===Il?El.memoizedState=Il=e:Il=Il.next=e}return Il}function Vl(e){var t=Ml;return Ml+=1,null===Al&&(Al=[]),e=il(Al,e,t),t=El,null===(null===Il?t.memoizedState:Il.next)&&(t=t.alternate,Un.H=null===t||null===t.memoizedState?Xc:Jc),e}function Wl(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return Vl(e);if(e.$$typeof===In)return Mr(e)}throw Error(hn(438,String(e)))}function Ql(e){var t=null,n=El.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var i=El.alternate;null!==i&&(null!==(i=i.updateQueue)&&(null!=(i=i.memoCache)&&(t={data:i.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},El.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=On;return t.index++,n}function Kl(e,t){return"function"==typeof t?t(e):t}function Yl(e){return Xl(Gl(),kl,e)}function Xl(e,t,n){var i=e.queue;if(null===i)throw Error(hn(311));i.lastRenderedReducer=n;var a=e.baseQueue,o=i.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}t.baseQueue=a=o,i.pending=null}if(o=e.baseState,null===a)e.memoizedState=o;else{var r=s=null,l=null,c=t=a.next,u=!1;do{var d=-536870913&c.lane;if(d!==c.lane?(uh&d)===d:(Cl&d)===d){var h=c.revertLane;if(0===h)null!==l&&(l=l.next={lane:0,revertLane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),d===$r&&(u=!0);else{if((Cl&h)===h){c=c.next,h===$r&&(u=!0);continue}d={lane:0,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===l?(r=l=d,s=o):l=l.next=d,El.lanes|=h,yh|=h}d=c.action,Nl&&n(o,d),o=c.hasEagerState?c.eagerState:n(o,d)}else h={lane:d,revertLane:c.revertLane,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null},null===l?(r=l=h,s=o):l=l.next=h,El.lanes|=d,yh|=d;c=c.next}while(null!==c&&c!==t);if(null===l?s=o:l.next=r,!ts(o,e.memoizedState)&&(Mu=!0,u&&null!==(n=qr)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=l,i.lastRenderedState=o}return null===a&&(i.lanes=0),[e.memoizedState,i.dispatch]}function Jl(e){var t=Gl(),n=t.queue;if(null===n)throw Error(hn(311));n.lastRenderedReducer=e;var i=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);ts(o,t.memoizedState)||(Mu=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function Zl(e,t,n){var i=El,a=Gl(),o=dr;if(o){if(void 0===n)throw Error(hn(407));n=n()}else n=t();var s=!ts((kl||a).memoizedState,n);if(s&&(a.memoizedState=n,Mu=!0),a=a.queue,_c(2048,8,nc.bind(null,i,a,e),[e]),a.getSnapshot!==t||s||null!==Il&&1&Il.memoizedState.tag){if(i.flags|=2048,bc(9,{destroy:void 0,resource:void 0},tc.bind(null,i,a,n,t),null),null===lh)throw Error(hn(349));o||124&Cl||ec(i,t,n)}return n}function ec(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=El.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},El.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function tc(e,t,n,i){t.value=n,t.getSnapshot=i,ic(t)&&ac(e)}function nc(e,t,n){return n(function(){ic(t)&&ac(e)})}function ic(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ts(e,n)}catch(i){return!0}}function ac(e){var t=Ls(e,2);null!==t&&Hh(t,e,2)}function oc(e){var t=ql();if("function"==typeof e){var n=e;if(e=n(),Nl){yi(!0);try{n()}finally{yi(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kl,lastRenderedState:e},t}function sc(e,t,n,i){return e.baseState=n,Xl(e,kl,"function"==typeof i?i:Kl)}function rc(e,t,n,i,a){if(Wc(e))throw Error(hn(485));if(null!==(e=t.action)){var o={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==Un.T?n(!0):o.isTransition=!1,i(o),null===(n=t.pending)?(o.next=t.pending=o,lc(t,o)):(o.next=n.next,t.pending=n.next=o)}}function lc(e,t){var n=t.action,i=t.payload,a=e.state;if(t.isTransition){var o=Un.T,s={};Un.T=s;try{var r=n(a,i),l=Un.S;null!==l&&l(s,r),cc(e,t,r)}catch(c){dc(e,t,c)}finally{Un.T=o}}else try{cc(e,t,o=n(a,i))}catch(u){dc(e,t,u)}}function cc(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){uc(e,t,n)},function(n){return dc(e,t,n)}):uc(e,t,n)}function uc(e,t,n){t.status="fulfilled",t.value=n,hc(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,lc(e,n)))}function dc(e,t,n){var i=e.pending;if(e.pending=null,null!==i){i=i.next;do{t.status="rejected",t.reason=n,hc(t),t=t.next}while(t!==i)}e.action=null}function hc(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function pc(e,t){return t}function mc(e,t){if(dr){var n=lh.formState;if(null!==n){e:{var i=El;if(dr){if(ur){t:{for(var a=ur,o=pr;8!==a.nodeType;){if(!o){a=null;break t}if(null===(a=_m(a.nextSibling))){a=null;break t}}a="F!"===(o=a.data)||"F"===o?a:null}if(a){ur=_m(a.nextSibling),i="F!"===a.data;break e}}fr(i)}i=!1}i&&(t=n[0])}}return(n=ql()).memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pc,lastRenderedState:t},n.queue=i,n=qc.bind(null,El,i),i.dispatch=n,i=oc(!1),o=Vc.bind(null,El,!1,i.queue),a={state:t,dispatch:null,action:e,pending:null},(i=ql()).queue=a,n=rc.bind(null,El,a,o,n),a.dispatch=n,i.memoizedState=e,[t,n,!1]}function fc(e){return gc(Gl(),kl,e)}function gc(e,t,n){if(t=Xl(e,t,pc)[0],e=Yl(Kl)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var i=Vl(t)}catch(s){if(s===Xr)throw Zr;throw s}else i=t;var a=(t=Gl()).queue,o=a.dispatch;return n!==t.memoizedState&&(El.flags|=2048,bc(9,{destroy:void 0,resource:void 0},vc.bind(null,a,n),null)),[i,o,e]}function vc(e,t){e.action=t}function yc(e){var t=Gl(),n=kl;if(null!==n)return gc(t,n,e);Gl(),t=t.memoizedState;var i=(n=Gl()).queue.dispatch;return n.memoizedState=e,[t,i,!1]}function bc(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},null===(t=El.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},El.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function xc(){return Gl().memoizedState}function wc(e,t,n,i){var a=ql();i=void 0===i?null:i,El.flags|=e,a.memoizedState=bc(1|t,{destroy:void 0,resource:void 0},n,i)}function _c(e,t,n,i){var a=Gl();i=void 0===i?null:i;var o=a.memoizedState.inst;null!==kl&&null!==i&&Dl(i,kl.memoizedState.deps)?a.memoizedState=bc(t,o,n,i):(El.flags|=e,a.memoizedState=bc(1|t,o,n,i))}function Sc(e,t){wc(8390656,8,e,t)}function Cc(e,t){_c(2048,8,e,t)}function Ec(e,t){return _c(4,2,e,t)}function kc(e,t){return _c(4,4,e,t)}function Ic(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Tc(e,t,n){n=null!=n?n.concat([e]):null,_c(4,4,Ic.bind(null,t,e),n)}function jc(){}function Nc(e,t){var n=Gl();t=void 0===t?null:t;var i=n.memoizedState;return null!==t&&Dl(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Pc(e,t){var n=Gl();t=void 0===t?null:t;var i=n.memoizedState;if(null!==t&&Dl(t,i[1]))return i[0];if(i=e(),Nl){yi(!0);try{e()}finally{yi(!1)}}return n.memoizedState=[i,t],i}function Mc(e,t,n){return void 0===n||1073741824&Cl?e.memoizedState=t:(e.memoizedState=n,e=Uh(),El.lanes|=e,yh|=e,n)}function Ac(e,t,n,i){return ts(n,t)?n:null!==bl.current?(e=Mc(e,n,i),ts(e,t)||(Mu=!0),e):42&Cl?(e=Uh(),El.lanes|=e,yh|=e,t):(Mu=!0,e.memoizedState=n)}function Oc(e,t,n,i,a){var o=Hn.p;Hn.p=0!==o&&8>o?o:8;var s,r,l,c=Un.T,u={};Un.T=u,Vc(e,!1,t,n);try{var d=a(),h=Un.S;if(null!==h&&h(u,d),null!==d&&"object"==typeof d&&"function"==typeof d.then)Gc(e,t,(s=i,r=[],l={status:"pending",value:null,reason:null,then:function(e){r.push(e)}},d.then(function(){l.status="fulfilled",l.value=s;for(var e=0;e<r.length;e++)(0,r[e])(s)},function(e){for(l.status="rejected",l.reason=e,e=0;e<r.length;e++)(0,r[e])(void 0)}),l),zh());else Gc(e,t,i,zh())}catch(p){Gc(e,t,{then:function(){},status:"rejected",reason:p},zh())}finally{Hn.p=o,Un.T=c}}function Rc(){}function Dc(e,t,n,i){if(5!==e.tag)throw Error(hn(476));var a=Lc(e).queue;Oc(e,a,t,Bn,null===n?Rc:function(){return Fc(e),n(i)})}function Lc(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:Bn,baseState:Bn,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kl,lastRenderedState:Bn},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Kl,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Fc(e){Gc(e,Lc(e).next.queue,{},zh())}function zc(){return Mr(Zm)}function Uc(){return Gl().memoizedState}function Hc(){return Gl().memoizedState}function Bc(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=zh(),i=dl(t,e=ul(n),n);return null!==i&&(Hh(i,t,n),hl(i,t,n)),t={cache:zr()},void(e.payload=t)}t=t.return}}function $c(e,t,n){var i=zh();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Wc(e)?Qc(t,n):null!==(n=Ds(e,t,n,i))&&(Hh(n,e,i),Kc(n,t,i))}function qc(e,t,n){Gc(e,t,n,zh())}function Gc(e,t,n,i){var a={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Wc(e))Qc(t,a);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,r=o(s,n);if(a.hasEagerState=!0,a.eagerState=r,ts(r,s))return Rs(e,t,a,0),null===lh&&Os(),!1}catch(l){}if(null!==(n=Ds(e,t,a,i)))return Hh(n,e,i),Kc(n,t,i),!0}return!1}function Vc(e,t,n,i){if(i={lane:2,revertLane:Op(),action:i,hasEagerState:!1,eagerState:null,next:null},Wc(e)){if(t)throw Error(hn(479))}else null!==(t=Ds(e,n,i,2))&&Hh(t,e,2)}function Wc(e){var t=e.alternate;return e===El||null!==t&&t===El}function Qc(e,t){jl=Tl=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Kc(e,t,n){if(4194048&n){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,Ai(e,n)}}var Yc={readContext:Mr,use:Wl,useCallback:Rl,useContext:Rl,useEffect:Rl,useImperativeHandle:Rl,useLayoutEffect:Rl,useInsertionEffect:Rl,useMemo:Rl,useReducer:Rl,useRef:Rl,useState:Rl,useDebugValue:Rl,useDeferredValue:Rl,useTransition:Rl,useSyncExternalStore:Rl,useId:Rl,useHostTransitionStatus:Rl,useFormState:Rl,useActionState:Rl,useOptimistic:Rl,useMemoCache:Rl,useCacheRefresh:Rl},Xc={readContext:Mr,use:Wl,useCallback:function(e,t){return ql().memoizedState=[e,void 0===t?null:t],e},useContext:Mr,useEffect:Sc,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,wc(4194308,4,Ic.bind(null,t,e),n)},useLayoutEffect:function(e,t){return wc(4194308,4,e,t)},useInsertionEffect:function(e,t){wc(4,2,e,t)},useMemo:function(e,t){var n=ql();t=void 0===t?null:t;var i=e();if(Nl){yi(!0);try{e()}finally{yi(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=ql();if(void 0!==n){var a=n(t);if(Nl){yi(!0);try{n(t)}finally{yi(!1)}}}else a=t;return i.memoizedState=i.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},i.queue=e,e=e.dispatch=$c.bind(null,El,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},ql().memoizedState=e},useState:function(e){var t=(e=oc(e)).queue,n=qc.bind(null,El,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:jc,useDeferredValue:function(e,t){return Mc(ql(),e,t)},useTransition:function(){var e=oc(!1);return e=Oc.bind(null,El,e.queue,!0,!1),ql().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=El,a=ql();if(dr){if(void 0===n)throw Error(hn(407));n=n()}else{if(n=t(),null===lh)throw Error(hn(349));124&uh||ec(i,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Sc(nc.bind(null,i,o,e),[e]),i.flags|=2048,bc(9,{destroy:void 0,resource:void 0},tc.bind(null,i,o,n,t),null),n},useId:function(){var e=ql(),t=lh.identifierPrefix;if(dr){var n=ar;t=""+t+"R"+(n=(ir&~(1<<32-bi(ir)-1)).toString(32)+n),0<(n=Pl++)&&(t+="H"+n.toString(32)),t+=""}else t=""+t+"r"+(n=Ol++).toString(32)+"";return e.memoizedState=t},useHostTransitionStatus:zc,useFormState:mc,useActionState:mc,useOptimistic:function(e){var t=ql();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Vc.bind(null,El,!0,n),n.dispatch=t,[e,t]},useMemoCache:Ql,useCacheRefresh:function(){return ql().memoizedState=Bc.bind(null,El)}},Jc={readContext:Mr,use:Wl,useCallback:Nc,useContext:Mr,useEffect:Cc,useImperativeHandle:Tc,useInsertionEffect:Ec,useLayoutEffect:kc,useMemo:Pc,useReducer:Yl,useRef:xc,useState:function(){return Yl(Kl)},useDebugValue:jc,useDeferredValue:function(e,t){return Ac(Gl(),kl.memoizedState,e,t)},useTransition:function(){var e=Yl(Kl)[0],t=Gl().memoizedState;return["boolean"==typeof e?e:Vl(e),t]},useSyncExternalStore:Zl,useId:Uc,useHostTransitionStatus:zc,useFormState:fc,useActionState:fc,useOptimistic:function(e,t){return sc(Gl(),0,e,t)},useMemoCache:Ql,useCacheRefresh:Hc},Zc={readContext:Mr,use:Wl,useCallback:Nc,useContext:Mr,useEffect:Cc,useImperativeHandle:Tc,useInsertionEffect:Ec,useLayoutEffect:kc,useMemo:Pc,useReducer:Jl,useRef:xc,useState:function(){return Jl(Kl)},useDebugValue:jc,useDeferredValue:function(e,t){var n=Gl();return null===kl?Mc(n,e,t):Ac(n,kl.memoizedState,e,t)},useTransition:function(){var e=Jl(Kl)[0],t=Gl().memoizedState;return["boolean"==typeof e?e:Vl(e),t]},useSyncExternalStore:Zl,useId:Uc,useHostTransitionStatus:zc,useFormState:yc,useActionState:yc,useOptimistic:function(e,t){var n=Gl();return null!==kl?sc(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Ql,useCacheRefresh:Hc},eu=null,tu=0;function nu(e){var t=tu;return tu+=1,null===eu&&(eu=[]),il(eu,e,t)}function iu(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function au(e,t){if(t.$$typeof===bn)throw Error(hn(525));throw e=Object.prototype.toString.call(t),Error(hn(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ou(e){return(0,e._init)(e._payload)}function su(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(e,t){return(e=qs(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=67108866,n):i:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function r(e,t,n,i){return null===t||6!==t.tag?((t=Qs(n,e.mode,i)).return=e,t):((t=a(t,n)).return=e,t)}function l(e,t,n,i){var o=n.type;return o===_n?u(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===Mn&&ou(o)===t.type)?(iu(t=a(t,n.props),n),t.return=e,t):(iu(t=Vs(n.type,n.key,n.props,null,e.mode,i),n),t.return=e,t)}function c(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ks(n,e.mode,i)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function u(e,t,n,i,o){return null===t||7!==t.tag?((t=Ws(n,e.mode,i,o)).return=e,t):((t=a(t,n)).return=e,t)}function d(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Qs(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case xn:return iu(n=Vs(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case wn:return(t=Ks(t,e.mode,n)).return=e,t;case Mn:return d(e,t=(0,t._init)(t._payload),n)}if(zn(t)||Dn(t))return(t=Ws(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return d(e,nu(t),n);if(t.$$typeof===In)return d(e,Ar(e,t),n);au(e,t)}return null}function h(e,t,n,i){var a=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==a?null:r(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case xn:return n.key===a?l(e,t,n,i):null;case wn:return n.key===a?c(e,t,n,i):null;case Mn:return h(e,t,n=(a=n._init)(n._payload),i)}if(zn(n)||Dn(n))return null!==a?null:u(e,t,n,i,null);if("function"==typeof n.then)return h(e,t,nu(n),i);if(n.$$typeof===In)return h(e,t,Ar(e,n),i);au(e,n)}return null}function p(e,t,n,i,a){if("string"==typeof i&&""!==i||"number"==typeof i||"bigint"==typeof i)return r(t,e=e.get(n)||null,""+i,a);if("object"==typeof i&&null!==i){switch(i.$$typeof){case xn:return l(t,e=e.get(null===i.key?n:i.key)||null,i,a);case wn:return c(t,e=e.get(null===i.key?n:i.key)||null,i,a);case Mn:return p(e,t,n,i=(0,i._init)(i._payload),a)}if(zn(i)||Dn(i))return u(t,e=e.get(n)||null,i,a,null);if("function"==typeof i.then)return p(e,t,n,nu(i),a);if(i.$$typeof===In)return p(e,t,n,Ar(t,i),a);au(t,i)}return null}function m(r,l,c,u){if("object"==typeof c&&null!==c&&c.type===_n&&null===c.key&&(c=c.props.children),"object"==typeof c&&null!==c){switch(c.$$typeof){case xn:e:{for(var f=c.key;null!==l;){if(l.key===f){if((f=c.type)===_n){if(7===l.tag){n(r,l.sibling),(u=a(l,c.props.children)).return=r,r=u;break e}}else if(l.elementType===f||"object"==typeof f&&null!==f&&f.$$typeof===Mn&&ou(f)===l.type){n(r,l.sibling),iu(u=a(l,c.props),c),u.return=r,r=u;break e}n(r,l);break}t(r,l),l=l.sibling}c.type===_n?((u=Ws(c.props.children,r.mode,u,c.key)).return=r,r=u):(iu(u=Vs(c.type,c.key,c.props,null,r.mode,u),c),u.return=r,r=u)}return s(r);case wn:e:{for(f=c.key;null!==l;){if(l.key===f){if(4===l.tag&&l.stateNode.containerInfo===c.containerInfo&&l.stateNode.implementation===c.implementation){n(r,l.sibling),(u=a(l,c.children||[])).return=r,r=u;break e}n(r,l);break}t(r,l),l=l.sibling}(u=Ks(c,r.mode,u)).return=r,r=u}return s(r);case Mn:return m(r,l,c=(f=c._init)(c._payload),u)}if(zn(c))return function(a,s,r,l){for(var c=null,u=null,m=s,f=s=0,g=null;null!==m&&f<r.length;f++){m.index>f?(g=m,m=null):g=m.sibling;var v=h(a,m,r[f],l);if(null===v){null===m&&(m=g);break}e&&m&&null===v.alternate&&t(a,m),s=o(v,s,f),null===u?c=v:u.sibling=v,u=v,m=g}if(f===r.length)return n(a,m),dr&&or(a,f),c;if(null===m){for(;f<r.length;f++)null!==(m=d(a,r[f],l))&&(s=o(m,s,f),null===u?c=m:u.sibling=m,u=m);return dr&&or(a,f),c}for(m=i(m);f<r.length;f++)null!==(g=p(m,a,f,r[f],l))&&(e&&null!==g.alternate&&m.delete(null===g.key?f:g.key),s=o(g,s,f),null===u?c=g:u.sibling=g,u=g);return e&&m.forEach(function(e){return t(a,e)}),dr&&or(a,f),c}(r,l,c,u);if(Dn(c)){if("function"!=typeof(f=Dn(c)))throw Error(hn(150));return function(a,s,r,l){if(null==r)throw Error(hn(151));for(var c=null,u=null,m=s,f=s=0,g=null,v=r.next();null!==m&&!v.done;f++,v=r.next()){m.index>f?(g=m,m=null):g=m.sibling;var y=h(a,m,v.value,l);if(null===y){null===m&&(m=g);break}e&&m&&null===y.alternate&&t(a,m),s=o(y,s,f),null===u?c=y:u.sibling=y,u=y,m=g}if(v.done)return n(a,m),dr&&or(a,f),c;if(null===m){for(;!v.done;f++,v=r.next())null!==(v=d(a,v.value,l))&&(s=o(v,s,f),null===u?c=v:u.sibling=v,u=v);return dr&&or(a,f),c}for(m=i(m);!v.done;f++,v=r.next())null!==(v=p(m,a,f,v.value,l))&&(e&&null!==v.alternate&&m.delete(null===v.key?f:v.key),s=o(v,s,f),null===u?c=v:u.sibling=v,u=v);return e&&m.forEach(function(e){return t(a,e)}),dr&&or(a,f),c}(r,l,c=f.call(c),u)}if("function"==typeof c.then)return m(r,l,nu(c),u);if(c.$$typeof===In)return m(r,l,Ar(r,c),u);au(r,c)}return"string"==typeof c&&""!==c||"number"==typeof c||"bigint"==typeof c?(c=""+c,null!==l&&6===l.tag?(n(r,l.sibling),(u=a(l,c)).return=r,r=u):(n(r,l),(u=Qs(c,r.mode,u)).return=r,r=u),s(r)):n(r,l)}return function(e,t,n,i){try{tu=0;var a=m(e,t,n,i);return eu=null,a}catch(s){if(s===Xr||s===Zr)throw s;var o=Bs(29,s,null,e.mode);return o.lanes=i,o.return=e,o}}}var ru=su(!0),lu=su(!1),cu=Gn(null),uu=null;function du(e){var t=e.alternate;Wn(fu,1&fu.current),Wn(cu,e),null===uu&&(null===t||null!==bl.current||null!==t.memoizedState)&&(uu=e)}function hu(e){if(22===e.tag){if(Wn(fu,fu.current),Wn(cu,e),null===uu){var t=e.alternate;null!==t&&null!==t.memoizedState&&(uu=e)}}else pu()}function pu(){Wn(fu,fu.current),Wn(cu,cu.current)}function mu(e){Vn(cu),uu===e&&(uu=null),Vn(fu)}var fu=Gn(0);function gu(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||wm(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function vu(e,t,n,i){n=null==(n=n(i,t=e.memoizedState))?t:yn({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var yu={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=zh(),a=ul(i);a.payload=t,null!=n&&(a.callback=n),null!==(t=dl(e,a,i))&&(Hh(t,e,i),hl(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=zh(),a=ul(i);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=dl(e,a,i))&&(Hh(t,e,i),hl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=zh(),i=ul(n);i.tag=2,null!=t&&(i.callback=t),null!==(t=dl(e,i,n))&&(Hh(t,e,n),hl(t,e,n))}};function bu(e,t,n,i,a,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!ns(n,i)||!ns(a,o))}function xu(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&yu.enqueueReplaceState(t,t.state,null)}function wu(e,t){var n=t;if("ref"in t)for(var i in n={},t)"ref"!==i&&(n[i]=t[i]);if(e=e.defaultProps)for(var a in n===t&&(n=yn({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}var _u="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)};function Su(e){_u(e)}function Cu(e){}function Eu(e){_u(e)}function ku(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Iu(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function Tu(e,t,n){return(n=ul(n)).tag=3,n.payload={element:null},n.callback=function(){ku(e,t)},n}function ju(e){return(e=ul(e)).tag=3,e}function Nu(e,t,n,i){var a=n.type.getDerivedStateFromError;if("function"==typeof a){var o=i.value;e.payload=function(){return a(o)},e.callback=function(){Iu(t,n,i)}}var s=n.stateNode;null!==s&&"function"==typeof s.componentDidCatch&&(e.callback=function(){Iu(t,n,i),"function"!=typeof a&&(null===jh?jh=new Set([this]):jh.add(this));var e=i.stack;this.componentDidCatch(i.value,{componentStack:null!==e?e:""})})}var Pu=Error(hn(461)),Mu=!1;function Au(e,t,n,i){t.child=null===e?lu(t,null,n,i):ru(t,e.child,n,i)}function Ou(e,t,n,i,a){n=n.render;var o=t.ref;if("ref"in i){var s={};for(var r in i)"ref"!==r&&(s[r]=i[r])}else s=i;return Pr(t),i=Ll(e,t,n,s,o,a),r=Hl(),null===e||Mu?(dr&&r&&rr(t),t.flags|=1,Au(e,t,i,a),t.child):(Bl(e,t,a),ed(e,t,a))}function Ru(e,t,n,i,a){if(null===e){var o=n.type;return"function"!=typeof o||$s(o)||void 0!==o.defaultProps||null!==n.compare?((e=Vs(n.type,null,i,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Du(e,t,o,i,a))}if(o=e.child,!td(e,a)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:ns)(s,i)&&e.ref===t.ref)return ed(e,t,a)}return t.flags|=1,(e=qs(o,i)).ref=t.ref,e.return=t,t.child=e}function Du(e,t,n,i,a){if(null!==e){var o=e.memoizedProps;if(ns(o,i)&&e.ref===t.ref){if(Mu=!1,t.pendingProps=i=o,!td(e,a))return t.lanes=e.lanes,ed(e,t,a);131072&e.flags&&(Mu=!0)}}return Uu(e,t,n,i,a)}function Lu(e,t,n){var i=t.pendingProps,a=i.children,o=null!==e?e.memoizedState:null;if("hidden"===i.mode){if(128&t.flags){if(i=null!==o?o.baseLanes|n:n,null!==e){for(a=t.child=e.child,o=0;null!==a;)o=o|a.lanes|a.childLanes,a=a.sibling;t.childLanes=o&~i}else t.childLanes=0,t.child=null;return Fu(e,t,i,n)}if(!(536870912&n))return t.lanes=t.childLanes=536870912,Fu(e,t,null!==o?o.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Kr(0,null!==o?o.cachePool:null),null!==o?wl(t,o):_l(),hu(t)}else null!==o?(Kr(0,o.cachePool),wl(t,o),pu(),t.memoizedState=null):(null!==e&&Kr(0,null),_l(),pu());return Au(e,t,a,n),t.child}function Fu(e,t,n,i){var a=Qr();return a=null===a?null:{parent:Fr._currentValue,pool:a},t.memoizedState={baseLanes:n,cachePool:a},null!==e&&Kr(0,null),_l(),hu(t),null!==e&&jr(e,t,i,!0),null}function zu(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(hn(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Uu(e,t,n,i,a){return Pr(t),n=Ll(e,t,n,i,void 0,a),i=Hl(),null===e||Mu?(dr&&i&&rr(t),t.flags|=1,Au(e,t,n,a),t.child):(Bl(e,t,a),ed(e,t,a))}function Hu(e,t,n,i,a,o){return Pr(t),t.updateQueue=null,n=zl(t,i,n,a),Fl(e),i=Hl(),null===e||Mu?(dr&&i&&rr(t),t.flags|=1,Au(e,t,n,o),t.child):(Bl(e,t,o),ed(e,t,o))}function Bu(e,t,n,i,a){if(Pr(t),null===t.stateNode){var o=Us,s=n.contextType;"object"==typeof s&&null!==s&&(o=Mr(s)),o=new n(i,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=yu,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=i,o.state=t.memoizedState,o.refs={},ll(t),s=n.contextType,o.context="object"==typeof s&&null!==s?Mr(s):Us,o.state=t.memoizedState,"function"==typeof(s=n.getDerivedStateFromProps)&&(vu(t,n,s,i),o.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(s=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),s!==o.state&&yu.enqueueReplaceState(o,o.state,null),gl(t,i,o,a),fl(),o.state=t.memoizedState),"function"==typeof o.componentDidMount&&(t.flags|=4194308),i=!0}else if(null===e){o=t.stateNode;var r=t.memoizedProps,l=wu(n,r);o.props=l;var c=o.context,u=n.contextType;s=Us,"object"==typeof u&&null!==u&&(s=Mr(u));var d=n.getDerivedStateFromProps;u="function"==typeof d||"function"==typeof o.getSnapshotBeforeUpdate,r=t.pendingProps!==r,u||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(r||c!==s)&&xu(t,o,i,s),rl=!1;var h=t.memoizedState;o.state=h,gl(t,i,o,a),fl(),c=t.memoizedState,r||h!==c||rl?("function"==typeof d&&(vu(t,n,d,i),c=t.memoizedState),(l=rl||bu(t,n,l,i,h,c,s))?(u||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=c),o.props=i,o.state=c,o.context=s,i=l):("function"==typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,cl(e,t),u=wu(n,s=t.memoizedProps),o.props=u,d=t.pendingProps,h=o.context,c=n.contextType,l=Us,"object"==typeof c&&null!==c&&(l=Mr(c)),(c="function"==typeof(r=n.getDerivedStateFromProps)||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==d||h!==l)&&xu(t,o,i,l),rl=!1,h=t.memoizedState,o.state=h,gl(t,i,o,a),fl();var p=t.memoizedState;s!==d||h!==p||rl||null!==e&&null!==e.dependencies&&Nr(e.dependencies)?("function"==typeof r&&(vu(t,n,r,i),p=t.memoizedState),(u=rl||bu(t,n,u,i,h,p,l)||null!==e&&null!==e.dependencies&&Nr(e.dependencies))?(c||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(i,p,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,p,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),o.props=i,o.state=p,o.context=l,i=u):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return o=i,zu(e,t),i=!!(128&t.flags),o||i?(o=t.stateNode,n=i&&"function"!=typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&i?(t.child=ru(t,e.child,null,a),t.child=ru(t,null,n,a)):Au(e,t,n,a),t.memoizedState=o.state,e=t.child):e=ed(e,t,a),e}function $u(e,t,n,i){return br(),t.flags|=256,Au(e,t,n,i),t.child}var qu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Gu(e){return{baseLanes:e,cachePool:Yr()}}function Vu(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=wh),e}function Wu(e,t,n){var i,a=t.pendingProps,o=!1,s=!!(128&t.flags);if((i=s)||(i=(null===e||null!==e.memoizedState)&&!!(2&fu.current)),i&&(o=!0,t.flags&=-129),i=!!(32&t.flags),t.flags&=-33,null===e){if(dr){if(o?du(t):pu(),dr){var r,l=ur;if(r=l){e:{for(r=l,l=pr;8!==r.nodeType;){if(!l){l=null;break e}if(null===(r=_m(r.nextSibling))){l=null;break e}}l=r}null!==l?(t.memoizedState={dehydrated:l,treeContext:null!==nr?{id:ir,overflow:ar}:null,retryLane:536870912,hydrationErrors:null},(r=Bs(18,null,null,0)).stateNode=l,r.return=t,t.child=r,cr=t,ur=null,r=!0):r=!1}r||fr(t)}if(null!==(l=t.memoizedState)&&null!==(l=l.dehydrated))return wm(l)?t.lanes=32:t.lanes=536870912,null;mu(t)}return l=a.children,a=a.fallback,o?(pu(),l=Ku({mode:"hidden",children:l},o=t.mode),a=Ws(a,o,n,null),l.return=t,a.return=t,l.sibling=a,t.child=l,(o=t.child).memoizedState=Gu(n),o.childLanes=Vu(e,i,n),t.memoizedState=qu,a):(du(t),Qu(t,l))}if(null!==(r=e.memoizedState)&&null!==(l=r.dehydrated)){if(s)256&t.flags?(du(t),t.flags&=-257,t=Yu(e,t,n)):null!==t.memoizedState?(pu(),t.child=e.child,t.flags|=128,t=null):(pu(),o=a.fallback,l=t.mode,a=Ku({mode:"visible",children:a.children},l),(o=Ws(o,l,n,null)).flags|=2,a.return=t,o.return=t,a.sibling=o,t.child=a,ru(t,e.child,null,n),(a=t.child).memoizedState=Gu(n),a.childLanes=Vu(e,i,n),t.memoizedState=qu,t=o);else if(du(t),wm(l)){if(i=l.nextSibling&&l.nextSibling.dataset)var c=i.dgst;i=c,(a=Error(hn(419))).stack="",a.digest=i,wr({value:a,source:null,stack:null}),t=Yu(e,t,n)}else if(Mu||jr(e,t,n,!1),i=0!==(n&e.childLanes),Mu||i){if(null!==(i=lh)&&(0!==(a=0!==((a=42&(a=n&-n)?1:Oi(a))&(i.suspendedLanes|n))?0:a)&&a!==r.retryLane))throw r.retryLane=a,Ls(e,a),Hh(i,e,a),Pu;"$?"===l.data||Jh(),t=Yu(e,t,n)}else"$?"===l.data?(t.flags|=192,t.child=e.child,t=null):(e=r.treeContext,ur=_m(l.nextSibling),cr=t,dr=!0,hr=null,pr=!1,null!==e&&(er[tr++]=ir,er[tr++]=ar,er[tr++]=nr,ir=e.id,ar=e.overflow,nr=t),(t=Qu(t,a.children)).flags|=4096);return t}return o?(pu(),o=a.fallback,l=t.mode,c=(r=e.child).sibling,(a=qs(r,{mode:"hidden",children:a.children})).subtreeFlags=65011712&r.subtreeFlags,null!==c?o=qs(c,o):(o=Ws(o,l,n,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,null===(l=e.child.memoizedState)?l=Gu(n):(null!==(r=l.cachePool)?(c=Fr._currentValue,r=r.parent!==c?{parent:c,pool:c}:r):r=Yr(),l={baseLanes:l.baseLanes|n,cachePool:r}),o.memoizedState=l,o.childLanes=Vu(e,i,n),t.memoizedState=qu,a):(du(t),e=(n=e.child).sibling,(n=qs(n,{mode:"visible",children:a.children})).return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n)}function Qu(e,t){return(t=Ku({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Ku(e,t){return(e=Bs(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Yu(e,t,n){return ru(t,e.child,null,n),(e=Qu(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Xu(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ir(e.return,t,n)}function Ju(e,t,n,i,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=a)}function Zu(e,t,n){var i=t.pendingProps,a=i.revealOrder,o=i.tail;if(Au(e,t,i.children,n),2&(i=fu.current))i=1&i|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Xu(e,n,t);else if(19===e.tag)Xu(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}switch(Wn(fu,i),a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===gu(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Ju(t,!1,a,n,o);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===gu(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Ju(t,!0,n,null,o);break;case"together":Ju(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ed(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),yh|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(jr(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(hn(153));if(null!==t.child){for(n=qs(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=qs(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function td(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Nr(e))}function nd(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Mu=!0;else{if(!(td(e,n)||128&t.flags))return Mu=!1,function(e,t,n){switch(t.tag){case 3:Jn(t,t.stateNode.containerInfo),Er(0,Fr,e.memoizedState.cache),br();break;case 27:case 5:ei(t);break;case 4:Jn(t,t.stateNode.containerInfo);break;case 10:Er(0,t.type,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(null!==i)return null!==i.dehydrated?(du(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Wu(e,t,n):(du(t),null!==(e=ed(e,t,n))?e.sibling:null);du(t);break;case 19:var a=!!(128&e.flags);if((i=0!==(n&t.childLanes))||(jr(e,t,n,!1),i=0!==(n&t.childLanes)),a){if(i)return Zu(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Wn(fu,fu.current),i)break;return null;case 22:case 23:return t.lanes=0,Lu(e,t,n);case 24:Er(0,Fr,e.memoizedState.cache)}return ed(e,t,n)}(e,t,n);Mu=!!(131072&e.flags)}else Mu=!1,dr&&1048576&t.flags&&sr(t,Zs,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var i=t.elementType,a=i._init;if(i=a(i._payload),t.type=i,"function"!=typeof i){if(null!=i){if((a=i.$$typeof)===Tn){t.tag=11,t=Ou(null,t,i,e,n);break e}if(a===Pn){t.tag=14,t=Ru(null,t,i,e,n);break e}}throw t=Fn(i)||i,Error(hn(306,t,""))}$s(i)?(e=wu(i,e),t.tag=1,t=Bu(null,t,i,e,n)):(t.tag=0,t=Uu(null,t,i,e,n))}return t;case 0:return Uu(e,t,t.type,t.pendingProps,n);case 1:return Bu(e,t,i=t.type,a=wu(i,t.pendingProps),n);case 3:e:{if(Jn(t,t.stateNode.containerInfo),null===e)throw Error(hn(387));i=t.pendingProps;var o=t.memoizedState;a=o.element,cl(e,t),gl(t,i,null,n);var s=t.memoizedState;if(i=s.cache,Er(0,Fr,i),i!==o.cache&&Tr(t,[Fr],n,!0),fl(),i=s.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=$u(e,t,i,n);break e}if(i!==a){wr(a=Ns(Error(hn(424)),t)),t=$u(e,t,i,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ur=_m(e.firstChild),cr=t,dr=!0,hr=null,pr=!0,n=lu(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(br(),i===a){t=ed(e,t,n);break e}Au(e,t,i,n)}t=t.child}return t;case 26:return zu(e,t),null===e?(n=Am(t.type,null,t.pendingProps,null))?t.memoizedState=n:dr||(n=t.type,e=t.pendingProps,(i=lm(Yn.current).createElement(n))[Fi]=t,i[zi]=e,om(i,n,e),Xi(i),t.stateNode=i):t.memoizedState=Am(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return ei(t),null===e&&dr&&(i=t.stateNode=Em(t.type,t.pendingProps,Yn.current),cr=t,pr=!0,a=ur,ym(t.type)?(Sm=a,ur=_m(i.firstChild)):ur=a),Au(e,t,t.pendingProps.children,n),zu(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&dr&&((a=i=ur)&&(null!==(i=function(e,t,n,i){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(i){if(!e[Gi])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===o)return e}if(null===(e=_m(e.nextSibling)))break}return null}(i,t.type,t.pendingProps,pr))?(t.stateNode=i,cr=t,ur=_m(i.firstChild),pr=!1,a=!0):a=!1),a||fr(t)),ei(t),a=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,i=o.children,dm(a,o)?i=null:null!==s&&dm(a,s)&&(t.flags|=32),null!==t.memoizedState&&(a=Ll(e,t,Ul,null,null,n),Zm._currentValue=a),zu(e,t),Au(e,t,i,n),t.child;case 6:return null===e&&dr&&((e=n=ur)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=_m(e.nextSibling)))return null}return e}(n,t.pendingProps,pr))?(t.stateNode=n,cr=t,ur=null,e=!0):e=!1),e||fr(t)),null;case 13:return Wu(e,t,n);case 4:return Jn(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=ru(t,null,i,n):Au(e,t,i,n),t.child;case 11:return Ou(e,t,t.type,t.pendingProps,n);case 7:return Au(e,t,t.pendingProps,n),t.child;case 8:case 12:return Au(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,Er(0,t.type,i.value),Au(e,t,i.children,n),t.child;case 9:return a=t.type._context,i=t.pendingProps.children,Pr(t),i=i(a=Mr(a)),t.flags|=1,Au(e,t,i,n),t.child;case 14:return Ru(e,t,t.type,t.pendingProps,n);case 15:return Du(e,t,t.type,t.pendingProps,n);case 19:return Zu(e,t,n);case 31:return i=t.pendingProps,n=t.mode,i={mode:i.mode,children:i.children},null===e?((n=Ku(i,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=qs(e.child,i)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Lu(e,t,n);case 24:return Pr(t),i=Mr(Fr),null===e?(null===(a=Qr())&&(a=lh,o=zr(),a.pooledCache=o,o.refCount++,null!==o&&(a.pooledCacheLanes|=n),a=o),t.memoizedState={parent:i,cache:a},ll(t),Er(0,Fr,a)):(0!==(e.lanes&n)&&(cl(e,t),gl(t,null,null,n),fl()),a=e.memoizedState,o=t.memoizedState,a.parent!==i?(a={parent:i,cache:i},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),Er(0,Fr,i)):(i=o.cache,Er(0,Fr,i),i!==a.cache&&Tr(t,[Fr],n,!0))),Au(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(hn(156,t.tag))}function id(e){e.flags|=4}function ad(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!Vm(t)){if(null!==(t=cu.current)&&((4194048&uh)===uh?null!==uu:(62914560&uh)!==uh&&!(536870912&uh)||t!==uu))throw al=el,Jr;e.flags|=8192}}function od(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?ji():536870912,e.lanes|=t,_h|=t)}function sd(e,t){if(!dr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function rd(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,i|=65011712&a.subtreeFlags,i|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,i|=a.subtreeFlags,i|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function ld(e,t,n){var i=t.pendingProps;switch(lr(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return rd(t),null;case 3:return n=t.stateNode,i=null,null!==e&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),kr(Fr),Zn(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(yr(t)?id(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,xr())),rd(t),null;case 26:return n=t.memoizedState,null===e?(id(t),null!==n?(rd(t),ad(t,n)):(rd(t),t.flags&=-16777217)):n?n!==e.memoizedState?(id(t),rd(t),ad(t,n)):(rd(t),t.flags&=-16777217):(e.memoizedProps!==i&&id(t),rd(t),t.flags&=-16777217),null;case 27:ti(t),n=Yn.current;var a=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==i&&id(t);else{if(!i){if(null===t.stateNode)throw Error(hn(166));return rd(t),null}e=Qn.current,yr(t)?gr(t):(e=Em(a,i,n),t.stateNode=e,id(t))}return rd(t),null;case 5:if(ti(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&id(t);else{if(!i){if(null===t.stateNode)throw Error(hn(166));return rd(t),null}if(e=Qn.current,yr(t))gr(t);else{switch(a=lm(Yn.current),e){case 1:e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=a.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=a.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"==typeof i.is?a.createElement("select",{is:i.is}):a.createElement("select"),i.multiple?e.multiple=!0:i.size&&(e.size=i.size);break;default:e="string"==typeof i.is?a.createElement(n,{is:i.is}):a.createElement(n)}}e[Fi]=t,e[zi]=i;e:for(a=t.child;null!==a;){if(5===a.tag||6===a.tag)e.appendChild(a.stateNode);else if(4!==a.tag&&27!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;null===a.sibling;){if(null===a.return||a.return===t)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}t.stateNode=e;e:switch(om(e,n,i),n){case"button":case"input":case"select":case"textarea":e=!!i.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&id(t)}}return rd(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==i&&id(t);else{if("string"!=typeof i&&null===t.stateNode)throw Error(hn(166));if(e=Yn.current,yr(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,null!==(a=cr))switch(a.tag){case 27:case 5:i=a.memoizedProps}e[Fi]=t,(e=!!(e.nodeValue===n||null!==i&&!0===i.suppressHydrationWarning||tm(e.nodeValue,n)))||fr(t)}else(e=lm(e).createTextNode(i))[Fi]=t,t.stateNode=e}return rd(t),null;case 13:if(i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=yr(t),null!==i&&null!==i.dehydrated){if(null===e){if(!a)throw Error(hn(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(hn(317));a[Fi]=t}else br(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;rd(t),a=!1}else a=xr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return 256&t.flags?(mu(t),t):(mu(t),null)}if(mu(t),128&t.flags)return t.lanes=n,t;if(n=null!==i,e=null!==e&&null!==e.memoizedState,n){a=null,null!==(i=t.child).alternate&&null!==i.alternate.memoizedState&&null!==i.alternate.memoizedState.cachePool&&(a=i.alternate.memoizedState.cachePool.pool);var o=null;null!==i.memoizedState&&null!==i.memoizedState.cachePool&&(o=i.memoizedState.cachePool.pool),o!==a&&(i.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),od(t,t.updateQueue),rd(t),null;case 4:return Zn(),null===e&&Gp(t.stateNode.containerInfo),rd(t),null;case 10:return kr(t.type),rd(t),null;case 19:if(Vn(fu),null===(a=t.memoizedState))return rd(t),null;if(i=!!(128&t.flags),null===(o=a.rendering))if(i)sd(a,!1);else{if(0!==vh||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(o=gu(e))){for(t.flags|=128,sd(a,!1),e=o.updateQueue,t.updateQueue=e,od(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Gs(n,e),n=n.sibling;return Wn(fu,1&fu.current|2),t.child}e=e.sibling}null!==a.tail&&ri()>Ih&&(t.flags|=128,i=!0,sd(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=gu(o))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,od(t,e),sd(a,!0),null===a.tail&&"hidden"===a.tailMode&&!o.alternate&&!dr)return rd(t),null}else 2*ri()-a.renderingStartTime>Ih&&536870912!==n&&(t.flags|=128,i=!0,sd(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=a.last)?e.sibling=o:t.child=o,a.last=o)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=ri(),t.sibling=null,e=fu.current,Wn(fu,i?1&e|2:1&e),t):(rd(t),null);case 22:case 23:return mu(t),Sl(),i=null!==t.memoizedState,null!==e?null!==e.memoizedState!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?!!(536870912&n)&&!(128&t.flags)&&(rd(t),6&t.subtreeFlags&&(t.flags|=8192)):rd(t),null!==(n=t.updateQueue)&&od(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),i=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),null!==e&&Vn(Wr),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),kr(Fr),rd(t),null;case 25:case 30:return null}throw Error(hn(156,t.tag))}function cd(e,t){switch(lr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return kr(Fr),Zn(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return ti(t),null;case 13:if(mu(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(hn(340));br()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Vn(fu),null;case 4:return Zn(),null;case 10:return kr(t.type),null;case 22:case 23:return mu(t),Sl(),null!==e&&Vn(Wr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return kr(Fr),null;default:return null}}function ud(e,t){switch(lr(t),t.tag){case 3:kr(Fr),Zn();break;case 26:case 27:case 5:ti(t);break;case 4:Zn();break;case 13:mu(t);break;case 19:Vn(fu);break;case 10:kr(t.type);break;case 22:case 23:mu(t),Sl(),null!==e&&Vn(Wr);break;case 24:kr(Fr)}}function dd(e,t){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var a=i.next;n=a;do{if((n.tag&e)===e){i=void 0;var o=n.create,s=n.inst;i=o(),s.destroy=i}n=n.next}while(n!==a)}}catch(r){fp(t,t.return,r)}}function hd(e,t,n){try{var i=t.updateQueue,a=null!==i?i.lastEffect:null;if(null!==a){var o=a.next;i=o;do{if((i.tag&e)===e){var s=i.inst,r=s.destroy;if(void 0!==r){s.destroy=void 0,a=t;var l=n,c=r;try{c()}catch(u){fp(a,l,u)}}}i=i.next}while(i!==o)}}catch(u){fp(t,t.return,u)}}function pd(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{yl(t,n)}catch(i){fp(e,e.return,i)}}}function md(e,t,n){n.props=wu(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){fp(e,t,i)}}function fd(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;default:i=e.stateNode}"function"==typeof n?e.refCleanup=n(i):n.current=i}}catch(a){fp(e,t,a)}}function gd(e,t){var n=e.ref,i=e.refCleanup;if(null!==n)if("function"==typeof i)try{i()}catch(a){fp(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(o){fp(e,t,o)}else n.current=null}function vd(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(a){fp(e,e.return,a)}}function yd(e,t,n){try{var i=e.stateNode;!function(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,o=null,s=null,r=null,l=null,c=null,u=null;for(p in n){var d=n[p];if(n.hasOwnProperty(p)&&null!=d)switch(p){case"checked":case"value":break;case"defaultValue":l=d;default:i.hasOwnProperty(p)||im(e,t,p,null,i,d)}}for(var h in i){var p=i[h];if(d=n[h],i.hasOwnProperty(h)&&(null!=p||null!=d))switch(h){case"type":o=p;break;case"name":a=p;break;case"checked":c=p;break;case"defaultChecked":u=p;break;case"value":s=p;break;case"defaultValue":r=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(hn(137,t));break;default:p!==d&&im(e,t,h,p,i,d)}}return void _a(e,s,r,l,c,u,o,a);case"select":for(o in p=s=r=h=null,n)if(l=n[o],n.hasOwnProperty(o)&&null!=l)switch(o){case"value":break;case"multiple":p=l;default:i.hasOwnProperty(o)||im(e,t,o,null,i,l)}for(a in i)if(o=i[a],l=n[a],i.hasOwnProperty(a)&&(null!=o||null!=l))switch(a){case"value":h=o;break;case"defaultValue":r=o;break;case"multiple":s=o;default:o!==l&&im(e,t,a,o,i,l)}return t=r,n=s,i=p,void(null!=h?Ea(e,!!n,h,!1):!!i!=!!n&&(null!=t?Ea(e,!!n,t,!0):Ea(e,!!n,n?[]:"",!1)));case"textarea":for(r in p=h=null,n)if(a=n[r],n.hasOwnProperty(r)&&null!=a&&!i.hasOwnProperty(r))switch(r){case"value":case"children":break;default:im(e,t,r,null,i,a)}for(s in i)if(a=i[s],o=n[s],i.hasOwnProperty(s)&&(null!=a||null!=o))switch(s){case"value":h=a;break;case"defaultValue":p=a;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=a)throw Error(hn(91));break;default:a!==o&&im(e,t,s,a,i,o)}return void ka(e,h,p);case"option":for(var m in n)if(h=n[m],n.hasOwnProperty(m)&&null!=h&&!i.hasOwnProperty(m))if("selected"===m)e.selected=!1;else im(e,t,m,null,i,h);for(l in i)if(h=i[l],p=n[l],i.hasOwnProperty(l)&&h!==p&&(null!=h||null!=p))if("selected"===l)e.selected=h&&"function"!=typeof h&&"symbol"!=typeof h;else im(e,t,l,h,i,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var f in n)h=n[f],n.hasOwnProperty(f)&&null!=h&&!i.hasOwnProperty(f)&&im(e,t,f,null,i,h);for(c in i)if(h=i[c],p=n[c],i.hasOwnProperty(c)&&h!==p&&(null!=h||null!=p))switch(c){case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(hn(137,t));break;default:im(e,t,c,h,i,p)}return;default:if(Ma(t)){for(var g in n)h=n[g],n.hasOwnProperty(g)&&void 0!==h&&!i.hasOwnProperty(g)&&am(e,t,g,void 0,i,h);for(u in i)h=i[u],p=n[u],!i.hasOwnProperty(u)||h===p||void 0===h&&void 0===p||am(e,t,u,h,i,p);return}}for(var v in n)h=n[v],n.hasOwnProperty(v)&&null!=h&&!i.hasOwnProperty(v)&&im(e,t,v,null,i,h);for(d in i)h=i[d],p=n[d],!i.hasOwnProperty(d)||h===p||null==h&&null==p||im(e,t,d,h,i,p)}(i,e.type,n,t),i[zi]=t}catch(a){fp(e,e.return,a)}}function bd(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&ym(e.type)||4===e.tag}function xd(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||bd(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&ym(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function wd(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=nm));else if(4!==i&&(27===i&&ym(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(wd(e,t,n),e=e.sibling;null!==e;)wd(e,t,n),e=e.sibling}function _d(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&(27===i&&ym(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(_d(e,t,n),e=e.sibling;null!==e;)_d(e,t,n),e=e.sibling}function Sd(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);om(t,i,n),t[Fi]=e,t[zi]=n}catch(o){fp(e,e.return,o)}}var Cd=!1,Ed=!1,kd=!1,Id="function"==typeof WeakSet?WeakSet:Set,Td=null;function jd(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Bd(e,n),4&i&&dd(5,n);break;case 1:if(Bd(e,n),4&i)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){fp(n,n.return,s)}else{var a=wu(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(r){fp(n,n.return,r)}}64&i&&pd(n),512&i&&fd(n,n.return);break;case 3:if(Bd(e,n),64&i&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{yl(e,t)}catch(s){fp(n,n.return,s)}}break;case 27:null===t&&4&i&&Sd(n);case 26:case 5:Bd(e,n),null===t&&4&i&&vd(n),512&i&&fd(n,n.return);break;case 12:Bd(e,n);break;case 13:Bd(e,n),4&i&&Rd(e,n),64&i&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}(e,n=bp.bind(null,n))));break;case 22:if(!(i=null!==n.memoizedState||Cd)){t=null!==t&&null!==t.memoizedState||Ed,a=Cd;var o=Ed;Cd=i,(Ed=t)&&!o?qd(e,n,!!(8772&n.subtreeFlags)):Bd(e,n),Cd=a,Ed=o}break;case 30:break;default:Bd(e,n)}}function Nd(e){var t=e.alternate;null!==t&&(e.alternate=null,Nd(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Vi(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Pd=null,Md=!1;function Ad(e,t,n){for(n=n.child;null!==n;)Od(e,t,n),n=n.sibling}function Od(e,t,n){if(vi&&"function"==typeof vi.onCommitFiberUnmount)try{vi.onCommitFiberUnmount(gi,n)}catch(o){}switch(n.tag){case 26:Ed||gd(n,t),Ad(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Ed||gd(n,t);var i=Pd,a=Md;ym(n.type)&&(Pd=n.stateNode,Md=!1),Ad(e,t,n),km(n.stateNode),Pd=i,Md=a;break;case 5:Ed||gd(n,t);case 6:if(i=Pd,a=Md,Pd=null,Ad(e,t,n),Md=a,null!==(Pd=i))if(Md)try{(9===Pd.nodeType?Pd.body:"HTML"===Pd.nodeName?Pd.ownerDocument.body:Pd).removeChild(n.stateNode)}catch(s){fp(n,t,s)}else try{Pd.removeChild(n.stateNode)}catch(s){fp(n,t,s)}break;case 18:null!==Pd&&(Md?(bm(9===(e=Pd).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Af(e)):bm(Pd,n.stateNode));break;case 4:i=Pd,a=Md,Pd=n.stateNode.containerInfo,Md=!0,Ad(e,t,n),Pd=i,Md=a;break;case 0:case 11:case 14:case 15:Ed||hd(2,n,t),Ed||hd(4,n,t),Ad(e,t,n);break;case 1:Ed||(gd(n,t),"function"==typeof(i=n.stateNode).componentWillUnmount&&md(n,t,i)),Ad(e,t,n);break;case 21:Ad(e,t,n);break;case 22:Ed=(i=Ed)||null!==n.memoizedState,Ad(e,t,n),Ed=i;break;default:Ad(e,t,n)}}function Rd(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Af(e)}catch(n){fp(t,t.return,n)}}function Dd(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Id),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Id),t;default:throw Error(hn(435,e.tag))}}(e);t.forEach(function(t){var i=xp.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))})}function Ld(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var a=n[i],o=e,s=t,r=s;e:for(;null!==r;){switch(r.tag){case 27:if(ym(r.type)){Pd=r.stateNode,Md=!1;break e}break;case 5:Pd=r.stateNode,Md=!1;break e;case 3:case 4:Pd=r.stateNode.containerInfo,Md=!0;break e}r=r.return}if(null===Pd)throw Error(hn(160));Od(o,s,a),Pd=null,Md=!1,null!==(o=a.alternate)&&(o.return=null),a.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)zd(t,e),t=t.sibling}var Fd=null;function zd(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Ld(t,e),Ud(e),4&i&&(hd(3,e,e.return),dd(3,e),hd(5,e,e.return));break;case 1:Ld(t,e),Ud(e),512&i&&(Ed||null===n||gd(n,n.return)),64&i&&Cd&&(null!==(e=e.updateQueue)&&(null!==(i=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?i:n.concat(i))));break;case 26:var a=Fd;if(Ld(t,e),Ud(e),512&i&&(Ed||null===n||gd(n,n.return)),4&i){var o=null!==n?n.memoizedState:null;if(i=e.memoizedState,null===n)if(null===i)if(null===e.stateNode){e:{i=e.type,n=e.memoizedProps,a=a.ownerDocument||a;t:switch(i){case"title":(!(o=a.getElementsByTagName("title")[0])||o[Gi]||o[Fi]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=a.createElement(i),a.head.insertBefore(o,a.querySelector("head > title"))),om(o,i,n),o[Fi]=e,Xi(o),i=o;break e;case"link":var s=qm("link","href",a).get(i+(n.href||""));if(s)for(var r=0;r<s.length;r++)if((o=s[r]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(r,1);break t}om(o=a.createElement(i),i,n),a.head.appendChild(o);break;case"meta":if(s=qm("meta","content",a).get(i+(n.content||"")))for(r=0;r<s.length;r++)if((o=s[r]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(r,1);break t}om(o=a.createElement(i),i,n),a.head.appendChild(o);break;default:throw Error(hn(468,i))}o[Fi]=e,Xi(o),i=o}e.stateNode=i}else Gm(a,e.type,e.stateNode);else e.stateNode=zm(a,i,e.memoizedProps);else o!==i?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===i?Gm(a,e.type,e.stateNode):zm(a,i,e.memoizedProps)):null===i&&null!==e.stateNode&&yd(e,e.memoizedProps,n.memoizedProps)}break;case 27:Ld(t,e),Ud(e),512&i&&(Ed||null===n||gd(n,n.return)),null!==n&&4&i&&yd(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Ld(t,e),Ud(e),512&i&&(Ed||null===n||gd(n,n.return)),32&e.flags){a=e.stateNode;try{Ta(a,"")}catch(p){fp(e,e.return,p)}}4&i&&null!=e.stateNode&&yd(e,a=e.memoizedProps,null!==n?n.memoizedProps:a),1024&i&&(kd=!0);break;case 6:if(Ld(t,e),Ud(e),4&i){if(null===e.stateNode)throw Error(hn(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(p){fp(e,e.return,p)}}break;case 3:if($m=null,a=Fd,Fd=jm(t.containerInfo),Ld(t,e),Fd=a,Ud(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Af(t.containerInfo)}catch(p){fp(e,e.return,p)}kd&&(kd=!1,Hd(e));break;case 4:i=Fd,Fd=jm(e.stateNode.containerInfo),Ld(t,e),Ud(e),Fd=i;break;case 12:default:Ld(t,e),Ud(e);break;case 13:Ld(t,e),Ud(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(kh=ri()),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,Dd(e,i)));break;case 22:a=null!==e.memoizedState;var l=null!==n&&null!==n.memoizedState,c=Cd,u=Ed;if(Cd=c||a,Ed=u||l,Ld(t,e),Ed=u,Cd=c,Ud(e),8192&i)e:for(t=e.stateNode,t._visibility=a?-2&t._visibility:1|t._visibility,a&&(null===n||l||Cd||Ed||$d(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){l=n=t;try{if(o=l.stateNode,a)"function"==typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{r=l.stateNode;var d=l.memoizedProps.style,h=null!=d&&d.hasOwnProperty("display")?d.display:null;r.style.display=null==h||"boolean"==typeof h?"":(""+h).trim()}}catch(p){fp(l,l.return,p)}}}else if(6===t.tag){if(null===n){l=t;try{l.stateNode.nodeValue=a?"":l.memoizedProps}catch(p){fp(l,l.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&i&&(null!==(i=e.updateQueue)&&(null!==(n=i.retryQueue)&&(i.retryQueue=null,Dd(e,n))));break;case 19:Ld(t,e),Ud(e),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,Dd(e,i)));case 30:case 21:}}function Ud(e){var t=e.flags;if(2&t){try{for(var n,i=e.return;null!==i;){if(bd(i)){n=i;break}i=i.return}if(null==n)throw Error(hn(160));switch(n.tag){case 27:var a=n.stateNode;_d(e,xd(e),a);break;case 5:var o=n.stateNode;32&n.flags&&(Ta(o,""),n.flags&=-33),_d(e,xd(e),o);break;case 3:case 4:var s=n.stateNode.containerInfo;wd(e,xd(e),s);break;default:throw Error(hn(161))}}catch(r){fp(e,e.return,r)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Hd(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Hd(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Bd(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)jd(e,t.alternate,t),t=t.sibling}function $d(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:hd(4,t,t.return),$d(t);break;case 1:gd(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&md(t,t.return,n),$d(t);break;case 27:km(t.stateNode);case 26:case 5:gd(t,t.return),$d(t);break;case 22:null===t.memoizedState&&$d(t);break;default:$d(t)}e=e.sibling}}function qd(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var i=t.alternate,a=e,o=t,s=o.flags;switch(o.tag){case 0:case 11:case 15:qd(a,o,n),dd(4,o);break;case 1:if(qd(a,o,n),"function"==typeof(a=(i=o).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){fp(i,i.return,c)}if(null!==(a=(i=o).updateQueue)){var r=i.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)vl(l[a],r)}catch(c){fp(i,i.return,c)}}n&&64&s&&pd(o),fd(o,o.return);break;case 27:Sd(o);case 26:case 5:qd(a,o,n),n&&null===i&&4&s&&vd(o),fd(o,o.return);break;case 12:qd(a,o,n);break;case 13:qd(a,o,n),n&&4&s&&Rd(a,o);break;case 22:null===o.memoizedState&&qd(a,o,n),fd(o,o.return);break;case 30:break;default:qd(a,o,n)}t=t.sibling}}function Gd(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ur(n))}function Vd(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ur(e))}function Wd(e,t,n,i){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Qd(e,t,n,i),t=t.sibling}function Qd(e,t,n,i){var a=t.flags;switch(t.tag){case 0:case 11:case 15:Wd(e,t,n,i),2048&a&&dd(9,t);break;case 1:case 13:default:Wd(e,t,n,i);break;case 3:Wd(e,t,n,i),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ur(e)));break;case 12:if(2048&a){Wd(e,t,n,i),e=t.stateNode;try{var o=t.memoizedProps,s=o.id,r=o.onPostCommit;"function"==typeof r&&r(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){fp(t,t.return,l)}}else Wd(e,t,n,i);break;case 23:break;case 22:o=t.stateNode,s=t.alternate,null!==t.memoizedState?2&o._visibility?Wd(e,t,n,i):Yd(e,t):2&o._visibility?Wd(e,t,n,i):(o._visibility|=2,Kd(e,t,n,i,!!(10256&t.subtreeFlags))),2048&a&&Gd(s,t);break;case 24:Wd(e,t,n,i),2048&a&&Vd(t.alternate,t)}}function Kd(e,t,n,i,a){for(a=a&&!!(10256&t.subtreeFlags),t=t.child;null!==t;){var o=e,s=t,r=n,l=i,c=s.flags;switch(s.tag){case 0:case 11:case 15:Kd(o,s,r,l,a),dd(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?Kd(o,s,r,l,a):Yd(o,s):(u._visibility|=2,Kd(o,s,r,l,a)),a&&2048&c&&Gd(s.alternate,s);break;case 24:Kd(o,s,r,l,a),a&&2048&c&&Vd(s.alternate,s);break;default:Kd(o,s,r,l,a)}t=t.sibling}}function Yd(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,i=t,a=i.flags;switch(i.tag){case 22:Yd(n,i),2048&a&&Gd(i.alternate,i);break;case 24:Yd(n,i),2048&a&&Vd(i.alternate,i);break;default:Yd(n,i)}t=t.sibling}}var Xd=8192;function Jd(e){if(e.subtreeFlags&Xd)for(e=e.child;null!==e;)Zd(e),e=e.sibling}function Zd(e){switch(e.tag){case 26:Jd(e),e.flags&Xd&&null!==e.memoizedState&&function(e,t,n){if(null===Wm)throw Error(hn(475));var i=Wm;if(!("stylesheet"!==t.type||"string"==typeof n.media&&!1===matchMedia(n.media).matches||4&t.state.loading)){if(null===t.instance){var a=Om(n.href),o=e.querySelector(Rm(a));if(o)return null!==(e=o._p)&&"object"==typeof e&&"function"==typeof e.then&&(i.count++,i=Km.bind(i),e.then(i,i)),t.state.loading|=4,t.instance=o,void Xi(o);o=e.ownerDocument||e,n=Dm(n),(a=Im.get(a))&&Hm(n,a),Xi(o=o.createElement("link"));var s=o;s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),om(o,"link",n),t.instance=o}null===i.stylesheets&&(i.stylesheets=new Map),i.stylesheets.set(t,e),(e=t.state.preload)&&!(3&t.state.loading)&&(i.count++,t=Km.bind(i),e.addEventListener("load",t),e.addEventListener("error",t))}}(Fd,e.memoizedState,e.memoizedProps);break;case 5:default:Jd(e);break;case 3:case 4:var t=Fd;Fd=jm(e.stateNode.containerInfo),Jd(e),Fd=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Xd,Xd=16777216,Jd(e),Xd=t):Jd(e))}}function eh(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function th(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Td=i,ah(i,e)}eh(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)nh(e),e=e.sibling}function nh(e){switch(e.tag){case 0:case 11:case 15:th(e),2048&e.flags&&hd(9,e,e.return);break;case 3:case 12:default:th(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,ih(e)):th(e)}}function ih(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Td=i,ah(i,e)}eh(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:hd(8,t,t.return),ih(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,ih(t));break;default:ih(t)}e=e.sibling}}function ah(e,t){for(;null!==Td;){var n=Td;switch(n.tag){case 0:case 11:case 15:hd(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var i=n.memoizedState.cachePool.pool;null!=i&&i.refCount++}break;case 24:Ur(n.memoizedState.cache)}if(null!==(i=n.child))i.return=n,Td=i;else e:for(n=e;null!==Td;){var a=(i=Td).sibling,o=i.return;if(Nd(i),i===n){Td=null;break e}if(null!==a){a.return=o,Td=a;break e}Td=o}}}var oh={getCacheForType:function(e){var t=Mr(Fr),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},sh="function"==typeof WeakMap?WeakMap:Map,rh=0,lh=null,ch=null,uh=0,dh=0,hh=null,ph=!1,mh=!1,fh=!1,gh=0,vh=0,yh=0,bh=0,xh=0,wh=0,_h=0,Sh=null,Ch=null,Eh=!1,kh=0,Ih=1/0,Th=null,jh=null,Nh=0,Ph=null,Mh=null,Ah=0,Oh=0,Rh=null,Dh=null,Lh=0,Fh=null;function zh(){if(2&rh&&0!==uh)return uh&-uh;if(null!==Un.T){return 0!==$r?$r:Op()}return Di()}function Uh(){0===wh&&(wh=536870912&uh&&!dr?536870912:Ti());var e=cu.current;return null!==e&&(e.flags|=32),wh}function Hh(e,t,n){(e!==lh||2!==dh&&9!==dh)&&null===e.cancelPendingCommit||(Qh(e,0),Gh(e,uh,wh,!1)),Pi(e,n),2&rh&&e===lh||(e===lh&&(!(2&rh)&&(bh|=n),4===vh&&Gh(e,uh,wh,!1)),Ip(e))}function Bh(e,t,n){if(6&rh)throw Error(hn(327));for(var i=!n&&!(124&t)&&0===(t&e.expiredLanes)||ki(e,t),a=i?function(e,t){var n=rh;rh|=2;var i=Yh(),a=Xh();lh!==e||uh!==t?(Th=null,Ih=ri()+500,Qh(e,t)):mh=ki(e,t);e:for(;;)try{if(0!==dh&&null!==ch){t=ch;var o=hh;t:switch(dh){case 1:dh=0,hh=null,ap(e,t,o,1);break;case 2:case 9:if(tl(o)){dh=0,hh=null,ip(t);break}t=function(){2!==dh&&9!==dh||lh!==e||(dh=7),Ip(e)},o.then(t,t);break e;case 3:dh=7;break e;case 4:dh=5;break e;case 7:tl(o)?(dh=0,hh=null,ip(t)):(dh=0,hh=null,ap(e,t,o,7));break;case 5:var s=null;switch(ch.tag){case 26:s=ch.memoizedState;case 5:case 27:var r=ch;if(!s||Vm(s)){dh=0,hh=null;var l=r.sibling;if(null!==l)ch=l;else{var c=r.return;null!==c?(ch=c,op(c)):ch=null}break t}}dh=0,hh=null,ap(e,t,o,5);break;case 6:dh=0,hh=null,ap(e,t,o,6);break;case 8:Wh(),vh=6;break e;default:throw Error(hn(462))}}tp();break}catch(u){Kh(e,u)}return Cr=Sr=null,Un.H=i,Un.A=a,rh=n,null!==ch?0:(lh=null,uh=0,Os(),vh)}(e,t):Zh(e,t,!0),o=i;;){if(0===a){mh&&!i&&Gh(e,t,0,!1);break}if(n=e.current.alternate,!o||qh(n)){if(2===a){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var r=e;a=Sh;var l=r.current.memoizedState.isDehydrated;if(l&&(Qh(r,s).flags|=256),2!==(s=Zh(r,s,!1))){if(fh&&!l){r.errorRecoveryDisabledLanes|=o,bh|=o,a=4;break e}o=Ch,Ch=a,null!==o&&(null===Ch?Ch=o:Ch.push.apply(Ch,o))}a=s}if(o=!1,2!==a)continue}}if(1===a){Qh(e,0),Gh(e,t,0,!0);break}e:{switch(i=e,o=a){case 0:case 1:throw Error(hn(345));case 4:if((4194048&t)!==t)break;case 6:Gh(i,t,wh,!ph);break e;case 2:Ch=null;break;case 3:case 5:break;default:throw Error(hn(329))}if((62914560&t)===t&&10<(a=kh+300-ri())){if(Gh(i,t,wh,!ph),0!==Ei(i,0,!0))break e;i.timeoutHandle=pm($h.bind(null,i,n,Ch,Th,Eh,t,wh,bh,_h,ph,o,2,-0,0),a)}else $h(i,n,Ch,Th,Eh,t,wh,bh,_h,ph,o,0,-0,0)}break}a=Zh(e,t,!1),o=!1}Ip(e)}function $h(e,t,n,i,a,o,s,r,l,c,u,d,h,p){if(e.timeoutHandle=-1,(8192&(d=t.subtreeFlags)||!(16785408&~d))&&(Wm={stylesheets:null,count:0,unsuspend:Qm},Zd(t),null!==(d=function(){if(null===Wm)throw Error(hn(475));var e=Wm;return e.stylesheets&&0===e.count&&Xm(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Xm(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=d(rp.bind(null,e,t,o,n,i,a,s,r,l,u,1,h,p)),void Gh(e,o,s,!c);rp(e,t,o,n,i,a,s,r,l)}function qh(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var i=0;i<n.length;i++){var a=n[i],o=a.getSnapshot;a=a.value;try{if(!ts(o(),a))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Gh(e,t,n,i){t&=~xh,t&=~bh,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var a=t;0<a;){var o=31-bi(a),s=1<<o;i[o]=-1,a&=~s}0!==n&&Mi(e,n,t)}function Vh(){return!!(6&rh)||(Tp(0),!1)}function Wh(){if(null!==ch){if(0===dh)var e=ch.return;else Cr=Sr=null,$l(e=ch),eu=null,tu=0,e=ch;for(;null!==e;)ud(e.alternate,e),e=e.return;ch=null}}function Qh(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,mm(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Wh(),lh=e,ch=n=qs(e.current,null),uh=t,dh=0,hh=null,ph=!1,mh=ki(e,t),fh=!1,_h=wh=xh=bh=yh=vh=0,Ch=Sh=null,Eh=!1,8&t&&(t|=32&t);var i=e.entangledLanes;if(0!==i)for(e=e.entanglements,i&=t;0<i;){var a=31-bi(i),o=1<<a;t|=e[a],i&=~o}return gh=t,Os(),n}function Kh(e,t){El=null,Un.H=Yc,t===Xr||t===Zr?(t=ol(),dh=3):t===Jr?(t=ol(),dh=4):dh=t===Pu?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,hh=t,null===ch&&(vh=1,ku(e,Ns(t,e.current)))}function Yh(){var e=Un.H;return Un.H=Yc,null===e?Yc:e}function Xh(){var e=Un.A;return Un.A=oh,e}function Jh(){vh=4,ph||(4194048&uh)!==uh&&null!==cu.current||(mh=!0),!(134217727&yh)&&!(134217727&bh)||null===lh||Gh(lh,uh,wh,!1)}function Zh(e,t,n){var i=rh;rh|=2;var a=Yh(),o=Xh();lh===e&&uh===t||(Th=null,Qh(e,t)),t=!1;var s=vh;e:for(;;)try{if(0!==dh&&null!==ch){var r=ch,l=hh;switch(dh){case 8:Wh(),s=6;break e;case 3:case 2:case 9:case 6:null===cu.current&&(t=!0);var c=dh;if(dh=0,hh=null,ap(e,r,l,c),n&&mh){s=0;break e}break;default:c=dh,dh=0,hh=null,ap(e,r,l,c)}}ep(),s=vh;break}catch(u){Kh(e,u)}return t&&e.shellSuspendCounter++,Cr=Sr=null,rh=i,Un.H=a,Un.A=o,null===ch&&(lh=null,uh=0,Os()),s}function ep(){for(;null!==ch;)np(ch)}function tp(){for(;null!==ch&&!oi();)np(ch)}function np(e){var t=nd(e.alternate,e,gh);e.memoizedProps=e.pendingProps,null===t?op(e):ch=t}function ip(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Hu(n,t,t.pendingProps,t.type,void 0,uh);break;case 11:t=Hu(n,t,t.pendingProps,t.type.render,t.ref,uh);break;case 5:$l(t);default:ud(n,t),t=nd(n,t=ch=Gs(t,gh),gh)}e.memoizedProps=e.pendingProps,null===t?op(e):ch=t}function ap(e,t,n,i){Cr=Sr=null,$l(t),eu=null,tu=0;var a=t.return;try{if(function(e,t,n,i,a){if(n.flags|=32768,null!==i&&"object"==typeof i&&"function"==typeof i.then){if(null!==(t=n.alternate)&&jr(t,n,a,!0),null!==(n=cu.current)){switch(n.tag){case 13:return null===uu?Jh():null===n.alternate&&0===vh&&(vh=3),n.flags&=-257,n.flags|=65536,n.lanes=a,i===el?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([i]):t.add(i),gp(e,i,a)),!1;case 22:return n.flags|=65536,i===el?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([i]):n.add(i),gp(e,i,a)),!1}throw Error(hn(435,n.tag))}return gp(e,i,a),Jh(),!1}if(dr)return null!==(t=cu.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,i!==mr&&wr(Ns(e=Error(hn(422),{cause:i}),n))):(i!==mr&&wr(Ns(t=Error(hn(423),{cause:i}),n)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,i=Ns(i,n),pl(e,a=Tu(e.stateNode,i,a)),4!==vh&&(vh=2)),!1;var o=Error(hn(520),{cause:i});if(o=Ns(o,n),null===Sh?Sh=[o]:Sh.push(o),4!==vh&&(vh=2),null===t)return!0;i=Ns(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,pl(n,e=Tu(n.stateNode,i,e)),!1;case 1:if(t=n.type,o=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===o||"function"!=typeof o.componentDidCatch||null!==jh&&jh.has(o))))return n.flags|=65536,a&=-a,n.lanes|=a,Nu(a=ju(a),e,n,i),pl(n,a),!1}n=n.return}while(null!==n);return!1}(e,a,t,n,uh))return vh=1,ku(e,Ns(n,e.current)),void(ch=null)}catch(o){if(null!==a)throw ch=a,o;return vh=1,ku(e,Ns(n,e.current)),void(ch=null)}32768&t.flags?(dr||1===i?e=!0:mh||536870912&uh?e=!1:(ph=e=!0,(2===i||9===i||3===i||6===i)&&(null!==(i=cu.current)&&13===i.tag&&(i.flags|=16384))),sp(t,e)):op(t)}function op(e){var t=e;do{if(32768&t.flags)return void sp(t,ph);e=t.return;var n=ld(t.alternate,t,gh);if(null!==n)return void(ch=n);if(null!==(t=t.sibling))return void(ch=t);ch=t=e}while(null!==t);0===vh&&(vh=5)}function sp(e,t){do{var n=cd(e.alternate,e);if(null!==n)return n.flags&=32767,void(ch=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(ch=e);ch=e=n}while(null!==e);vh=6,ch=null}function rp(e,t,n,i,a,o,s,r,l){e.cancelPendingCommit=null;do{hp()}while(0!==Nh);if(6&rh)throw Error(hn(327));if(null!==t){if(t===e.current)throw Error(hn(177));if(o=t.lanes|t.childLanes,function(e,t,n,i,a,o){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var r=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-bi(n),d=1<<u;r[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var p=h[u];null!==p&&(p.lane&=-536870913)}n&=~d}0!==i&&Mi(e,i,0),0!==o&&0===a&&0!==e.tag&&(e.suspendedLanes|=o&~(s&~t))}(e,n,o|=As,s,r,l),e===lh&&(ch=lh=null,uh=0),Mh=t,Ph=e,Ah=n,Oh=o,Rh=a,Dh=i,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,ii(di,function(){return pp(),null})):(e.callbackNode=null,e.callbackPriority=0),i=!!(13878&t.flags),13878&t.subtreeFlags||i){i=Un.T,Un.T=null,a=Hn.p,Hn.p=2,s=rh,rh|=4;try{!function(e,t){if(e=e.containerInfo,sm=lf,rs(e=ss(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var a=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(f){n=null;break e}var s=0,r=-1,l=-1,c=0,u=0,d=e,h=null;t:for(;;){for(var p;d!==n||0!==a&&3!==d.nodeType||(r=s+a),d!==o||0!==i&&3!==d.nodeType||(l=s+i),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)h=d,d=p;for(;;){if(d===e)break t;if(h===n&&++c===a&&(r=s),h===o&&++u===i&&(l=s),null!==(p=d.nextSibling))break;h=(d=h).parentNode}d=p}n=-1===r||-1===l?null:{start:r,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(rm={focusedElem:e,selectionRange:n},lf=!1,Td=t;null!==Td;)if(e=(t=Td).child,1024&t.subtreeFlags&&null!==e)e.return=t,Td=e;else for(;null!==Td;){switch(o=(t=Td).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==o){e=void 0,n=t,a=o.memoizedProps,o=o.memoizedState,i=n.stateNode;try{var m=wu(n.type,a,(n.elementType,n.type));e=i.getSnapshotBeforeUpdate(m,o),i.__reactInternalSnapshotBeforeUpdate=e}catch(g){fp(n,n.return,g)}}break;case 3:if(1024&e)if(9===(n=(e=t.stateNode.containerInfo).nodeType))xm(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":xm(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(hn(163))}if(null!==(e=t.sibling)){e.return=t.return,Td=e;break}Td=t.return}}(e,t)}finally{rh=s,Hn.p=a,Un.T=i}}Nh=1,lp(),cp(),up()}}function lp(){if(1===Nh){Nh=0;var e=Ph,t=Mh,n=!!(13878&t.flags);if(13878&t.subtreeFlags||n){n=Un.T,Un.T=null;var i=Hn.p;Hn.p=2;var a=rh;rh|=4;try{zd(t,e);var o=rm,s=ss(e.containerInfo),r=o.focusedElem,l=o.selectionRange;if(s!==r&&r&&r.ownerDocument&&os(r.ownerDocument.documentElement,r)){if(null!==l&&rs(r)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in r)r.selectionStart=c,r.selectionEnd=Math.min(u,r.value.length);else{var d=r.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var p=h.getSelection(),m=r.textContent.length,f=Math.min(l.start,m),g=void 0===l.end?f:Math.min(l.end,m);!p.extend&&f>g&&(s=g,g=f,f=s);var v=as(r,f),y=as(r,g);if(v&&y&&(1!==p.rangeCount||p.anchorNode!==v.node||p.anchorOffset!==v.offset||p.focusNode!==y.node||p.focusOffset!==y.offset)){var b=d.createRange();b.setStart(v.node,v.offset),p.removeAllRanges(),f>g?(p.addRange(b),p.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),p.addRange(b))}}}}for(d=[],p=r;p=p.parentNode;)1===p.nodeType&&d.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"==typeof r.focus&&r.focus(),r=0;r<d.length;r++){var x=d[r];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}lf=!!sm,rm=sm=null}finally{rh=a,Hn.p=i,Un.T=n}}e.current=t,Nh=2}}function cp(){if(2===Nh){Nh=0;var e=Ph,t=Mh,n=!!(8772&t.flags);if(8772&t.subtreeFlags||n){n=Un.T,Un.T=null;var i=Hn.p;Hn.p=2;var a=rh;rh|=4;try{jd(e,t.alternate,t)}finally{rh=a,Hn.p=i,Un.T=n}}Nh=3}}function up(){if(4===Nh||3===Nh){Nh=0,si();var e=Ph,t=Mh,n=Ah,i=Dh;10256&t.subtreeFlags||10256&t.flags?Nh=5:(Nh=0,Mh=Ph=null,dp(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(jh=null),Ri(n),t=t.stateNode,vi&&"function"==typeof vi.onCommitFiberRoot)try{vi.onCommitFiberRoot(gi,t,void 0,!(128&~t.current.flags))}catch(l){}if(null!==i){t=Un.T,a=Hn.p,Hn.p=2,Un.T=null;try{for(var o=e.onRecoverableError,s=0;s<i.length;s++){var r=i[s];o(r.value,{componentStack:r.stack})}}finally{Un.T=t,Hn.p=a}}3&Ah&&hp(),Ip(e),a=e.pendingLanes,4194090&n&&42&a?e===Fh?Lh++:(Lh=0,Fh=e):Lh=0,Tp(0)}}function dp(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ur(t)))}function hp(e){return lp(),cp(),up(),pp()}function pp(){if(5!==Nh)return!1;var e=Ph,t=Oh;Oh=0;var n=Ri(Ah),i=Un.T,a=Hn.p;try{Hn.p=32>n?32:n,Un.T=null,n=Rh,Rh=null;var o=Ph,s=Ah;if(Nh=0,Mh=Ph=null,Ah=0,6&rh)throw Error(hn(331));var r=rh;if(rh|=4,nh(o.current),Qd(o,o.current,s,n),rh=r,Tp(0,!1),vi&&"function"==typeof vi.onPostCommitFiberRoot)try{vi.onPostCommitFiberRoot(gi,o)}catch(l){}return!0}finally{Hn.p=a,Un.T=i,dp(e,t)}}function mp(e,t,n){t=Ns(n,t),null!==(e=dl(e,t=Tu(e.stateNode,t,2),2))&&(Pi(e,2),Ip(e))}function fp(e,t,n){if(3===e.tag)mp(e,e,n);else for(;null!==t;){if(3===t.tag){mp(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===jh||!jh.has(i))){e=Ns(n,e),null!==(i=dl(t,n=ju(2),2))&&(Nu(n,i,t,e),Pi(i,2),Ip(i));break}}t=t.return}}function gp(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new sh;var a=new Set;i.set(t,a)}else void 0===(a=i.get(t))&&(a=new Set,i.set(t,a));a.has(n)||(fh=!0,a.add(n),e=vp.bind(null,e,t,n),t.then(e,e))}function vp(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,lh===e&&(uh&n)===n&&(4===vh||3===vh&&(62914560&uh)===uh&&300>ri()-kh?!(2&rh)&&Qh(e,0):xh|=n,_h===uh&&(_h=0)),Ip(e)}function yp(e,t){0===t&&(t=ji()),null!==(e=Ls(e,t))&&(Pi(e,t),Ip(e))}function bp(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),yp(e,n)}function xp(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(hn(314))}null!==i&&i.delete(t),yp(e,n)}var wp=null,_p=null,Sp=!1,Cp=!1,Ep=!1,kp=0;function Ip(e){e!==_p&&null===e.next&&(null===_p?wp=_p=e:_p=_p.next=e),Cp=!0,Sp||(Sp=!0,gm(function(){6&rh?ii(ci,jp):Np()}))}function Tp(e,t){if(!Ep&&Cp){Ep=!0;do{for(var n=!1,i=wp;null!==i;){if(0!==e){var a=i.pendingLanes;if(0===a)var o=0;else{var s=i.suspendedLanes,r=i.pingedLanes;o=(1<<31-bi(42|e)+1)-1,o=201326741&(o&=a&~(s&~r))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,Ap(i,o))}else o=uh,!(3&(o=Ei(i,i===lh?o:0,null!==i.cancelPendingCommit||-1!==i.timeoutHandle)))||ki(i,o)||(n=!0,Ap(i,o));i=i.next}}while(n);Ep=!1}}function jp(){Np()}function Np(){Cp=Sp=!1;var e=0;0!==kp&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==hm&&(hm=e,!0);return hm=null,!1}()&&(e=kp),kp=0);for(var t=ri(),n=null,i=wp;null!==i;){var a=i.next,o=Pp(i,t);0===o?(i.next=null,null===n?wp=a:n.next=a,null===a&&(_p=n)):(n=i,(0!==e||3&o)&&(Cp=!0)),i=a}Tp(e)}function Pp(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var s=31-bi(o),r=1<<s,l=a[s];-1===l?0!==(r&n)&&0===(r&i)||(a[s]=Ii(r,t)):l<=t&&(e.expiredLanes|=r),o&=~r}if(n=uh,n=Ei(e,e===(t=lh)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),i=e.callbackNode,0===n||e===t&&(2===dh||9===dh)||null!==e.cancelPendingCommit)return null!==i&&null!==i&&ai(i),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||ki(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==i&&ai(i),Ri(n)){case 2:case 8:n=ui;break;case 32:default:n=di;break;case 268435456:n=pi}return i=Mp.bind(null,e),n=ii(n,i),e.callbackPriority=t,e.callbackNode=n,t}return null!==i&&null!==i&&ai(i),e.callbackPriority=2,e.callbackNode=null,2}function Mp(e,t){if(0!==Nh&&5!==Nh)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(hp()&&e.callbackNode!==n)return null;var i=uh;return 0===(i=Ei(e,e===lh?i:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Bh(e,i,t),Pp(e,ri()),null!=e.callbackNode&&e.callbackNode===n?Mp.bind(null,e):null)}function Ap(e,t){if(hp())return null;Bh(e,t,!0)}function Op(){return 0===kp&&(kp=Ti()),kp}function Rp(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:Ra(""+e)}function Dp(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Lp=0;Lp<Is.length;Lp++){var Fp=Is[Lp];Ts(Fp.toLowerCase(),"on"+(Fp[0].toUpperCase()+Fp.slice(1)))}Ts(bs,"onAnimationEnd"),Ts(xs,"onAnimationIteration"),Ts(ws,"onAnimationStart"),Ts("dblclick","onDoubleClick"),Ts("focusin","onFocus"),Ts("focusout","onBlur"),Ts(_s,"onTransitionRun"),Ts(Ss,"onTransitionStart"),Ts(Cs,"onTransitionCancel"),Ts(Es,"onTransitionEnd"),ta("onMouseEnter",["mouseout","mouseover"]),ta("onMouseLeave",["mouseout","mouseover"]),ta("onPointerEnter",["pointerout","pointerover"]),ta("onPointerLeave",["pointerout","pointerover"]),ea("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ea("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ea("onBeforeInput",["compositionend","keypress","textInput","paste"]),ea("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ea("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ea("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Up=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zp));function Hp(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var i=e[n],a=i.event;i=i.listeners;e:{var o=void 0;if(t)for(var s=i.length-1;0<=s;s--){var r=i[s],l=r.instance,c=r.currentTarget;if(r=r.listener,l!==o&&a.isPropagationStopped())break e;o=r,a.currentTarget=c;try{o(a)}catch(u){_u(u)}a.currentTarget=null,o=l}else for(s=0;s<i.length;s++){if(l=(r=i[s]).instance,c=r.currentTarget,r=r.listener,l!==o&&a.isPropagationStopped())break e;o=r,a.currentTarget=c;try{o(a)}catch(u){_u(u)}a.currentTarget=null,o=l}}}}function Bp(e,t){var n=t[Hi];void 0===n&&(n=t[Hi]=new Set);var i=e+"__bubble";n.has(i)||(Vp(t,e,2,!1),n.add(i))}function $p(e,t,n){var i=0;t&&(i|=4),Vp(n,e,i,t)}var qp="_reactListening"+Math.random().toString(36).slice(2);function Gp(e){if(!e[qp]){e[qp]=!0,Ji.forEach(function(t){"selectionchange"!==t&&(Up.has(t)||$p(t,!1,e),$p(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[qp]||(t[qp]=!0,$p("selectionchange",!1,t))}}function Vp(e,t,n,i){switch(ff(t)){case 2:var a=cf;break;case 8:a=uf;break;default:a=df}n=a.bind(null,t,n,e),a=void 0,!Ga||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),i?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Wp(e,t,n,i,a){var o=i;if(!(1&t||2&t||null===i))e:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var r=i.stateNode.containerInfo;if(r===a)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&s.stateNode.containerInfo===a)return;s=s.return}for(;null!==r;){if(null===(s=Wi(r)))return;if(5===(l=s.tag)||6===l||26===l||27===l){i=o=s;continue e}r=r.parentNode}}i=i.return}Ba(function(){var i=o,a=La(n),s=[];e:{var r=ks.get(e);if(void 0!==r){var l=oo,c=e;switch(e){case"keypress":if(0===Xa(n))break e;case"keydown":case"keyup":l=wo;break;case"focusin":c="focus",l=ho;break;case"focusout":c="blur",l=ho;break;case"beforeblur":case"afterblur":l=ho;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=co;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=uo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=So;break;case bs:case xs:case ws:l=po;break;case Es:l=Co;break;case"scroll":case"scrollend":l=ro;break;case"wheel":l=Eo;break;case"copy":case"cut":case"paste":l=mo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=_o;break;case"toggle":case"beforetoggle":l=ko}var u=!!(4&t),d=!u&&("scroll"===e||"scrollend"===e),h=u?null!==r?r+"Capture":null:r;u=[];for(var p,m=i;null!==m;){var f=m;if(p=f.stateNode,5!==(f=f.tag)&&26!==f&&27!==f||null===p||null===h||null!=(f=$a(m,h))&&u.push(Qp(m,f,p)),d)break;m=m.return}0<u.length&&(r=new l(r,c,null,n,a),s.push({event:r,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(r="mouseover"===e||"pointerover"===e)||n===Da||!(c=n.relatedTarget||n.fromElement)||!Wi(c)&&!c[Ui])&&(l||r)&&(r=a.window===a?a:(r=a.ownerDocument)?r.defaultView||r.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?Wi(c):null)&&(d=mn(c),u=c.tag,c!==d||5!==u&&27!==u&&6!==u)&&(c=null)):(l=null,c=i),l!==c)){if(u=co,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(u=_o,f="onPointerLeave",h="onPointerEnter",m="pointer"),d=null==l?r:Ki(l),p=null==c?r:Ki(c),(r=new u(f,m+"leave",l,n,a)).target=d,r.relatedTarget=p,f=null,Wi(a)===i&&((u=new u(h,m+"enter",c,n,a)).target=p,u.relatedTarget=d,f=u),d=f,l&&c)e:{for(h=c,m=0,p=u=l;p;p=Yp(p))m++;for(p=0,f=h;f;f=Yp(f))p++;for(;0<m-p;)u=Yp(u),m--;for(;0<p-m;)h=Yp(h),p--;for(;m--;){if(u===h||null!==h&&u===h.alternate)break e;u=Yp(u),h=Yp(h)}u=null}else u=null;null!==l&&Xp(s,r,l,u,!1),null!==c&&null!==d&&Xp(s,d,c,u,!0)}if("select"===(l=(r=i?Ki(i):window).nodeName&&r.nodeName.toLowerCase())||"input"===l&&"file"===r.type)var g=qo;else if(Fo(r))if(Go)g=es;else{g=Jo;var v=Xo}else!(l=r.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==r.type&&"radio"!==r.type?i&&Ma(i.elementType)&&(g=qo):g=Zo;switch(g&&(g=g(e,i))?zo(s,g,n,a):(v&&v(e,r,i),"focusout"===e&&i&&"number"===r.type&&null!=i.memoizedProps.value&&Ca(r,"number",r.value)),v=i?Ki(i):window,e){case"focusin":(Fo(v)||"true"===v.contentEditable)&&(cs=v,us=i,ds=null);break;case"focusout":ds=us=cs=null;break;case"mousedown":hs=!0;break;case"contextmenu":case"mouseup":case"dragend":hs=!1,ps(s,n,a);break;case"selectionchange":if(ls)break;case"keydown":case"keyup":ps(s,n,a)}var y;if(To)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Do?Oo(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Po&&"ko"!==n.locale&&(Do||"onCompositionStart"!==b?"onCompositionEnd"===b&&Do&&(y=Ya()):(Qa="value"in(Wa=a)?Wa.value:Wa.textContent,Do=!0)),0<(v=Kp(i,b)).length&&(b=new fo(b,e,null,n,a),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Ro(n))&&(b.data=y))),(y=No?function(e,t){switch(e){case"compositionend":return Ro(t);case"keypress":return 32!==t.which?null:(Ao=!0,Mo);case"textInput":return(e=t.data)===Mo&&Ao?null:e;default:return null}}(e,n):function(e,t){if(Do)return"compositionend"===e||!To&&Oo(e,t)?(e=Ya(),Ka=Qa=Wa=null,Do=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Po&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(b=Kp(i,"onBeforeInput")).length&&(v=new fo("onBeforeInput","beforeinput",null,n,a),s.push({event:v,listeners:b}),v.data=y)),function(e,t,n,i,a){if("submit"===t&&n&&n.stateNode===a){var o=Rp((a[zi]||null).action),s=i.submitter;s&&null!==(t=(t=s[zi]||null)?Rp(t.formAction):s.getAttribute("formAction"))&&(o=t,s=null);var r=new oo("action","action",null,i,a);e.push({event:r,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(0!==kp){var e=s?Dp(a,s):new FormData(a);Dc(n,{pending:!0,data:e,method:a.method,action:o},null,e)}}else"function"==typeof o&&(r.preventDefault(),e=s?Dp(a,s):new FormData(a),Dc(n,{pending:!0,data:e,method:a.method,action:o},o,e))},currentTarget:a}]})}}(s,e,i,n,a)}Hp(s,t)})}function Qp(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kp(e,t){for(var n=t+"Capture",i=[];null!==e;){var a=e,o=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===o||(null!=(a=$a(e,n))&&i.unshift(Qp(e,a,o)),null!=(a=$a(e,t))&&i.push(Qp(e,a,o))),3===e.tag)return i;e=e.return}return[]}function Yp(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Xp(e,t,n,i,a){for(var o=t._reactName,s=[];null!==n&&n!==i;){var r=n,l=r.alternate,c=r.stateNode;if(r=r.tag,null!==l&&l===i)break;5!==r&&26!==r&&27!==r||null===c||(l=c,a?null!=(c=$a(n,o))&&s.unshift(Qp(n,c,l)):a||null!=(c=$a(n,o))&&s.push(Qp(n,c,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Jp=/\r\n?/g,Zp=/\u0000|\uFFFD/g;function em(e){return("string"==typeof e?e:""+e).replace(Jp,"\n").replace(Zp,"")}function tm(e,t){return t=em(t),em(e)===t}function nm(){}function im(e,t,n,i,a,o){switch(n){case"children":"string"==typeof i?"body"===t||"textarea"===t&&""===i||Ta(e,i):("number"==typeof i||"bigint"==typeof i)&&"body"!==t&&Ta(e,""+i);break;case"className":la(e,"class",i);break;case"tabIndex":la(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":la(e,n,i);break;case"style":Pa(e,i,o);break;case"data":if("object"!==t){la(e,"data",i);break}case"src":case"href":if(""===i&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==i||"function"==typeof i||"symbol"==typeof i||"boolean"==typeof i){e.removeAttribute(n);break}i=Ra(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if("function"==typeof i){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof o&&("formAction"===n?("input"!==t&&im(e,t,"name",a.name,a,null),im(e,t,"formEncType",a.formEncType,a,null),im(e,t,"formMethod",a.formMethod,a,null),im(e,t,"formTarget",a.formTarget,a,null)):(im(e,t,"encType",a.encType,a,null),im(e,t,"method",a.method,a,null),im(e,t,"target",a.target,a,null))),null==i||"symbol"==typeof i||"boolean"==typeof i){e.removeAttribute(n);break}i=Ra(""+i),e.setAttribute(n,i);break;case"onClick":null!=i&&(e.onclick=nm);break;case"onScroll":null!=i&&Bp("scroll",e);break;case"onScrollEnd":null!=i&&Bp("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!=typeof i||!("__html"in i))throw Error(hn(61));if(null!=(n=i.__html)){if(null!=a.children)throw Error(hn(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&"function"!=typeof i&&"symbol"!=typeof i;break;case"muted":e.muted=i&&"function"!=typeof i&&"symbol"!=typeof i;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==i||"function"==typeof i||"boolean"==typeof i||"symbol"==typeof i){e.removeAttribute("xlink:href");break}n=Ra(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===i?e.setAttribute(n,""):!1!==i&&null!=i&&"function"!=typeof i&&"symbol"!=typeof i?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":null==i||"function"==typeof i||"symbol"==typeof i||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":Bp("beforetoggle",e),Bp("toggle",e),ra(e,"popover",i);break;case"xlinkActuate":ca(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":ca(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":ca(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":ca(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":ca(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":ca(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":ca(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":ca(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":ca(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":ra(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ra(e,n=Aa.get(n)||n,i)}}function am(e,t,n,i,a,o){switch(n){case"style":Pa(e,i,o);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!=typeof i||!("__html"in i))throw Error(hn(61));if(null!=(n=i.__html)){if(null!=a.children)throw Error(hn(60));e.innerHTML=n}}break;case"children":"string"==typeof i?Ta(e,i):("number"==typeof i||"bigint"==typeof i)&&Ta(e,""+i);break;case"onScroll":null!=i&&Bp("scroll",e);break;case"onScrollEnd":null!=i&&Bp("scrollend",e);break;case"onClick":null!=i&&(e.onclick=nm);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Zi.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(a=n.endsWith("Capture"),t=n.slice(2,a?n.length-7:void 0),"function"==typeof(o=null!=(o=e[zi]||null)?o[n]:null)&&e.removeEventListener(t,o,a),"function"!=typeof i)?n in e?e[n]=i:!0===i?e.setAttribute(n,""):ra(e,n,i):("function"!=typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,a)))}}function om(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bp("error",e),Bp("load",e);var i,a=!1,o=!1;for(i in n)if(n.hasOwnProperty(i)){var s=n[i];if(null!=s)switch(i){case"src":a=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(hn(137,t));default:im(e,t,i,s,n,null)}}return o&&im(e,t,"srcSet",n.srcSet,n,null),void(a&&im(e,t,"src",n.src,n,null));case"input":Bp("invalid",e);var r=i=s=o=null,l=null,c=null;for(a in n)if(n.hasOwnProperty(a)){var u=n[a];if(null!=u)switch(a){case"name":o=u;break;case"type":s=u;break;case"checked":l=u;break;case"defaultChecked":c=u;break;case"value":i=u;break;case"defaultValue":r=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(hn(137,t));break;default:im(e,t,a,u,n,null)}}return Sa(e,i,r,l,c,s,o,!1),void va(e);case"select":for(o in Bp("invalid",e),a=s=i=null,n)if(n.hasOwnProperty(o)&&null!=(r=n[o]))switch(o){case"value":i=r;break;case"defaultValue":s=r;break;case"multiple":a=r;default:im(e,t,o,r,n,null)}return t=i,n=s,e.multiple=!!a,void(null!=t?Ea(e,!!a,t,!1):null!=n&&Ea(e,!!a,n,!0));case"textarea":for(s in Bp("invalid",e),i=o=a=null,n)if(n.hasOwnProperty(s)&&null!=(r=n[s]))switch(s){case"value":a=r;break;case"defaultValue":o=r;break;case"children":i=r;break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(hn(91));break;default:im(e,t,s,r,n,null)}return Ia(e,a,o,i),void va(e);case"option":for(l in n)if(n.hasOwnProperty(l)&&null!=(a=n[l]))if("selected"===l)e.selected=a&&"function"!=typeof a&&"symbol"!=typeof a;else im(e,t,l,a,n,null);return;case"dialog":Bp("beforetoggle",e),Bp("toggle",e),Bp("cancel",e),Bp("close",e);break;case"iframe":case"object":Bp("load",e);break;case"video":case"audio":for(a=0;a<zp.length;a++)Bp(zp[a],e);break;case"image":Bp("error",e),Bp("load",e);break;case"details":Bp("toggle",e);break;case"embed":case"source":case"link":Bp("error",e),Bp("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(c in n)if(n.hasOwnProperty(c)&&null!=(a=n[c]))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(hn(137,t));default:im(e,t,c,a,n,null)}return;default:if(Ma(t)){for(u in n)n.hasOwnProperty(u)&&(void 0!==(a=n[u])&&am(e,t,u,a,n,void 0));return}}for(r in n)n.hasOwnProperty(r)&&(null!=(a=n[r])&&im(e,t,r,a,n,null))}var sm=null,rm=null;function lm(e){return 9===e.nodeType?e:e.ownerDocument}function cm(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function um(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function dm(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var hm=null;var pm="function"==typeof setTimeout?setTimeout:void 0,mm="function"==typeof clearTimeout?clearTimeout:void 0,fm="function"==typeof Promise?Promise:void 0,gm="function"==typeof queueMicrotask?queueMicrotask:void 0!==fm?function(e){return fm.resolve(null).then(e).catch(vm)}:pm;function vm(e){setTimeout(function(){throw e})}function ym(e){return"head"===e}function bm(e,t){var n=t,i=0,a=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0<i&&8>i){n=i;var s=e.ownerDocument;if(1&n&&km(s.documentElement),2&n&&km(s.body),4&n)for(km(n=s.head),s=n.firstChild;s;){var r=s.nextSibling,l=s.nodeName;s[Gi]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=r}}if(0===a)return e.removeChild(o),void Af(t);a--}else"$"===n||"$?"===n||"$!"===n?a++:i=n.charCodeAt(0)-48;else i=0;n=o}while(n);Af(t)}function xm(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":xm(n),Vi(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function wm(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function _m(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var Sm=null;function Cm(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function Em(e,t,n){switch(t=lm(n),e){case"html":if(!(e=t.documentElement))throw Error(hn(452));return e;case"head":if(!(e=t.head))throw Error(hn(453));return e;case"body":if(!(e=t.body))throw Error(hn(454));return e;default:throw Error(hn(451))}}function km(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Vi(e)}var Im=new Map,Tm=new Set;function jm(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Nm=Hn.d;Hn.d={f:function(){var e=Nm.f(),t=Vh();return e||t},r:function(e){var t=Qi(e);null!==t&&5===t.tag&&"form"===t.type?Fc(t):Nm.r(e)},D:function(e){Nm.D(e),Mm("dns-prefetch",e,null)},C:function(e,t){Nm.C(e,t),Mm("preconnect",e,t)},L:function(e,t,n){Nm.L(e,t,n);var i=Pm;if(i&&e&&t){var a='link[rel="preload"][as="'+wa(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+wa(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(a+='[imagesizes="'+wa(n.imageSizes)+'"]')):a+='[href="'+wa(e)+'"]';var o=a;switch(t){case"style":o=Om(e);break;case"script":o=Lm(e)}Im.has(o)||(e=yn({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Im.set(o,e),null!==i.querySelector(a)||"style"===t&&i.querySelector(Rm(o))||"script"===t&&i.querySelector(Fm(o))||(om(t=i.createElement("link"),"link",e),Xi(t),i.head.appendChild(t)))}},m:function(e,t){Nm.m(e,t);var n=Pm;if(n&&e){var i=t&&"string"==typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+wa(i)+'"][href="'+wa(e)+'"]',o=a;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Lm(e)}if(!Im.has(o)&&(e=yn({rel:"modulepreload",href:e},t),Im.set(o,e),null===n.querySelector(a))){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Fm(o)))return}om(i=n.createElement("link"),"link",e),Xi(i),n.head.appendChild(i)}}},X:function(e,t){Nm.X(e,t);var n=Pm;if(n&&e){var i=Yi(n).hoistableScripts,a=Lm(e),o=i.get(a);o||((o=n.querySelector(Fm(a)))||(e=yn({src:e,async:!0},t),(t=Im.get(a))&&Bm(e,t),Xi(o=n.createElement("script")),om(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(a,o))}},S:function(e,t,n){Nm.S(e,t,n);var i=Pm;if(i&&e){var a=Yi(i).hoistableStyles,o=Om(e);t=t||"default";var s=a.get(o);if(!s){var r={loading:0,preload:null};if(s=i.querySelector(Rm(o)))r.loading=5;else{e=yn({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Im.get(o))&&Hm(e,n);var l=s=i.createElement("link");Xi(l),om(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){r.loading|=1}),l.addEventListener("error",function(){r.loading|=2}),r.loading|=4,Um(s,t,i)}s={type:"stylesheet",instance:s,count:1,state:r},a.set(o,s)}}},M:function(e,t){Nm.M(e,t);var n=Pm;if(n&&e){var i=Yi(n).hoistableScripts,a=Lm(e),o=i.get(a);o||((o=n.querySelector(Fm(a)))||(e=yn({src:e,async:!0,type:"module"},t),(t=Im.get(a))&&Bm(e,t),Xi(o=n.createElement("script")),om(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(a,o))}}};var Pm="undefined"==typeof document?null:document;function Mm(e,t,n){var i=Pm;if(i&&"string"==typeof t&&t){var a=wa(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"==typeof n&&(a+='[crossorigin="'+n+'"]'),Tm.has(a)||(Tm.add(a),e={rel:e,crossOrigin:n,href:t},null===i.querySelector(a)&&(om(t=i.createElement("link"),"link",e),Xi(t),i.head.appendChild(t)))}}function Am(e,t,n,i){var a,o,s,r,l=(l=Yn.current)?jm(l):null;if(!l)throw Error(hn(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof n.precedence&&"string"==typeof n.href?(t=Om(n.href),(i=(n=Yi(l).hoistableStyles).get(t))||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=Om(n.href);var c=Yi(l).hoistableStyles,u=c.get(e);if(u||(l=l.ownerDocument||l,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},c.set(e,u),(c=l.querySelector(Rm(e)))&&!c._p&&(u.instance=c,u.state.loading=5),Im.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Im.set(e,n),c||(a=l,o=e,s=n,r=u.state,a.querySelector('link[rel="preload"][as="style"]['+o+"]")?r.loading=1:(o=a.createElement("link"),r.preload=o,o.addEventListener("load",function(){return r.loading|=1}),o.addEventListener("error",function(){return r.loading|=2}),om(o,"link",s),Xi(o),a.head.appendChild(o))))),t&&null===i)throw Error(hn(528,""));return u}if(t&&null!==i)throw Error(hn(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Lm(n),(i=(n=Yi(l).hoistableScripts).get(t))||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(hn(444,e))}}function Om(e){return'href="'+wa(e)+'"'}function Rm(e){return'link[rel="stylesheet"]['+e+"]"}function Dm(e){return yn({},e,{"data-precedence":e.precedence,precedence:null})}function Lm(e){return'[src="'+wa(e)+'"]'}function Fm(e){return"script[async]"+e}function zm(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+wa(n.href)+'"]');if(i)return t.instance=i,Xi(i),i;var a=yn({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return Xi(i=(e.ownerDocument||e).createElement("style")),om(i,"style",a),Um(i,n.precedence,e),t.instance=i;case"stylesheet":a=Om(n.href);var o=e.querySelector(Rm(a));if(o)return t.state.loading|=4,t.instance=o,Xi(o),o;i=Dm(n),(a=Im.get(a))&&Hm(i,a),Xi(o=(e.ownerDocument||e).createElement("link"));var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),om(o,"link",i),t.state.loading|=4,Um(o,n.precedence,e),t.instance=o;case"script":return o=Lm(n.src),(a=e.querySelector(Fm(o)))?(t.instance=a,Xi(a),a):(i=n,(a=Im.get(o))&&Bm(i=yn({},n),a),Xi(a=(e=e.ownerDocument||e).createElement("script")),om(a,"link",i),e.head.appendChild(a),t.instance=a);case"void":return null;default:throw Error(hn(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(i=t.instance,t.state.loading|=4,Um(i,n.precedence,e));return t.instance}function Um(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=i.length?i[i.length-1]:null,o=a,s=0;s<i.length;s++){var r=i[s];if(r.dataset.precedence===t)o=r;else if(o!==a)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Hm(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Bm(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var $m=null;function qm(e,t,n){if(null===$m){var i=new Map,a=$m=new Map;a.set(n,i)}else(i=(a=$m).get(n))||(i=new Map,a.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var o=n[a];if(!(o[Gi]||o[Fi]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var s=o.getAttribute(t)||"";s=e+s;var r=i.get(s);r?r.push(o):i.set(s,[o])}}return i}function Gm(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function Vm(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var Wm=null;function Qm(){}function Km(){if(this.count--,0===this.count)if(this.stylesheets)Xm(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Ym=null;function Xm(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Ym=new Map,t.forEach(Jm,e),Ym=null,Km.call(e))}function Jm(e,t){if(!(4&t.state.loading)){var n=Ym.get(e);if(n)var i=n.get(null);else{n=new Map,Ym.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<a.length;o++){var s=a[o];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),i=s)}i&&n.set(null,i)}s=(a=t.instance).getAttribute("data-precedence"),(o=n.get(s)||i)===i&&n.set(null,a),n.set(s,a),this.count++,i=Km.bind(this),a.addEventListener("load",i),a.addEventListener("error",i),o?o.parentNode.insertBefore(a,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var Zm={$$typeof:In,Provider:null,Consumer:null,_currentValue:Bn,_currentValue2:Bn,_threadCount:0};function ef(e,t,n,i,a,o,s,r){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ni(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ni(0),this.hiddenUpdates=Ni(null),this.identifierPrefix=i,this.onUncaughtError=a,this.onCaughtError=o,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=r,this.incompleteTransitions=new Map}function tf(e,t,n,i,a,o,s,r,l,c,u,d){return e=new ef(e,t,n,s,r,l,c,d),t=1,!0===o&&(t|=24),o=Bs(3,null,null,t),e.current=o,o.stateNode=e,(t=zr()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:i,isDehydrated:n,cache:t},ll(o),e}function nf(e){return e?e=Us:Us}function af(e,t,n,i,a,o){a=nf(a),null===i.context?i.context=a:i.pendingContext=a,(i=ul(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(i.callback=o),null!==(n=dl(e,i,t))&&(Hh(n,0,t),hl(n,e,t))}function of(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function sf(e,t){of(e,t),(e=e.alternate)&&of(e,t)}function rf(e){if(13===e.tag){var t=Ls(e,67108864);null!==t&&Hh(t,0,67108864),sf(e,67108864)}}var lf=!0;function cf(e,t,n,i){var a=Un.T;Un.T=null;var o=Hn.p;try{Hn.p=2,df(e,t,n,i)}finally{Hn.p=o,Un.T=a}}function uf(e,t,n,i){var a=Un.T;Un.T=null;var o=Hn.p;try{Hn.p=8,df(e,t,n,i)}finally{Hn.p=o,Un.T=a}}function df(e,t,n,i){if(lf){var a=hf(i);if(null===a)Wp(e,t,i,pf,n),Cf(e,i);else if(function(e,t,n,i,a){switch(t){case"focusin":return vf=Ef(vf,e,t,n,i,a),!0;case"dragenter":return yf=Ef(yf,e,t,n,i,a),!0;case"mouseover":return bf=Ef(bf,e,t,n,i,a),!0;case"pointerover":var o=a.pointerId;return xf.set(o,Ef(xf.get(o)||null,e,t,n,i,a)),!0;case"gotpointercapture":return o=a.pointerId,wf.set(o,Ef(wf.get(o)||null,e,t,n,i,a)),!0}return!1}(a,e,t,n,i))i.stopPropagation();else if(Cf(e,i),4&t&&-1<Sf.indexOf(e)){for(;null!==a;){var o=Qi(a);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var s=Ci(o.pendingLanes);if(0!==s){var r=o;for(r.pendingLanes|=2,r.entangledLanes|=2;s;){var l=1<<31-bi(s);r.entanglements[1]|=l,s&=~l}Ip(o),!(6&rh)&&(Ih=ri()+500,Tp(0))}}break;case 13:null!==(r=Ls(o,2))&&Hh(r,0,2),Vh(),sf(o,2)}if(null===(o=hf(i))&&Wp(e,t,i,pf,n),o===a)break;a=o}null!==a&&i.stopPropagation()}else Wp(e,t,i,null,n)}}function hf(e){return mf(e=La(e))}var pf=null;function mf(e){if(pf=null,null!==(e=Wi(e))){var t=mn(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=fn(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return pf=e,null}function ff(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(li()){case ci:return 2;case ui:return 8;case di:case hi:return 32;case pi:return 268435456;default:return 32}default:return 32}}var gf=!1,vf=null,yf=null,bf=null,xf=new Map,wf=new Map,_f=[],Sf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Cf(e,t){switch(e){case"focusin":case"focusout":vf=null;break;case"dragenter":case"dragleave":yf=null;break;case"mouseover":case"mouseout":bf=null;break;case"pointerover":case"pointerout":xf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":wf.delete(t.pointerId)}}function Ef(e,t,n,i,a,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[a]},null!==t&&(null!==(t=Qi(t))&&rf(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function kf(e){var t=Wi(e.target);if(null!==t){var n=mn(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=fn(n)))return e.blockedOn=t,void function(e,t){var n=Hn.p;try{return Hn.p=e,t()}finally{Hn.p=n}}(e.priority,function(){if(13===n.tag){var e=zh();e=Oi(e);var t=Ls(n,e);null!==t&&Hh(t,0,e),sf(n,e)}})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function If(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=hf(e.nativeEvent);if(null!==n)return null!==(t=Qi(n))&&rf(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);Da=i,n.target.dispatchEvent(i),Da=null,t.shift()}return!0}function Tf(e,t,n){If(e)&&n.delete(t)}function jf(){gf=!1,null!==vf&&If(vf)&&(vf=null),null!==yf&&If(yf)&&(yf=null),null!==bf&&If(bf)&&(bf=null),xf.forEach(Tf),wf.forEach(Tf)}function Nf(e,t){e.blockedOn===t&&(e.blockedOn=null,gf||(gf=!0,cn.unstable_scheduleCallback(cn.unstable_NormalPriority,jf)))}var Pf=null;function Mf(e){Pf!==e&&(Pf=e,cn.unstable_scheduleCallback(cn.unstable_NormalPriority,function(){Pf===e&&(Pf=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],a=e[t+2];if("function"!=typeof i){if(null===mf(i||n))continue;break}var o=Qi(n);null!==o&&(e.splice(t,3),t-=3,Dc(o,{pending:!0,data:a,method:n.method,action:i},i,a))}}))}function Af(e){function t(t){return Nf(t,e)}null!==vf&&Nf(vf,e),null!==yf&&Nf(yf,e),null!==bf&&Nf(bf,e),xf.forEach(t),wf.forEach(t);for(var n=0;n<_f.length;n++){var i=_f[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<_f.length&&null===(n=_f[0]).blockedOn;)kf(n),null===n.blockedOn&&_f.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(i=0;i<n.length;i+=3){var a=n[i],o=n[i+1],s=a[zi]||null;if("function"==typeof o)s||Mf(n);else if(s){var r=null;if(o&&o.hasAttribute("formAction")){if(a=o,s=o[zi]||null)r=s.formAction;else if(null!==mf(a))continue}else r=s.action;"function"==typeof r?n[i+1]=r:(n.splice(i,3),i-=3),Mf(n)}}}function Of(e){this._internalRoot=e}function Rf(e){this._internalRoot=e}Rf.prototype.render=Of.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(hn(409));af(t.current,zh(),e,t,null,null)},Rf.prototype.unmount=Of.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;af(e.current,2,null,e,null,null),Vh(),t[Ui]=null}},Rf.prototype.unstable_scheduleHydration=function(e){if(e){var t=Di();e={blockedOn:null,target:e,priority:t};for(var n=0;n<_f.length&&0!==t&&t<_f[n].priority;n++);_f.splice(n,0,e),0===n&&kf(e)}};var Df=un.version;if("19.1.1"!==Df)throw Error(hn(527,Df,"19.1.1"));Hn.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(hn(188));throw e=Object.keys(e).join(","),Error(hn(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=mn(e)))throw Error(hn(188));return t!==e?null:e}for(var n=e,i=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(i=a.return)){n=i;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return gn(a),e;if(o===i)return gn(a),t;o=o.sibling}throw Error(hn(188))}if(n.return!==i.return)n=a,i=o;else{for(var s=!1,r=a.child;r;){if(r===n){s=!0,n=a,i=o;break}if(r===i){s=!0,i=a,n=o;break}r=r.sibling}if(!s){for(r=o.child;r;){if(r===n){s=!0,n=o,i=a;break}if(r===i){s=!0,i=o,n=a;break}r=r.sibling}if(!s)throw Error(hn(189))}}if(n.alternate!==i)throw Error(hn(190))}if(3!==n.tag)throw Error(hn(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?vn(e):null)?null:e.stateNode};var Lf={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Un,reconcilerVersion:"19.1.1"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Ff=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ff.isDisabled&&Ff.supportsFiber)try{gi=Ff.inject(Lf),vi=Ff}catch(IX){}}sn.createRoot=function(e,t){if(!pn(e))throw Error(hn(299));var n=!1,i="",a=Su,o=Cu,s=Eu;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(a=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(s=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=tf(e,1,!1,null,0,n,i,a,o,s,0,null),e[Ui]=t.current,Gp(e),new Of(t)},sn.hydrateRoot=function(e,t,n){if(!pn(e))throw Error(hn(299));var i=!1,a="",o=Su,s=Cu,r=Eu,l=null;return null!=n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onUncaughtError&&(o=n.onUncaughtError),void 0!==n.onCaughtError&&(s=n.onCaughtError),void 0!==n.onRecoverableError&&(r=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(l=n.formState)),(t=tf(e,1,!0,t,0,i,a,o,s,r,0,l)).context=nf(null),n=t.current,(a=ul(i=Oi(i=zh()))).callback=null,dl(n,a,i),n=i,t.current.lanes=n,Pi(t,n),Ip(t),e[Ui]=t.current,Gp(e),new Rf(t)},sn.version="19.1.1",function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(IX){}}(),on.exports=sn;var zf=on.exports;let Uf=null;const Hf=()=>(Uf||(Uf=O()),Uf),Bf="",$f="/api/v1",qf="/api/v2",Gf="DPO_qwenlm-intl@service.alibaba.com";var Vf=(e=>(e.SIDEBAR_NEW_CHAT_BUTTON="sidebar-new-chat-button",e.CHAT_INPUT="chat-input",e.COPY_CODE_BUTTON="copy-code-button",e.COPY_RESPONSE_BUTTON="copy-response-button",e.SIDEBAR_TOGGLE_BUTTON="sidebar-toggle-button",e.DELETE_CHAT_BUTTON="delete-chat-button",e.SETTING_TOGGLE_BUTTON="setting-toggle-button",e.SHOW_SHORTCUTS_BUTTON="show-shortcuts-button",e))(Vf||{});const Wf=760,Qf="manually_close_sidebar";var Kf=(e=>(e.IOS="ios",e.ANDROID="android",e.WEB="web",e.DESKTOP="desktop",e.UNKNOWN="unknown",e))(Kf||{}),Yf=(e=>(e.RECCOMMAND="recommendation",e.CHAT="chat",e.RETRY="retry",e.EDIT="edit",e.ASK="ask",e.EXPLAIN="explain",e.TRANSLATE="translate",e))(Yf||{}),Xf=(e=>(e.SETAPP="setapp",e.DESKTOP="desktop",e))(Xf||{}),Jf=(e=>(e.THINKING="THINKING",e.THOUGHT_COMPLETED="THOUGHT_COMPLETED",e.THOUGHT_STOP="THOUGHT_STOP",e.NONE_THINKING="NONE_THINKING",e))(Jf||{}),Zf=(e=>(e.CODE_INTERPRETER="code_interpreter_http",e.WEB_SEARCH="web_search",e))(Zf||{}),eg=(e=>(e.TIMEOUT="timeout",e.NETWORK="network",e.VALIDATION="validation",e.UNKNOWN="unknown",e))(eg||{});class tg extends Error{constructor(e,t="unknown",n="error",i,a){super(e),C(this,"type"),C(this,"messageId"),C(this,"details"),C(this,"priority"),this.name="ChatError",this.type=t,this.messageId=i,this.details=a,this.priority=n}}var ng=(e=>(e.DeepResearch="deep_research",e.DeepThinking="deep_thinking",e.Artifacts="artifacts",e.WebSearch="search",e.ImageGeneration="t2i",e.VideoGeneration="t2v",e.Image2Video="i2v",e.Txt2Txt="t2t",e.WebDev="web_dev",e.TRANSLATE="translate",e.Thinking="thinking",e.Mcp="mcp",e.ImageEdit="image_edit",e.DeepResearchWebDev="deep_research_webdev",e.Podcast="aipodcast",e.TRAVEL_FEEDBACK="travel_feedback",e.Travel="travel",e.TRAVEL_RESEARCH="travel_research",e.LEARN="learn",e.INTERRUPT="interrupt",e))(ng||{}),ig=(e=>(e.OmniAudio="omni_audio",e.OmniVideo="omni_video",e))(ig||{}),ag=(e=>(e.PdfViewer="pdf_viewer",e.DeepResearch="deep_research",e.Artifacts="artifacts",e.Overview="overview",e.Settings="settings",e.Feedback="feedback",e.None="none",e.DeepResearchLinkSource="DeepResearchLinkSource",e.WebDev="web_dev",e.WebSearch="search",e.Thinking="thinking",e.ThinkingAndSearch="thinking_and_search",e.ImageReason="imageReason",e.DeepResearchDetail="deep_research_detail",e.ThinkingAndSources="thinking_and_sources",e))(ag||{}),og=(e=>(e.THINK="think",e.TOOL="tool",e.ANSWER="answer",e.DEEPTHINKING="DeepThinking",e.RESEARCHPLANNING="ResearchPlanning",e.PdfMdGen="PdfMdGen",e.ReportGeneration="ReportGeneration",e.KEEPALIVE="KeepAlive",e.LOCAL_TOOL="local_tool",e.IMAGE_GEN_THINK="image_gen_think",e.IMAGE_GEN_WEB_SEARCH="image_gen_websearch",e.IMAGE_GEN="image_gen",e.WEB_SEARCH="web_search",e.IMAGE="image",e.IMAGE_ZOOM_IN_TOOL="image_zoom_in_tool",e.CODE_INTERPRETER="code_interpreter",e.THINKING_SUMMARY="thinking_summary",e.WEB_EXTRACTOR="web_extractor",e.HISTORY_RETRIEVER="history_retriever",e.BIO="bio",e.INTERRUPT="interrupt",e.INTERRUPTRECEIVED="InterruptReceived",e.RESEARCHNOTICE="ResearchNotice",e))(og||{}),sg=(e=>(e.TYPING="typing",e.FINISHED="finished",e.ERROR="error",e.PAUSE="pause",e))(sg||{}),rg=(e=>(e.text="text",e.url="url",e))(rg||{}),lg=(e=>(e.SUCCESS="success",e.FAIL="failed",e.OUT_OF_LIMIT="out_of_limit",e.PARSING="parsing",e))(lg||{});const cg=40960,ug={"1:1":"1:1","4:3":"4:3","3:4":"3:4","16:9":"16:9","9:16":"9:16"},dg=!0;var hg=(e=>(e.DeepResearch="deep_research",e.Artifacts="artifacts",e.WebSearch="search",e.ImageGeneration="t2i",e.VideoGeneration="t2v",e.Image2Video="i2v",e.Txt2Txt="t2t",e.Travel="travel",e))(hg||{}),pg=(e=>(e.ReportGeneration="ReportGeneration",e.ResearchPlanning="ResearchPlanning",e.PdfMdGen="PdfMdGen",e))(pg||{});const mg=[{title:"Model issue",content:[{label:"Inconsistent with the facts",value:"Inconsistent with the facts"},{label:"Inconsistent with the instruction",value:"Inconsistent with the instruction"},{label:"Offensive/Unsafe",value:"Offensive/Unsafe"},{label:"Language error",value:"Language error"},{label:"Unreasonable format",value:"Unreasonable format"},{label:"The content is mediocre/boring",value:"The content is mediocre/boring"},{label:"Output lagging",value:"Output lagging"},{label:"Other",value:"Other"}]},{title:"UI issue",content:[{label:"Laggy UI",value:"Laggy UI"},{label:"Poor readability",value:"Poor readability"},{label:"Hard-to-find features",value:"Hard-to-find features"},{label:"Inconsistent interactions",value:"Inconsistent interactions"},{label:"Missing guidance",value:"Missing guidance"}]}],fg="Cherry",gg=[ag.PdfViewer,ag.DeepResearchDetail,ag.DeepResearch],vg=e=>[ng.DeepResearch,ng.TRAVEL_RESEARCH].includes(e),yg=e=>["deep_research","travel"].includes(e),bg="chat-messages-scroll-container",xg="NATIVE_NEW_BRANCH";var wg=(e=>(e.ITEM="item",e.GROUP="group",e))(wg||{});const _g=["text/plain"],Sg=["image/gif","image/webp","image/jpeg","image/png","image/bmp","image/x-bmp","image/x-ms-bmp","image/icns","image/jp2","image/sgi","image/tiff","image/x-icon"],Cg=["video/mp4","video/avi","video/x-ms-wmv","video/x-flv","video/x-matroska","video/quicktime"],Eg=["audio/amr","audio/wav","audio/x-wav","audio/aac","audio/mpeg","audio/x-m4a"],kg=["text/x-java-source","text/x-kotlin","text/x-scala","text/x-groovy","application/javascript","text/javascript","application/typescript","text/jsx","text/tsx","application/javascript","text/x-vue","text/x-python","application/x-ipynb+json","text/html","text/css","text/x-sass","text/x-less","text/x-stylus","image/svg+xml","application/x-shellscript","text/x-powershell","application/x-msdownload","text/x-dockerfile-config","text/x-go","text/x-rust","text/x-swift","application/x-httpd-php","application/x-ruby","text/x-csharp","text/x-vb","text/x-fsharp","application/sql","text/x-lua","text/x-r","text/x-perl","application/x-tcl","text/x-awk","application/x-fish-script","application/xml","application/json","application/x-yaml","application/toml","text/x-groovy","text/x-kotlin","text/x-markdown","text/x-matlab","text/x-julia","text/x-sas","text/x-gdscript","text/x-glsl","text/x-hlsl","text/x-asm","text/x-verilog","text/x-vhdl","application/x-ipynb+json","text/x-quarto","text/markdown","text/x-protobuf","text/x-thrift","application/graphql","application/wasm","application/json","text/x-c","text/x-c++src","text/x-c++hdr","text/x-arduino","text/x-csrc"],Ig=["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","text/csv","text/comma-separated-values","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/markdown","text/plain",...kg],Tg=["txt","TXT"],jg=["gif","webp","jpg","jpeg","png","bmp","icns","jp2","sgi","tif","tiff","dib","ico","jfif","j2c","j2k","jpc","jpf","jpx","apng","bw","rgb","rgba"],Ng=["mp4","avi","wmv","flv","mkv","mov"],Pg=["amr","wav","aac","mp3","m4a"],Mg=["c","h","cc","cxx","hpp","hh","hxx","ino","java","kt","kts","scala","groovy","js","ts","jsx","tsx","vue","mjs","cjs","py","pyi","ipynb","html","htm","css","scss","sass","less","styl","svg","sh","bash","zsh","ps1","bat","cmd","dockerfile","containerfile","go","rs","swift","php","rb","cs","vb","fs","csproj","sln","sql","lua","r","pl","tcl","awk","fish","xml","json","jsonc","yaml","yml","toml","ini","env","gradle","kts","pom","mk","cmake","lock","rmd","m","jl","sas","asm","s","v","sv","vhd","vhdl","gd","shader","glsl","hlsl","proto","thrift","graphql","gql","wasm","asmdef","qmd","cpp","lock","smali"],Ag=["pdf","doc","docx","csv","xlsx","xls","md",...Mg],Og=1/0,Rg="qwen2.5-omni-7b",Dg=1/0;var Lg=(e=>(e.DEFAULT="default",e.IMAGE="vision",e.VIDEO="video",e.AUDIO="audio",e.DOC="document",e))(Lg||{}),Fg=(e=>(e.FILE="file",e.IMAGE="image",e.VIDEO="video",e.AUDIO="audio",e))(Fg||{});const zg={default:{max_count:Og,max_size:20,accept_extension:Tg,accept_type:_g},document:{max_count:5,max_size:20,accept_extension:Ag,accept_type:Ig},vision:{max_count:5,max_size:10,accept_extension:jg,accept_type:Sg},video:{max_count:1,max_size:500,accept_extension:Ng,accept_type:Cg,max_duration:600},audio:{max_count:1,max_size:100,accept_extension:Pg,accept_type:Eg,max_duration:180}},Ug=w({"application/epub+zip":{icon:"iconepub1",bg:"#9BC751"},"application/pdf":{icon:"iconpdf1",bg:"#DE5A5E"},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{icon:"iconppt1",bg:"#E4785F"},"text/plain":{icon:"icontxt1",bg:"#61B6ED"},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{icon:"iconexcel1",bg:"#6BBF6D"},others:{icon:"iconothers1",bg:"#A0A3BA"},"text/html":{icon:"iconhtml1",bg:"#F1B94A"},"text/htm":{icon:"iconhtml1",bg:"#F1B94A"},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{icon:"iconword1",bg:"#4B8EF7"},"text/md":{icon:"iconmd1",bg:"#7BC8C3"},"text/markdown":{icon:"iconmd1",bg:"#7BC8C3"},"video/mp4":{icon:"iconvideo1",bg:"#407FFD"},"video/avi":{icon:"iconvideo1",bg:"#407FFD"},"video/quicktime":{icon:"iconvideo1",bg:"#407FFD"},"video/x-flv":{icon:"iconvideo1",bg:"#407FFD"},"video/x-matroska":{icon:"iconvideo1",bg:"#407FFD"},"video/x-ms-wmv":{icon:"iconvideo1",bg:"#407FFD"}},[...Eg].reduce((e,t)=>(e[t]={icon:"iconaudio",bg:"#FFAB19"},e),{}));var Hg=(e=>(e.Default="Default",e.Error="Error",e.Listening="Listening",e.Connecting="Connecting",e.Thinking="Thinking",e.Speaking="Speaking",e))(Hg||{}),Bg=(e=>(e.NoMicphonePermission="NoMicphonePermission",e.ConnectionLost="ConnectionLost",e.UnknownError="UnknownError",e.CallingTooFrequently="CallingTooFrequently",e.InternalServerError="InternalServerError",e.DataInputInspectionFailed="DataInputInspectionFailed",e.CurrentConversationTimeout="CurrentConversationTimeout",e.DailyConversationTimeout="DailyConversationTimeout",e.TodayExhausted="TodayExhausted",e.NotSupported="NotSupported",e.Limited="Limited",e))(Bg||{});class $g extends Error{constructor(e){super(),C(this,"payload"),this.payload={error:e}}}const qg="//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/audio",Gg=[{imgUrl:"https://img.alicdn.com/imgextra/i2/O1CN01wTLOYq1kJFZ4YsxwN_!!6000000004662-2-tps-96-96.png",breathConfig:{timestamp:"2025-01-15_19-12-47",background:"f6f1c3",palette:["b3eeff","a2ffff","bbcfff","60c6ff","e2dfff"],offsets:[2,2,2,1.17,.65,.7,-.54,.9,2,-.9],twist:[4,0,.36,5.7,.6,.15,2.1,1,.14,.04],symbolColor:"#1B58F4"},breathVideo:`${qg}/MP4-F245.mp4`},{imgUrl:"https://img.alicdn.com/imgextra/i3/O1CN01gzeD5Z1mBaAKBRD9t_!!6000000004916-2-tps-96-96.png",breathConfig:{timestamp:"2025-01-17_16-58-53",background:"fff6f6",palette:["ffb5b7","ffc2ed","faf1ff","fff2fa","ffb9ec"],offsets:[.1,-.77,.01,1.36,2,1.13,2,2,-1.01,-1.39],twist:[-2,-2,.96,2.5,.67,1,2.36,1,.12,0],symbolColor:"#8340F2"},breathVideo:`${qg}/MP4-F05.mp4`},{imgUrl:"https://img.alicdn.com/imgextra/i2/O1CN01sdDcX31h2oVI9jUiL_!!6000000004220-2-tps-96-96.png",breathConfig:{timestamp:"2025-01-15_17-51-55",background:"B7CCFB",palette:["928ef3","5E82D1","DCDCFB","8CB5F9","ACB4F7"],offsets:[1.02,1.5,1.05,-.95,-1.75,.27,.99,-1.5,.95,.54],twist:[2,0,.24,5.7,.6,.15,1.5,1,.32,.05],symbolColor:"#6483FF"},breathVideo:`${qg}/MP4-M02.mp4`},{imgUrl:"https://img.alicdn.com/imgextra/i1/O1CN01LDtR50268dwIq0QLW_!!6000000007617-2-tps-96-96.png",breathConfig:{timestamp:"2025-01-17_16-56-39",background:"d3b5fe",palette:["fb98be","ed478c","e2cadc","ba70fb","e7adff"],offsets:[2,2,2,1.17,.65,.7,-.54,.9,2,-.9],twist:[4,0,.37,5.7,.6,.15,1.5,1,.127,0],symbolColor:"#1B58F4"},breathVideo:`${qg}/MP4-F030.mp4`}],Vg={[Hg.Connecting]:{animate:"pointAnimate",text:"Connecting"},[Hg.Listening]:{animate:"jumpAnimate",text:"I'm listening"},[Hg.Thinking]:{animate:"pointAnimate",text:"Let me think"},[Hg.Speaking]:{animate:"jumpAnimate",text:"I'm speaking"}},Wg={[Bg.ConnectionLost]:()=>Pv("Connection failed, please retry."),[Bg.NoMicphonePermission]:()=>Pv("No microphone permission, please check permission settings"),[Bg.UnknownError]:()=>Pv("An error occurred during the call. Please try again."),[Bg.CallingTooFrequently]:()=>Pv("The call frequency is too high, please try again later ({{number}} times/minute).",{number:1}),[Bg.InternalServerError]:()=>Pv("An error occurred during the call. Please try again."),[Bg.DataInputInspectionFailed]:()=>Pv("The call content includes non-compliant content, please try again."),[Bg.CurrentConversationTimeout]:()=>Pv("The current call has exceeded {{time}} minutes, please restart the session ({{time}} minutes/session).",{time:3}),[Bg.DailyConversationTimeout]:()=>Pv("The call today exceeded {{time}} minutes, please come back tomorrow to use it ({{time}} minutes/day).",{time:30}),[Bg.TodayExhausted]:()=>Pv("Today's chat limit has been reached"),[Bg.NotSupported]:()=>Pv("Voice and video chat are not supported in this version of the web browser."),[Bg.Limited]:()=>Pv("Oops, it's overcrowded! Please try again later.")},Qg=["internal-qwenlm.alibaba-inc.com","qwenlm.io","chat.qwenlm.ai","qwenlm.ai","qwen.ai","chat.qwen.ai","qwenchat.com"].some(e=>location.host===e)?"prod":"pre",Kg="/api/v2",Yg="prod"===Qg?"https://qwenlm.io/":"https://pre-qwenlm-box.alibaba-inc.com/",Xg="https://img.alicdn.com/imgextra/i3/O1CN01Cq8uhd23V8UCJZ0fh_!!6000000007260-2-tps-135-135.png",Jg="https://img.alicdn.com/imgextra/i3/O1CN01TpE2ye1OVghd2mGKR_!!6000000001711-2-tps-135-135.png",Zg="https://img.alicdn.com/imgextra/i1/O1CN019vymhb1ixtSVzxTQl_!!6000000004480-2-tps-80-80.png",ev="https://img.alicdn.com/imgextra/i4/O1CN01K49Cpa28SueDV7tjF_!!6000000007932-2-tps-80-80.png",tv="https://img.alicdn.com/imgextra/i2/O1CN01phdKoS1MEAJmHK3c5_!!6000000001402-2-tps-135-135.png",nv="https://img.alicdn.com/imgextra/i4/O1CN01hJPJD51DDrVurbnIy_!!6000000000183-2-tps-135-135.png",iv="https://img.alicdn.com/imgextra/i2/O1CN01lKevnt1CT9AjHPH6K_!!6000000000081-2-tps-80-80.png",av="https://img.alicdn.com/imgextra/i2/O1CN01q52uU51e07Jtd5VoQ_!!6000000003808-2-tps-80-80.png",ov=["https://img.alicdn.com/imgextra/i2/O1CN01lKevnt1CT9AjHPH6K_!!6000000000081-2-tps-80-80.png","https://img.alicdn.com/imgextra/i4/O1CN01uIRvDi1HmRwXjbGPl_!!6000000000800-2-tps-80-80.png","https://img.alicdn.com/imgextra/i4/O1CN01Z3uK5L1XGQ656m31M_!!6000000002896-2-tps-80-80.png","https://img.alicdn.com/imgextra/i2/O1CN01IyqtJf1Rvk8bDTdnw_!!6000000002174-2-tps-80-80.png","https://img.alicdn.com/imgextra/i3/O1CN01FPKNKM1G6U2Kf9szo_!!6000000000573-2-tps-80-80.png","https://img.alicdn.com/imgextra/i3/O1CN01ZrELpb1ewHbrU51Vz_!!6000000003935-2-tps-80-80.png","https://img.alicdn.com/imgextra/i1/O1CN01AScJqr28R56Gtis7F_!!6000000007928-2-tps-80-80.png","https://img.alicdn.com/imgextra/i2/O1CN01inWYU91VWKcrqNUIG_!!6000000002660-2-tps-80-80.png","https://img.alicdn.com/imgextra/i1/O1CN01L4GN611Moo3mwfKcN_!!6000000001482-2-tps-80-80.png","https://img.alicdn.com/imgextra/i1/O1CN01GwiFlo1xdU3Gx5PL3_!!6000000006466-2-tps-80-80.png"],sv=[{title:"Ne Zha 2: A milestone in the industrialization and cultural export of Chinese cinema",query:"Using Ne Zha 2 as an entry point to analyze the development of Chinese cinema"},{title:"Comparative analysis of the advantages and disadvantages of PPO, GRPO, and DAPO algorithms",query:"Please introduce and compare the advantages and disadvantages of the three algorithms PPO, GRPO, and DAPO respectively"},{title:"Research Report on a One-Week Travel Itinerary from Beijing to Hong Kong",query:"I want to go to Hong Kong for a week. Can you help me plan the itinerary, departing from Beijing?"},{title:"The 5 Most Essential Vitamins for Chinese People: Their Functions and Supplementation Recommendations",query:"Research the 5 vitamins most needed by Chinese people, describing their functions, the scientific research behind them, the principles of how they work in the body, and methods and recommendations for supplementing vitamins for the general public."},{title:"Research Report on the Development Trends of Men's Professional Singles Tennis over the Next Three Years",query:"Analysis and prediction of the men's singles professional tennis landscape in the next three years"}],rv=[{title:"Shanghai 3-day cultural tour: an in-depth exploration of museums, gardens, and urban memories",query:"I plan to go to Shanghai alone for three days the day after tomorrow, departing from Hangzhou. Can you help me arrange the itinerary?"},{title:"7-Day Self-Drive Tour of Northern Xinjiang's Natural Wonders: A Journey Through Autumn Landscapes",query:"Plan a 7-day itinerary for the Northern Xinjiang small loop, departing from Beijing next Monday, for one person"},{title:"Qiandao Lake family slow tour: a two-day lakeside and mountain scenery trip from Shanghai on September 20-21, 2025",query:"Next weekend, the three of us in my family will depart from Shanghai and head to Qiandao Lake for a two-day trip. Please arrange an itinerary for us."},{title:"3-Day Relaxing Family Trip to Nanjing: A Journey of Cultural Strolls and Natural Adventures",query:"Next Saturday, my family of three will leave from Beijing to Nanjing for a three-day trip. Please arrange the itinerary for me."}],lv=[{title:"Make a Snake game",src:"https://img.alicdn.com/imgextra/i3/O1CN01hrxnOs25KGJKjxW67_!!6000000007507-2-tps-546-546.png",darkSrc:"https://img.alicdn.com/imgextra/i3/O1CN01RWCmpW1ddfrF3up3l_!!6000000003759-2-tps-546-546.png"},{title:"Make a small Gomoku game.",src:"https://img.alicdn.com/imgextra/i4/O1CN012wVcz528nyrMPiGCM_!!6000000007978-2-tps-546-546.png",darkSrc:"https://img.alicdn.com/imgextra/i4/O1CN01mCyofW1K9T2MEhL8g_!!6000000001121-2-tps-546-546.png"},{title:"Make a Minesweeper mini-game.",src:"https://img.alicdn.com/imgextra/i1/O1CN01McVpy11wOzrha64Nx_!!6000000006299-2-tps-546-546.png",darkSrc:"https://img.alicdn.com/imgextra/i2/O1CN01AlLlNZ1xgENvLmc4o_!!6000000006472-2-tps-546-546.png"},{title:'How many "r"s are in "strawberrrrry"? Make a cute HTML mini card!',src:"https://img.alicdn.com/imgextra/i3/O1CN018mcDZJ1UAyUwn7uCk_!!6000000002478-2-tps-546-546.png",darkSrc:"https://img.alicdn.com/imgextra/i4/O1CN018UQUIJ1diiDMJ7aIp_!!6000000003770-2-tps-546-546.png"},{title:"Create a simple calculator web application",src:"https://img.alicdn.com/imgextra/i2/O1CN01rzjVtp1rfPzFvC7Uy_!!6000000005658-2-tps-546-546.png",darkSrc:"https://img.alicdn.com/imgextra/i4/O1CN01Qkdh0B1alVmxSobDv_!!6000000003370-2-tps-546-546.png"},{title:"Create a personal portfolio website with sections for an About Me page, a Projects gallery, a Blog for sharing articles, and a Contact form.",src:"https://img.alicdn.com/imgextra/i2/O1CN01bYO0CO1wkysNU0Luf_!!6000000006347-2-tps-546-546.png",darkSrc:"https://img.alicdn.com/imgextra/i1/O1CN01iOzcak20lfwMfksX1_!!6000000006890-2-tps-546-546.png"},{title:"Create a graphical workflow overview html of RAGs",src:"https://img.alicdn.com/imgextra/i3/O1CN011TUuwf1UUfWp42y1v_!!6000000002521-2-tps-546-546.png",darkSrc:"https://img.alicdn.com/imgextra/i4/O1CN01cbVhEh1Ul9mq0o3uv_!!6000000002557-2-tps-546-546.png"},{title:"Create a presentation deck for a startup pitch, including slides for the company overview, market analysis, product features, business model, and financial projections. The presentation should be visually appealing, and have multiple slides that user can switch to next and previous slides by clicking the arrow keys.",src:"https://img.alicdn.com/imgextra/i3/O1CN01ZTrcPh1bLEgDDO4Xh_!!6000000003448-2-tps-546-546.png",darkSrc:"https://img.alicdn.com/imgextra/i1/O1CN01xPCI551dqxLOfzLZ8_!!6000000003788-2-tps-546-546.png"},{title:"Check the weather in London and make a weather card including temperature, weather, and emoji expressions.",src:"https://img.alicdn.com/imgextra/i3/O1CN01hpZRm52A20bfxoDZG_!!6000000008144-2-tps-546-546.png",darkSrc:"https://img.alicdn.com/imgextra/i1/O1CN01IkCYsf29RMvD1KV5r_!!6000000008064-2-tps-546-546.png"}],cv=[{title:"Create a personal website for a software engineer, including sections such as personal introduction, education background, project experience, etc.",src:"https://img.alicdn.com/imgextra/i4/O1CN01xlhSky1GuPAf4eFrK_!!6000000000682-2-tps-948-543.png",darkSrc:"https://img.alicdn.com/imgextra/i1/O1CN017XBwc120EhQlYC19P_!!6000000006818-2-tps-948-543.png"},{title:'Generate a semantic "Contact Support" form consisting of the user\'s name, email, issue type, and message. The form elements should be stacked vertically and placed inside a card.',src:"https://img.alicdn.com/imgextra/i1/O1CN011dEWtw1rpx6TbxdQj_!!6000000005681-2-tps-948-543.png",darkSrc:"https://img.alicdn.com/imgextra/i2/O1CN012BqDoa1Pa69W0BdH8_!!6000000001856-2-tps-948-543.png"},{title:"Write a fruit e-commerce website.",src:"https://img.alicdn.com/imgextra/i1/O1CN01iVUvAq1i3YiGagDmD_!!6000000004357-2-tps-948-543.png",darkSrc:"https://img.alicdn.com/imgextra/i2/O1CN01Ytn7DF1CaTTG0gSei_!!6000000000097-2-tps-948-543.png"},{title:'How many "r"s are in "strawberrrrry"? Make a cute HTML mini card!',src:"https://img.alicdn.com/imgextra/i1/O1CN01ywIpzR1Xgz24H0Ncl_!!6000000002954-2-tps-948-543.png",darkSrc:"https://img.alicdn.com/imgextra/i4/O1CN01ihIvuO1yioEnAH8u1_!!6000000006613-2-tps-948-543.png"},{title:"Create a content social networking website with a RedNote-style design.",src:"https://img.alicdn.com/imgextra/i1/O1CN01PIcmRB1PEZXN1OKaN_!!6000000001809-2-tps-948-543.png",darkSrc:"https://img.alicdn.com/imgextra/i2/O1CN01uhXGeZ1ZKexWGzZlM_!!6000000003176-2-tps-948-543.png"},{title:"Create a sunscreen product introduction website.",src:"https://img.alicdn.com/imgextra/i2/O1CN01s5jfll1uOsXTRizNd_!!6000000006028-2-tps-948-543.png",darkSrc:"https://img.alicdn.com/imgextra/i2/O1CN01kArlys1wCAma0newZ_!!6000000006271-2-tps-948-543.png"}],uv=[{src:"/video/video_squirrel.mp4",description:"A squirrel wearing a little vest is driving a small car made of hazelnut shells for the body and twigs for the wheels, bumping along a leaf-covered forest path.",height:"h-[16.5rem]"},{src:"/video/video_couple.mp4",description:"The scene opens with a medium shot of a man and a woman walking side by side across a bridge at sunset. Captured with a handheld camera, the shot features slightly softened depth of field, creating a gentle bokeh effect. The background glows in warm pink-orange hues, softly illuminating their faces, while streetlights emit a gentle glow. They stroll leisurelythe man in a white shirt with a mustard-yellow tie, a brown jacket draped over his arm; the woman in a coral-pink sleeveless dress, holding a beige clutch. A light breeze tousles her hair as the man glances at her: What do you want to say? She nods playfully and replies, You first. The camera moves steadily alongside them, with subtle handheld sway, cutting between expressive close-ups and wider shots to capture the rhythm of their interaction. The overall visuals feel cinematic and intimate, with realistic lighting, soft motion blur, and fluid, immersive handheld tracking that heighten the natural warmth and authenticity of the moment.",height:"h-[16.5rem]"},{src:"/video/video_panda.mp4",description:"The video shows a panda showing off its skills at an urban skate park, riding a skateboard with remarkable agility and executing multiple high-difficulty tricks in succession. The camera closely follows, precisely capturing every flip and spin, showcasing the panda's extreme sports prowess.",height:"h-[16.5rem]"},{src:"/video/video_flower.mp4",description:"Using time-lapse photography techniques, the entire process of a flower bloomingfrom bud to full bloomis condensed into just a few seconds, accompanied by soothing background music.",height:"h-[16.5rem]"},{src:"/video/video_man.mp4",description:'Hard light, side lighting, medium shot, low saturation, high contrast, medium focal length, eye-level close-up of a man. He\'s wearing a striped shirt, sitting at a wooden table with folders and a red telephone on it. His arms are crossed over his chest, and his head rests against the wall. His eyes are closed, mouth slightly open, saying, "I really like it here." A blurred figure appears in the foreground. The background is a dark wooden wall adorned with a painting and other decorations. The entire scene evokes a quiet, contemplative mood.',height:"h-[16.5rem]"},{src:"/video/video_deer.mp4",description:"On a lawn in Nara, a girl attentively feeds a fawn, gazing at it, with a Japanese ambiance and bright sunshine.",height:"h-[16.5rem]",image:"https://qwen-chat.oss-ap-southeast-1.aliyuncs.com/resources/i2v/1762487167.png"},{src:"/video/video_bear.mp4",description:'The light flickered above his head as he softly asked, "Why does 1 + 1 equal 2?"',height:"h-[16.5rem]",image:"https://qwen-chat.oss-ap-southeast-1.aliyuncs.com/resources/i2v/1762076628.png"},{src:"/video/video_sea.mp4",description:"A diver in a diving suit explores the secrets of a sunken ship in the deep sea, holding a searchlight that illuminates the dark underwater world.",height:"h-[16.5rem]",image:"https://qwen-chat.oss-ap-southeast-1.aliyuncs.com/resources/i2v/1762498392.png"}],dv=[{type:"Learn",data:[{title:"Explain a baffling topic to me",image:"icon-line-explain"},{title:"Help me with my homework",image:"icon-line-homework"},{title:"Create a practice quiz for me",image:"icon-line-quiz"},{title:"Draw up a study plan for me",image:"icon-line-plan"},{title:"Analyse the incorrect answer for me",image:"icon-line-analysis"}]},{type:"CreateImage",data:["Create an image of a serene mountain lake.","Create an image of a bustling city skyline.","Create an image of a vibrant flower field.","Create an image of a tranquil forest path.","Create an image of a majestic sunset over ocean.","Create an image of a cozy rustic cabin.","Create an image of a futuristic cityscape at night.","Create an image of a colorful hot air balloon.","Create an image of a peaceful countryside morning.","Create an image of an ancient castle ruins."]},{type:"Code",data:["Help me create a to-do list app in JavaScript.","Help me build a weather API integration with Python.","Help me design a responsive portfolio site using HTML/CSS.","Help me implement a sorting algorithm in Java.","Help me set up a basic Flask server in Python.","Help me write a script to automate file backups."]},{type:"MakePlan",data:["Help me with a plan to start a business.","Help me with a plan for saving money.","Help me with a plan to learn a new skill.","Help me with a plan for a healthy lifestyle.","Help me with a plan to organize my home.","Help me with a plan for a successful interview.","Help me with a plan to improve my time management.","Help me with a plan for a family vacation.","Help me with a plan to achieve my goals.","Help me with a plan for a productive day."]},{type:"News",data:["Tell me the latest news from New York.","Tell me about today's weather updates.","Tell me what's happening in technology now.","Tell me the top sports headlines today.","Tell me recent developments in climate change.","Tell me about global financial markets today.","Tell me updates on the latest space missions.","Tell me breaking news from around the world.","Tell me health news related to new discoveries."]},{type:"CreateVideo",data:["Create a video of a dog surfing on waves.","Create a video of flowers blooming in fast motion.","Create a video of a chef making pizza art.","Create a video of stars twinkling in the night sky.","Create a video of a robot dancing to jazz.","Create a video of autumn leaves swirling in the wind.","Create a video of a painter creating a mural.","Create a video of dolphins playing with a ball.","Create a video of fireworks lighting up the city.","Create a video of a violinist performing in the rain."]},{type:"AnalyzeImage",data:["Describe the landscape and its prominent features.","Describe the people and their activities in the image.","Describe the colors and mood of the scene.","Describe the architecture and building materials used.","Describe the interaction between the subjects.","Describe the weather and environmental conditions shown.","Describe the textures and patterns visible.","Describe the lighting and shadows in the image.","Describe the main subject and its surroundings.","Describe the composition and framing of the shot."]},{type:"SummarizeText",data:["Summarize the article on climate change.","Summarize the book's main themes.","Summarize the podcast episode highlights.","Summarize the project's key objectives.","Summarize the lecture on economics.","Summarize the movie plot briefly.","Summarize the report's findings concisely.","Summarize the interview with the expert.","Summarize the research paper's methodology.","Summarize the discussion in the forum."]},{type:"GetAdvice",data:["Give me advice about managing stress.","Give me advice about saving money.","Give me advice about making friends.","Give me advice about staying healthy.","Give me advice about time management.","Give me advice about public speaking.","Give me advice about setting goals.","Give me advice about overcoming fear.","Give me advice about being kind.","Give me advice about finding purpose."]},{type:"HelpWrite",data:["Help me write a poem about autumn leaves.","Help me write an essay on climate change.","Help me write a letter to my future self.","Help me write a story with a twist ending.","Help me write a review of a new book.","Help me write a speech for a graduation ceremony.","Help me write a blog post on mental health.","Help me write a descriptive paragraph about the ocean.","Help me write a character sketch for a novel.","Help me write a persuasive argument for recycling."]},{type:"Brainstorm",data:["Give me an idea for a new eco-friendly product.","Give me an idea to improve mental health support.","Give me an idea for a unique restaurant concept.","Give me an idea to enhance online education tools.","Give me an idea for a sustainable fashion line.","Give me an idea to simplify daily household chores.","Give me an idea for a tech-free entertainment option.","Give me an idea to boost community engagement locally.","Give me an idea for a creative marketing campaign.","Give me an idea to reduce urban traffic congestion."]},{type:"Artifacts",data:["Create a web page for a personal blog with HTML.","Create a web page showcasing your portfolio with HTML.","Create a web page for a local restaurant with HTML.","Create a web page with a photo gallery using HTML.","Create a web page for a travel guide with HTML.","Create a web page for a simple calculator app with HTML.","Create a web page featuring a quiz game with HTML.","Create a web page for a book club with HTML.","Create a web page for a fitness tracker with HTML.","Create a web page for a weather forecast with HTML."]}],hv=[{description:'There is a screen next to this woman; he turns and looks at the screen, which displays "".',image:["https://img.alicdn.com/imgextra/i4/O1CN01sw5fPy1yTEoDBptAC_!!6000000006579-2-tps-1104-1472.png"],thumbnail:["https://img.alicdn.com/imgextra/i2/O1CN01a0Uhl41yDCwkU2cZg_!!6000000006544-0-tps-1104-1472.jpg"]},{description:'Change to a happy expression, with one finger pointing forward. Below it, write the artistic text "".',image:["https://img.alicdn.com/imgextra/i2/O1CN01JPV76t1ymTRZDa57C_!!6000000006621-2-tps-716-716.png"],thumbnail:["https://img.alicdn.com/imgextra/i2/O1CN01J0rEWh254EUoEhJbj_!!6000000007472-0-tps-716-716.jpg"]},{description:"Create a nine-square grid layout with the given image as one of the nine squares. Generate eight additional distinct images that match the aesthetic and theme of the originalfeaturing a young woman in a gothic-lolita style with blonde pigtails, black lace dress, and purple backgroundto complete the grid. Ensure all nine images are visually cohesive in color tone, lighting, and fashion style, but vary in pose, expression, or minor details.",image:["https://img.alicdn.com/imgextra/i2/O1CN01kvmTNc1j7VmhPAkIk_!!6000000004501-2-tps-896-1184.png"],thumbnail:["https://img.alicdn.com/imgextra/i4/O1CN0174E3Qa1QnfXcYnGZC_!!6000000002021-0-tps-896-1184.jpg"]},{description:"Convert the logo to an intricate embroidery style, featuring purple floral patterns, preserving the original shape and structure",image:["https://img.alicdn.com/imgextra/i2/O1CN01rUhAxP1liGnsNOyA6_!!6000000004852-2-tps-1024-1024.png"],thumbnail:["https://img.alicdn.com/imgextra/i3/O1CN01lby04M1iQuwzAqVFA_!!6000000004408-0-tps-1024-1024.jpg"]},{description:"Restore and colorize the old photo",image:["https://img.alicdn.com/imgextra/i3/O1CN01rek3Xa1w6g4FzzD54_!!6000000006259-2-tps-1216-864.png"],thumbnail:["https://img.alicdn.com/imgextra/i2/O1CN01WBnM391w3TIOhe3q4_!!6000000006252-0-tps-1216-864.jpg"]},{description:"Generate an image that matches the human pose outlined in Figure 1 and follows this description: A boy standing on a subway platform, wearing a baseball cap on his head, a T-shirt, and jeans. A speeding train is passing behind him.",image:["https://img.alicdn.com/imgextra/i1/O1CN010dE9QT1fGR2Pn3ffm_!!6000000003979-2-tps-1154-769.png"],thumbnail:["https://img.alicdn.com/imgextra/i3/O1CN010Gqfq22A0dSnVWlSa_!!6000000008141-0-tps-1154-769.jpg"]},{description:"Based on the woman in Figure 1 and the man in Figure 2, generate a set of wedding photos following this description: The groom wears a red traditional Chinese mandarin jacket, while the bride wears an elaborate Xiuhe costume with a golden phoenix headdress. They stand side by side in front of an ancient vermilion palace wall, with carved wooden windows in the background. The lighting is bright and soft, the composition symmetrical, creating a joyful yet solemn atmosphere.",image:["https://img.alicdn.com/imgextra/i4/O1CN01dUtRE51yeEJYyGBPf_!!6000000006603-2-tps-1584-1056.png","https://img.alicdn.com/imgextra/i3/O1CN01QE5cmu1LfMH8CObnQ_!!6000000001326-2-tps-1594-1090.png"],thumbnail:["https://img.alicdn.com/imgextra/i1/O1CN016GBK2a1tCE1B9PwzI_!!6000000005865-0-tps-1584-1056.jpg","https://img.alicdn.com/imgextra/i4/O1CN01qLPRDL219Ua6rvkZB_!!6000000006942-2-tps-1594-1090.png"]},{description:"The girl in Figure 1 is standing next to the car in Figure 2.",image:["https://img.alicdn.com/imgextra/i4/O1CN01ymH7DK21lVSEZB8jW_!!6000000007025-2-tps-824-1236.png","https://img.alicdn.com/imgextra/i1/O1CN014gBQE41phag9AjL0M_!!6000000005392-2-tps-1440-900.png"],thumbnail:["https://img.alicdn.com/imgextra/i1/O1CN01U9TH6G1WG8EZYEiGe_!!6000000002760-0-tps-824-1236.jpg","https://img.alicdn.com/imgextra/i1/O1CN01aAfiDJ1m5d0DUOxaY_!!6000000004903-0-tps-1440-900.jpg"]},{description:"The girl in Figure 1 is wearing the black dress from Figure 2 and sitting in the pose shown in Figure 3.",image:["https://img.alicdn.com/imgextra/i2/O1CN01BMHlTC1I2To6B2khM_!!6000000000835-2-tps-1104-1472.png","https://img.alicdn.com/imgextra/i2/O1CN01smFn0k1tP36kPPiTP_!!6000000005893-2-tps-768-1024.png","https://img.alicdn.com/imgextra/i4/O1CN01Ee8WB31vmWdoQvIy6_!!6000000006215-2-tps-832-1248.png"],thumbnail:["https://img.alicdn.com/imgextra/i1/O1CN01gy7qFz1sCOY78uTGf_!!6000000005730-0-tps-1104-1472.jpg","https://img.alicdn.com/imgextra/i3/O1CN0135nVeC26HLRzcFTwD_!!6000000007636-0-tps-768-1024.jpg","https://img.alicdn.com/imgextra/i3/O1CN01nW7p7q1GWac6qzw5S_!!6000000000630-2-tps-832-1248.png"]}],pv=[{src:"https://img.alicdn.com/imgextra/i1/O1CN01JbYx6E1l1fxq1a4ko_!!6000000004759-0-tps-1328-1328.jpg",description:"A capybara wearing a suit holding a sign that reads 'Hello World'"},{src:"https://img.alicdn.com/imgextra/i2/O1CN01ucdBBH1VpZG03JlAo_!!6000000002702-0-tps-1328-1328.jpg",description:"A delicate and intricate traditional Chinese painting, with a vibrant red peony at the center. The peony is in full bloom, featuring both large, open petals and buds about to blossom, creating a rich and colorful yet elegant scene. The branches and leaves of the peony spread out gracefully, with lush, deep green leaves and clearly visible veins, complementing the red flowers beautifully. A blue-purple butterfly, seemingly drawn to the flowers, rests on one of the blooming peonies in the center of the painting, reluctant to leave, its wings slightly spread, depicted with such realism that it seems ready to flutter away with the breeze. The entire painting is executed with precise and meticulous brushwork, using vivid and intense colors, showcasing the exquisite charm and spirit of traditional Chinese fine-line painting, imbuing the scene with vitality and dynamism."},{src:"https://img.alicdn.com/imgextra/i1/O1CN01ccnbGr1bsDErD77Eg_!!6000000003520-0-tps-1328-1328.jpg",description:'A young woman, dressed in a light and elegant pale pink cross-collar robe, sits with her back to the camera, bending over to concentrate on writing the four strong Chinese characters "" with a brush on plain white rice paper. The antique and tastefully decorated interior features a desk adorned with a celadon tea cup and a gilded incense burner, from which a wisp of incense smoke rises lightly; the soft light falls on her shoulders, outlining the gentle texture of her dress and her focused expression, as if freezing a tranquil and warm moment from the past.'},{src:"https://img.alicdn.com/imgextra/i3/O1CN01dCgvsj1RosC3cYYIl_!!6000000002159-0-tps-1328-1328.jpg",description:"A pull-out tissue box, with 'Face, CLEAN & SOFT TISSUE' written on top and '' underneath, the brand name '' in the upper left corner, in an overall white and light yellow tone."},{src:"https://img.alicdn.com/imgextra/i3/O1CN011RXlxB265tXnOYmhQ_!!6000000007611-0-tps-1328-1328.jpg",description:"A hand-drawn style water cycle diagram, the overall picture presents a vivid and lifelike illustration of the water cycle process. At the center of the image is a range of undulating mountains and valleys, with a clear river flowing through the valley, which eventually merges into a vast ocean. The mountains and land are depicted with green vegetation. Below the image is the groundwater layer, represented by blue gradient blocks, forming a clearly layered spatial relationship with surface water. The sun is located in the upper right corner of the image, causing surface water to evaporate, indicated by rising curved arrows. Clouds float in the air, drawn in a white cotton-like appearance, with some clouds being dense, indicating the condensation of water vapor into rain, connected by downward arrows to show the precipitation process. Rain is represented by blue lines and dot symbols, falling from the clouds, replenishing rivers and groundwater. The entire illustration is presented in a cartoon hand-drawn style, with soft lines, bright colors, and clear annotations. The background has a light yellow paper texture, with a slight hand-drawn texture."},{src:"https://img.alicdn.com/imgextra/i3/O1CN01PhOgF71CVtXqo7bVZ_!!6000000000087-0-tps-1328-1328.jpg",description:'A meeting room, with "3.14159265-358979-32384626-4338327950" written on the wall, and a small top spinning on the table'},{src:"https://img.alicdn.com/imgextra/i1/O1CN017S2EBY1i9yI6g1raO_!!6000000004371-0-tps-1328-1328.jpg",description:'A young girl wearing a school uniform stands in a classroom, writing on a chalkboard. The text "Introducing Qwen-Image, a foundational image generation model that excels in complex text rendering and precise image editing" appears in neat white chalk at the center of the blackboard. Soft natural light filters through windows, casting gentle shadows. The scene is rendered in a realistic photography style with fine details, shallow depth of field, and warm tones. The girl\'s focused expression and chalk dust in the air add dynamism. Background elements include desks and educational posters, subtly blurred to emphasize the central action. Ultra-detailed 32K resolution, DSLR-quality, soft bokeh effect, documentary-style composition.'},{src:"https://img.alicdn.com/imgextra/i4/O1CN01YlWfQQ1Z2L9K6KPHo_!!6000000003136-0-tps-1328-1328.jpg",description:"Realistic still life photography style: A single, fresh apple resting on a clean, soft-textured surface. The apple is slightly off-center, softly backlit to highlight its natural gloss and subtle color gradientsdeep crimson red blending into light golden hues. Fine details such as small blemishes, dew drops, and a few light highlights enhance its lifelike appearance. A shallow depth of field gently blurs the neutral background, drawing full attention to the apple. Hyper-detailed 8K resolution, studio lighting, photorealistic render, emphasizing texture and form."},{src:"https://img.alicdn.com/imgextra/i3/O1CN01kUJ8pg1X95kxxPPOT_!!6000000002880-0-tps-1136-1472.jpg",description:'Generate a children\'s style illustration: On the left, Santa Claus is riding a reindeer under the moonlight, delivering gifts to people, with several Christmas trees and a house in the scene. On the right, write a simple Christmas story in English, with the title "Believe in Magic."'},{src:"https://img.alicdn.com/imgextra/i1/O1CN01ulQY7U1GFdxEsRckQ_!!6000000000593-0-tps-1136-1472.jpg",description:"The main subject is a vintage bill prototype with a beige background, intricate green patterned borders on the outside, repeated English 'FUDINGWHITE TEA' at the top and bottom, 'BAI MU DAN' in the middle, vertical Chinese characters \"\" on both sides, bold black handwriting of \"\" in the center, surrounded by small vertical text, with English 'Wish you all the heavenly blessings' and a red seal stamp at the bottom, creating a scene of a national trend bill, national trend style, close-up shot, lively and nostalgic atmosphere, decorated with a collision of retro patterns, cursive calligraphy, seal engraving, and English slogans."},{src:"https://img.alicdn.com/imgextra/i3/O1CN012Ucaoj1pH1ha8pg7t_!!6000000005334-0-tps-1328-1328.jpg",description:'Lawn background, font design "" is creative, featuring trendy hand-drawn fonts, text layout, high-end art, and the English word "Summer". The title is adorned with cartoon patterns around it, and the font is abstractly transformed to create a unique rhythm and dynamism.'},{src:"https://img.alicdn.com/imgextra/i2/O1CN01P2eMH21GvmOIWsZas_!!6000000000685-0-tps-1328-1328.jpg",description:"masterpiece,best quality,official art,extremely detailed CG unity 8k wallpaper, A street-style map of Tokyo placed on a concrete surface, with a photorealistic miniature version of Tokyo emerging from it  cherry blossom trees, Tokyo Tower, Shibuya Crossing, neon signs, and tiny bullet trains. All elements grow from the map like a 3D urban diorama. Studio soft lighting, cinematic depth"},{src:"https://img.alicdn.com/imgextra/i4/O1CN01Nx6PGq1V3TfBCPTZM_!!6000000002597-0-tps-768-1024.jpg",description:"Blueprint for a Q version of Harry Potter mascot doll, furry style, with design sketch. Macaron-style colors. Includes dimensions and explanatory text notes, with lines and measurements indicating the dimensions of each part for a technical and detailed feel. Also includes scattered thumbnails showing different angles and 3D depth of field."}],mv=["Best pizza places near me","How to fix a leaky faucet","Cheap flights to New York","Yoga for beginners at home","Quick healthy dinner recipes","Top-rated movies this year","Learn Spanish online free","DIY home decor ideas","Best budget laptops","Cute dog names suggestions"],fv=[{key:"Image Edit",icon:"",url:Zg,value:"Image Edit",prompt:"",chatType:ng.ImageEdit,subChatType:ng.ImageEdit},{key:"Learn",icon:"",url:av,value:"Learn",prompt:"",chatType:ng.LEARN,subChatType:ng.LEARN},{key:"DeepResearch",icon:"",url:Xg,value:"Deep Research",prompt:"",chatType:ng.DeepResearch},{key:"Image Generation",icon:"",url:tv,value:"Image Generation",prompt:"",chatType:ng.ImageGeneration,subChatType:ng.ImageGeneration},{key:"Video Generation",icon:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/Video.png",url:nv,value:"Video Generation",prompt:"",chatType:ng.VideoGeneration},{key:"Travel",icon:"",url:iv,value:"Travel Planner",prompt:"",chatType:ng.Travel},{key:"Artifacts",icon:"",url:Jg,value:"Artifacts",prompt:"",chatType:ng.Artifacts,subChatType:ng.Artifacts},{key:"Web Dev",icon:"",url:ev,value:"Web Dev",prompt:"",chatType:ng.Artifacts,subChatType:ng.WebDev}],gv=[{key:"Image Edit",icon:"",url:Zg,value:"Image Edit",prompt:"",chatType:ng.ImageEdit,subChatType:ng.ImageEdit},{key:"Learn",icon:"",url:av,value:"Learn",prompt:"",chatType:ng.LEARN,subChatType:ng.LEARN},{key:"DeepResearch",icon:"",url:Xg,value:"Deep Research",prompt:"",chatType:ng.DeepResearch},{key:"Image Generation",icon:"",url:tv,value:"Image Generation",prompt:"",chatType:ng.ImageGeneration,subChatType:ng.ImageGeneration},{key:"Video Generation",url:nv,value:"Video Generation",prompt:"",chatType:ng.VideoGeneration},{key:"Web Dev",icon:"",url:ev,value:"Web Dev",prompt:"",chatType:ng.Artifacts,subChatType:ng.WebDev}],vv=[{key:"Image Edit",icon:"",url:Zg,value:"Image Edit",prompt:"",chatType:ng.ImageEdit,subChatType:ng.ImageEdit},{key:"Image Generation",icon:"",url:tv,value:"Image Generation",prompt:"",chatType:ng.ImageGeneration,subChatType:ng.ImageGeneration},{key:"Video Generation",icon:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/Video.png",value:"Video Generation",prompt:"",chatType:ng.VideoGeneration},{key:"Artifacts",icon:"",url:Jg,value:"Artifacts",prompt:"",chatType:ng.Artifacts,subChatType:ng.Artifacts},{key:"Web Dev",icon:"",url:ev,value:"Web Dev",prompt:"",chatType:ng.Artifacts,subChatType:ng.WebDev}],yv=[{key:"Artifacts",icon:"",url:Jg,value:"Artifacts",prompt:"",chatType:ng.Artifacts,subChatType:ng.Artifacts},{key:"Travel",icon:"",url:iv,value:"Travel Planner",prompt:"",chatType:ng.Travel},{key:"Code",icon:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/Code.png",value:"Code",prompt:"Help me",chatType:ng.Txt2Txt},{key:"MakePlan",icon:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/MakeAPlan.png",value:"Make a plan",prompt:"Help me with a plan",chatType:ng.Txt2Txt},{key:"News",icon:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/NewsLight.png",value:"News",prompt:"Tell me",chatType:ng.Txt2Txt},{key:"AnalyzeImage",icon:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/AnalyzeImage.png",value:"Analyze image",prompt:"Describe",chatType:ng.Txt2Txt},{key:"SummarizeText",icon:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/Summarize.png",value:"Summarize text",prompt:"Summarize",chatType:ng.Txt2Txt},{key:"GetAdvice",icon:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/GetAdvice.png",value:"Get advice",prompt:"Give me advice",chatType:ng.Txt2Txt},{key:"HelpWrite",icon:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/HelpMeWrite.png",value:"Help me write",prompt:"Help me write",chatType:ng.Txt2Txt},{key:"Brainstorm",icon:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/Brainstorm.png",value:"Brainstorm",prompt:"Give me an idea",chatType:ng.Txt2Txt}];ng.VideoGeneration,ng.Txt2Txt,ng.Txt2Txt,ng.Txt2Txt,ng.Txt2Txt,ng.Txt2Txt,ng.Txt2Txt,ng.Txt2Txt,ng.Txt2Txt;const bv=["model","thinking","search","t2v","t2i","deep_research_deep_research","artifacts_deploy_artifacts","artifacts_deploy_web_dev","artifacts_deploy_deep_research","audio_chat_AudioOnly","audio_chat_AudioAndVideo","deep_research_aipodcast","code","image_edit","deep_research_deep_research_advanced"],xv="NATIVE_NEW_PROJECT_ID",wv=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],_v=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Sv={"":"","":"","":"","":navigator.userAgent.includes("Windows")?"":"","":navigator.userAgent.includes("Windows")?"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},Cv=e=>{const t=new Date,n=new Date(1e3*e),i=(t.getTime()-n.getTime())/864e5,a=t.getDate(),o=t.getMonth(),s=t.getFullYear(),r=n.getDate(),l=n.getMonth(),c=n.getFullYear();return s===c&&o===l&&a===r?"Today":s===c&&o===l&&a-r===1?"Yesterday":i<=7?"Previous 7 days":i<=30?"Previous 30 days":s===c?n.toLocaleString("default",{month:"long"}):n.getFullYear().toString()},Ev=(e="",t="subscript")=>{let n=e;switch(t){case"subscript":n=e.replace(/\[\[\d+\]\]/g,"");break;case"numberAndEntry":n=e.replace(/(\d+)[\r\n]+/g,"")}return n},kv=(e,t,n)=>{const i=e.map(e=>e.code);if(!t||0===t.length)return n;const a=t[0],o=i.find(e=>e===a);return o||n},Iv=(e,t)=>{const n=w({},e);return Object.keys(t).forEach(e=>{const i=t[e],a=n[e];i&&"object"==typeof i&&!Array.isArray(i)&&a&&"object"==typeof a&&!Array.isArray(a)?n[e]=Iv(a,i):n[e]=i}),n};let Tv;const jv=()=>j(void 0,null,function*(){return(yield Se(()=>j(void 0,null,function*(){const{default:e}=yield import("./languages.js");return{default:e}}),[])).default}),Nv=e=>j(void 0,null,function*(){Tv=Hf();const e=localStorage.getItem("locale"),t=yield jv(),n=navigator.languages||[navigator.language||navigator.userLanguage],i=e||kv(t,n,"en-US");return Tv.use(R((e,t)=>((e,t,n)=>{const i=e[t];return i?"function"==typeof i?i():Promise.resolve(i):new Promise((e,i)=>{("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+t+(t.split("/").length!==n?". Note that variables only represent file names one level deep.":""))))})})(Object.assign({"./locales/ar-BH/translation.json":()=>Se(()=>import("./translation.js"),[]),"./locales/de-DE/translation.json":()=>Se(()=>import("./translation2.js"),[]),"./locales/en-US/translation.json":()=>Se(()=>import("./translation3.js"),[]),"./locales/es-ES/translation.json":()=>Se(()=>import("./translation4.js"),[]),"./locales/fr-FR/translation.json":()=>Se(()=>import("./translation5.js"),[]),"./locales/it-IT/translation.json":()=>Se(()=>import("./translation6.js"),[]),"./locales/ja-JP/translation.json":()=>Se(()=>import("./translation7.js"),[]),"./locales/ko-KR/translation.json":()=>Se(()=>import("./translation8.js"),[]),"./locales/pt-PT/translation.json":()=>Se(()=>import("./translation9.js"),[]),"./locales/ru-RU/translation.json":()=>Se(()=>import("./translation10.js"),[]),"./locales/zh-CN/translation.json":()=>Se(()=>import("./translation11.js"),[]),"./locales/zh-TW/translation.json":()=>Se(()=>import("./translation12.js"),[])}),`./locales/${e}/${t}.json`,4).then(e=>e.default))).use(D).use(L).init({lng:i,debug:!1,detection:{order:["querystring","localStorage","navigator"],caches:["localStorage"],lookupQuerystring:"lang",lookupLocalStorage:"locale"},fallbackLng:{default:[""]},ns:"translation",returnEmptyString:!1,interpolation:{escapeValue:!1}},e=>{}),Tv.on("languageChanged",e=>{}),Tv}),Pv=(e,t)=>{const n=Hf();return t?n.t(e,t):n.t(e)};function Mv(){return Mv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Mv.apply(this,arguments)}var Av,Ov;(Ov=Av||(Av={})).Pop="POP",Ov.Push="PUSH",Ov.Replace="REPLACE";const Rv="popstate";function Dv(e){return void 0===e&&(e={}),function(e,t,n,i){void 0===i&&(i={});let{window:a=document.defaultView,v5Compat:o=!1}=i,s=a.history,r=Av.Pop,l=null,c=u();null==c&&(c=0,s.replaceState(Mv({},s.state,{idx:c}),""));function u(){return(s.state||{idx:null}).idx}function d(){r=Av.Pop;let e=u(),t=null==e?null:e-c;c=e,l&&l({action:r,location:f.location,delta:t})}function h(e,t){r=Av.Push;let n=Uv(f.location,e,t);c=u()+1;let i=zv(n,c),d=f.createHref(n);try{s.pushState(i,"",d)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;a.location.assign(d)}o&&l&&l({action:r,location:f.location,delta:1})}function p(e,t){r=Av.Replace;let n=Uv(f.location,e,t);c=u();let i=zv(n,c),a=f.createHref(n);s.replaceState(i,"",a),o&&l&&l({action:r,location:f.location,delta:0})}function m(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,n="string"==typeof e?e:Hv(e);return n=n.replace(/ $/,"%20"),Lv(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}let f={get action(){return r},get location(){return e(a,s)},listen(e){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(Rv,d),l=e,()=>{a.removeEventListener(Rv,d),l=null}},createHref:e=>t(a,e),createURL:m,encodeLocation(e){let t=m(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:h,replace:p,go:e=>s.go(e)};return f}(function(e,t){let{pathname:n,search:i,hash:a}=e.location;return Uv("",{pathname:n,search:i,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:Hv(t)},0,e)}function Lv(e,t){if(!1===e||null==e)throw new Error(t)}function Fv(e,t){if(!e)try{throw new Error(t)}catch(kX){}}function zv(e,t){return{usr:e.state,key:e.key,idx:t}}function Uv(e,t,n,i){return void 0===n&&(n=null),Mv({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?Bv(t):t,{state:n,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function Hv(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function Bv(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}var $v,qv;function Gv(e,t,n){return void 0===n&&(n="/"),function(e,t,n){let i="string"==typeof t?Bv(t):t,a=oy(i.pathname||"/",n);if(null==a)return null;let o=Vv(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(o);let s=null;for(let r=0;null==s&&r<o.length;++r){let e=ay(a);s=ny(o[r],e)}return s}(e,t,n)}function Vv(e,t,n,i){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===i&&(i="");let a=(e,a,o)=>{let s={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};s.relativePath.startsWith("/")&&(Lv(s.relativePath.startsWith(i),'Absolute route path "'+s.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(i.length));let r=hy([i,s.relativePath]),l=n.concat(s);e.children&&e.children.length>0&&(Lv(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+r+'".'),Vv(e.children,t,l,r)),(null!=e.path||e.index)&&t.push({path:r,score:ty(r,e.index),routesMeta:l})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let i of Wv(e.path))a(e,t,i);else a(e,t)}),t}function Wv(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===i.length)return a?[o,""]:[o];let s=Wv(i.join("/")),r=[];return r.push(...s.map(e=>""===e?o:[o,e].join("/"))),a&&r.push(...s),r.map(t=>e.startsWith("/")&&""===t?"/":t)}(qv=$v||($v={})).data="data",qv.deferred="deferred",qv.redirect="redirect",qv.error="error";const Qv=/^:[\w-]+$/,Kv=3,Yv=2,Xv=1,Jv=10,Zv=-2,ey=e=>"*"===e;function ty(e,t){let n=e.split("/"),i=n.length;return n.some(ey)&&(i+=Zv),t&&(i+=Yv),n.filter(e=>!ey(e)).reduce((e,t)=>e+(Qv.test(t)?Kv:""===t?Xv:Jv),i)}function ny(e,t,n){let{routesMeta:i}=e,a={},o="/",s=[];for(let r=0;r<i.length;++r){let e=i[r],n=r===i.length-1,l="/"===o?t:t.slice(o.length)||"/",c=iy({path:e.relativePath,caseSensitive:e.caseSensitive,end:n},l),u=e.route;if(!c)return null;Object.assign(a,c.params),s.push({params:a,pathname:hy([o,c.pathname]),pathnameBase:py(hy([o,c.pathnameBase])),route:u}),"/"!==c.pathnameBase&&(o=hy([o,c.pathnameBase]))}return s}function iy(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);Fv("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let i=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(i.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let o=new RegExp(a,t?void 0:"i");return[o,i]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],s=o.replace(/(.)\/+$/,"$1"),r=a.slice(1);return{params:i.reduce((e,t,n)=>{let{paramName:i,isOptional:a}=t;if("*"===i){let e=r[n]||"";s=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const l=r[n];return e[i]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:o,pathnameBase:s,pattern:e}}function ay(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return Fv(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function oy(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}const sy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function ry(e,t){void 0===t&&(t="/");let n,{pathname:i,search:a="",hash:o=""}="string"==typeof e?Bv(e):e;if(i)if(s=i,sy.test(s))n=i;else{if(i.includes("//")){let e=i;i=i.replace(/\/\/+/g,"/"),Fv(!1,"Pathnames cannot have embedded double slashes - normalizing "+e+" -> "+i)}n=i.startsWith("/")?ly(i.substring(1),"/"):ly(i,t)}else n=t;var s;return{pathname:n,search:my(a),hash:fy(o)}}function ly(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}function cy(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function uy(e,t){let n=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t?n.map((e,t)=>t===n.length-1?e.pathname:e.pathnameBase):n.map(e=>e.pathnameBase)}function dy(e,t,n,i){let a;void 0===i&&(i=!1),"string"==typeof e?a=Bv(e):(a=Mv({},e),Lv(!a.pathname||!a.pathname.includes("?"),cy("?","pathname","search",a)),Lv(!a.pathname||!a.pathname.includes("#"),cy("#","pathname","hash",a)),Lv(!a.search||!a.search.includes("#"),cy("#","search","hash",a)));let o,s=""===e||""===a.pathname,r=s?"/":a.pathname;if(null==r)o=n;else{let e=t.length-1;if(!i&&r.startsWith("..")){let t=r.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}o=e>=0?t[e]:"/"}let l=ry(a,o),c=r&&"/"!==r&&r.endsWith("/"),u=(s||"."===r)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}const hy=e=>e.join("/").replace(/\/\/+/g,"/"),py=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),my=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",fy=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";const gy=["post","put","patch","delete"];new Set(gy);const vy=["get",...gy];function yy(){return yy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},yy.apply(this,arguments)}new Set(vy);const by=A.createContext(null),xy=A.createContext(null),wy=A.createContext(null),_y=A.createContext(null),Sy=A.createContext({outlet:null,matches:[],isDataRoute:!1}),Cy=A.createContext(null);function Ey(){return null!=A.useContext(_y)}function ky(){return Ey()||Lv(!1),A.useContext(_y).location}function Iy(e){A.useContext(wy).static||A.useLayoutEffect(e)}function Ty(){let{isDataRoute:e}=A.useContext(Sy);return e?function(){let{router:e}=function(){let e=A.useContext(by);return e||Lv(!1),e}(Ly.UseNavigateStable),t=zy(Fy.UseNavigateStable),n=A.useRef(!1);Iy(()=>{n.current=!0});let i=A.useCallback(function(i,a){void 0===a&&(a={}),n.current&&("number"==typeof i?e.navigate(i):e.navigate(i,yy({fromRouteId:t},a)))},[e,t]);return i}():function(){Ey()||Lv(!1);let e=A.useContext(by),{basename:t,future:n,navigator:i}=A.useContext(wy),{matches:a}=A.useContext(Sy),{pathname:o}=ky(),s=JSON.stringify(uy(a,n.v7_relativeSplatPath)),r=A.useRef(!1);Iy(()=>{r.current=!0});let l=A.useCallback(function(n,a){if(void 0===a&&(a={}),!r.current)return;if("number"==typeof n)return void i.go(n);let l=dy(n,JSON.parse(s),o,"path"===a.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:hy([t,l.pathname])),(a.replace?i.replace:i.push)(l,a.state,a)},[t,i,s,o,e]);return l}()}const jy=A.createContext(null);function Ny(){let{matches:e}=A.useContext(Sy),t=e[e.length-1];return t?t.params:{}}function Py(e,t){let{relative:n}=void 0===t?{}:t,{future:i}=A.useContext(wy),{matches:a}=A.useContext(Sy),{pathname:o}=ky(),s=JSON.stringify(uy(a,i.v7_relativeSplatPath));return A.useMemo(()=>dy(e,JSON.parse(s),o,"path"===n),[e,s,o,n])}function My(e,t){return function(e,t,n,i){Ey()||Lv(!1);let{navigator:a}=A.useContext(wy),{matches:o}=A.useContext(Sy),s=o[o.length-1],r=s?s.params:{};!s||s.pathname;let l=s?s.pathnameBase:"/";s&&s.route;let c,u=ky();if(t){var d;let e="string"==typeof t?Bv(t):t;"/"===l||(null==(d=e.pathname)?void 0:d.startsWith(l))||Lv(!1),c=e}else c=u;let h=c.pathname||"/",p=h;if("/"!==l){let e=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(e.length).join("/")}let m=Gv(e,{pathname:p}),f=function(e,t,n,i){var a;void 0===t&&(t=[]);void 0===n&&(n=null);void 0===i&&(i=null);if(null==e){var o;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(o=i)&&o.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let s=e,r=null==(a=n)?void 0:a.errors;if(null!=r){let e=s.findIndex(e=>e.route.id&&void 0!==(null==r?void 0:r[e.route.id]));e>=0||Lv(!1),s=s.slice(0,Math.min(s.length,e+1))}let l=!1,c=-1;if(n&&i&&i.v7_partialHydration)for(let u=0;u<s.length;u++){let e=s[u];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(c=u),e.route.id){let{loaderData:t,errors:i}=n,a=e.route.loader&&void 0===t[e.route.id]&&(!i||void 0===i[e.route.id]);if(e.route.lazy||a){l=!0,s=c>=0?s.slice(0,c+1):[s[0]];break}}}return s.reduceRight((e,i,a)=>{let o,u=!1,d=null,h=null;var p;n&&(o=r&&i.route.id?r[i.route.id]:void 0,d=i.route.errorElement||Oy,l&&(c<0&&0===a?(Uy[p="route-fallback"]||(Uy[p]=!0),u=!0,h=null):c===a&&(u=!0,h=i.route.hydrateFallbackElement||null)));let m=t.concat(s.slice(0,a+1)),f=()=>{let t;return t=o?d:u?h:i.route.Component?A.createElement(i.route.Component,null):i.route.element?i.route.element:e,A.createElement(Dy,{match:i,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(i.route.ErrorBoundary||i.route.errorElement||0===a)?A.createElement(Ry,{location:n.location,revalidation:n.revalidation,component:d,error:o,children:f(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):f()},null)}(m&&m.map(e=>Object.assign({},e,{params:Object.assign({},r,e.params),pathname:hy([l,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?l:hy([l,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),o,n,i);if(t&&f)return A.createElement(_y.Provider,{value:{location:yy({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Av.Pop}},f);return f}(e,t)}function Ay(){let e=function(){var e;let t=A.useContext(Cy),n=function(){let e=A.useContext(xy);return e||Lv(!1),e}(),i=zy();if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[i]}(),t=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},t),n?A.createElement("pre",{style:i},n):null,null)}const Oy=A.createElement(Ay,null);class Ry extends A.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){}render(){return void 0!==this.state.error?A.createElement(Sy.Provider,{value:this.props.routeContext},A.createElement(Cy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Dy(e){let{routeContext:t,match:n,children:i}=e,a=A.useContext(by);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),A.createElement(Sy.Provider,{value:t},i)}var Ly=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Ly||{}),Fy=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Fy||{});function zy(e){let t=function(){let e=A.useContext(Sy);return e||Lv(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||Lv(!1),n.route.id}const Uy={};function Hy(e){return function(e){let t=A.useContext(Sy).outlet;return t?A.createElement(jy.Provider,{value:e},t):t}(e.context)}function By(e){Lv(!1)}function $y(e){let{basename:t="/",children:n=null,location:i,navigationType:a=Av.Pop,navigator:o,static:s=!1,future:r}=e;Ey()&&Lv(!1);let l=t.replace(/^\/*/,"/"),c=A.useMemo(()=>({basename:l,navigator:o,static:s,future:yy({v7_relativeSplatPath:!1},r)}),[l,r,o,s]);"string"==typeof i&&(i=Bv(i));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:m="default"}=i,f=A.useMemo(()=>{let e=oy(u,l);return null==e?null:{location:{pathname:e,search:d,hash:h,state:p,key:m},navigationType:a}},[l,u,d,h,p,m,a]);return null==f?null:A.createElement(wy.Provider,{value:c},A.createElement(_y.Provider,{children:n,value:f}))}function qy(e){let{children:t,location:n}=e;return My(Gy(t),n)}function Gy(e,t){void 0===t&&(t=[]);let n=[];return A.Children.forEach(e,(e,i)=>{if(!A.isValidElement(e))return;let a=[...t,i];if(e.type===A.Fragment)return void n.push.apply(n,Gy(e.props.children,a));e.type!==By&&Lv(!1),e.props.index&&e.props.children&&Lv(!1);let o={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=Gy(e.props.children,a)),n.push(o)}),n}function Vy(){return Vy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Vy.apply(this,arguments)}function Wy(e){return void 0===e&&(e=""),new URLSearchParams("string"==typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let i=e[n];return t.concat(Array.isArray(i)?i.map(e=>[n,e]):[[n,i]])},[]))}new Promise(()=>{});const Qy=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(kX){}const Ky=F.startTransition;function Yy(e){let{basename:t,children:n,future:i,window:a}=e,o=A.useRef();null==o.current&&(o.current=Dv({window:a,v5Compat:!0}));let s=o.current,[r,l]=A.useState({action:s.action,location:s.location}),{v7_startTransition:c}=i||{},u=A.useCallback(e=>{c&&Ky?Ky(()=>l(e)):l(e)},[l,c]);return A.useLayoutEffect(()=>s.listen(u),[s,u]),A.useEffect(()=>{return null==(e=i)||e.v7_startTransition,void(null==e||e.v7_relativeSplatPath);var e},[i]),A.createElement($y,{basename:t,children:n,location:r.location,navigationType:r.action,navigator:s,future:i})}const Xy="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,Jy=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zy=A.forwardRef(function(e,t){let n,{onClick:i,relative:a,reloadDocument:o,replace:s,state:r,target:l,to:c,preventScrollReset:u,viewTransition:d}=e,h=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,Qy),{basename:p}=A.useContext(wy),m=!1;if("string"==typeof c&&Jy.test(c)&&(n=c,Xy))try{let e=new URL(window.location.href),t=c.startsWith("//")?new URL(e.protocol+c):new URL(c),n=oy(t.pathname,p);t.origin===e.origin&&null!=n?c=n+t.search+t.hash:m=!0}catch(kX){}let f=function(e,t){let{relative:n}=void 0===t?{}:t;Ey()||Lv(!1);let{basename:i,navigator:a}=A.useContext(wy),{hash:o,pathname:s,search:r}=Py(e,{relative:n}),l=s;return"/"!==i&&(l="/"===s?i:hy([i,s])),a.createHref({pathname:l,search:r,hash:o})}(c,{relative:a}),g=function(e,t){let{target:n,replace:i,state:a,preventScrollReset:o,relative:s,viewTransition:r}=void 0===t?{}:t,l=Ty(),c=ky(),u=Py(e,{relative:s});return A.useCallback(t=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(t,n)){t.preventDefault();let n=void 0!==i?i:Hv(c)===Hv(u);l(e,{replace:n,state:a,preventScrollReset:o,relative:s,viewTransition:r})}},[c,l,u,i,a,n,e,o,s,r])}(c,{replace:s,state:r,target:l,preventScrollReset:u,relative:a,viewTransition:d});return A.createElement("a",Vy({},h,{href:n||f,onClick:m||o?i:function(e){i&&i(e),e.defaultPrevented||g(e)},ref:t,target:l}))});var eb,tb,nb,ib;function ab(e){let t=A.useRef(Wy(e)),n=A.useRef(!1),i=ky(),a=A.useMemo(()=>function(e,t){let n=Wy(e);return t&&t.forEach((e,i)=>{n.has(i)||t.getAll(i).forEach(e=>{n.append(i,e)})}),n}(i.search,n.current?null:t.current),[i.search]),o=Ty(),s=A.useCallback((e,t)=>{const i=Wy("function"==typeof e?e(a):e);n.current=!0,o("?"+i,t)},[o,a]);return[a,s]}(tb=eb||(eb={})).UseScrollRestoration="useScrollRestoration",tb.UseSubmit="useSubmit",tb.UseSubmitFetcher="useSubmitFetcher",tb.UseFetcher="useFetcher",tb.useViewTransitionState="useViewTransitionState",(ib=nb||(nb={})).UseFetcher="useFetcher",ib.UseFetchers="useFetchers",ib.UseScrollRestoration="useScrollRestoration";var ob={d:(e,t)=>{for(var n in t)ob.o(t,n)&&!ob.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},sb={};ob.d(sb,{A:()=>ub,k:()=>cb});var rb=function(e,t,n,i){return new(n||(n=Promise))(function(t,a){function o(e){try{r(i.next(e))}catch(t){a(t)}}function s(e){try{r(i.throw(e))}catch(t){a(t)}}function r(e){var i;e.done?t(e.value):(i=e.value,i instanceof n?i:new n(function(e){e(i)})).then(o,s)}r((i=i.apply(e,[])).next())})},lb=function(e,t){var n,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(r){return function(l){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,r[0]&&(s=0)),s;)try{if(n=1,i&&(a=2&r[0]?i.return:r[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){s.label=r[1];break}if(6===r[0]&&s.label<a[1]){s.label=a[1],a=r;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(r);break}a[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(l){r=[6,l],i=0}finally{n=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}};function cb(){return rb(this,void 0,Promise,function(){return lb(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e,t){var n="Unknown",i=!1;function a(t){i||(i=!0,e({isPrivate:t,browserName:n}))}function o(){var e=0,t=parseInt("-1");try{t.toFixed(t)}catch(n){e=n.message.length}return e}function s(){return rb(this,void 0,void 0,function(){var e;return lb(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,navigator.storage.getDirectory()];case 1:return t.sent(),a(!1),[3,3];case 2:return e=t.sent(),a((e instanceof Error&&"string"==typeof e.message?e.message:String(e)).includes("unknown transient reason")),[3,3];case 3:return[2]}})})}function r(){var e;return rb(this,void 0,Promise,function(){return lb(this,function(t){switch(t.label){case 0:return"function"!=typeof(null===(e=navigator.storage)||void 0===e?void 0:e.getDirectory)?[3,2]:[4,s()];case 1:return t.sent(),[3,3];case 2:void 0!==navigator.maxTouchPoints?function(){var e=String(Math.random());try{var t=indexedDB.open(e,1);t.onupgradeneeded=function(t){var n=t.target.result,i=function(e){a(e)};try{n.createObjectStore("t",{autoIncrement:!0}).put(new Blob),i(!1)}catch(o){(o instanceof Error&&"string"==typeof o.message?o.message:String(o)).includes("are not yet supported")?i(!0):i(!1)}finally{n.close(),indexedDB.deleteDatabase(e)}},t.onerror=function(){return a(!1)}}catch(n){a(!1)}}():function(){var e=window.openDatabase,t=window.localStorage;try{e(null,null,null,null)}catch(n){return void a(!0)}try{t.setItem("test","1"),t.removeItem("test")}catch(n){return void a(!0)}a(!1)}(),t.label=3;case 3:return[2]}})})}function l(){void 0!==self.Promise&&void 0!==self.Promise.allSettled?navigator.webkitTemporaryStorage.queryUsageAndQuota(function(e,t){var n,i,o,s;a(Math.round(t/1048576)<2*Math.round((null!==(o=null===(i=null===(n=null==(s=window)?void 0:s.performance)||void 0===n?void 0:n.memory)||void 0===i?void 0:i.jsHeapSizeLimit)&&void 0!==o?o:1073741824)/1048576))},function(e){t(new Error("detectIncognito somehow failed to query storage quota: "+e.message))}):(0,window.webkitRequestFileSystem)(0,1,function(){a(!1)},function(){a(!0)})}function c(){var e;return rb(this,void 0,Promise,function(){var t,n;return lb(this,function(i){switch(i.label){case 0:if("function"!=typeof(null===(e=navigator.storage)||void 0===e?void 0:e.getDirectory))return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,navigator.storage.getDirectory()];case 2:return i.sent(),a(!1),[3,4];case 3:return t=i.sent(),a((t instanceof Error&&"string"==typeof t.message?t.message:String(t)).includes("Security error")),[2];case 4:return[3,6];case 5:(n=indexedDB.open("inPrivate")).onerror=function(e){n.error&&"InvalidStateError"===n.error.name&&e.preventDefault(),a(!0)},n.onsuccess=function(){indexedDB.deleteDatabase("inPrivate"),a(!1)},i.label=6;case 6:return[2]}})})}(function(){return rb(this,void 0,Promise,function(){return lb(this,function(e){switch(e.label){case 0:return 44!==o()&&43!==o()?[3,2]:(n="Safari",[4,r()]);case 1:return e.sent(),[3,6];case 2:return 51!==o()?[3,3]:(i=navigator.userAgent,n=i.match(/Chrome/)?void 0!==navigator.brave?"Brave":i.match(/Edg/)?"Edge":i.match(/OPR/)?"Opera":"Chrome":"Chromium",l(),[3,6]);case 3:return 25!==o()?[3,5]:(n="Firefox",[4,c()]);case 4:return e.sent(),[3,6];case 5:void 0!==navigator.msSaveBlob?(n="Internet Explorer",a(void 0===window.indexedDB)):t(new Error("detectIncognito cannot determine the browser")),e.label=6;case 6:return[2]}var i})})})().catch(t)})];case 1:return[2,e.sent()]}})})}"undefined"!=typeof window&&(window.detectIncognito=cb);const ub=cb,db=sb.k,hb={chrome:93,firefox:105,edge:110,safari:16},pb=(e=hb,t=!1)=>{if(t)return!0;const n=window.navigator.userAgent,i=n.match(/Chrome\/(\d+)/),a=n.match(/Firefox\/(\d+)/),o=n.match(/Edg\/(\d+)/),s=n.includes("Safari")&&!n.includes("Chrome"),r=n.match(/Version\/(\d+)/);if(i){const t=Number.parseInt(i[1],10);return!!(t&&t>=e.chrome)}if(a){const t=Number.parseInt(a[1],10);return!!(t&&t>=e.firefox)}if(o){const t=Number.parseInt(o[1],10);return!!(t&&t>=e.edge)}if(s&&r){const t=Number.parseInt(r[1],10);return!!(t&&t>=e.safari)}return!0},mb=e=>{let t;const n=new Set,i=(e,i)=>{const a="function"==typeof e?e(t):e;if(!Object.is(a,t)){const e=t;t=(null!=i?i:"object"!=typeof a||null===a)?a:Object.assign({},t,a),n.forEach(n=>n(t,e))}},a=()=>t,o={setState:i,getState:a,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e))},s=t=e(i,a,o);return o},fb=e=>e?mb(e):mb,gb=e=>e;const vb=e=>{const t=fb(e),n=e=>function(e,t=gb){const n=z.useSyncExternalStore(e.subscribe,z.useCallback(()=>t(e.getState()),[e,t]),z.useCallback(()=>t(e.getInitialState()),[e,t]));return z.useDebugValue(n),n}(t,e);return Object.assign(n,t),n},yb=e=>vb;var bb=Symbol.for("immer-nothing"),xb=Symbol.for("immer-draftable"),wb=Symbol.for("immer-state");function _b(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Sb=Object.getPrototypeOf;function Cb(e){return!!e&&!!e[wb]}function Eb(e){var t;return!!e&&(Tb(e)||Array.isArray(e)||!!e[xb]||!!(null==(t=e.constructor)?void 0:t[xb])||Ab(e)||Ob(e))}var kb=Object.prototype.constructor.toString(),Ib=new WeakMap;function Tb(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);if(null===t||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if("function"!=typeof n)return!1;let i=Ib.get(n);return void 0===i&&(i=Function.toString.call(n),Ib.set(n,i)),i===kb}function jb(e,t,n=!0){if(0===Nb(e)){(n?Reflect.ownKeys(e):Object.keys(e)).forEach(n=>{t(n,e[n],e)})}else e.forEach((n,i)=>t(i,n,e))}function Nb(e){const t=e[wb];return t?t.type_:Array.isArray(e)?1:Ab(e)?2:Ob(e)?3:0}function Pb(e,t){return 2===Nb(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Mb(e,t,n){const i=Nb(e);2===i?e.set(t,n):3===i?e.add(n):e[t]=n}function Ab(e){return e instanceof Map}function Ob(e){return e instanceof Set}function Rb(e){return e.copy_||e.base_}function Db(e,t){if(Ab(e))return new Map(e);if(Ob(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=Tb(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[wb];let n=Reflect.ownKeys(t);for(let i=0;i<n.length;i++){const a=n[i],o=t[a];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(Sb(e),t)}{const t=Sb(e);if(null!==t&&n)return w({},e);const i=Object.create(t);return Object.assign(i,e)}}function Lb(e,t=!1){return zb(e)||Cb(e)||!Eb(e)||(Nb(e)>1&&Object.defineProperties(e,{set:Fb,add:Fb,clear:Fb,delete:Fb}),Object.freeze(e),t&&Object.values(e).forEach(e=>Lb(e,!0))),e}var Fb={value:function(){_b(2)}};function zb(e){return null===e||"object"!=typeof e||Object.isFrozen(e)}var Ub,Hb={};function Bb(e){const t=Hb[e];return t||_b(0),t}function $b(){return Ub}function qb(e,t){t&&(Bb("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Gb(e){Vb(e),e.drafts_.forEach(Qb),e.drafts_=null}function Vb(e){e===Ub&&(Ub=e.parent_)}function Wb(e){return Ub={drafts_:[],parent_:Ub,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Qb(e){const t=e[wb];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Kb(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[wb].modified_&&(Gb(t),_b(4)),Eb(e)&&(e=Yb(t,e),t.parent_||Jb(t,e)),t.patches_&&Bb("Patches").generateReplacementPatches_(n[wb].base_,e,t.patches_,t.inversePatches_)):e=Yb(t,n,[]),Gb(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==bb?e:void 0}function Yb(e,t,n){if(zb(t))return t;const i=e.immer_.shouldUseStrictIteration(),a=t[wb];if(!a)return jb(t,(i,o)=>Xb(e,a,t,i,o,n),i),t;if(a.scope_!==e)return t;if(!a.modified_)return Jb(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const t=a.copy_;let o=t,s=!1;3===a.type_&&(o=new Set(t),t.clear(),s=!0),jb(o,(i,o)=>Xb(e,a,t,i,o,n,s),i),Jb(e,t,!1),n&&e.patches_&&Bb("Patches").generatePatches_(a,n,e.patches_,e.inversePatches_)}return a.copy_}function Xb(e,t,n,i,a,o,s){if(null==a)return;if("object"!=typeof a&&!s)return;const r=zb(a);if(!r||s){if(Cb(a)){const s=Yb(e,a,o&&t&&3!==t.type_&&!Pb(t.assigned_,i)?o.concat(i):void 0);if(Mb(n,i,s),!Cb(s))return;e.canAutoFreeze_=!1}else s&&n.add(a);if(Eb(a)&&!r){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;if(t&&t.base_&&t.base_[i]===a&&r)return;Yb(e,a),t&&t.scope_.parent_||"symbol"==typeof i||!(Ab(n)?n.has(i):Object.prototype.propertyIsEnumerable.call(n,i))||Jb(e,a)}}}function Jb(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Lb(t,n)}var Zb={get(e,t){if(t===wb)return e;const n=Rb(e);if(!Pb(n,t))return function(e,t,n){var i;const a=nx(t,n);return a?"value"in a?a.value:null==(i=a.get)?void 0:i.call(e.draft_):void 0}(e,n,t);const i=n[t];return e.finalized_||!Eb(i)?i:i===tx(e.base_,t)?(ax(e),e.copy_[t]=ox(i,e)):i},has:(e,t)=>t in Rb(e),ownKeys:e=>Reflect.ownKeys(Rb(e)),set(e,t,n){const i=nx(Rb(e),t);if(null==i?void 0:i.set)return i.set.call(e.draft_,n),!0;if(!e.modified_){const i=tx(Rb(e),t),s=null==i?void 0:i[wb];if(s&&s.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((a=n)===(o=i)?0!==a||1/a==1/o:a!=a&&o!=o)&&(void 0!==n||Pb(e.base_,t)))return!0;ax(e),ix(e)}var a,o;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==tx(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,ax(e),ix(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=Rb(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:i.enumerable,value:n[t]}:i},defineProperty(){_b(11)},getPrototypeOf:e=>Sb(e.base_),setPrototypeOf(){_b(12)}},ex={};function tx(e,t){const n=e[wb];return(n?Rb(n):e)[t]}function nx(e,t){if(!(t in e))return;let n=Sb(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Sb(n)}}function ix(e){e.modified_||(e.modified_=!0,e.parent_&&ix(e.parent_))}function ax(e){e.copy_||(e.copy_=Db(e.base_,e.scope_.immer_.useStrictShallowCopy_))}jb(Zb,(e,t)=>{ex[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),ex.deleteProperty=function(e,t){return ex.set.call(this,e,t,void 0)},ex.set=function(e,t,n){return Zb.set.call(this,e[0],t,n,e[0])};function ox(e,t){const n=Ab(e)?Bb("MapSet").proxyMap_(e,t):Ob(e)?Bb("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),i={type_:n?1:0,scope_:t?t.scope_:$b(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=i,o=Zb;n&&(a=[i],o=ex);const{revoke:s,proxy:r}=Proxy.revocable(a,o);return i.draft_=r,i.revoke_=s,r}(e,t);return(t?t.scope_:$b()).drafts_.push(n),n}function sx(e){if(!Eb(e)||zb(e))return e;const t=e[wb];let n,i=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Db(e,t.scope_.immer_.useStrictShallowCopy_),i=t.scope_.immer_.shouldUseStrictIteration()}else n=Db(e,!0);return jb(n,(e,t)=>{Mb(n,e,sx(t))},i),t&&(t.finalized_=!1),n}var rx=(new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,n)=>{if("function"==typeof e&&"function"!=typeof t){const n=t;t=e;const i=this;return function(e=n,...a){return i.produce(e,e=>t.call(this,e,...a))}}let i;if("function"!=typeof t&&_b(6),void 0!==n&&"function"!=typeof n&&_b(7),Eb(e)){const a=Wb(this),o=ox(e,void 0);let s=!0;try{i=t(o),s=!1}finally{s?Gb(a):Vb(a)}return qb(a,n),Kb(i,a)}if(!e||"object"!=typeof e){if(i=t(e),void 0===i&&(i=e),i===bb&&(i=void 0),this.autoFreeze_&&Lb(i,!0),n){const t=[],a=[];Bb("Patches").generateReplacementPatches_(e,i,t,a),n(t,a)}return i}_b(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...n)=>this.produceWithPatches(t,t=>e(t,...n));let n,i;return[this.produce(e,t,(e,t)=>{n=e,i=t}),n,i]},"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof(null==e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),"boolean"==typeof(null==e?void 0:e.useStrictIteration)&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Eb(e)||_b(8),Cb(e)&&(e=function(e){Cb(e)||_b(10);return sx(e)}(e));const t=Wb(this),n=ox(e,void 0);return n[wb].isManual_=!0,Vb(t),n}finishDraft(e,t){const n=e&&e[wb];n&&n.isManual_||_b(9);const{scope_:i}=n;return qb(i,t),Kb(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const i=t[n];if(0===i.path.length&&"replace"===i.op){e=i.value;break}}n>-1&&(t=t.slice(n+1));const i=Bb("Patches").applyPatches_;return Cb(e)?i(e,t):this.produce(e,e=>i(e,t))}}).produce;const lx=e=>(t,n,i)=>(i.setState=(e,n,...i)=>{const a="function"==typeof e?rx(e):e;return t(a,n,...i)},e(i.setState,n,i)),cx={BASE_URL:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/",DEV:!1,LEGACY:!1,MODE:"production",PROD:!0,SSR:!1},ux=new Map,dx=e=>{const t=ux.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([e,t])=>[e,t.getState()])):{}},hx=e=>{var t,n;if(!e)return;const i=e.split("\n"),a=i.findIndex(e=>e.includes("api.setState"));if(a<0)return;const o=(null==(t=i[a+1])?void 0:t.trim())||"";return null==(n=/.+ (.+) .+/.exec(o))?void 0:n[1]},px=(e,t={})=>(n,i,a)=>{const o=t,{enabled:s,anonymousActionType:r,store:l}=o,c=S(o,["enabled","anonymousActionType","store"]);let u;try{u=(null!=s?s:"production"!==(cx?"production":void 0))&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(kX){}if(!u)return e(n,i,a);const d=((e,t,n)=>{if(void 0===e)return{type:"untracked",connection:t.connect(n)};const i=ux.get(n.name);if(i)return w({type:"tracked",store:e},i);const a={connection:t.connect(n),stores:{}};return ux.set(n.name,a),w({type:"tracked",store:e},a)})(l,u,c),{connection:h}=d,p=S(d,["connection"]);let m=!0;a.setState=(e,t,o)=>{const s=n(e,t);if(!m)return s;const u=void 0===o?{type:r||hx((new Error).stack)||"anonymous"}:"string"==typeof o?{type:o}:o;return void 0===l?(null==h||h.send(u,i()),s):(null==h||h.send(_(w({},u),{type:`${l}/${u.type}`}),_(w({},dx(c.name)),{[l]:a.getState()})),s)},a.devtools={cleanup:()=>{h&&"function"==typeof h.unsubscribe&&h.unsubscribe(),((e,t)=>{if(void 0===t)return;const n=ux.get(e);n&&(delete n.stores[t],0===Object.keys(n.stores).length&&ux.delete(e))})(c.name,l)}};const f=(...e)=>{const t=m;m=!1,n(...e),m=t},g=e(a.setState,i,a);if("untracked"===p.type?null==h||h.init(g):(p.stores[p.store]=a,null==h||h.init(Object.fromEntries(Object.entries(p.stores).map(([e,t])=>[e,e===p.store?g:t.getState()])))),a.dispatchFromDevtools&&"function"==typeof a.dispatch){let e=!1;const t=a.dispatch;a.dispatch=(...n)=>{"production"===(cx?"production":void 0)||"__setState"!==n[0].type||e||(e=!0),t(...n)}}return h.subscribe(e=>{var t;switch(e.type){case"ACTION":if("string"!=typeof e.payload)return;return mx(e.payload,e=>{if("__setState"===e.type){if(void 0===l)return void f(e.state);Object.keys(e.state).length;const t=e.state[l];if(null==t)return;return void(JSON.stringify(a.getState())!==JSON.stringify(t)&&f(t))}a.dispatchFromDevtools&&"function"==typeof a.dispatch&&a.dispatch(e)});case"DISPATCH":switch(e.payload.type){case"RESET":return f(g),void 0===l?null==h?void 0:h.init(a.getState()):null==h?void 0:h.init(dx(c.name));case"COMMIT":return void 0===l?void(null==h||h.init(a.getState())):null==h?void 0:h.init(dx(c.name));case"ROLLBACK":return mx(e.state,e=>{if(void 0===l)return f(e),void(null==h||h.init(a.getState()));f(e[l]),null==h||h.init(dx(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return mx(e.state,e=>{void 0!==l?JSON.stringify(a.getState())!==JSON.stringify(e[l])&&f(e[l]):f(e)});case"IMPORT_STATE":{const{nextLiftedState:n}=e.payload,i=null==(t=n.computedStates.slice(-1)[0])?void 0:t.state;if(!i)return;return f(void 0===l?i:i[l]),void(null==h||h.send(null,n))}case"PAUSE_RECORDING":return m=!m}return}}),g},mx=(e,t)=>{let n;try{n=JSON.parse(e)}catch(kX){}void 0!==n&&t(n)},fx=e=>(t,n,i)=>{const a=i.subscribe;i.subscribe=(e,t,n)=>{let o=e;if(t){const a=(null==n?void 0:n.equalityFn)||Object.is;let s=e(i.getState());o=n=>{const i=e(n);if(!a(s,i)){const e=s;t(s=i,e)}},(null==n?void 0:n.fireImmediately)&&t(s,s)}return a(o)};return e(t,n,i)},gx=()=>({isStopDisabled:!1,currentChatPage:1,chatLoaded:!1,isChat:!1,chatPermission:{local_mcp:"prompt"},chatId:"",chatTitle:"",emitSendPromptType:"chat",chatParams:null,history:{messages:{},currentId:null,currentResponseIds:[]},historyCurrentId:"",projectId:"",currentInputFeature:hg.Txt2Txt,currentInputSubType:void 0,currentCitationInfo:{messageId:"",citationIndex:0},currentSearchSource:{},currentSearchLists:{},allSearchAndThinkLists:{},temporarySource:{},shareChatError:"",chatMode:"normal",imageReasonData:{status:"",imageUrl:""},branchInfo:null,callBackInfo:null,isCompareVersion:!0}),vx=yb()(lx(px((e,t)=>w(w({},gx()),(e=>({setIsStopDisabled:t=>e({isStopDisabled:t}),setCurrentChatPage:t=>e({currentChatPage:t}),setChatLoaded:t=>e({chatLoaded:t}),setIsChat:t=>e({isChat:t}),setChatPermission:t=>e({chatPermission:t}),setChatId:t=>e({chatId:t}),setChatTitle:t=>e({chatTitle:t}),setProjectId:t=>e({projectId:t}),setEmitSendPromptType:t=>e({emitSendPromptType:t}),setChatParams:t=>e({chatParams:t}),setHistory:t=>e({history:t}),updateHistoryByImmer:t=>{e("function"==typeof t?e=>{t(e.history)}:{history:t})},setHistoryCurrentId:t=>e({historyCurrentId:t}),setAllSearchAndThinkLists:t=>e({allSearchAndThinkLists:t}),setCurrentInputFeature:t=>e({currentInputFeature:t}),setCurrentInputSubType:t=>e({currentInputSubType:t}),setCurrentCitationInfo:t=>e({currentCitationInfo:t}),setCurrentSearchSource:t=>e({currentSearchSource:t}),setTemporarySource:t=>e({temporarySource:t}),setCurrentArtifactsMessage:t=>e({currentArtifactsMessage:t}),resetChatState:()=>e(gx()),setCurrentSearchLists:t=>e({currentSearchLists:t}),setShareChatError:t=>e({shareChatError:t}),setChatMode:t=>e({chatMode:t}),setImageReasonData:t=>e({imageReasonData:t}),setBranchInfo:t=>e({branchInfo:t}),setCallBackInfo:t=>e({callBackInfo:t}),setIsCompareVersion:t=>e({isCompareVersion:t})}))(e)),{name:"chatStore",store:"chatStore",enabled:!1}))),yx={chats:[],pinnedChats:[]},bx=yb()(px(e=>w(w({},yx),(e=>({setChats:t=>e({chats:t}),setPinnedChats:t=>e({pinnedChats:t})}))(e)),{name:"chatConfigStore",store:"chatConfigStore",enabled:!1})),xx={"zh-cht":"zh-TW",zh:"zh-CN",en:"en-US",fr:"fr-FR",de:"de-DE",it:"it-IT",ja:"ja-JP",ko:"ko-KR",pt:"pt-PT",ar:"ar-BH",ru:"ru-RU",es:"es-ES"},wx=(e=!1,t="light")=>"dark"===t?e?"https://img.alicdn.com/imgextra/i2/O1CN01J8AmJN1cZGSJ5xFjV_!!6000000003614-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01lSOiPA1VfwvV2cZw6_!!6000000002681-54-tps-60-60.apng":"light"===t?e?"https://img.alicdn.com/imgextra/i4/O1CN01Jwyf191eaIa5xowFe_!!6000000003887-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01pNHavt1CykU9z9sPI_!!6000000000150-54-tps-60-60.apng":void 0,_x={showDeleteDeployConfirm:!1,reUpdateFolders:!1,taskRunning:!1,hasChatIsRunning:!1,visionGenerating:!1,showArchivedChats:!1,showChangelog:!1,showModelSelect:!1,showMCPconfig:!1,showUserLongPressChat:!1,showResLongPressChat:!1,showMcpServerModal:!1,showMcpJsonNewModal:!1,showMcpDetailModal:!1,showMcpDeleteModal:!1,thinkingEnabled:!1,searchEnabled:!1,researchMode:!1,featureConfig:"",webSearchEnabled:!1,imageGenerateEnabled:!1,mcpEnabled:!1,videoGenerateEnabled:!1,disableOtherFeature:!1,currentShowControl:ag.None,temporaryChatEnabled:!1,reUpdateMessagesScroll:!1,selectedArtifactsMessageId:"",historyCurrentId:"",welcomeModalShow:!1,isHongkong:!1,isRussia:!1,isShowGetTheApp:!1,isPdfVisible:!1,isSourcesVisible:!1,PdfViewInfo:null,isPdfCardVisible:!1,websearchLoading:!1,selectedModels:[],folders:{},currentDPLanguageCode:xx.en,podcastCount:0,deepResearchVersion:"",omniType:"",currentActionMessageId:"",locateTheSearchSource:!1},Sx=yb()(fx(px(e=>w(w({},_x),(e=>({setShowDeleteDeployConfirm:t=>e({showDeleteDeployConfirm:t}),setReUpdateFolders:t=>e({reUpdateFolders:t}),setTaskRunning:t=>e({taskRunning:t}),setHasChatIsRunning:t=>e({hasChatIsRunning:t}),setVisionGenerating:t=>e({visionGenerating:t}),setShowArchivedChats:t=>e({showArchivedChats:t}),setShowChangelog:t=>e({showChangelog:t}),setShowModelSelect:t=>e({showModelSelect:t}),setShowMCPconfig:t=>e({showMCPconfig:t}),setShowUserLongPressChat:t=>e({showUserLongPressChat:t}),setShowResLongPressChat:t=>e({showResLongPressChat:t}),setShowMcpServerModal:t=>e({showMcpServerModal:t}),setShowMcpJsonNewModal:t=>e({showMcpJsonNewModal:t}),setShowMcpDetailModal:t=>e({showMcpDetailModal:t}),setShowMcpDeleteModal:t=>e({showMcpDeleteModal:t}),setThinkingEnabled:t=>e({thinkingEnabled:t}),setSearchEnabled:t=>e({searchEnabled:t}),setResearchMode:t=>e({researchMode:t}),setFeatureConfig:t=>e({featureConfig:t}),setWebSearchEnabled:t=>e({webSearchEnabled:t}),setImageGenerateEnabled:t=>e({imageGenerateEnabled:t}),setMcpEnabled:t=>e({mcpEnabled:t}),setVideoGenerateEnabled:t=>e({videoGenerateEnabled:t}),setDisableOtherFeature:t=>e({disableOtherFeature:t}),setCurrentShowControl:t=>e({currentShowControl:t}),setTemporaryChatEnabled:t=>e({temporaryChatEnabled:t}),setReUpdateMessagesScroll:t=>e({reUpdateMessagesScroll:t}),setSelectedArtifactsMessageId:t=>e({selectedArtifactsMessageId:t}),setHistoryCurrentId:t=>e({historyCurrentId:t}),setWelcomeModalShow:t=>e({welcomeModalShow:t}),setIsHongkong:t=>e({isHongkong:t}),setIsRussia:t=>e({isRussia:t}),setIsShowGetTheApp:t=>e({isShowGetTheApp:t}),setIsPdfVisible:t=>e({isPdfVisible:t}),setIsSourcesVisible:t=>e({isSourcesVisible:t}),setPDFViewInfo:t=>e({PdfViewInfo:t}),setIsPdfCardVisible:t=>e({isPdfCardVisible:t}),setWebsearchLoading:t=>e({websearchLoading:t}),setSelectedModels:t=>e({selectedModels:t}),setCurrentDPLanguageCode:t=>e({currentDPLanguageCode:t}),setPodcastCount:t=>e({podcastCount:t}),setDeepResearchVersion:t=>e({deepResearchVersion:t}),setOmniType:t=>e({omniType:t}),setPdfCardType:t=>e({pdfCardType:t}),setCurrentActionMessageId:t=>e({currentActionMessageId:t}),resetFeatureState:(t={})=>e(w(w({},_x),t)),setFolders:t=>e({folders:t}),setLocateTheSearchSource:t=>e({locateTheSearchSource:t})}))(e)),{name:"featureStore",store:"featureStore",enabled:!1}))),Cx={webuiName:"",config:void 0,mobile:!1,pad:!1,modelDownloadPool:{},globalGuestTracker:null,isDisableGuestAccess:!1},Ex=yb()(px(e=>w(w({},Cx),(e=>({setWebuiName:t=>e({webuiName:t}),setConfig:t=>e({config:t}),setMobile:t=>e({mobile:t}),setPad:t=>e({pad:t}),setModelDownloadPool:t=>e({modelDownloadPool:t}),setGlobalGuestTracker:t=>e({globalGuestTracker:t}),setIsDisableGuestAccess:t=>e({isDisableGuestAccess:t})}))(e)),{name:"globalConfigStore",store:"globalConfigStore",enabled:!1}));var kx,Ix={exports:{}};kx=Ix,function(){function e(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function t(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){s(i.response,t,n)},i.onerror=function(){},i.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(n){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof U&&U.global===U?U:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(e,o,s){var r=a.URL||a.webkitURL,l=document.createElement("a");o=o||e.name||"download",l.download=o,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):n(l.href)?t(e,o,s):i(l,l.target="_blank")):(l.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(l.href)},4e4),setTimeout(function(){i(l)},0))}:"msSaveOrOpenBlob"in navigator?function(a,o,s){if(o=o||a.name||"download","string"!=typeof a)navigator.msSaveOrOpenBlob(e(a,s),o);else if(n(a))t(a,o,s);else{var r=document.createElement("a");r.href=a,r.target="_blank",setTimeout(function(){i(r)})}}:function(e,n,i,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,i);var r="application/octet-stream"===e.type,l=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||r&&l||o)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=e:location=e,s=null},u.readAsDataURL(e)}else{var d=a.URL||a.webkitURL,h=d.createObjectURL(e);s?s.location=h:location.href=h,s=null,setTimeout(function(){d.revokeObjectURL(h)},4e4)}});a.saveAs=s.saveAs=s,kx.exports=s}();const Tx=H(Ix.exports);function jx(){const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}const Nx=e=>"number"==typeof e&&!Number.isNaN(e);function Px(){const{userAgent:e}=navigator;return Boolean(e.match(/iPad Simulator|iPhone Simulator|iPod Simulator|iPad|iPhone|iPod/)||e.includes("Mac")&&"ontouchend"in document)}const Mx=()=>{const e=navigator.userAgent.toLowerCase();return/iphone/.test(e)},Ax=()=>-1!==navigator.userAgent.toLowerCase().indexOf("android"),Ox=()=>{const e=navigator.userAgent,t=/(iPad|Macintosh.*AppleWebKit(?!.*Chrome))/.test(e)&&!/iPhone|iPod/.test(e)&&Px(),n=/Android/.test(e)&&!/Mobile/.test(e),i=/Windows/.test(e)&&/Touch/.test(e);return t?"iPad":n||i?"tablet":/iPhone|Android/.test(e)?"mobile":"pc"},Rx=()=>-1!==navigator.userAgent.toLowerCase().indexOf("micromessenger"),Dx=()=>Ax()&&Rx(),Lx=()=>{const e=Ox();return["iPad","mobile","tablet"].includes(e)},Fx=()=>"pc"===Ox(),zx=()=>/AliApp\(QWENCHAT\/[^)]*\)/.test(navigator.userAgent),Ux=()=>!Fx()&&!zx(),Hx=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Bx=()=>{const e=navigator.userAgent.match(/AliApp\(QWENCHAT\/([\d.]+)\)/);return e?e[1]:"1.0.0"},$x=()=>{const e=navigator.userAgent.match(/AliApp\(QWENCHAT\/(\d+\.\d+\.\d+)/),t=e?e[1]:null;return t&&!(e=>{const t=e.split(".").map(e=>parseInt(e,10));for(;t.length<3;)t.push(0);return t[0]<1||!(t[0]>1)&&t[1]<2})(t)},qx=()=>!Fx()&&!$x(),Gx=()=>!!window.electronAPI&&/AliDesktop\(QWENCHAT\/\d+\.\d+\.\d+\)/.test(navigator.userAgent),Vx=()=>Px()&&zx()||Ax()&&zx(),Wx=()=>{const e=window.navigator.userAgent,t=window.navigator.platform;let n="";return-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(t)?n="MACOS":-1!==["iPhone","iPad","iPod"].indexOf(t)?n="IOS":-1!==["Win32","Win64","Windows","WinCE"].indexOf(t)?n="WINDOWS":/Android/.test(e)?n="ANDROID":!n&&/Linux/.test(t)&&(n="LINUX"),n},Qx=()=>{var e;if(!zx()||$x())return"0px";const t=null==(e=null==window?void 0:window.QwenChat)?void 0:e.safeAreaInsetTop;return Mx()?Nx(t)?`${t}px`:"env(safe-area-inset-top)":Nx(t)?`${t}px`:"33px"},Kx=()=>{var e;if(!zx()||$x())return"0px";const t=null==(e=null==window?void 0:window.QwenChat)?void 0:e.safeAreaInsetBottom;return Mx()?Nx(t)?`${t}px`:"env(safe-area-inset-bottom)":Nx(t)?`${t}px`:"38px"},Yx=(e,t=!1)=>{const n=Bx(),i=e.split(".").map(Number),a=n.split(".").map(Number);for(let o=0;o<3;o++){const e=i[o]||0,t=a[o]||0;if(t<e)return!0;if(t>e)return!1}return t},Xx=()=>{const e=navigator.userAgent;let t,n;if(e.indexOf("Firefox")>-1){t="Firefox";const i=e.match(/Firefox\/([\d.]+)/);n=i?i[1]:"Unknown"}else if(e.indexOf("Opera")>-1||e.indexOf("OPR")>-1){t="Opera";const i=e.match(/(Opera|OPR)\/([\d.]+)/);n=i?i[2]:"Unknown"}else if(e.indexOf("Edge")>-1){t="Edge";const i=e.match(/Edge\/([\d.]+)/);n=i?i[1]:"Unknown"}else if(e.indexOf("Chrome")>-1){t="Chrome";const i=e.match(/Chrome\/([\d.]+)/);n=i?i[1]:"Unknown"}else if(e.indexOf("Safari")>-1&&!e.match("Chrome")){t="Safari";const i=e.match(/Version\/([\d.]+)/);n=i?i[1]:"Unknown"}return{name:t,version:n}},Jx=(e,t)=>{var n;Gx()&&(null==(n=window.electronAPI)?void 0:n.open_external_link)&&(e.preventDefault(),window.electronAPI.open_external_link(t))},Zx=e=>{const t=(e=>{const{url:t,headers:n}=e;null==t||t.indexOf(Yg),n.getAccept()||n.set("Accept","application/json"),n.getContentType()||n.set("Content-Type","application/json"),n.set("Version","0.1.38");let i="h5";Fx()&&(i="web"),zx()&&(i="app"),Gx()&&(i="desktop"),n.set("source",i);const a=localStorage.getItem("token");return a&&!["web","h5"].includes(i)&&n.set("Authorization",`Bearer ${a}`),n.get("X-Request-Id")||n.set("X-Request-Id",rt()),["web","h5"].includes(i)&&n.has("Authorization")&&n.delete("Authorization"),!zT()||["web","h5"].includes(i)||n.has("Authorization")||n.set("Authorization",`Bearer ${zT()}`),n.set("Timezone",(new Date).toString().replace(/\s*\(.+\)$/,"")),w({},e)})(e);return(e=>{const{url:t,headers:n}=e,i=new Date;String(i.getMilliseconds()).padStart(3,"0"),i.toLocaleDateString(),i.toLocaleTimeString()})(e),w({},t)},ew=(e,t)=>{const n=null==e?void 0:e.stage,i=null==e?void 0:e.modality,a=null==i?void 0:i.map(e=>t.t(e)).join(", ");let o="Content security warning: output data may contain inappropriate content!",s={};return"input"===n?a?(o="Content security warning: input {{fileType}} data may contain inappropriate content!",s={fileType:a}):o="Content security warning: input data may contain inappropriate content!":a&&(o="Content security warning: output {{fileType}} data may contain inappropriate content!",s={fileType:a}),t.t(o,s)},tw=[{urls:["chats/share/"]},{urls:["share/message/"]},{urls:["notifications/latest"]}],nw=(e,t)=>{var n,i;const a=Hf(),o=e.status,s=(null==e?void 0:e.code)||"ERR_UNKNOWN_ERROR";let r=null==e?void 0:e.message;const l=null==e?void 0:e.name;let c=!(tw.find(({code:e,urls:n})=>{const i=!e||e.includes(s),a=n.find(e=>(t.url||"").includes(e));return i&&!!a})||null!=(n=t.toast)&&!n);const{user:u,setUser:d}=HE.getState(),{mobile:h}=Ex.getState();switch(401!==o&&"Invalid token"!==s||(null==(i=(null==t?void 0:t.url)||"")?void 0:i.indexOf("/auths/"))>-1||(kT.adapter.clearCookie(Xf.SETAPP),d(void 0),$x()&&(kT.adapter.invoke({method:"showAlert",params:{type:"login"}}),kT.adapter.invoke({method:"showToast",params:{type:"warning",text:r}})),window.location.href=h?"/auth":"/"),o){case 401:break;case 403:"access_prohibited"===s&&u&&(d(_(w({},u),{role:"disabled"})),c=!1)}if(!r)switch(s){case"ERR_NETWORK":r=a.t("Network error");break;case"ERR_UNKNOWN_ERROR":"TypeError"!==l&&"AxiosError"!==l||(r=a.t("Network error"))}switch("data_inspection_failed"===s&&(r=(null==e?void 0:e.message)?e.message:ew(e,a)),r){case"Too Many Requests":r="Your operation is too frequent, please try again later.";break;case"Invalid token":r="Your session has expired, or the token is no longer valid. Please sign in again to proceed.";break;case"[ERROR: Folder already exists]":r="The folder already exists.";break;case"[ERROR: File already exists]":r="The file already exists.";break;case"[ERROR: You are not authorized to access this share]":r="Access deniedthis share link is private. Redirecting to the homepage in 5 seconds.";break;case"[ERROR: Share not found]":r="Access deniedthis share link is expired or disabled. Redirecting to the homepage in 5 seconds.";break;case"Network Error":r=a.t("Network error")}return c&&ht.openOnce({type:"error",content:a.t(r)}),{success:!1,data:{code:s,message:r}}},iw=e=>{var t,n;const i=Hf(),a=e,{data:o,status:s}=a,r=(null==o?void 0:o.code)||"";let l=null==o?void 0:o.details;switch("detail"in o&&"string"==typeof o.detail?["data_inspection_passed"].includes(o.detail)||(l=null==o?void 0:o.detail):"error"in o?l=o.error&&"object"==typeof o.error&&"message"in o.error?o.error.message:o.error:"message"in o?l=o.message:(null==(t=null==o?void 0:o.detail)?void 0:t.code)&&(l=null==(n=null==o?void 0:o.detail)?void 0:n.message),r){case"data_inspection_failed":l=ew(o,i);break;case"access_prohibited":l=null==o?void 0:o.message}return r||l?(l||(l=`${i.t("Network error")}: ${s}`),a.data={success:!1,data:{code:r,details:l}}):a.data={success:!0,data:w({},e.data)},a};const aw=ut.create({baseURL:Kg,method:"GET",withCredentials:!0});aw.interceptors.request.use(e=>Zx(e)),aw.interceptors.response.use(e=>e);const ow=(e,t)=>j(void 0,null,function*(){var n,i;const a=!!(null==t?void 0:t.baseURL),o=localStorage.getItem("locale")||navigator.language||"en-US",s=`${o},${o.split("-")[0]};q=0.9`;try{if("stream"===(null==t?void 0:t.responseType))return yield function(e,t){return j(this,null,function*(){var n;const{headers:i}=t||{},a=Zx(_(w({},t),{headers:new ct(i||{})})),{params:o={},data:s}=a,r=new URLSearchParams(o).toString();try{const i={method:(null==t?void 0:t.method)||"GET",headers:a.headers.toJSON()};"GET"!==(null==(n=null==t?void 0:t.method)?void 0:n.toUpperCase())&&s&&(i.body=JSON.stringify(s||{}));const o=yield fetch(`${Kg}${e}${r?`?${r}`:""}`,i),l=o.headers.get("content-type");if(null==l?void 0:l.includes("text/event-stream"))return{success:!0,data:o.body,isStream:!0};if(null==l?void 0:l.includes("application/json"))return{success:!0,data:yield o.json()};throw new lt("Unknown error","ERR_UNKNOWN_ERROR")}catch(l){return nw(new lt(l.message,l.code),Object.assign({},t,{url:e}))}})}(e,_(w({},t||{}),{headers:w({"Accept-Language":s},null==t?void 0:t.headers)}));let n=yield aw(_(w({url:e},t||{}),{headers:w({"Accept-Language":s},null==t?void 0:t.headers)}));return a&&(n=iw(n)),(e=>{var t,n;const{data:i}=e;if(!i.success){const e=(null==(t=i.data)?void 0:t.code)||"ERR_UNKNOWN_ERROR",a=(null==(n=i.data)?void 0:n.details)||"Unknown error";throw new lt(a,e)}return i})(n)}catch(r){const o=null==r?void 0:r.response;if(o&&a){const{data:a}=iw(o);if(!a.success)return nw(new lt(null==(n=a.data)?void 0:n.details,null==(i=a.data)?void 0:i.code),Object.assign({},t,{url:e}))}return nw(r,Object.assign({},t,{url:e}))}}),sw=["/api/chat/completions","/api/chats/new","/api/chat/completed","/api/v1/chats","/api/v1/chats/all/tags","/api/task/suggestions/completions","/api/v1/tasks/status","/api/v1/files/getstsToken","/api/task/title/completions","/api/task/tags/completions","/api/parse_url","/api/v2/chats","/api/v2/chat/completions","/api/v2/task/suggestions/completions","/api/v2/files/getstsToken","/api/v2/community","/api/v2/tts/completions","/api/v2/files/getfilelink","/api/v2/files/parse","/api/v2/files/parse/status"],rw=e=>new Promise(t=>{setTimeout(t,e)}),lw=()=>j(void 0,null,function*(){var e;return window.baxiaCommon&&(null==(e=window.__baxia__)?void 0:e.baxiaPromptInit)?yield uw():yield new Promise(e=>{!function(e,t){var n;const i="script",a=document.getElementsByTagName(i)[0],o=document.createElement(i);if(o.async=!0,o.src=e,o.crossOrigin="anonymous",t){let e=!1;o.onload=function(){e||(o.onload=null,e=!0,t("success"))}}o.onerror=function(){t("error")},null==(n=a.parentNode)||n.insertBefore(o,a)}("https://assets.alicdn.com/g/??/AWSC/AWSC/awsc.js,/sd/baxia-entry/baxiaCommon.js",t=>j(void 0,null,function*(){!function(){const e=new Date;String(e.getMilliseconds()).padStart(3,"0");e.toLocaleDateString(),e.toLocaleTimeString()}(),"success"===t&&(yield uw()),e(!0)}))})});let cw=0;const uw=()=>j(void 0,null,function*(){var e,t,n;return cw++,!!(window.baxiaCommon&&(null==(e=window.__baxia__)?void 0:e.baxiaPromptInit)&&window.baxiaInitialized)||(window.baxiaCommon&&(null==(t=window.__baxia__)?void 0:t.baxiaPromptInit)&&!window.baxiaInitialized?window.baxiaNeedDelay?(yield rw(1500),yield uw()):(yield j(void 0,null,function*(){var e;window.baxiaCommon&&(null==(e=window.__baxia__)?void 0:e.baxiaPromptInit)&&(window.baxiaCommon.init({appendTo:"header",uabOptions:{location:"sea"},checkApiPath:function(e){return sw.some(t=>e.indexOf(t)>-1)},paramstype:["uab","umid"],autoSize:!0}),$x()&&(window.baxiaNeedDelay=!0,yield rw(1500),window.baxiaNeedDelay=!1),window.baxiaInitialized=!0)}),yield uw()):cw<6&&cw>3&&!window.baxiaCommon&&!(null==(n=window.__baxia__)?void 0:n.baxiaPromptInit)?yield lw():cw>6||(yield rw(1e3),yield uw()))}),dw=e=>j(void 0,null,function*(){return yield uw(),yield ow(`/share/artifacts/${e.share_id}`,{baseURL:"/api/v1",toast:!1})}),hw=e=>j(void 0,null,function*(){return yield ow("/share/artifacts/report",{method:"POST",data:e})}),pw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mw="ARRAYBUFFER not supported by this environment",fw="UINT8ARRAY not supported by this environment";function gw(e,t,n,i){let a,o,s;const r=t||[0],l=(n=n||0)>>>3,c=-1===i?3:0;for(a=0;a<e.length;a+=1)s=a+l,o=s>>>2,r.length<=o&&r.push(0),r[o]|=e[a]<<8*(c+i*(s%4));return{value:r,binLen:8*e.length+n}}function vw(e,t,n){switch(t){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":return function(e,t,i){return function(e,t,n,i){let a,o,s,r;if(0!=e.length%2)throw new Error("String of HEX type must be in byte increments");const l=t||[0],c=(n=n||0)>>>3,u=-1===i?3:0;for(a=0;a<e.length;a+=2){if(o=parseInt(e.substr(a,2),16),isNaN(o))throw new Error("String of HEX type contains invalid characters");for(r=(a>>>1)+c,s=r>>>2;l.length<=s;)l.push(0);l[s]|=o<<8*(u+i*(r%4))}return{value:l,binLen:4*e.length+n}}(e,t,i,n)};case"TEXT":return function(e,i,a){return function(e,t,n,i,a){let o,s,r,l,c,u,d,h,p=0;const m=n||[0],f=(i=i||0)>>>3;if("UTF8"===t)for(d=-1===a?3:0,r=0;r<e.length;r+=1)for(o=e.charCodeAt(r),s=[],128>o?s.push(o):2048>o?(s.push(192|o>>>6),s.push(128|63&o)):55296>o||57344<=o?s.push(224|o>>>12,128|o>>>6&63,128|63&o):(r+=1,o=65536+((1023&o)<<10|1023&e.charCodeAt(r)),s.push(240|o>>>18,128|o>>>12&63,128|o>>>6&63,128|63&o)),l=0;l<s.length;l+=1){for(u=p+f,c=u>>>2;m.length<=c;)m.push(0);m[c]|=s[l]<<8*(d+a*(u%4)),p+=1}else for(d=-1===a?2:0,h="UTF16LE"===t&&1!==a||"UTF16LE"!==t&&1===a,r=0;r<e.length;r+=1){for(o=e.charCodeAt(r),!0===h&&(l=255&o,o=l<<8|o>>>8),u=p+f,c=u>>>2;m.length<=c;)m.push(0);m[c]|=o<<8*(d+a*(u%4)),p+=2}return{value:m,binLen:8*p+i}}(e,t,i,a,n)};case"B64":return function(e,t,i){return function(e,t,n,i){let a,o,s,r,l,c,u,d=0;const h=t||[0],p=(n=n||0)>>>3,m=-1===i?3:0,f=e.indexOf("=");if(-1===e.search(/^[a-zA-Z0-9=+/]+$/))throw new Error("Invalid character in base-64 string");if(e=e.replace(/=/g,""),-1!==f&&f<e.length)throw new Error("Invalid '=' found in base-64 string");for(o=0;o<e.length;o+=4){for(l=e.substr(o,4),r=0,s=0;s<l.length;s+=1)a=pw.indexOf(l.charAt(s)),r|=a<<18-6*s;for(s=0;s<l.length-1;s+=1){for(u=d+p,c=u>>>2;h.length<=c;)h.push(0);h[c]|=(r>>>16-8*s&255)<<8*(m+i*(u%4)),d+=1}}return{value:h,binLen:8*d+n}}(e,t,i,n)};case"BYTES":return function(e,t,i){return function(e,t,n,i){let a,o,s,r;const l=t||[0],c=(n=n||0)>>>3,u=-1===i?3:0;for(o=0;o<e.length;o+=1)a=e.charCodeAt(o),r=o+c,s=r>>>2,l.length<=s&&l.push(0),l[s]|=a<<8*(u+i*(r%4));return{value:l,binLen:8*e.length+n}}(e,t,i,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(PI){throw new Error(mw)}return function(e,t,i){return a=t,o=i,s=n,gw(new Uint8Array(e),a,o,s);var a,o,s};case"UINT8ARRAY":try{new Uint8Array(0)}catch(PI){throw new Error(fw)}return function(e,t,i){return gw(e,t,i,n)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function yw(e,t,n,i){switch(e){case"HEX":return function(e){return function(e,t,n,i){const a="0123456789abcdef";let o,s,r="";const l=t/8,c=-1===n?3:0;for(o=0;o<l;o+=1)s=e[o>>>2]>>>8*(c+n*(o%4)),r+=a.charAt(s>>>4&15)+a.charAt(15&s);return i.outputUpper?r.toUpperCase():r}(e,t,n,i)};case"B64":return function(e){return function(e,t,n,i){let a,o,s,r,l,c="";const u=t/8,d=-1===n?3:0;for(a=0;a<u;a+=3)for(r=a+1<u?e[a+1>>>2]:0,l=a+2<u?e[a+2>>>2]:0,s=(e[a>>>2]>>>8*(d+n*(a%4))&255)<<16|(r>>>8*(d+n*((a+1)%4))&255)<<8|l>>>8*(d+n*((a+2)%4))&255,o=0;o<4;o+=1)c+=8*a+6*o<=t?pw.charAt(s>>>6*(3-o)&63):i.b64Pad;return c}(e,t,n,i)};case"BYTES":return function(e){return function(e,t,n){let i,a,o="";const s=t/8,r=-1===n?3:0;for(i=0;i<s;i+=1)a=e[i>>>2]>>>8*(r+n*(i%4))&255,o+=String.fromCharCode(a);return o}(e,t,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(PI){throw new Error(mw)}return function(e){return function(e,t,n){let i;const a=t/8,o=new ArrayBuffer(a),s=new Uint8Array(o),r=-1===n?3:0;for(i=0;i<a;i+=1)s[i]=e[i>>>2]>>>8*(r+n*(i%4))&255;return o}(e,t,n)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(PI){throw new Error(fw)}return function(e){return function(e,t,n){let i;const a=t/8,o=-1===n?3:0,s=new Uint8Array(a);for(i=0;i<a;i+=1)s[i]=e[i>>>2]>>>8*(o+n*(i%4))&255;return s}(e,t,n)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}const bw=4294967296,xw=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],ww=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],_w=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Sw="Chosen SHA variant is not supported",Cw="Cannot set numRounds with MAC";function Ew(e,t){let n,i;const a=e.binLen>>>3,o=t.binLen>>>3,s=a<<3,r=4-a<<3;if(a%4!=0){for(n=0;n<o;n+=4)i=a+n>>>2,e.value[i]|=t.value[n>>>2]<<s,e.value.push(0),e.value[i+1]|=t.value[n>>>2]>>>r;return(e.value.length<<2)-4>=o+a&&e.value.pop(),{value:e.value,binLen:e.binLen+t.binLen}}return{value:e.value.concat(t.value),binLen:e.binLen+t.binLen}}function kw(e){const t={outputUpper:!1,b64Pad:"=",outputLen:-1},n=e||{},i="Output length must be a multiple of 8";if(t.outputUpper=n.outputUpper||!1,n.b64Pad&&(t.b64Pad=n.b64Pad),n.outputLen){if(n.outputLen%8!=0)throw new Error(i);t.outputLen=n.outputLen}else if(n.shakeLen){if(n.shakeLen%8!=0)throw new Error(i);t.outputLen=n.shakeLen}if("boolean"!=typeof t.outputUpper)throw new Error("Invalid outputUpper formatting option");if("string"!=typeof t.b64Pad)throw new Error("Invalid b64Pad formatting option");return t}function Iw(e,t,n,i){const a=e+" must include a value and format";if(!t){if(!i)throw new Error(a);return i}if(void 0===t.value||!t.format)throw new Error(a);return vw(t.format,t.encoding||"UTF8",n)(t.value)}class Tw{constructor(e,t,n){const i=n||{};if(this.t=t,this.i=i.encoding||"UTF8",this.numRounds=i.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=e,this.h=[],this.u=0,this.l=!1,this.A=0,this.H=!1,this.S=[],this.p=[]}update(e){let t,n=0;const i=this.m>>>5,a=this.C(e,this.h,this.u),o=a.binLen,s=a.value,r=o>>>5;for(t=0;t<r;t+=i)n+this.m<=o&&(this.U=this.v(s.slice(t,t+i),this.U),n+=this.m);return this.A+=n,this.h=s.slice(n>>>5),this.u=o%this.m,this.l=!0,this}getHash(e,t){let n,i,a=this.R;const o=kw(t);if(this.K){if(-1===o.outputLen)throw new Error("Output length must be specified in options");a=o.outputLen}const s=yw(e,a,this.T,o);if(this.H&&this.g)return s(this.g(o));for(i=this.F(this.h.slice(),this.u,this.A,this.L(this.U),a),n=1;n<this.numRounds;n+=1)this.K&&a%32!=0&&(i[i.length-1]&=16777215>>>24-a%32),i=this.F(i,a,0,this.B(this.o),a);return s(i)}setHMACKey(e,t,n){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const i=vw(t,(n||{}).encoding||"UTF8",this.T);this.k(i(e))}k(e){const t=this.m>>>3,n=t/4-1;let i;if(1!==this.numRounds)throw new Error(Cw);if(this.H)throw new Error("MAC key already set");for(t<e.binLen/8&&(e.value=this.F(e.value,e.binLen,0,this.B(this.o),this.R));e.value.length<=n;)e.value.push(0);for(i=0;i<=n;i+=1)this.S[i]=909522486^e.value[i],this.p[i]=1549556828^e.value[i];this.U=this.v(this.S,this.U),this.A=this.m,this.H=!0}getHMAC(e,t){const n=kw(t);return yw(e,this.R,this.T,n)(this.Y())}Y(){let e;if(!this.H)throw new Error("Cannot call getHMAC without first setting MAC key");const t=this.F(this.h.slice(),this.u,this.A,this.L(this.U),this.R);return e=this.v(this.p,this.B(this.o)),e=this.F(t,this.R,this.m,e,this.R),e}}function jw(e,t){return e<<t|e>>>32-t}function Nw(e,t){return e>>>t|e<<32-t}function Pw(e,t){return e>>>t}function Mw(e,t,n){return e^t^n}function Aw(e,t,n){return e&t^~e&n}function Ow(e,t,n){return e&t^e&n^t&n}function Rw(e){return Nw(e,2)^Nw(e,13)^Nw(e,22)}function Dw(e,t){const n=(65535&e)+(65535&t);return(65535&(e>>>16)+(t>>>16)+(n>>>16))<<16|65535&n}function Lw(e,t,n,i){const a=(65535&e)+(65535&t)+(65535&n)+(65535&i);return(65535&(e>>>16)+(t>>>16)+(n>>>16)+(i>>>16)+(a>>>16))<<16|65535&a}function Fw(e,t,n,i,a){const o=(65535&e)+(65535&t)+(65535&n)+(65535&i)+(65535&a);return(65535&(e>>>16)+(t>>>16)+(n>>>16)+(i>>>16)+(a>>>16)+(o>>>16))<<16|65535&o}function zw(e){return Nw(e,7)^Nw(e,18)^Pw(e,3)}function Uw(e){return Nw(e,6)^Nw(e,11)^Nw(e,25)}function Hw(e){return[1732584193,4023233417,2562383102,271733878,3285377520]}function Bw(e,t){let n,i,a,o,s,r,l;const c=[];for(n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=0;l<80;l+=1)c[l]=l<16?e[l]:jw(c[l-3]^c[l-8]^c[l-14]^c[l-16],1),r=l<20?Fw(jw(n,5),Aw(i,a,o),s,1518500249,c[l]):l<40?Fw(jw(n,5),Mw(i,a,o),s,1859775393,c[l]):l<60?Fw(jw(n,5),Ow(i,a,o),s,2400959708,c[l]):Fw(jw(n,5),Mw(i,a,o),s,3395469782,c[l]),s=o,o=a,a=jw(i,30),i=n,n=r;return t[0]=Dw(n,t[0]),t[1]=Dw(i,t[1]),t[2]=Dw(a,t[2]),t[3]=Dw(o,t[3]),t[4]=Dw(s,t[4]),t}function $w(e,t,n,i){let a;const o=15+(t+65>>>9<<4),s=t+n;for(;e.length<=o;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[o]=4294967295&s,e[o-1]=s/bw|0,a=0;a<e.length;a+=16)i=Bw(e.slice(a,a+16),i);return i}let qw=class extends Tw{constructor(e,t,n){if("SHA-1"!==e)throw new Error(Sw);super(e,t,n);const i=n||{};this.M=!0,this.g=this.Y,this.T=-1,this.C=vw(this.t,this.i,this.T),this.v=Bw,this.L=function(e){return e.slice()},this.B=Hw,this.F=$w,this.U=[1732584193,4023233417,2562383102,271733878,3285377520],this.m=512,this.R=160,this.K=!1,i.hmacKey&&this.k(Iw("hmacKey",i.hmacKey,this.T))}};function Gw(e){let t;return t="SHA-224"==e?ww.slice():_w.slice(),t}function Vw(e,t){let n,i,a,o,s,r,l,c,u,d,h;const p=[];for(n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],r=t[5],l=t[6],c=t[7],h=0;h<64;h+=1)p[h]=h<16?e[h]:Lw(Nw(m=p[h-2],17)^Nw(m,19)^Pw(m,10),p[h-7],zw(p[h-15]),p[h-16]),u=Fw(c,Uw(s),Aw(s,r,l),xw[h],p[h]),d=Dw(Rw(n),Ow(n,i,a)),c=l,l=r,r=s,s=Dw(o,u),o=a,a=i,i=n,n=Dw(u,d);var m;return t[0]=Dw(n,t[0]),t[1]=Dw(i,t[1]),t[2]=Dw(a,t[2]),t[3]=Dw(o,t[3]),t[4]=Dw(s,t[4]),t[5]=Dw(r,t[5]),t[6]=Dw(l,t[6]),t[7]=Dw(c,t[7]),t}let Ww=class extends Tw{constructor(e,t,n){if("SHA-224"!==e&&"SHA-256"!==e)throw new Error(Sw);super(e,t,n);const i=n||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=vw(this.t,this.i,this.T),this.v=Vw,this.L=function(e){return e.slice()},this.B=Gw,this.F=function(t,n,i,a){return function(e,t,n,i,a){let o,s;const r=15+(t+65>>>9<<4),l=t+n;for(;e.length<=r;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[r]=4294967295&l,e[r-1]=l/bw|0,o=0;o<e.length;o+=16)i=Vw(e.slice(o,o+16),i);return s="SHA-224"===a?[i[0],i[1],i[2],i[3],i[4],i[5],i[6]]:i,s}(t,n,i,a,e)},this.U=Gw(e),this.m=512,this.R="SHA-224"===e?224:256,this.K=!1,i.hmacKey&&this.k(Iw("hmacKey",i.hmacKey,this.T))}};class Qw{constructor(e,t){this.N=e,this.I=t}}function Kw(e,t){let n;return t>32?(n=64-t,new Qw(e.I<<t|e.N>>>n,e.N<<t|e.I>>>n)):0!==t?(n=32-t,new Qw(e.N<<t|e.I>>>n,e.I<<t|e.N>>>n)):e}function Yw(e,t){let n;return t<32?(n=32-t,new Qw(e.N>>>t|e.I<<n,e.I>>>t|e.N<<n)):(n=64-t,new Qw(e.I>>>t|e.N<<n,e.N>>>t|e.I<<n))}function Xw(e,t){return new Qw(e.N>>>t,e.I>>>t|e.N<<32-t)}function Jw(e,t,n){return new Qw(e.N&t.N^e.N&n.N^t.N&n.N,e.I&t.I^e.I&n.I^t.I&n.I)}function Zw(e){const t=Yw(e,28),n=Yw(e,34),i=Yw(e,39);return new Qw(t.N^n.N^i.N,t.I^n.I^i.I)}function e_(e,t){let n,i;n=(65535&e.I)+(65535&t.I),i=(e.I>>>16)+(t.I>>>16)+(n>>>16);const a=(65535&i)<<16|65535&n;return n=(65535&e.N)+(65535&t.N)+(i>>>16),i=(e.N>>>16)+(t.N>>>16)+(n>>>16),new Qw((65535&i)<<16|65535&n,a)}function t_(e,t,n,i){let a,o;a=(65535&e.I)+(65535&t.I)+(65535&n.I)+(65535&i.I),o=(e.I>>>16)+(t.I>>>16)+(n.I>>>16)+(i.I>>>16)+(a>>>16);const s=(65535&o)<<16|65535&a;return a=(65535&e.N)+(65535&t.N)+(65535&n.N)+(65535&i.N)+(o>>>16),o=(e.N>>>16)+(t.N>>>16)+(n.N>>>16)+(i.N>>>16)+(a>>>16),new Qw((65535&o)<<16|65535&a,s)}function n_(e,t,n,i,a){let o,s;o=(65535&e.I)+(65535&t.I)+(65535&n.I)+(65535&i.I)+(65535&a.I),s=(e.I>>>16)+(t.I>>>16)+(n.I>>>16)+(i.I>>>16)+(a.I>>>16)+(o>>>16);const r=(65535&s)<<16|65535&o;return o=(65535&e.N)+(65535&t.N)+(65535&n.N)+(65535&i.N)+(65535&a.N)+(s>>>16),s=(e.N>>>16)+(t.N>>>16)+(n.N>>>16)+(i.N>>>16)+(a.N>>>16)+(o>>>16),new Qw((65535&s)<<16|65535&o,r)}function i_(e,t){return new Qw(e.N^t.N,e.I^t.I)}function a_(e){const t=Yw(e,19),n=Yw(e,61),i=Xw(e,6);return new Qw(t.N^n.N^i.N,t.I^n.I^i.I)}function o_(e){const t=Yw(e,1),n=Yw(e,8),i=Xw(e,7);return new Qw(t.N^n.N^i.N,t.I^n.I^i.I)}function s_(e){const t=Yw(e,14),n=Yw(e,18),i=Yw(e,41);return new Qw(t.N^n.N^i.N,t.I^n.I^i.I)}const r_=[new Qw(xw[0],3609767458),new Qw(xw[1],602891725),new Qw(xw[2],3964484399),new Qw(xw[3],2173295548),new Qw(xw[4],4081628472),new Qw(xw[5],3053834265),new Qw(xw[6],2937671579),new Qw(xw[7],3664609560),new Qw(xw[8],2734883394),new Qw(xw[9],1164996542),new Qw(xw[10],1323610764),new Qw(xw[11],3590304994),new Qw(xw[12],4068182383),new Qw(xw[13],991336113),new Qw(xw[14],633803317),new Qw(xw[15],3479774868),new Qw(xw[16],2666613458),new Qw(xw[17],944711139),new Qw(xw[18],2341262773),new Qw(xw[19],2007800933),new Qw(xw[20],1495990901),new Qw(xw[21],1856431235),new Qw(xw[22],3175218132),new Qw(xw[23],2198950837),new Qw(xw[24],3999719339),new Qw(xw[25],766784016),new Qw(xw[26],2566594879),new Qw(xw[27],3203337956),new Qw(xw[28],1034457026),new Qw(xw[29],2466948901),new Qw(xw[30],3758326383),new Qw(xw[31],168717936),new Qw(xw[32],1188179964),new Qw(xw[33],1546045734),new Qw(xw[34],1522805485),new Qw(xw[35],2643833823),new Qw(xw[36],2343527390),new Qw(xw[37],1014477480),new Qw(xw[38],1206759142),new Qw(xw[39],344077627),new Qw(xw[40],1290863460),new Qw(xw[41],3158454273),new Qw(xw[42],3505952657),new Qw(xw[43],106217008),new Qw(xw[44],3606008344),new Qw(xw[45],1432725776),new Qw(xw[46],1467031594),new Qw(xw[47],851169720),new Qw(xw[48],3100823752),new Qw(xw[49],1363258195),new Qw(xw[50],3750685593),new Qw(xw[51],3785050280),new Qw(xw[52],3318307427),new Qw(xw[53],3812723403),new Qw(xw[54],2003034995),new Qw(xw[55],3602036899),new Qw(xw[56],1575990012),new Qw(xw[57],1125592928),new Qw(xw[58],2716904306),new Qw(xw[59],442776044),new Qw(xw[60],593698344),new Qw(xw[61],3733110249),new Qw(xw[62],2999351573),new Qw(xw[63],3815920427),new Qw(3391569614,3928383900),new Qw(3515267271,566280711),new Qw(3940187606,3454069534),new Qw(4118630271,4000239992),new Qw(116418474,1914138554),new Qw(174292421,2731055270),new Qw(289380356,3203993006),new Qw(460393269,320620315),new Qw(685471733,587496836),new Qw(852142971,1086792851),new Qw(1017036298,365543100),new Qw(1126000580,2618297676),new Qw(1288033470,3409855158),new Qw(1501505948,4234509866),new Qw(1607167915,987167468),new Qw(1816402316,1246189591)];function l_(e){return"SHA-384"===e?[new Qw(3418070365,ww[0]),new Qw(1654270250,ww[1]),new Qw(2438529370,ww[2]),new Qw(355462360,ww[3]),new Qw(1731405415,ww[4]),new Qw(41048885895,ww[5]),new Qw(3675008525,ww[6]),new Qw(1203062813,ww[7])]:[new Qw(_w[0],4089235720),new Qw(_w[1],2227873595),new Qw(_w[2],4271175723),new Qw(_w[3],1595750129),new Qw(_w[4],2917565137),new Qw(_w[5],725511199),new Qw(_w[6],4215389547),new Qw(_w[7],327033209)]}function c_(e,t){let n,i,a,o,s,r,l,c,u,d,h,p;const m=[];for(n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],r=t[5],l=t[6],c=t[7],h=0;h<80;h+=1)h<16?(p=2*h,m[h]=new Qw(e[p],e[p+1])):m[h]=t_(a_(m[h-2]),m[h-7],o_(m[h-15]),m[h-16]),u=n_(c,s_(s),(g=r,v=l,new Qw((f=s).N&g.N^~f.N&v.N,f.I&g.I^~f.I&v.I)),r_[h],m[h]),d=e_(Zw(n),Jw(n,i,a)),c=l,l=r,r=s,s=e_(o,u),o=a,a=i,i=n,n=e_(u,d);var f,g,v;return t[0]=e_(n,t[0]),t[1]=e_(i,t[1]),t[2]=e_(a,t[2]),t[3]=e_(o,t[3]),t[4]=e_(s,t[4]),t[5]=e_(r,t[5]),t[6]=e_(l,t[6]),t[7]=e_(c,t[7]),t}let u_=class extends Tw{constructor(e,t,n){if("SHA-384"!==e&&"SHA-512"!==e)throw new Error(Sw);super(e,t,n);const i=n||{};this.g=this.Y,this.M=!0,this.T=-1,this.C=vw(this.t,this.i,this.T),this.v=c_,this.L=function(e){return e.slice()},this.B=l_,this.F=function(t,n,i,a){return function(e,t,n,i,a){let o,s;const r=31+(t+129>>>10<<5),l=t+n;for(;e.length<=r;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[r]=4294967295&l,e[r-1]=l/bw|0,o=0;o<e.length;o+=32)i=c_(e.slice(o,o+32),i);return s="SHA-384"===a?[i[0].N,i[0].I,i[1].N,i[1].I,i[2].N,i[2].I,i[3].N,i[3].I,i[4].N,i[4].I,i[5].N,i[5].I]:[i[0].N,i[0].I,i[1].N,i[1].I,i[2].N,i[2].I,i[3].N,i[3].I,i[4].N,i[4].I,i[5].N,i[5].I,i[6].N,i[6].I,i[7].N,i[7].I],s}(t,n,i,a,e)},this.U=l_(e),this.m=1024,this.R="SHA-384"===e?384:512,this.K=!1,i.hmacKey&&this.k(Iw("hmacKey",i.hmacKey,this.T))}};const d_=[new Qw(0,1),new Qw(0,32898),new Qw(2147483648,32906),new Qw(2147483648,2147516416),new Qw(0,32907),new Qw(0,2147483649),new Qw(2147483648,2147516545),new Qw(2147483648,32777),new Qw(0,138),new Qw(0,136),new Qw(0,2147516425),new Qw(0,2147483658),new Qw(0,2147516555),new Qw(2147483648,139),new Qw(2147483648,32905),new Qw(2147483648,32771),new Qw(2147483648,32770),new Qw(2147483648,128),new Qw(0,32778),new Qw(2147483648,2147483658),new Qw(2147483648,2147516545),new Qw(2147483648,32896),new Qw(0,2147483649),new Qw(2147483648,2147516424)],h_=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function p_(e){let t;const n=[];for(t=0;t<5;t+=1)n[t]=[new Qw(0,0),new Qw(0,0),new Qw(0,0),new Qw(0,0),new Qw(0,0)];return n}function m_(e){let t;const n=[];for(t=0;t<5;t+=1)n[t]=e[t].slice();return n}function f_(e,t){let n,i,a,o;const s=[],r=[];if(null!==e)for(i=0;i<e.length;i+=2)t[(i>>>1)%5][(i>>>1)/5|0]=i_(t[(i>>>1)%5][(i>>>1)/5|0],new Qw(e[i+1],e[i]));for(n=0;n<24;n+=1){for(o=p_(),i=0;i<5;i+=1)s[i]=(l=t[i][0],c=t[i][1],u=t[i][2],d=t[i][3],h=t[i][4],new Qw(l.N^c.N^u.N^d.N^h.N,l.I^c.I^u.I^d.I^h.I));for(i=0;i<5;i+=1)r[i]=i_(s[(i+4)%5],Kw(s[(i+1)%5],1));for(i=0;i<5;i+=1)for(a=0;a<5;a+=1)t[i][a]=i_(t[i][a],r[i]);for(i=0;i<5;i+=1)for(a=0;a<5;a+=1)o[a][(2*i+3*a)%5]=Kw(t[i][a],h_[i][a]);for(i=0;i<5;i+=1)for(a=0;a<5;a+=1)t[i][a]=i_(o[i][a],new Qw(~o[(i+1)%5][a].N&o[(i+2)%5][a].N,~o[(i+1)%5][a].I&o[(i+2)%5][a].I));t[0][0]=i_(t[0][0],d_[n])}var l,c,u,d,h;return t}function g_(e){let t,n,i=0;const a=[0,0],o=[4294967295&e,e/bw&2097151];for(t=6;t>=0;t--)n=o[t>>2]>>>8*t&255,0===n&&0===i||(a[i+1>>2]|=n<<8*(i+1),i+=1);return i=0!==i?i:1,a[0]|=i,{value:i+1>4?a:[a[0]],binLen:8+8*i}}function v_(e){return Ew(g_(e.binLen),e)}function y_(e,t){let n,i=g_(t);i=Ew(i,e);const a=t>>>2,o=(a-i.value.length%a)%a;for(n=0;n<o;n++)i.value.push(0);return i.value}let b_=class extends Tw{constructor(e,t,n){let i=6,a=0;super(e,t,n);const o=n||{};if(1!==this.numRounds){if(o.kmacKey||o.hmacKey)throw new Error(Cw);if("CSHAKE128"===this.o||"CSHAKE256"===this.o)throw new Error("Cannot set numRounds for CSHAKE variants")}switch(this.T=1,this.C=vw(this.t,this.i,this.T),this.v=f_,this.L=m_,this.B=p_,this.U=p_(),this.K=!1,e){case"SHA3-224":this.m=a=1152,this.R=224,this.M=!0,this.g=this.Y;break;case"SHA3-256":this.m=a=1088,this.R=256,this.M=!0,this.g=this.Y;break;case"SHA3-384":this.m=a=832,this.R=384,this.M=!0,this.g=this.Y;break;case"SHA3-512":this.m=a=576,this.R=512,this.M=!0,this.g=this.Y;break;case"SHAKE128":i=31,this.m=a=1344,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"SHAKE256":i=31,this.m=a=1088,this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"KMAC128":i=4,this.m=a=1344,this.X(n),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"KMAC256":i=4,this.m=a=1088,this.X(n),this.R=-1,this.K=!0,this.M=!1,this.g=this._;break;case"CSHAKE128":this.m=a=1344,i=this.O(n),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;case"CSHAKE256":this.m=a=1088,i=this.O(n),this.R=-1,this.K=!0,this.M=!1,this.g=null;break;default:throw new Error(Sw)}this.F=function(e,t,n,o,s){return function(e,t,n,i,a,o,s){let r,l,c=0;const u=[],d=a>>>5,h=t>>>5;for(r=0;r<h&&t>=a;r+=d)i=f_(e.slice(r,r+d),i),t-=a;for(e=e.slice(r),t%=a;e.length<d;)e.push(0);for(r=t>>>3,e[r>>2]^=o<<r%4*8,e[d-1]^=2147483648,i=f_(e,i);32*u.length<s&&(l=i[c%5][c/5|0],u.push(l.I),!(32*u.length>=s));)u.push(l.N),c+=1,0==64*c%a&&(f_(null,i),c=0);return u}(e,t,0,o,a,i,s)},o.hmacKey&&this.k(Iw("hmacKey",o.hmacKey,this.T))}O(e,t){const n=function(e){const t=e||{};return{funcName:Iw("funcName",t.funcName,1,{value:[],binLen:0}),customization:Iw("Customization",t.customization,1,{value:[],binLen:0})}}(e||{});t&&(n.funcName=t);const i=Ew(v_(n.funcName),v_(n.customization));if(0!==n.customization.binLen||0!==n.funcName.binLen){const e=y_(i,this.m>>>3);for(let t=0;t<e.length;t+=this.m>>>5)this.U=this.v(e.slice(t,t+(this.m>>>5)),this.U),this.A+=this.m;return 4}return 31}X(e){const t=function(e){const t=e||{};return{kmacKey:Iw("kmacKey",t.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:Iw("Customization",t.customization,1,{value:[],binLen:0})}}(e||{});this.O(e,t.funcName);const n=y_(v_(t.kmacKey),this.m>>>3);for(let i=0;i<n.length;i+=this.m>>>5)this.U=this.v(n.slice(i,i+(this.m>>>5)),this.U),this.A+=this.m;this.H=!0}_(e){const t=Ew({value:this.h.slice(),binLen:this.u},function(e){let t,n,i=0;const a=[0,0],o=[4294967295&e,e/bw&2097151];for(t=6;t>=0;t--)n=o[t>>2]>>>8*t&255,0===n&&0===i||(a[i>>2]|=n<<8*i,i+=1);return i=0!==i?i:1,a[i>>2]|=i<<8*i,{value:i+1>4?a:[a[0]],binLen:8+8*i}}(e.outputLen));return this.F(t.value,t.binLen,this.A,this.L(this.U),e.outputLen)}};class x_{constructor(e,t,n){if("SHA-1"==e)this.P=new qw(e,t,n);else if("SHA-224"==e||"SHA-256"==e)this.P=new Ww(e,t,n);else if("SHA-384"==e||"SHA-512"==e)this.P=new u_(e,t,n);else{if("SHA3-224"!=e&&"SHA3-256"!=e&&"SHA3-384"!=e&&"SHA3-512"!=e&&"SHAKE128"!=e&&"SHAKE256"!=e&&"CSHAKE128"!=e&&"CSHAKE256"!=e&&"KMAC128"!=e&&"KMAC256"!=e)throw new Error(Sw);this.P=new b_(e,t,n)}}update(e){return this.P.update(e),this}getHash(e,t){return this.P.getHash(e,t)}setHMACKey(e,t,n){this.P.setHMACKey(e,t,n)}getHMAC(e,t){return this.P.getHMAC(e,t)}}const w_=e=>{const t=new x_("SHA-256","TEXT",{numRounds:1});return t.update(e),t.getHash("HEX")},__=(e=!0)=>j(void 0,null,function*(){return yield ow("/auths/",{baseURL:"/api/v1",toast:e})}),S_=e=>j(void 0,null,function*(){const t=w_(e.password),n={email:e.email,password:t};return yield ow("/auths/signin",{method:"POST",data:n})}),C_=e=>j(void 0,null,function*(){const t=w_(e.password),n=_(w({},e),{password:t});return yield ow("/auths/signup",{baseURL:"/api/v1",method:"POST",data:n})}),E_=e=>j(void 0,null,function*(){return yield ow(`/users/logout/${e.userId}`,{method:"POST"})}),k_=()=>j(void 0,null,function*(){return yield ow("/auths/signout")}),I_=e=>j(void 0,null,function*(){return yield ow("/auths/reset/password",{baseURL:"/api/v1",method:"POST",data:e})}),T_=e=>j(void 0,null,function*(){const t=w_(e.password),n=w_(e.newPassword);return yield ow("/auths/update/password",{method:"POST",data:{password:t,new_password:n}})}),j_=e=>j(void 0,null,function*(){return yield ow("/auths/update/profile",{method:"POST",data:e})}),N_=()=>j(void 0,null,function*(){return yield ow("/chats/",{method:"DELETE"})}),P_=()=>j(void 0,null,function*(){return yield ow("/chats/all")}),M_=e=>j(void 0,null,function*(){return yield uw(),yield ow("/chats/",{params:e})}),A_=()=>j(void 0,null,function*(){return yield ow("/chats/pinned")}),O_=e=>j(void 0,null,function*(){return yield ow("/chats/search",{params:e})}),R_=(e,t)=>j(void 0,null,function*(){var n;const i=_(w({},t),{toast:null!=(n=null==t?void 0:t.toast)?n:!$x()});return yield uw(),yield ow(`/chats/${e.chat_id}`,i)}),D_=e=>j(void 0,null,function*(){const{chat_id:t,chat:n}=e,{title:i,tags:a,history:o,permission:s}=n||{},{currentId:r,currentResponseIds:l}=o||{},c={};return i&&(c.title=i),r&&(c.currentId=r),l&&(c.currentResponseIds=l),a&&(c.tags=a),s&&(c.permission=s),yield ow(`/chats/${t}`,{method:"POST",data:c})}),L_=e=>j(void 0,null,function*(){return yield ow(`/chats/${e.chat_id}/folder`,{method:"POST",data:{folder_id:e.folder_id}})}),F_=e=>j(void 0,null,function*(){return yield ow(`/chats/${e.chat_id}/messages/${e.message_id}`,{method:"POST",data:{content:e.content,content_list:e.content_list}})}),z_=e=>j(void 0,null,function*(){const t=new FormData;return t.append("file",e.file),yield ow("/chats/import",{method:"POST",headers:{"Content-Type":"multipart/form-data"},transformRequest:[e=>e],data:t})}),U_=e=>j(void 0,null,function*(){return yield ow(`/chats/folder/${e.folder_id}`)}),H_=()=>j(void 0,null,function*(){return yield ow("/chats/all/archived")}),B_=()=>j(void 0,null,function*(){return yield ow("/chats/archive/all",{method:"POST"})}),$_=()=>j(void 0,null,function*(){return yield ow("/chats/archived")}),q_=e=>j(void 0,null,function*(){return yield ow(`/chats/${e||"all"}/archive`,{method:"POST"})}),G_=e=>j(void 0,null,function*(){return yield ow(`/chats/${e}`,{method:"DELETE"})}),V_=e=>j(void 0,null,function*(){return yield ow(`/chats/${e}/pin`,{method:"POST"})}),W_=e=>j(void 0,null,function*(){return yield ow(`/chats/${e}/clone`,{method:"POST"})}),Q_=e=>j(void 0,null,function*(){return yield ow(`/chats/${e}/share`,{method:"DELETE"})}),K_=e=>j(void 0,null,function*(){return yield ow("/filter/content",{baseURL:"/api",method:"POST",data:e})}),Y_=e=>j(void 0,null,function*(){return yield ow("/share/message/cancel",{method:"POST",data:{share_id:e.id}})}),X_=e=>j(void 0,null,function*(){return yield uw(),yield ow(`/chats/${e.chatId}/check`,{method:"GET"})}),J_=()=>{const e=location.pathname,t={[String("/"===e)]:{spmB:"29997169",pageId:`//${window.location.host}/`},[String("/c/new-chat"===e)]:{spmB:"29997170",pageId:`//${window.location.host}/c/new-chat`},[String("/c/new-branch"===e)]:{spmB:"29997171",pageId:`//${window.location.host}/c/new-branch`},[String(e.startsWith("/c/")&&"/c/new-branch"!==e&&"/c/new-chat"!==e)]:{spmB:"29997173",pageId:`//${window.location.host}/c/`},[String(e.startsWith("/s/"))]:{spmB:"29997178",pageId:`//${window.location.host}/s/`},[String(e.startsWith("/p/"))]:{spmB:"41591450",pageId:`//${window.location.host}/p/`},[String("/auth"===e)]:{spmB:"29997180",pageId:`//${window.location.host}/auth`},[String("/authorize"===e)]:{spmB:"30620387",pageId:`//${window.location.host}/authorize`},[String("/error"===e||e.startsWith("/error"))]:{spmB:"29997183",pageId:`//${window.location.host}/error`},[String("/legal-agreement/privacy-policy"===e||e.startsWith("/legal-agreement/privacy-policy"))]:{spmB:"29997187",pageId:`//${window.location.host}/legal-agreement/privacy-policy`},[String("/legal-agreement/terms-of-service"===e||e.startsWith("/legal-agreement/terms-of-service"))]:{spmB:"29997190",pageId:`//${window.location.host}/legal-agreement/terms-of-service`},[String("/forget"===e||e.startsWith("/forget"))]:{spmB:"29997194",pageId:`//${window.location.host}/forget`},[String("/reset"===e||e.startsWith("/reset"))]:{spmB:"29997199",pageId:`//${window.location.host}/reset`},[String(e.startsWith("/mobile/chat"))]:{spmB:"29997173",pageId:`//${window.location.host}/mobile/chat`},[String(e.startsWith("/settings/general"))]:{spmB:"30233031",pageId:`//${window.location.host}/settings/general`},[String(e.startsWith("/settings/interface"))]:{spmB:"30233032",pageId:`//${window.location.host}/settings/interface`},[String(e.startsWith("/settings/privacy-policy"))]:{spmB:"29997187",pageId:`//${window.location.host}/settings/privacy-policy`},[String(e.startsWith("/settings/terms-of-service"))]:{spmB:"29997190",pageId:`//${window.location.host}/settings/terms-of-service`},[String(e.startsWith("/settings/model"))]:{spmB:"30233033",pageId:`//${window.location.host}/settings/model`},[String(e.startsWith("/settings/chats"))]:{spmB:"30233034",pageId:`//${window.location.host}/settings/chats`},[String(e.startsWith("/settings/personalization/memory"))]:{spmB:"30233038",pageId:`//${window.location.host}/settings/personalization/memory`},[String(e.startsWith("/settings/personalization/custom-instr"))]:{spmB:"30233039",pageId:`//${window.location.host}/settings/personalization/custom-instr`},[String("/settings/personalization"===e)]:{spmB:"30233035",pageId:`//${window.location.host}/settings/personalization`},[String(e.startsWith("/settings/account"))]:{spmB:"30233036",pageId:`//${window.location.host}/settings/account`},[String(e.startsWith("/settings/about"))]:{spmB:"30233037",pageId:`//${window.location.host}/settings/about`},[String(e.startsWith("/settings/languages"))]:{spmB:"30233051",pageId:`//${window.location.host}/settings/languages`},[String(e.startsWith("/settings/theme"))]:{spmB:"30233052",pageId:`//${window.location.host}/settings/theme`},[String(e.startsWith("/settings/voice"))]:{spmB:"30233053",pageId:`//${window.location.host}/settings/voice`},[String(e.startsWith("/settings/contact-us"))]:{spmB:"30233054",pageId:`//${window.location.host}/settings/contact-us`},[String(e.startsWith("/settings/change-password"))]:{spmB:"30233055",pageId:`//${window.location.host}/settings/change-password`},[String("/settings"===e)]:{spmB:"30233050",pageId:`//${window.location.host}/settings`}};return t.true||{spmB:"not exist",pageId:"not exist"}},Z_=e=>{const t=window.location.search.slice(1);if(!t)return null;return new URLSearchParams(t).get(e)||null},eS=()=>window.userId||"";let tS=window.aes||null;const nS=window.location.host;let iS=[],aS=[],oS=null,sS=null,rS=null;const lS={"internal-qwenlm.alibaba-inc.com":"prod","chat.qwenlm.ai":"prod","qwenlm.ai":"prod","qwen.ai":"prod","chat.qwen.ai":"prod","qwenchat.com":"prod","pre-chat.qwenlm.ai":"pre","pre-qwenlm.alibaba-inc.com":"pre","pre-chat.qwen.ai":"pre","pre2-chat.qwen.ai":"pre","pre2-chat.qwenlm.ai":"pre","dev.aliyun.com":"dev"}[nS]||"dev";oS=setInterval(()=>{if(tS){clearInterval(oS),sS=tS.use(window.AESPluginEvent),rS=tS.use(window.AESPluginPV,{autoPV:!1,enableHistory:!0});for(let e=0;e<aS.length;e++)rS.switchPage({page_id:aS[e].page_id,dim1:aS[e].userId});aS=[];for(let e=0;e<iS.length;e++)sS(iS[e].eventId,iS[e].params);iS=[]}else tS=window.aes},500);const cS=(e,t)=>{const{params:n,aesParams:i}=t||{};tS&&sS?sS(e,_(w(w({c1:eS()},n),i),{c10:"0.1.38"})):iS.push({eventId:e,params:w({c1:eS()},n)})},uS=e=>{var t,n;const i=window.aplus_queue||(window.aplus_queue=[]),a={};if(a.typarm1=zx()?"app":Gx()?"desktop":"pc"===Ox()?"web":"h5",a.typarm2=e||eS(),i.push({action:"aplus.setUserProfile",arguments:[{uidaplus:e||eS()}]}),a.typarm3=lS,a.typarm4="qwen_chat",a.typarm5=location.pathname.startsWith("/s/")?"share":"product",a.orgid="tongyi",(null==(t=J_())?void 0:t.pageId)===`//${window.location.host}/s/`){const e=location.pathname.replace(/\/s\//g,"");a.share_id=e.replace(/\//g,"")}if((null==(n=J_())?void 0:n.pageId)===`//${window.location.host}/p/`){const e=location.pathname.replace(/\/p\//g,"");a.project_id=e.replace(/\//g,"")}return Z_("qsrc")&&(a.channel_type=Z_("qsrc")),"share"===Z_("qsrc")&&Z_("share_id")&&(a.from_id=Z_("share_id")),a.cdn_version="0.1.38",a},dS=(e,t)=>{((e,t)=>{const{params:n,paramsExtend:i}=t,{et:a}=n,o=uS(),s=w(w(w({},o),n),i);let r="";for(const c in s){const e=s[c];"et"!==c&&e&&(r+=`&${c}=${e}`)}let l=a;"OTHER"===a&&(l="self_define"),(window.aplus_queue||(window.aplus_queue=[])).push({action:"aplus.record",arguments:[`/tongyi-sg.qwen_chat.${e}`,l,r]})})(e,t),cS(e,t)},hS=e=>{var t,n;if(((e="a2ty_o01")=>{const{spmB:t}=J_()||{};if(!t)return;(window.aplus_queue||(window.aplus_queue=[])).push({action:"aplus.setPageSPM",arguments:[e,`${t}`]})})(),$x())return;(e=>{let t=uS(e);t=w({},t),(window.aplus_queue||(window.aplus_queue=[])).push({action:"aplus.appendMetaInfo",arguments:["aplus-cpvdata",t]})})(e||""),(window.aplus_queue||(window.aplus_queue=[])).push({action:"aplus.sendPV",arguments:[{is_auto:!1},{}]});const{spmB:i,pageId:a}=J_()||{};var o;o=_(w({},uS(e)),{spmId:`a2ty_o01.${i}`,aemPageId:a,domain:nS}),j(void 0,null,function*(){return yield ow("/users/status",{method:"POST",data:{typarms:o}})}),tS&&rS?rS.switchPage({page_id:null==(n=J_())?void 0:n.pageId,dim1:e||""}):aS.push({userId:e||"",page_id:null==(t=J_())?void 0:t.pageId})},pS=e=>j(void 0,null,function*(){return yield ow("/chat/completions/stop",{method:"post",params:{chat_id:e.chat_id},headers:{"X-Accel-Buffering":"no"},data:e})}),mS=()=>j(void 0,null,function*(){return yield ow("/configs/")}),fS=e=>j(void 0,null,function*(){return yield uw(),yield ow("files/getfilelink",{method:"POST",data:e})}),gS=e=>j(void 0,null,function*(){return yield ow("/folders/",{method:"POST",data:e})}),vS=e=>j(void 0,null,function*(){return yield ow(`/folders/${e.id}/update`,{method:"POST",data:{name:e.name}})}),yS=e=>j(void 0,null,function*(){return yield ow(`/folders/${e.id}/update/expanded`,{method:"POST",data:{is_expanded:e.is_expanded}})}),bS=e=>j(void 0,null,function*(){return yield ow(`/folders/${e.id}/update/parent`,{method:"POST",data:{parent_id:e.parent_id}})}),xS=e=>j(void 0,null,function*(){return yield ow(`/folders/${e.id}`,{method:"DELETE"})}),wS=(...e)=>j(void 0,[...e],function*(e={page_size:50,page_num:1}){return yield ow(`memories/?page_size=${e.page_size}&page_num=${e.page_num}`,{method:"GET"})}),_S=e=>j(void 0,null,function*(){return yield ow("/memories/delete",{method:"POST",data:e})}),SS=e=>j(void 0,null,function*(){const t=(()=>{const e={os_group:Wx()};return zx()?(e.terminal_type="app",e.app_version=Bx()):jx()?e.terminal_type="h5":e.terminal_type="web",e})();return yield ow("/users/user/audio_chat_token",{method:"POST",data:_(w({},e),{client_info:t})})}),CS=e=>j(void 0,null,function*(){return yield ow("/users/user/settings/update",{method:"POST",data:e})}),ES=e=>j(void 0,null,function*(){const t=w_(null==e?void 0:e.new_password);return yield ow("/users/reset/password",{baseURL:"/api/v1",method:"POST",data:_(w({},e),{new_password:t})})}),kS=(e,t)=>j(void 0,null,function*(){return yield ow(`/projects/${t}`,{method:"PUT",data:e})}),IS=e=>j(void 0,null,function*(){return yield ow(`/projects/${e}/files`)}),TS=(e,t)=>j(void 0,null,function*(){return yield ow(`/chats/?project_id=${e}&page=${t}`)}),jS=(e,t)=>j(void 0,null,function*(){return yield ow("/projects/add_chat",{method:"POST",data:JSON.stringify({chat_ids:t,project_id:e})})}),NS=e=>j(void 0,null,function*(){return yield ow(`/projects/${e}`)}),PS=(...e)=>j(void 0,[...e],function*(e=window.location.origin){return yield ow("/payment/subscribe",{method:"POST",data:{root_path:e}})}),MS=(...e)=>j(void 0,[...e],function*(e=window.location.origin){return yield ow("/payment/compensation_subscription",{method:"POST",data:{root_path:e}})}),AS=e=>j(void 0,null,function*(){return yield ow(`/payment/payment_status?payment_request_id=${e}`)}),OS=()=>j(void 0,null,function*(){return yield ow("/payment/cancel_subscription",{method:"POST"})}),RS=()=>j(void 0,null,function*(){return yield ow("/payment/active_subscription",{method:"POST"})}),DS=()=>j(void 0,null,function*(){return yield ow("/payment/payment_method")}),LS=(...e)=>j(void 0,[...e],function*(e=window.location.origin){return yield ow("/payment/add_payment_method",{method:"POST",data:{root_path:e}})}),FS=e=>j(void 0,null,function*(){return yield ow(`/payment/add_payment_method_status?vaulting_request_id=${e}`)}),zS=e=>j(void 0,null,function*(){return yield ow("/payment/update_default_method",{method:"POST",data:{payment_method_id:e}})}),US=e=>j(void 0,null,function*(){return yield ow("/payment/delete_payment_method",{method:"POST",data:{payment_method_id:e}})}),HS=(e=1,t=10)=>j(void 0,null,function*(){return yield ow(`/payment/invoice?page_no=${e}&page_size=${t}`)}),BS=e=>j(void 0,null,function*(){return yield ow("/notifications/delete_notification",{method:"POST",data:{types:e}})}),$S=()=>j(void 0,null,function*(){return yield ow("/payment/clear",{method:"POST",data:{}})}),qS=()=>j(void 0,null,function*(){return yield ow("/payment/disable_default_payment_method",{method:"POST",data:{}})}),GS=()=>{var e;return(null==(e=window.performance)?void 0:e.now)?window.performance.now():Date.now()};const VS=e=>{var t;let n=!1;const i=document.createElement("div");i.id="selectableDiv",i.textContent=e,i.style.top="0",i.style.left="0",i.style.position="fixed",document.body.appendChild(i);try{const e=window.getSelection(),a=document.createRange();a.selectNodeContents(i),null==e||e.removeAllRanges(),null==e||e.addRange(a);document.execCommand("copy")&&(n=!0),null==(t=null==window?void 0:window.getSelection())||t.removeAllRanges(),i.blur()}catch(IX){}finally{document.body.removeChild(i)}return n},WS=e=>j(void 0,null,function*(){let t=!1;const n=function(){const e=navigator.userAgent||navigator.vendor||window.opera||"";return/DingTalk/i.test(e)}();if(!navigator.clipboard||n)return t=VS(e),t;try{yield navigator.clipboard.writeText(e),t=!0}catch(i){try{const n=new ClipboardItem({"text/plain":new Blob([e],{type:"text/plain"})});yield navigator.clipboard.write([n]),t=!0}catch(a){t=VS(e)}}return t}),QS=(e,...t)=>j(void 0,[e,...t],function*(e,t=Pv("Copying to clipboard was successful!")){(yield WS(e))&&ht.open({type:"success",content:t})});function KS(e,t=null){try{return JSON.parse(e)}catch(kX){return t}}const YS=e=>{var t;return!!(null==(t=null==e?void 0:e.meta)?void 0:t.translateLanguage)},XS=(e,t)=>{const n=e=>"string"!=typeof e?e:e.includes(",")||e.includes('"')||e.includes("\n")?`"${e.replace(/"/g,'""')}"`:e,i=e.header.map(e=>e.tokens.map(e=>n(e.text)).join("")),a=e.rows.map(e=>e.map(e=>e.tokens.map(e=>n(e.text)).join(""))),o=i.join(","),s=a.map(e=>e.join(",")).join("\n"),r=new Blob(["\ufeff"+o+"\n"+s],{type:"text/csv;charset=UTF-8"});Tx(r,t)},JS=(e,t)=>j(void 0,null,function*(){const n=e.header.map(e=>e.text),i=e.rows.map(e=>{const t={};return e.forEach((e,i)=>{t[n[i]]=e.text}),t}),a=zt.json_to_sheet(i),o=zt.book_new();zt.book_append_sheet(o,a),zt.sheet_add_aoa(a,[n],{origin:"A1"});const s=e=>{let t=0;for(let n=0;n<e.length;n++){t+=e.charCodeAt(n)<=127?1:2.5}return t},r=n.map(e=>({wch:Math.max(10,Math.min(30,Math.max(s(e),...i.map(t=>s(t[e])))))}));a["!cols"]=r,Ut(o,`${t}`,{compression:!0})});function ZS(e){return e?Q(1e3*e).format("DD/MM/YYYY HH:mm"):""}function eC(e){try{const t=new URL(e),n=t.pathname.split("/").pop(),i=null==n?void 0:n.split(".").pop();return i===n?"":null==i?void 0:i.toLowerCase()}catch(kX){return""}}const tC=(e,t)=>j(void 0,null,function*(){var n;const i=new File([e],t,{lastModified:(new Date).getTime()}),a=yield(e=>j(void 0,null,function*(){const t=new FormData;t.append("file",e);let n=null;const i=yield ow(`${$f}/files/`,{method:"POST",data:t}).then(e=>j(void 0,null,function*(){if(!e.ok)throw yield e.json();return e.json()})).catch(e=>(n=e.detail,null));if(n)throw n;return i}))(i);if(a.error)throw a.error;const o=`${$f}/files/${a.id}/content`;null==(n=window.open(o,"_self"))||n.focus()}),nC=e=>{if(null==e)return"Unknown size";if("number"!=typeof e||e<0)return"Invalid size";if(0===e)return"0 B";const t=["B","KB","MB","GB","TB"];let n=0;for(;e>=1024&&n<t.length-1;)e/=1024,n++;return`${e.toFixed(1)} ${t[n]}`};class iC{constructor(e,t){C(this,"extensions"),C(this,"fileTypes"),this.extensions=e,this.fileTypes=t}getAcceptSuffix(){const e=[...this.extensions].map(e=>`.${e}`);return e.push(...this.fileTypes),e}}class aC extends iC{constructor(){super([...Ag,...Tg],[...Ig,..._g])}}class oC extends iC{constructor(){super(jg,Sg)}getAcceptSuffix(){let e=super.getAcceptSuffix();const t=["image/tiff",".tif",".tiff",".dib"],n=[".dib"];return Px()&&(e=e.filter(e=>!n.includes(e))),Ax()&&(e=e.filter(e=>!t.includes(e))),e}}class sC extends iC{constructor(){super(Ng,Cg)}}class rC extends iC{constructor(){super(Pg,Eg)}}const lC=e=>{let t,n=[];switch(e){case"document":t=new aC,n=t.getAcceptSuffix();break;case"vision":t=new oC,n=t.getAcceptSuffix();break;case"video":t=new sC,n=t.getAcceptSuffix();break;case"audio":t=new rC,n=t.getAcceptSuffix()}return n},cC=(e,t)=>{if("web"===e||!e)return"web";const n=eC(t||"");return n?Tg.includes(n)?"txt":Ag.includes(n)?"doc":Pg.includes(n)?"audio":Ng.includes(n)?"video":jg.includes(n)?"vision":n:"web"},uC=(e,t,n)=>j(void 0,null,function*(){try{return yield ow("/files/share_url",{method:"POST",headers:{"Content-Type":"application/json",authorization:localStorage.token?`Bearer ${localStorage.token}`:"Bearer"},data:{file_source:e,cdn_url:t,file_id:n},baseURL:$f})}catch(IX){}return null}),dC=e=>!!e.includes("/api/v1/files"),hC=e=>!!e.includes("?key="),pC=e=>!!e.includes("x-oss-expires"),mC=(e,t,n)=>j(void 0,null,function*(){let i;if("user"===e){if(!dC(t))return t;i=yield uC("upload","",n)}else{if(hC(t))return t;i=yield uC("generate",t,"")}return(null==i?void 0:i.url)||""}),fC=(e,t)=>{e.forEach(e=>{const t=e.substring(e.lastIndexOf("/")+1);try{const n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),e.startsWith("blob:")&&window.URL.revokeObjectURL(e)}catch(n){}})},gC=e=>j(void 0,null,function*(){return yield fetch(e).then(e=>e.blob()).then(e=>{const t=window.URL.createObjectURL(e);try{return fC([t]),!0}catch(n){return!1}}).catch(e=>!1)});let vC=!1;const yC=e=>j(void 0,[e],function*({role:e="",url:t,isFile:n=!1,errorTexts:i}){if(!t&&i)return ht.openOnce({type:"error",content:(null==i?void 0:i.urlError)||Pv("Download failed: url error")}),!1;try{if(dC(t))t.startsWith("https://")||(t=`${t}/content`);else if(pC(t)){const{success:e,data:n}=yield fS({fileUrl:t});if(!e||!(null==n?void 0:n.fileUrl))return!1;t=n.fileUrl}else{hC(t)||(t=yield mC(e,t));const n=new URL(t);n.searchParams.append("download","true"),n.searchParams.append("timestamp",Date.now().toString()),t=n.toString()}if(!vC&&zx()){if(n)return!1;vC=!0}if(!(yield(e=>j(void 0,null,function*(){try{const t=yield fetch(e);if(!t.ok)throw new Error(t.statusText);return!0}catch(t){return!1}}))(t)))return ht.openOnce({type:"error",content:Pv("Download failed")}),!1;const i=document.createElement("a");i.href=t;const a=null==t?void 0:t.toString().match(/[^/\\?]+(?=\?|$)/),o=a?decodeURIComponent(a[0]):null;return o&&(i.download=o),document.body.appendChild(i),i.click(),t.startsWith("blob:")&&window.URL.revokeObjectURL(t),document.body.removeChild(i),!0}catch(a){return i&&ht.openOnce({type:"error",content:(null==i?void 0:i.downloadError)||Pv("Download failed")}),!1}}),bC=e=>{var t;if(!e.currentId)return!1;const n=e.messages[e.currentId];if("assistant"!==(null==n?void 0:n.role))return!1;const i=null==n?void 0:n.content_list;if(!Array.isArray(i))return!1;if(Array.isArray(i)){const e=i.slice(-1)[0];return(null==e?void 0:e.phase)===og.LOCAL_TOOL&&(null==(t=null==e?void 0:e.extra)?void 0:t.local_mcp)}return!1},xC=[{name:"Fetch",type:"stdio",params:{command:"uvx",args:["mcp-server-fetch"]},description:"This server enables large language models to retrieve and process content from web pages, and convert HTML to markdown for easier use."},{name:"Filesystem",type:"stdio",params:{command:"npx",args:["-y","@modelcontextprotocol/server-filesystem@latest","/Users"]},description:"A model context protocol (MCP) implemented for file system operations."},{name:"Sequential-Thinking",type:"stdio",params:{command:"npx",args:["-y","@modelcontextprotocol/server-sequential-thinking"]},description:"An MCP server implementation that provides tools for dynamic and reflective problem-solving through a structured thinking process."}],wC=()=>xC.map(({name:e,type:t,params:n,description:i})=>({id:rt(),name:e,description:i,type:t,params:n,enabled:!1,default:!0,connectionStatus:"failed",errorMessage:"",tools:[]})),_C=Hf(),SC="LOCAL_MCP_SERVER",CC={initDefaultMCPServers:()=>{const e=CC.getMCPServers(),t=e.filter(e=>!!e.default),n=e.filter(e=>!e.default),i=wC();return i.forEach(e=>{t.find(t=>{t.name===e.name&&(e.id=t.id,e.enabled=t.enabled,e.connectionStatus=t.connectionStatus,e.tools=t.tools)})}),window.localStorage.setItem(SC,JSON.stringify([...i,...n])),i},getMCPServer:e=>{const t=CC.getMCPServers(),n=t.findIndex(t=>t.name===e);return t[n]},getMCPServerById:e=>{const t=CC.getMCPServers(),n=t.findIndex(t=>t.id===e);return t[n]},getMCPServers:()=>JSON.parse(window.localStorage.getItem(SC)||"[]"),getEnabledServers:()=>CC.getMCPServers().filter(e=>e.enabled),getFormatAvailableServerMap:()=>CC.getEnabledServers().filter(e=>"available"===e.connectionStatus).reduce((e,t)=>{const n=t.tools.reduce((e,t)=>t?_(w({},e),{[t.name]:{description:t.description,input_schema:t.inputSchema}}):e,{});return _(w({},e),{[t.name]:n})},{}),addMCPServer:e=>{const t=CC.getMCPServers();t.push(e),window.localStorage.setItem(SC,JSON.stringify(t))},removeMCPServer:e=>{const t=CC.getMCPServers(),n=t.findIndex(t=>t.id===e);n>-1&&t.splice(n,1),window.localStorage.setItem(SC,JSON.stringify(t))},updateMCPServer:(e,t)=>{const n=CC.getMCPServers(),i=n.findIndex(t=>t.id===e);i>-1&&(Object.assign(n[i],t),window.localStorage.setItem(SC,JSON.stringify(n)))}},EC=e=>{const t=e.match(/Error invoking remote method '.+': (.*)/);let n=(null==t?void 0:t[1])||e||"Tool call failed";return CC.getMCPServers().forEach(e=>{n.includes(e.id)&&(n=n.replace(e.id,e.name))}),n},kC={connect:(...e)=>j(void 0,[...e],function*(e=[]){const t=[];if(!Gx())return t;const n=CC.getEnabledServers(),i=[];e.length?i.push(...n.filter(t=>e.includes(t.name))):i.push(...n.filter(e=>"failed"!==e.connectionStatus));const a=i.reduce((e,t)=>{const{type:n,name:i,params:a}=t;return _(w({},e),{[i]:_(w({name:i},a),{transportType:n})})},{});try{yield window.electronAPI.mcp_client_update_config(a);const e=[],n=[];i.forEach(t=>{e.push(t.id),n.push(window.electronAPI.mcp_client_tool_list(t.name))});(yield Promise.allSettled(n)).forEach((n,i)=>{var a;const{status:o}=n;if("fulfilled"===o&&n.value.tools&&Array.isArray(n.value.tools))CC.updateMCPServer(e[i],{tools:n.value.tools,connectionStatus:"available"});else{const s=CC.getMCPServerById(e[i]);if(s){const r="rejected"===o?null==(a=n.reason)?void 0:a.message:_C.t("Failed to connect to the MCP server.");CC.updateMCPServer(e[i],{connectionStatus:"failed",errorMessage:EC(r||"")}),t.push(s)}}})}catch(kX){t.push(...i)}return t}),isAvailable:e=>j(void 0,null,function*(){if(!Gx())return;const{id:t,type:n,name:i,params:a}=e,o={connectionStatus:"connecting",errorMessage:""};try{const e={[i]:_(w({},a),{transportType:n})};yield window.electronAPI.mcp_client_update_config(e);const{tools:s}=yield window.electronAPI.mcp_client_tool_list(i),r=Array.isArray(s)?"available":"failed";o.connectionStatus=r,"available"===r?CC.updateMCPServer(t,{tools:s}):o.errorMessage=_C.t("Failed to connect to the MCP server.")}catch(s){o.connectionStatus="failed",o.errorMessage=EC((null==s?void 0:s.message)||"")}CC.updateMCPServer(t,o)}),callTool:e=>j(void 0,null,function*(){if(Gx())try{return yield window.electronAPI.mcp_client_tool_call(e)}catch(t){return{content:EC((null==t?void 0:t.message)||"")}}})},IC=w(w({},CC),kC),TC=e=>j(void 0,null,function*(){if(UT())return;const{onlyLocal:t,updateData:n}=e||{},i=NT.getState().settings,a=NT.getState().mcpSettingList,o=NT.getState().setMcpSettingList,s=NT.getState().setSettings;if(t){const e=a.filter(e=>!e.type);o([...IC.getMCPServers(),...e])}else if(n){const e=a.findIndex(e=>e.id===n.id),t=It({},a[e],n),r=[...a];if(r[e]=t,o(r),!t.type&&"enabled"in n){const{success:e,data:t}=yield CS(_(w({},i),{mcp:_(w({},i.mcp),{[n.id]:n.enabled})}));e&&s(t)}}else{const e=IC.initDefaultMCPServers();if(location.pathname.includes("settings"))for(let n=0;n<e.length;n++){const t=e[n];"failed"!==t.connectionStatus&&0!==t.tools.length||(yield IC.isAvailable(t))}const[t]=yield Promise.all([j(void 0,null,function*(){const e=Hf();return yield ow(`/mcp/list?language=${e.language}`)})]);if(t.success){const e=Object.keys(t.data).map(e=>{var n,a,o,s;return{id:e,name:(null==(n=t.data[e])?void 0:n.name)||"",description:(null==(a=t.data[e])?void 0:a.description)||"",tools:((null==(o=t.data[e])?void 0:o.tools)||[]).map(e=>Object.keys(e).map(t=>{var n;return{name:t,description:(null==(n=e[t])?void 0:n.description)||""}})[0]),enabled:(null==(s=null==i?void 0:i.mcp)?void 0:s[e])||!1,connectionStatus:"available"}});o([...IC.getMCPServers(),...e])}}}),jC=(e,t)=>{var n;if(null===e)return[];const i=null==(n=null==t?void 0:t.messages)?void 0:n[e];return i?(null==i?void 0:i.parentId)?[...jC(i.parentId,t),i]:[i]:[]},NC=e=>j(void 0,null,function*(){const t=e.chat.history;return jC(t.currentId,t).reduce((e,t)=>{var n;if("assistant"===t.role)if(t.content_list&&Array.isArray(t.content_list)){const e=null==(n=t.content_list)?void 0:n.find(e=>(null==e?void 0:e.phase)===og.ANSWER||(null==e?void 0:e.phase)===og.DEEPTHINKING);t.content=(null==e?void 0:e.content.replace(/\[\[\d+\]\]/g,""))||""}else t.content=t.content.replace(/\[\[\d+\]\]/g,"")||"";return`${e}### ${t.role.toUpperCase()}\n${t.content}\n\n`},"").trim()}),PC=e=>{const t=Object.values(e.messages||{}),n=e.messages[e.currentId||""];let i=(null==n?void 0:n.chat_type)||ng.Txt2Txt;return t.forEach(e=>{e.fid=e.fid||e.id||"",e.parentId=e.parentId||e.parent_id||null}),t.forEach(e=>{e.childrenIds=t.filter(t=>t.parentId===e.id).map(e=>e.id||"")}),t.forEach(e=>{if(e.parentId){const n=t.find(t=>t.id===e.parentId);n&&(!e.extra&&n.extra&&(e.extra=n.extra),!e.feature_config&&n.feature_config&&(e.feature_config=n.feature_config))}}),t.forEach(e=>{var t,n,i,a,o,s;(null==(i=null==(n=null==(t=e.content_list)?void 0:t[0])?void 0:n.extra)?void 0:i.web_search_info)&&(e.webSearchInfo=null==(s=null==(o=null==(a=e.content_list)?void 0:a[0])?void 0:o.extra)?void 0:s.web_search_info)}),t.forEach(e=>{e.chat_type&&e.chat_type===ng.Image2Video&&(e.chat_type=ng.VideoGeneration,i=ng.VideoGeneration,"assistant"===e.role&&(e.sub_chat_type=ng.VideoGeneration))}),(i===ng.VideoGeneration&&!(null==n?void 0:n.content)&&!(null==n?void 0:n.error)||bC(e))&&(n.done=!1),_(w({},e),{messages:t.reduce((e,t)=>(t.id&&(e[t.id]=t),e),{})})};function MC(){const e=document.getElementById("app-container");e&&!zx()&&(e.style.height=window.innerHeight+"px")}const AC=()=>j(void 0,null,function*(){const{setCurrentChatPage:e}=vx.getState();e(1),yield j(void 0,null,function*(){try{const e=vx.getState().currentChatPage,t=zE.getState().sideBarSearchText,n=e,i=t,{data:a}=i?yield O_({text:i,page:n}):yield M_({page:n,exclude_project:!0});"ERR_NETWORK"!==(null==a?void 0:a.code)&&bx.setState({chats:a})}catch(e){}})}),OC=()=>j(void 0,null,function*(){const e=DT.getState().activeProjectId,t=DT.getState().setProjectExpandChats;if(!e)return;const n=yield TS(e,1);n.success&&Array.isArray(n.data)&&t(n.data)}),RC=e=>{let t=e;return t===ng.Image2Video&&(t=ng.VideoGeneration),t};const DC=(e,t,n)=>{var i,a,o;if(!n)return e;null==(i=null==n?void 0:n.at(-1))||i.user_action;const s=function(e,t){const n=new Set(t);return e.filter(e=>!n.has(e))}(n.filter(e=>"user"===e.role&&e.id).map(e=>e.id),n.filter(e=>{var t,n,i;const a=(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.meta)?void 0:n.subChatType)||(null==e?void 0:e.sub_chat_type);return"assistant"===e.role&&"data_inspection_failed"===(null==(i=null==e?void 0:e.error)?void 0:i.errorCode)&&(a===ng.DeepResearch||a===ng.TRAVEL_RESEARCH||a===ng.INTERRUPT)}).map(e=>e.parentId)).length+1;if(e===ng.DeepResearch){if(t===ng.DeepResearchWebDev||t===ng.Podcast)return t;const e=null==n?void 0:n.findLast(e=>{var t,n;return((null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.meta)?void 0:n.subChatType)===ng.DeepResearch||(null==e?void 0:e.sub_chat_type)===ng.DeepResearch)&&"assistant"===e.role}),i=null==n?void 0:n.find(e=>{var t;return(null==e?void 0:e.sub_chat_type)===ng.INTERRUPT&&"assistant"===e.role&&(null==(t=null==e?void 0:e.content_list)?void 0:t.find(e=>e.phase===og.ANSWER))}),r=e&&!0!==(null==e?void 0:e.done)&&!(null==e?void 0:e.error)&&!i,l=null==n?void 0:n.at(-1),c=(null==l?void 0:l.sub_chat_type)||(null==(o=null==(a=null==l?void 0:l.extra)?void 0:a.meta)?void 0:o.subChatType)||"";return[ng.DeepResearch,ng.INTERRUPT].includes(c)&&r?ng.INTERRUPT:2===s?ng.DeepResearch:1===s?"deep_thinking":ng.Txt2Txt}return e===ng.Podcast?ng.Podcast:e===ng.Travel?2===s?ng.TRAVEL_RESEARCH:1===s?ng.TRAVEL_FEEDBACK:ng.Txt2Txt:t},LC=e=>j(void 0,null,function*(){const t=yield(e=>j(void 0,null,function*(){return yield ow("/task/suggestions/completions",{method:"POST",data:e})}))(e).catch(e=>[]);return t});function FC(e,t,n=""){if(Pt(n))return e;if(Array.isArray(null==e?void 0:e.sortKeys)||(e.sortKeys=[]),t in e){if("string"==typeof n){const i="string"==typeof e[t]?e[t]:"";e[t]=i+n}else if(Mt(n)){const i=e[t]||{};e[t]=function(e,t){const n={};for(const i in w(w({},e),t))Object.prototype.hasOwnProperty.call(e,i)&&Object.prototype.hasOwnProperty.call(t,i)?n[i]=e[i]+t[i]:Object.prototype.hasOwnProperty.call(e,i)?n[i]=e[i]:n[i]=t[i];return n}(i,n)}}else e[t]=n,e.sortKeys.push(t);return e}const zC=(e=[],t)=>{const n=new Set(e.map(e=>e.url)),i=(null==t?void 0:t.filter(e=>!n.has(e.url)))||[];return[...e,...i]},UC=(e,t)=>{const{query:n,index:i,status:a,phase:o}=t,s=jt(e);if(!i||i-1<0)return e;let r,l=s.findIndex(e=>e.index===i);const{id:c,query:u,learnings:d,researchGoal:h,webSites:p,pageContent:m,codeContent:f,searchContent:g}=n||{};-1===l?(r=_(w({},n),{index:i,status:a,phase:o}),l=s.length,s.push(r)):(r=s[l],FC(r,"searchContent",g),FC(r,"codeContent",f),FC(r,"pageContent",m),FC(r,"learnings",d),FC(r,"researchGoal",h),FC(r,"query","string"==typeof u?u:"")),(null==r?void 0:r.id)||(r.id=c),Nt(null==r?void 0:r.query)&&(r.query="");const v=Array.isArray(p)?p:null==p?void 0:p.webSites;return(null==r?void 0:r.webSites)?r.webSites=zC(r.webSites,v||[]):r.webSites=v,s[l]=_(w({},r),{status:a,phase:o}),s},HC=(e,t)=>{const n=jt(e);return t.forEach(e=>{const{query:t,index:i,status:a,phase:o}=e;if(!i||i<1)return;const s=n.findIndex(e=>(null==e?void 0:e.index)===i);if(-1===s)return void n.push(e);const r=n[s];if("finished"===(null==r?void 0:r.status)||"WebResultFinished"===(null==r?void 0:r.status))return;const{id:l,query:c,learnings:u,researchGoal:d,webSites:h,pageContent:p,codeContent:m,searchContent:f}="object"==typeof t?t:e||{};FC(r,"searchContent",f),FC(r,"codeContent",m),FC(r,"pageContent",p),FC(r,"learnings",u),FC(r,"researchGoal",d),FC(r,"query","string"==typeof c?c:""),!(null==r?void 0:r.id)&&l&&(r.id=l);const g=Array.isArray(h)?h:null==h?void 0:h.webSites;g&&((null==r?void 0:r.webSites)?r.webSites=zC(r.webSites,g||[]):r.webSites=g),n[s]=_(w({},r),{status:a,phase:o})}),n},BC=e=>e.filter(e=>e.phase===og.WEB_SEARCH).reduce((e,t)=>{var n;return e.push(...(null==(n=t.extra)?void 0:n.web_search_info)||[]),e},[]).map(e=>_(w({},e),{icon:e.hostlogo||e.icon,description:e.description||e.snippet})),$C=e=>{var t,n,i;return null==(i=null==(n=null==(t=e.find(e=>e.phase===og.ANSWER))?void 0:t.extra)?void 0:n.deep_research)?void 0:i.references},qC=(e,t="web")=>{if(e){if($x()){if("web"!==t){if(!e){const e=Hf();return void ht.openOnce({type:"error",content:e.t("Download failed: url error")})}try{yC({url:e,errorTexts:!0})}catch(n){const e=Hf();ht.openOnce({type:"error",content:e.t("Download failed")})}return}const i=`qwen://web?url=${encodeURIComponent(e)}`;kT.adapter.invoke({method:"openWindow",params:{uri:i}})}Gx()?kT.adapter.openWindow(e):window.open(e,"_blank")}},GC=e=>{var t,n,i,a;return 0===(null==(n=null==(t=null==e?void 0:e.permissions)?void 0:t.chat)?void 0:n.deep_research)||!(null==(a=null==(i=null==e?void 0:e.permissions)?void 0:i.chat)?void 0:a.deep_research)},VC=(e,t)=>UT()?e:t?"temporary":e,WC=e=>{var t,n,i,a;const o=vx.getState().history,s=o.messages[e||""];if(!s)return[];return(null!==(null==s?void 0:s.parentId)?null!=(i=null==(n=o.messages[null!=(t=s.parentId)?t:""])?void 0:n.childrenIds)?i:[]:null!=(a=Object.values(o.messages).filter(e=>null===e.parentId&&"user"===e.role).map(e=>e.id||e.fid))?a:[]).filter(e=>void 0!==e)},QC=e=>{var t;const n=vx.getState().history.messages[e];return(null==(t=null==n?void 0:n.models)?void 0:t.length)>1},KC=e=>{var t;return(null==(t=(e?Object.values(e||{}):[]).filter(e=>"assistant"===e.role&&e.sub_chat_type===ng.Podcast))?void 0:t.length)||0},YC=(e,t)=>j(void 0,null,function*(){var n,i;const{chatId:a}=vx.getState(),o=Ex.getState().mobile,s=Hf();let r=!1,l="";if(a&&e){try{const t=yield(c={chat_id:a,message_id:e,scope:1},j(void 0,null,function*(){return yield uw(),yield ow("/community/share",{method:"POST",data:w({},c),toast:!1})}));r=!!(null==(n=null==t?void 0:t.data)?void 0:n.share_id),l=(null==(i=null==t?void 0:t.data)?void 0:i.message)||""}catch(u){}var c;return r?(ht.open({type:"success",content:t?t():s.t("Published successfully"),closable:!1,className:o?"message-publish":""}),setTimeout(()=>{K.destroy()},3e3)):ht.open({type:"error",content:l,closable:!1,className:o?"message-publish message-publish-error":"",duration:3e3}),{success:r}}});let XC=!1;const JC=(e,t={})=>{var n,i;const a="system"===(o=e)?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":o;var o;XC="system"===e,Gx()&&(null==(n=null==window?void 0:window.electronAPI)?void 0:n.switch_theme)&&(null==(i=null==window?void 0:window.electronAPI)||i.switch_theme(e)),document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(a);let s=e;"system"===e&&(s=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),zE.setState({theme:e,realTheme:s});const{isPersistence:r=!0}=t;localStorage&&r&&(localStorage.theme=e)};window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{XC&&JC("system")});const ZC=e=>{let t=null;switch(e){case"loading":t=an.jsx(pt,{type:"icon-jiazaizhong",className:"qwen-message-icon"});break;case"error":t=an.jsx(pt,{type:"icon-line-x-circle-contained",className:"qwen-message-icon"});break;case"caution":case"info":case"warning":t=an.jsx(pt,{type:"icon-line-alert-circle",className:"qwen-message-icon"});break;case"success":t=an.jsx(pt,{type:"icon-line-check-contained1",className:"qwen-message-icon"});break;default:t=an.jsx(an.Fragment,{})}return t},eE=({type:e="info",content:t,duration:n=3e3,onCancel:i,hideIcon:a,className:o="",style:s=""})=>{const r=`qwen-message-${Date.now()}`,l=`${s}`,c=`qwen-design-message qwen-design-message-${e} ${o}`,u=an.jsxs("div",{className:"qwen-message-content",children:[an.jsxs("div",{className:"qwen-message-content-text",children:[t," "]}),i&&an.jsx(pt,{type:"icon-close-4",className:"qwen-message-content-close-icon",onClick:()=>{K.destroy(r),i&&i()}})]});(K[e]||K.info)({content:u,icon:a?an.jsx(an.Fragment,{}):ZC(e),duration:n/1e3,key:r,className:c,style:l})},tE={open:eE,openOnce:e=>{K.destroy(),eE(e)}};class nE{constructor(){C(this,"ready",!1),C(this,"platform",Kf.WEB),this.init()}init(){this.ready=!0}isReady(){return this.ready}invoke(e){return this.ready?new Promise(e=>{e(!0)}):Promise.reject("-base")}openWindow(e){window.open(e,"_blank","noopener,noreferrer")}routeTologin(){fj.navigate("/auth")}}class iE extends nE{getVersionMethodBlocklist(){return this.getDefaultVersionMethodBlocklist()}getDefaultVersionMethodBlocklist(){return{"1.3.0":new Set(["getStoredInfo"]),"1.5.1":new Set(["postContentToMainChat"]),"1.6.0":new Set(["openPodcastWindow","openMediaRateWindow"]),"1.7.0":new Set(["openMemoryWindow"]),"1.8.0":new Set(["controlAudioPlayer","downloadFile"])}}mergeVersionMethodBlocklist(...e){const t={};for(const n of e)if(n)for(const e in n){if(!Object.prototype.hasOwnProperty.call(n,e))continue;const i=n[e];if(t[e])for(const n of i)t[e].add(n);else t[e]=new Set(i)}return t}optionPatch(e){var t,n;"openHalfWindow"!==e.method||"openUrl"!==(null==(t=null==e?void 0:e.params)?void 0:t.type)||(null==(n=e.params)?void 0:n.windowSize)||(e.params.windowSize=100)}invoke(e){var t;if(!this.ready)return Promise.reject("");if(this.optionPatch(e),this.isMethodBlockedForCurrentVersion(e.method)){if(this.platform===Kf.IOS&&"openHalfWindow"===e.method&&"openUrl"===(null==(t=null==e?void 0:e.params)?void 0:t.type)&&e.params.windowSize)return delete e.params.windowSize,this.doInvoke(e);const n=Bx();return Promise.reject(` APP ${n} ${e.method}`)}return this.doInvoke(e)}isMethodBlockedForCurrentVersion(e){const t=this.getVersionMethodBlocklist();for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!this.isCurrentVersionGte(n)){const i=t[n];if(i.has("*")||i.has(e))return!0}return!1}isCurrentVersionGte(e){const t=Bx(),n=(e||"0").split(".").map(e=>parseInt(e,10)||0),i=(t||"0").split(".").map(e=>parseInt(e,10)||0);for(let a=0;a<3;a++){const e=i[a]||0,t=n[a]||0;if(e>t)return!0;if(e<t)return!1}return!0}}class aE extends iE{constructor(){super(),C(this,"ready",!1),C(this,"platform",Kf.ANDROID),C(this,"nativeBridge",null),this.init()}init(){return this.setupBridge().then(()=>{}).catch(e=>{})}invoke(e){return j(this,null,function*(){return this.ready||(yield(t=1e3,new Promise(e=>{setTimeout(e,t)})),this.ready)?(n=aE.prototype,i=this,a="invoke",g(p(n),a,i)).call(this,e):Promise.reject(` - ${null==e?void 0:e.method}`);var t,n,i,a})}getVersionMethodBlocklist(){return this.mergeVersionMethodBlocklist(this.getDefaultVersionMethodBlocklist(),{})}doInvoke(e){return this.invokeHandler(e)}setupBridge(){return new Promise((e,t)=>{setTimeout(()=>{(null==window?void 0:window.QwenChat)?(this.nativeBridge=null==window?void 0:window.QwenChat,this.ready=!0,e()):this.startPolling(e,t)},1e3)})}startPolling(e,t){let n=0,i=null;i=setInterval(()=>{n++,(null==window?void 0:window.QwenChat)?(i&&(clearInterval(i),i=null),this.nativeBridge=null==window?void 0:window.QwenChat,this.ready=!0,e()):n>=1200&&(i&&(clearInterval(i),i=null),t("window?.QwenChat is not defined after polling 1200 times"))},50)}invokeHandler(e){return new Promise((t,n)=>{const i=setTimeout(()=>{n(`: ${e.method}`)},e.timeout||1e4);try{if(this.nativeBridge&&this.nativeBridge[e.method]){const{params:n={}}=e,a=function(e,t=2){try{return JSON.stringify(e,(e,t)=>"function"==typeof t?"[Function]":"symbol"==typeof t?t.toString():void 0===t?null:t instanceof Error?t.toString():t instanceof Date?t.toISOString():t instanceof Set||t instanceof Map?[...t]:t,t)}catch(n){return null}}(n);t(this.nativeBridge[e.method](a)||!0),clearTimeout(i)}else clearTimeout(i),n(`: ${e.method}`)}catch(a){clearTimeout(i),n("")}})}openWindow(e,t="qwen://web?url="){const n=`${t}${encodeURIComponent(e)}`;this.invoke({method:"openWindow",params:{uri:n}})}routeTologin(){this.invoke({method:"showAlert",params:{type:"login"}})}}class oE extends nE{constructor(){super(...arguments),C(this,"platform",Kf.DESKTOP)}invoke(e){return j(this,null,function*(){var t,n;const{method:i,params:a}=e,o=i,s=a;return["get_app_version","get_platform_info","open_external_link","show_native_dialog","request_file_access","mcp_client_get_config","mcp_client_tool_list","mcp_client_tool_call","on_event","send_event","switch_theme","switch_ln"].includes(o)?{code:200,message:"success",data:null==(n=null==(t=window.electronAPI)?void 0:t[o])?void 0:n.call(t,s)}:{code:500,message:"method not found",data:null}})}openWindow(e){var t;null==(t=window.electronAPI)||t.open_external_link(e)}}class sE extends iE{constructor(){super(),C(this,"ready",!1),C(this,"platform",Kf.IOS),C(this,"nativeBridge",null),this.init()}getVersionMethodBlocklist(){const e={"1.3.0":new Set(["openHalfWindow"])};return this.mergeVersionMethodBlocklist(this.getDefaultVersionMethodBlocklist(),e)}init(){return this.setupBridge().then(()=>{this.ready=!0}).catch(e=>{})}doInvoke(e){return this.invokeHandler(e)}setupBridge(){return new Promise((e,t)=>{(null==window?void 0:window.QwenChat)?(this.nativeBridge=null==window?void 0:window.QwenChat,e()):t("Logger: window?.QwenChat is not defined")})}invokeHandler(e){return new Promise((t,n)=>{const i=setTimeout(()=>{n(`: ${e.method}`)},e.timeout||1e4);try{if(this.nativeBridge&&this.nativeBridge[e.method]){const{params:n={}}=e;t(this.nativeBridge[e.method](n)||!0),clearTimeout(i)}else clearTimeout(i),n(`: ${e.method}`)}catch(a){clearTimeout(i),n("")}})}openWindow(e,t="qwen://web?url="){const n=`${t}${encodeURIComponent(e)}`;this.invoke({method:"openWindow",params:{uri:n}})}routeTologin(){this.invoke({method:"showAlert",params:{type:"login"}})}}const rE=(()=>{if(Gx())return Kf.DESKTOP;const e=navigator.userAgent.toLowerCase(),t=/iphone|ipad|ipod/.test(e),n=/android/.test(e),i=$x();return t&&i?Kf.IOS:n&&i?Kf.ANDROID:Kf.WEB})();let lE=nE;switch(rE){case Kf.IOS:lE=sE;break;case Kf.ANDROID:lE=aE;break;case Kf.DESKTOP:lE=oE}class cE extends lE{constructor(){super()}setTheme(e,t){const n=!["system_light","system_dark"].includes(e);JC("system_light"===e?"light":"system_dark"===e?"dark":e,{isPersistence:n}),t===Xf.SETAPP&&this.invoke({method:"setTheme",params:{theme:e}})}setLanguage(e,t){(e=>{Hf().changeLanguage(e)})(e),document.documentElement.setAttribute("lang",e),t===Xf.SETAPP?this.invoke({method:"setLanguage",params:{lang:e}}):t===Xf.DESKTOP&&this.invoke({method:"switch_ln",params:e})}saveCookie(e,t){localStorage.token=e}clearCookie(e){LT("token"),LT("settings"),Xf.SETAPP}downloadFile({chat:e,fileType:t}){var n;"txt"!==t?"json"===t&&(n=e,j(void 0,null,function*(){var e;const{saveAs:t}=Tx;if(n.id){n=(n=yield R_({chat_id:n.id})).data;const t={};for(const i in n.chat.history.messages)Object.prototype.hasOwnProperty.call(n.chat.history.messages,i)&&(t[i]=Tt(n.chat.history.messages[i],["webSearchInfo","extra.web_search_info"]),"assistant"===t[i].role&&(null==(e=t[i])?void 0:e.content)&&(t[i].content=t[i].content.replace(/\[\[\d+\]\]/g,"")));n.chat.history.messages=t,n.chat.messages&&n.chat.messages.length&&(n.chat.messages=n.chat.messages.map(e=>{const t=Tt(e,["webSearchInfo","extra.web_search_info"]);return"assistant"===t.role&&(null==t?void 0:t.content)&&(t.content=t.content.replace(/\[\[\d+\]\]/g,"")),t}))}t(new Blob([JSON.stringify([n])],{type:"application/json;charset=utf-8"}),`chat-export-${Date.now()}.json`)})):((e,t)=>{j(void 0,null,function*(){const{saveAs:n}=Tx,i=yield NC(e),a=new Blob([i],{type:"text/plain;charset=utf-8"}),o=`chat-${e.chat.title}.txt`;if(Dx())try{yield tC(a,o)}catch(kX){"function"==typeof t&&t(kX)}else n(a,o)})})(e,e=>{tE.openOnce({type:"error",content:e})})}setNativeStopButton(e=!1){this.invoke({method:"showStopButton",params:{value:e}})}resetNativeState(){new URLSearchParams(window.location.search).get("shareId")||this.invoke({method:"setSendButtonEnabled",params:{value:!0}})}}var uE=(e=>(e.CHAT_INITIALIZED="chat.initialized",e.CHAT_HISTORY_LOADED="chat.historyLoaded",e.CHAT_INIT_NEWCHAT="chat.init.newChat",e.CHAT_BEGIN="chat.begin",e.CHAT_MESSAGE_SENT_REGENERATE="chat.message.sent.regenerate",e.CHAT_MESSAGE_EDIT_BEGIN="chat.message.sent.begin",e.CHAT_MESSAGE_EDIT_END="chat.message.sent.end",e.CHAT_MESSAGE_UPDATE="chat.message.update",e.CHAT_CREATE_NEW_CHAT="chat.create.new.chat",e.CHAT_SSE_ID_CHANGE="chat.sse.id.change",e.CHAT_SSE_BEGIN="chat.sse.begin",e.CHAT_SSE_ERROR="chat.sse.error",e.CHAT_SSE_PROCESS="chat.sse.process",e.CHAT_SSE_FIRST_RECEIVE_MESSAGE="chat.sse.first.receive.message",e.CHAT_SSE_END="chat.sse.end",e.CHAT_MESSAGE_FAILED="chat.message.failed",e.CHAT_MESSAGE_END="chat.message.end",e.CHAT_MESSAGE_END_PROCESS="chat.message.end.process",e.CHAT_END="chat.end",e.CHAT_MERGE_BEGIN="chat.merge.begin",e.CHAT_MERGE_MESSAGE_PROCESS="chat.merge.message.process",e.CHAT_MERGE_END="chat.merge.end",e.CHAR_HANDLE_DELETE_SOURCE="chat.message.delete.source",e.CHAT_ERROR="chat.error",e.CHAT_MESSAGE_DELETED="chat.message.deleted",e.CHAT_CLOSE_ROTE_COMMENT_PANEL="chat.close.rote.comment.panel",e.CHAT_RESET_INPUT_TEXTAREA="chat_reset_input_textarea",e.CHAR_REGENERATE_RESPONSE="chat.regenerate.response",e.CHAT_PARSE_URL_BEGIN="chat.message.parse.url",e.CHAT_PARSE_URL_END="chat.message.parse.url.end",e.CHAT_PARSE_URL_ERROR="chat.message.parse.url.error",e.CHAT_SCROLL_TO_BOTTOM="chat.message.scroll.to.bottom",e.CHAT_SELECTED_MODEL_ONMOUNT="chat.selected.model.onmount",e.FILE_PASE_REMOVE="file.pase.remove",e))(uE||{}),dE=(e=>(e.MESSAGE_SENT_BEFORE="message.sent.before",e.MESSAGE_SENT="message.sent",e.MESSAGE_VALIDATE_ERROR="message.validate.error",e.MESSAGE_EDIT_SAVE="message.edit.save",e.MESSAGE_FEEDBACK_SUBMIT="message.feedback.submit",e.MESSAGE_STOP_RESPONSE="message.stop.Response",e.MESSAGE_OPEN_TEMPORARY="message.open.temporary",e.MESSAGE_CLEAR_ALL="chear.all.messages",e.MESSAGE_INPUT_PANEL_ACTIVE="message.input.panel.active",e.MESSAGE_LEAVE_CONFIRM="message.leave.confirm",e.MESSAGE_ARTIFACT_SHOW="message.artifact.show",e.MESSAGE_ARTIFACT_DEPLOY_CHANGE="message.artifact.deploy.change",e.MESSAGE_PODCAST_AUDIO_PLAY_START="message.podcast.audio.play.start",e.MESSAGE_STOP_SCROLL_TO_BOTTOM="message.stop.scroll.to.bottom",e.MESSAGE_DEEP_RESEARCH_CLOSE_DETAIL="message.close.deepResearch.detail",e.MESSAGE_EDIT_ARTIFACTS="message.edit.artifacts",e.MESSAGE_STOP_ARTIFACTS_LOOP="message.stop.artifacts.loop",e))(dE||{}),hE=(e=>(e.SOURCE_CILCK="dp.source.messsage",e))(hE||{}),pE=(e=>(e.QWEN_SEND_MESSAGE="QwenEvent.onSendMessage",e.QWEN_REMOVE_SOURCE="QwenEvent.onRemoveSearchReference",e.QWEN_WEBLOAD="QwenEvent.onWebLoaded",e.QWEN_EVENT_ON_EDIT_MESSAGE="QwenEvent.onEditMessage",e.QWEN_EVENT_ON_CLICK_STOP_BUTTON="QwenEvent.onClickStopButton",e.QWEN_EVENT_ON_OPEN_CHAT="QwenEvent.onOpenChat",e.QWEN_EVENT_ON_DISLIKE_FEEDBACK="QwenEvent.onDislikeFeedback",e.QWEN_EVENT_ON_THEME_CHANGED="QwenEvent.onThemeChanged",e.QWEN_EVENT_ON_LANG_CHANGED="QwenEvent.onLangChanged",e.QWEN_EVENT_ON_CLEAR_ALL_CHATS="QwenEvent.onClearAllChats",e.QWEN_EVENT_ON_LOGOUT="QwenEvent.onLogout",e.QWEN_EVENT_ON_INPUT_PANEL_ACTIVE="QwenEvent.onInputPanelActive",e.QWEN_EVENT_ON_SELECT_MODEL="QwenEvent.onSelectModel",e.QWEN_EVENT_ON_ALERTPOSITIVE_BUTTON_CLICK="QwenEvent.onAlertPositiveButtonClick",e.QWEN_EVENT_ON_CHATCONFIG_CHANGE="QwenEvent.onChatConfigChange",e.QWEN_EVENT_ON_DEPLOY_STATUS_CHANGE="QwenEvent.onDeployStatusChange",e.QWEN_EVENT_ON_USER_PROFILE_UPDATE="QwenEvent.onUserProfileUpdate",e.QWEN_EVENT_ON_USER_PASSWORD_CHANGE="QwenEvent.onUserPasswordChange",e.QWEN_EVENT_ON_PAGE_PAUSE="QwenEvent.onPagePause",e.QWEN_EVENT_ON_PAGE_RESUME="QwenEvent.onPageResume",e.QWEN_EVENT_ON_TSS_SPEAKER_CHANGE="QwenEvent.onTTSSpeakerChange",e.QWEN_EVENT_ON_CALL_ENDED="QwenEvent.onCallEnded",e.QWEN_EVENT_ON_CALL_CONNECTED="QwenEvent.onCallConnected",e.QWEN_EVENT_ON_CALL_COMING="QwenEvent.onCallComing",e.QWEN_EVENT_ON_AUDIO_FOCUS_CHANGE="QwenEvent.onAudioFocusChange",e.QWEN_EVENT_ON_PLAYBACK_STATE_CHANGED="QwenEvent.onPlaybackStateChanged",e.QWEN_EVENT_ON_MEDIA_RATE_CHANGED="QwenEvent.onMediaRateChanged",e.QWEN_EVENT_ON_POST_CONTENT_TO_MAIN_CHAT="QwenEvent.onPostContentToMainChat",e.QWEN_EVENT_ON_SEND_PODCAST="QwenEvent.onSendPodcast",e.QWEN_EVENT_ON_PROMPT_SETTINGS_UPDATE="QwenEvent.onPromptSettingsUpdate",e))(pE||{}),mE=(e=>(e.QWEN_CHAT_ONDOWNLOADSTART="QwenChat.onDownloadStart",e.QWEN_CHAT_ONDOWNLOADCOMPLETE="QwenChat.onDownloadComplete",e))(mE||{}),fE=(e=>(e.COPY_MESSAGE="navbar.copy.messsage",e.NAVBAR_MODEL_SELECT_CHANGE="navbar.model.select.change",e.MESSAGE_AUDIO_PLAYBACK_CHANGED="message.audio.playback.changed",e.MESSAGE_AUDIO_PLAYBACK_RATE_CHANGED="message.audio.playback.rate.changed",e))(fE||{}),gE=(e=>(e.VIEWPORT_RESIZE="viewport.resize",e))(gE||{}),vE=(e=>(e.MESSAGE_INPUT_ON_BLUR="message.input.on.blur",e.MESSAGE_INPUT_TRIGGER_FOCUS="message.input.trigger.focus",e.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK="message.input.recommend.words.click",e.MESSAGE_INPUT_RECOMMEND_WORDS_INIT="message.input.recommend.words.init",e))(vE||{});const yE=new dt({wildcard:!0,delimiter:".",newListener:!1,removeListener:!1,maxListeners:30,verboseMemoryLeak:!1,ignoreErrors:!1}),bE=class t{constructor(){return C(this,"chats",new Map),C(this,"currentId",null),C(this,"currentChatId",null),C(this,"clearChatsStatus",()=>{this.chats.forEach(e=>{e.id!==this.currentId&&(e.setStatus({isLeave:!0}),e.destroy())})}),C(this,"forceClearAllChat",()=>{this.chats.forEach(e=>{e.forceClear()})}),k(t,e)?k(t,e):(T(t,e,this),this)}static getInstance(){return k(t,e)||T(t,e,new t),k(t,e)}getChats(){return this.chats}hasChat(e){return this.chats.has(e)}addChat(e,t){return this.chats.has(e)?(this.currentChatId=e,!1):(this.currentChatId=e,this.chats.set(e,t),!0)}getChat(e){return this.chats.get(e)}getChatByChatId(e){let t;return this.chats.forEach(n=>{n.chatId===e&&(t=n)}),t}removeChat(e){return!(!e||!this.chats.has(e))&&this.chats.delete(e)}size(){return this.chats.size}};e=new WeakMap,I(bE,e,null);const xE=bE.getInstance();const wE=new class{constructor(){C(this,"listeners"),this.listeners=new Map}add(e,t,n){let i=this.listeners.get(e);i||(i=new Set,this.listeners.set(e,i)),i.add(t),document.addEventListener(e,t,n||{})}remove(e,t){const n=this.listeners.get(e);n&&n.has(t)&&(document.removeEventListener(e,t),n.delete(t))}removeAll(e){const t=this.listeners.get(e);t&&(t.forEach(t=>{document.removeEventListener(e,t)}),t.clear())}clear(){this.listeners.forEach((e,t)=>{e.forEach(e=>{document.removeEventListener(t,e)})}),this.listeners.clear()}};class _E extends Error{constructor(e,t){super(e),this.name="ParseError",this.type=t.type,this.field=t.field,this.value=t.value,this.line=t.line}}function SE(e){}function CE(e){if("function"==typeof e)throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=SE,onError:n=SE,onRetry:i=SE,onComment:a}=e;let o,s="",r=!0,l="",c="";function u(e){if(""===e)return l.length>0&&t({id:o,event:c||void 0,data:l.endsWith("\n")?l.slice(0,-1):l}),o=void 0,l="",void(c="");if(e.startsWith(":"))return void(a&&a(e.slice(e.startsWith(": ")?2:1)));const n=e.indexOf(":");if(-1!==n){const t=e.slice(0,n),i=" "===e[n+1]?2:1;return void d(t,e.slice(n+i),e)}d(e,"",e)}function d(e,t,a){switch(e){case"event":c=t;break;case"data":l=`${l}${t}\n`;break;case"id":o=t.includes("\0")?void 0:t;break;case"retry":/^\d+$/.test(t)?i(parseInt(t,10)):n(new _E(`Invalid \`retry\` value: "${t}"`,{type:"invalid-retry",value:t,line:a}));break;default:n(new _E(`Unknown field "${e.length>20?`${e.slice(0,20)}`:e}"`,{type:"unknown-field",field:e,value:t,line:a}))}}return{feed:function(e){const t=r?e.replace(/^\xEF\xBB\xBF/,""):e,[n,i]=function(e){const t=[];let n="",i=0;for(;i<e.length;){const a=e.indexOf("\r",i),o=e.indexOf("\n",i);let s=-1;if(-1!==a&&-1!==o?s=Math.min(a,o):-1!==a?s=a===e.length-1?-1:a:-1!==o&&(s=o),-1===s){n=e.slice(i);break}{const n=e.slice(i,s);t.push(n),i=s+1,"\r"===e[i-1]&&"\n"===e[i]&&i++}}return[t,n]}(`${s}${t}`);for(const a of n)u(a);s=i,r=!1},reset:function(e={}){s&&e.consume&&u(s),r=!0,o=void 0,l="",c="",s=""}}}class EE extends TransformStream{constructor({onError:e,onRetry:t,onComment:n}={}){let i;super({start(a){i=CE({onEvent:e=>{a.enqueue(e)},onError(t){"terminate"===e?a.error(t):"function"==typeof e&&e(t)},onRetry:t,onComment:n})},transform(e){i.feed(e)}})}}const kE=e=>new Promise(t=>setTimeout(t,e));function IE(e,t,n=!0){return j(this,null,function*(){let i=function(e){return P(this,null,function*(){for(var t,n,i,a,o,s,r,l,c,u,d,h,p,m,f,g,v,y,b,x,S,C,E,k,I,T,j,P,M,A,O,R,D,L,F,z,U,H,B,$,q,G,V,W,Q,K,Y,X,J,Z,ee,te,ne,ie,ae,oe,se,re,le,ce,ue,de,he,pe,me,fe,ge,ve,ye,be,xe,we,_e,Se,Ce,Ee,ke,Ie;;){const{value:Te,done:je}=yield new N(e.read());if(je){yield{done:!0,value:""};break}if(!Te)continue;const Ne=Te.data;if(Ne.startsWith("[DONE]")){yield{done:!0,value:""};break}try{let e={};try{e=JSON.parse(Ne)}catch(kX){}const N=(null==e?void 0:e["response.created"])||void 0;if(N){yield{done:!1,value:"",chatId:N.chat_id,parentId:N.parent_id,responseId:N.response_id};continue}if(null==e?void 0:e["response.stopped"]){yield{done:!0,value:"",isStop:!0};continue}if(null==(i=null==(n=null==(t=null==e?void 0:e.choices)?void 0:t[0])?void 0:n.delta)?void 0:i.tts){const{tts:t=""}=null==(o=null==(a=null==e?void 0:e.choices)?void 0:a[0])?void 0:o.delta;yield{done:!1,value:t,tts:t,responseId:e.response_id}}if(e.error){yield{done:!0,value:"",error:e.error,responseId:e.response_id};continue}if(e.sources){yield{done:!1,value:"",sources:e.sources,role:null!=(c=null==(l=null==(r=null==(s=e.choices)?void 0:s[0])?void 0:r.delta)?void 0:l.role)?c:"",responseId:e.response_id};continue}if(e.selected_model_id){yield{done:!1,value:"",selectedModelId:e.selected_model_id,role:null!=(p=null==(h=null==(d=null==(u=e.choices)?void 0:u[0])?void 0:d.delta)?void 0:h.role)?p:"",responseId:e.response_id};continue}if("function"===(null==(g=null==(f=null==(m=e.choices)?void 0:m[0])?void 0:f.delta)?void 0:g.role)){if(null==(x=null==(b=null==(y=null==(v=e.choices)?void 0:v[0])?void 0:y.delta)?void 0:b.extra)?void 0:x.web_search_info){yield{done:!1,value:"",web_search_info:null!=(I=null==(k=null==(E=null==(C=null==(S=e.choices)?void 0:S[0])?void 0:C.delta)?void 0:E.extra)?void 0:k.web_search_info)?I:[],role:null!=(M=null==(P=null==(j=null==(T=e.choices)?void 0:T[0])?void 0:j.delta)?void 0:P.role)?M:"",responseId:e.response_id};continue}if(null==(D=null==(R=null==(O=null==(A=e.choices)?void 0:A[0])?void 0:O.delta)?void 0:R.extra)?void 0:D.code_interpreter_info){yield{done:!1,value:"",code_interpreter_info:null!=(H=null==(U=null==(z=null==(F=null==(L=e.choices)?void 0:L[0])?void 0:F.delta)?void 0:z.extra)?void 0:U.code_interpreter_info)?H:"",role:null!=(G=null==(q=null==($=null==(B=e.choices)?void 0:B[0])?void 0:$.delta)?void 0:q.role)?G:"",responseId:e.response_id};continue}}yield _(w({done:!1,value:null!=(K=null==(Q=null==(W=null==(V=e.choices)?void 0:V[0])?void 0:W.delta)?void 0:Q.content)?K:"",role:null!=(Z=null==(J=null==(X=null==(Y=e.choices)?void 0:Y[0])?void 0:X.delta)?void 0:J.role)?Z:"",phase:null==(ne=null==(te=null==(ee=e.choices)?void 0:ee[0])?void 0:te.delta)?void 0:ne.phase,status:null==(oe=null==(ae=null==(ie=e.choices)?void 0:ie[0])?void 0:ae.delta)?void 0:oe.status,usage:e.usage,extra:null==(le=null==(re=null==(se=e.choices)?void 0:se[0])?void 0:re.delta)?void 0:le.extra,lang_code:null==(de=null==(ue=null==(ce=e.choices)?void 0:ce[0])?void 0:ue.delta)?void 0:de.lang_code,function_call:null==(me=null==(pe=null==(he=e.choices)?void 0:he[0])?void 0:pe.delta)?void 0:me.function_call},(null==(ve=null==(ge=null==(fe=e.choices)?void 0:fe[0])?void 0:ge.delta)?void 0:ve.function_call)?{functionCallType:null==(we=null==(xe=null==(be=null==(ye=e.choices)?void 0:ye[0])?void 0:be.delta)?void 0:xe.function_call)?void 0:we.name}:{}),{mcp_name:null==(Ce=null==(Se=null==(_e=e.choices)?void 0:_e[0])?void 0:Se.delta)?void 0:Ce.mcp_name,tool_name:null==(Ie=null==(ke=null==(Ee=e.choices)?void 0:Ee[0])?void 0:ke.delta)?void 0:Ie.tool_name,responseId:e.response_id})}catch(kX){}}})}(e.pipeThrough(new TextDecoderStream).pipeThrough(new EE).getReader());return i=t?function(e,t=!0){return P(this,null,function*(){var n,i,a;let o="";try{for(var s,r,l,c=M(e);s=!(r=yield new N(c.next())).done;s=!1){const e=r.value;if(e.done||e.error)return void(yield e);if(e.sources||e.web_search_info||e.code_interpreter_info||e.function_call||e.functionCallType||e.parentId&&e.responseId||[og.IMAGE_GEN,og.TOOL,og.LOCAL_TOOL].includes(e.phase)||(null==(n=null==e?void 0:e.extra)?void 0:n.deep_research)||(null==(i=null==e?void 0:e.extra)?void 0:i.image_zoom_in_tool_info)||(null==(a=null==e?void 0:e.extra)?void 0:a.travel_research)){yield e;continue}let s=e.value;if(t){let t=s.substring((null==o?void 0:o.length)||0);if(t.length){const e={chunk_size:t.length,chunk_time:Date.now()};yield{chunk_data:e,done:!1,value:""}}if(t.length<5){yield{done:!1,value:t,functionCallType:null==e?void 0:e.functionCallType},o=s;continue}for(;""!=t;){const n=Math.min(Math.floor(3*Math.random())+1,t.length),i=t.slice(0,n);yield{done:!1,value:i,functionCallType:null==e?void 0:e.functionCallType},"hidden"!==(null==document?void 0:document.visibilityState)&&(yield new N(kE(5))),t=t.slice(n)}o=s}else{if(s.length){const e={chunk_size:s.length,chunk_time:Date.now()};yield{chunk_data:e,done:!1,value:""}}if(s.length<5){yield{done:!1,value:s,functionCallType:null==e?void 0:e.functionCallType,role:null==e?void 0:e.role,phase:null==e?void 0:e.phase,status:null==e?void 0:e.status};continue}for(;""!=s;){const t=Math.min(Math.floor(3*Math.random())+1,s.length),n=s.slice(0,t);yield{done:!1,value:n,functionCallType:null==e?void 0:e.functionCallType,role:null==e?void 0:e.role,phase:null==e?void 0:e.phase,status:null==e?void 0:e.status},"hidden"!==(null==document?void 0:document.visibilityState)&&(yield new N(kE(5))),s=s.slice(t)}}}}catch(r){l=[r]}finally{try{s&&(r=c.return)&&(yield new N(r.call(c)))}finally{if(l)throw l[0]}}})}(i,n):function(e){return P(this,null,function*(){let t="";try{for(var n,i,a,o=M(e);n=!(i=yield new N(o.next())).done;n=!1){const e=i.value,n=e.value,a="string"==typeof n?n.substring((null==t?void 0:t.length)||0):"";if(a.length){const e={chunk_size:a.length,chunk_time:Date.now()};yield{chunk_data:e,done:!1,value:""}}yield e,t=n}}catch(i){a=[i]}finally{try{n&&(i=o.return)&&(yield new N(i.call(o)))}finally{if(a)throw a[0]}}})}(i),i})}const TE=(e,t)=>{const{theme:n}=zE.getState();return"dark"===n?t:e},jE=(e,t)=>new Promise(n=>{const i=new Image;i.onload=()=>{t||setTimeout(()=>{jE(e,320)},100),n(!0)},i.onerror=i.onabort=()=>n(!1);const a=t||100,o=`x-oss-process=image/resize,m_mfit,w_${a},h_${a}`;e.includes("qwen-webui")?i.src=e:e.includes("?")?i.src=e+`&${o}`:i.src=e+`?${o}`}),NE={mp4:"video/mp4",avi:"video/avi",wmv:"video/x-ms-wmv",flv:"video/x-flv",mkv:"video/x-matroska",mov:"video/quicktime",md:"text/markdown"},PE=2097152;const ME=new class{constructor(){C(this,"uploadTask",{}),C(this,"execUpload",e=>j(this,null,function*(){var t,n;const i=this.uploadTask[e];if(i)try{this.uploadTask[e].status="uploading";const{file:n,client:a,checkPoint:o,parallel:s,partSize:r,ossToken:l}=i,{filePath:c}=l,u=w({},o?{checkPoint:o}:{parallel:s,partSize:r});n.size<PE?yield a.put(c,n):yield a.multipartUpload(c,n,_(w({},u),{progress:(t,n)=>{var a;if(this.uploadTask[e]){const o=Math.round(100*t);this.uploadTask[e].progress=o,null==(a=i.onUploadProgress)||a.call(i,o),this.uploadTask[e].checkPoint=n}}})).catch(e=>{if(!(null==e?void 0:e.name)||"cancel"!==e.name)throw e});const d=i.resumeTime||i.startTime,h=i.resumeTime?"resume":"start",p=GS();if(i.successTime=p,this.sendTrackEvent("finishUpload",{c4:d,c5:p,c6:p-d,c7:h,taskId:e}),yield null==(t=i.onUploadSuccess)?void 0:t.call(i,l.fileId,l.fileCDNUrl),!i.onGreenNetFinish)return void delete this.uploadTask[e];this.uploadTask[e].status="uploadSuccess",this.execGreenNetCheck(e)}catch(a){null==(n=i.onUploadFailed)||n.call(i,a),dS("uploadFileError",{params:{et:"OTHER",c5:e,c6:a instanceof Error?a.message:String(a),c7:String(a)}}),this.uploadTask[e].status="uploadError"}})),C(this,"execGreenNetCheck",e=>j(this,null,function*(){})),C(this,"getParallelParams",e=>e<5242880?{parallel:2,partSize:PE}:e<10485760?{parallel:4,partSize:PE}:e<52428800?{parallel:6,partSize:6291456}:e<104857600?{parallel:8,partSize:8388608}:{parallel:10,partSize:10485760}),C(this,"getFileType",e=>{const{type:t}=e;let n="file";return t.startsWith("video")&&(n="video"),t.startsWith("image")&&(n="image"),t.startsWith("audio")&&(n="audio"),n}),C(this,"sendTrackEvent",(e,t={})=>{try{const n=t,{taskId:i=""}=n,a=S(n,["taskId"]);let o;if(i&&this.uploadTask[i]){const{file:e}=this.uploadTask[i],{name:t,size:n,type:a}=e;o={filename:t,filesize:n,filetype:a}}cS(`FileUpload-${e}`,{params:w(w({et:"OTHER"},a),o?{c8:o}:{})})}catch(n){}}),C(this,"getTaskItem",e=>this.uploadTask[e])}uploadFileToOss(e,t){const n=rt(),{name:i,size:a,type:o}=e,s=this.getFileType(e);return(e=>j(void 0,null,function*(){try{const t=B();yield uw();const n=yield ow("/files/getstsToken",{method:"POST",headers:w({"Content-Type":"application/json","Accept-Language":`${t.language},${t.language.split("-")[0]};q=0.9`},localStorage.token&&{Authorization:`Bearer ${localStorage.token}`}),data:e||{}});if(!n.success||!n.data)return{errorCode:n.data.code||"",info:n.data.message||""};const i=n.data;return{accessKeyId:i.access_key_id,accessKeySecret:i.access_key_secret,stsToken:i.security_token,bucket:i.bucketname,region:i.region,endpoint:i.endpoint,fileId:i.file_id,filePath:i.file_path,fileCDNUrl:i.file_url}}catch(IX){return{errorCode:"",info:""}}}))({filename:i,filesize:a,filetype:s}).then(s=>{var r;if(void 0!==(null==s?void 0:s.errorCode)&&null!==(null==s?void 0:s.errorCode)||!s)return this.sendTrackEvent("ossTokenNetworkError",{c8:{filename:i,filesize:a,filetype:o}}),null==(r=null==t?void 0:t.onUploadFailed)||r.call(t,s),s;if((null==s?void 0:s.errorCode)||"error"===(null==s?void 0:s.type))return this.sendTrackEvent("ossTokenError",{c4:s,c8:{filename:i,filesize:a,filetype:o}}),null;const l=GS(),c=GS();this.sendTrackEvent("ossTokenTime",{c4:c,c5:l,c6:l-c,c8:{filename:i,filesize:a,filetype:o}});const u=new Ht({authorizationV4:!0,region:s.region,endpoint:s.endpoint,accessKeyId:s.accessKeyId,accessKeySecret:s.accessKeySecret,stsToken:s.stsToken,bucket:s.bucket}),d=this.getParallelParams(a),h=w(_(w({taskId:n,file:e,client:u,progress:0},d),{status:"uploading",startTime:c,ossToken:s}),t||{});return this.uploadTask[n]=h,h.startTime=GS(),this.sendTrackEvent("startUpload",{c4:h.startTime,taskId:n}),this.execUpload(n),n}).catch(e=>{var n;throw null==(n=null==t?void 0:t.onUploadFailed)||n.call(t,e),e})}resumeUpload(e){return j(this,null,function*(){var t;const n=this.uploadTask[e];if(n&&"uploadError"===n.status)try{n.resumeTime=GS(),this.sendTrackEvent("resumeUpload",{c4:n.resumeTime,taskId:e}),null==(t=n.onResumeUpload)||t.call(n),yield this.execUpload(e)}catch(i){}})}stopAndRemoveTask(e){return j(this,null,function*(){const t=this.uploadTask[e];if(t){this.sendTrackEvent("stopUpload",{c4:GS(),taskId:e});try{const{client:n,status:i,checkPoint:a}=t;"uploading"===i&&a&&n.abortMultipartUpload(a.name,a.uploadId).catch(e=>{!e.name||e.name}),delete this.uploadTask[e]}catch(n){}}})}getPromise(){let e=()=>{},t=()=>{};return{promise:new Promise((n,i)=>{e=n,t=i}),resolve:e,reject:t}}};let AE=B();const OE=e=>{if(!e||"{}"===JSON.stringify(e))return{};const{image_max_count:t,video_max_count:n,audio_max_count:i,doc_max_count:a,image_max_size:o,video_max_size:s,audio_max_size:r,doc_max_size:l,default_max_size:c,audio_max_duration:u,video_max_duration:d}=e;return{[Lg.DEFAULT]:{max_size:c},[Lg.DOC]:{max_count:a,max_size:l},[Lg.VIDEO]:{max_count:n,max_size:s,max_duration:d},[Lg.IMAGE]:{max_count:t,max_size:o},[Lg.AUDIO]:{max_count:i,max_size:r,max_duration:u}}};class RE{constructor({onAddProcess:e=()=>{},onAddSuccess:t=()=>{},onAddFail:n=()=>{},onPaseSuccess:i=()=>{},onPaseFail:a=()=>{},parsedFileTypes:o=[],userId:s}){C(this,"parseTaskIds",[]),C(this,"loopParse",null),C(this,"fileItems",[]),C(this,"limitTypes",Object.values(Lg)),C(this,"defaultLimitRules",zg),C(this,"limitRules",zg),C(this,"totalMaxCount",Dg),C(this,"onAddProcess",()=>{}),C(this,"onAddSuccess",()=>{}),C(this,"onAddFail",()=>{}),C(this,"onPaseSuccess",()=>{}),C(this,"onPaseFail",()=>{}),C(this,"userId"),C(this,"parsedFileTypes",[]),C(this,"beforeFileUpload",(e,t=!1,n)=>{const i=rt(),a=n===Lg.VIDEO,o=(e=>{switch(e){case"vision":return"image";case"document":case"audio":case"default":return"file";default:return e}})(n);return w({type:o,file:e,id:null,url:"",name:e.name,collection_name:"",progress:0,status:"uploading",greenNet:a?"greening":"success",size:e.size,error:"",itemId:i,file_type:e.type,showType:o,file_class:n},t||"default"===n?{context:"full"}:{})}),C(this,"startParse",(e,t)=>j(this,null,function*(){var n;e.id&&(n={file_id:e.id},j(void 0,null,function*(){const e=Hf();return yield ow("/files/parse",{method:"POST",headers:{"Accept-Language":`${e.language},${e.language.split("-")[0]};q=0.9`},data:n})})).then(n=>{var i,a,o,s,r;if(n.success&&(null==(i=n.data)?void 0:i.file_id)&&(null==(a=n.data)?void 0:a.file_id)===e.id){if(e.file&&(e.file=_(w({},e.file),{meta:_(w({},null==(o=e.file)?void 0:o.meta),{parse_meta:{parse_status:"running"}})}),this.parseTaskIds.push(null==(s=n.data)?void 0:s.file_id)),t){const t=this.fileItems.find(t=>t.id===e.id);(null==t?void 0:t.file)&&(t.file=e.file)}this.loopParse||this.loopGetParseStatus(),this.onAddSuccess(this.fileItems,e)}else e.file&&(this.parseTaskIds=this.fileItems.filter(t=>t.id&&t.id!==e.id).map(e=>e.id||""),e.file=_(w({},e.file),{meta:_(w({},null==(r=e.file)?void 0:r.meta),{parse_meta:{parse_status:"failed",retry:!0}})}),this.onPaseFail(this.fileItems,e))})})),C(this,"loopGetParseStatus",()=>j(this,null,function*(){const e=()=>{this.parseTaskIds=[],this.loopParse=null,this.fileItems.length&&this.fileItems.map(e=>{var t,n,i,a;e.file&&"running"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)&&(e.file=_(w({},e.file),{meta:_(w({},null==(a=e.file)?void 0:a.meta),{parse_meta:{parse_status:"failed",retry:!0}})}),this.onPaseFail(this.fileItems,e))})};try{this.loopParse=setTimeout(()=>{const t=this.parseTaskIds.filter(e=>this.fileItems.find(t=>t.id===e));var n;t.length?(n={file_id_list:t},j(void 0,null,function*(){const e=Hf();return yield ow("/files/parse/status",{method:"POST",headers:{"Accept-Language":`${e.language},${e.language.split("-")[0]};q=0.9`},data:n})})).then(t=>{var n;if(t.success){const e=[];null==(n=null==t?void 0:t.data)||n.map(t=>{var n,i,a,o,s,r,l,c;const u=this.fileItems.find(e=>e.id===t.file_id);"running"===t.status&&u?e.push(t.file_id):"success"===t.status&&u&&"running"===(null==(a=null==(i=null==(n=null==u?void 0:u.file)?void 0:n.meta)?void 0:i.parse_meta)?void 0:a.parse_status)?u.file&&(u.file=_(w({},u.file),{meta:_(w({},null==(o=u.file)?void 0:o.meta),{parse_meta:{parse_status:"success"}})}),this.onPaseSuccess(this.fileItems,u)):"failed"===t.status&&u&&"running"===(null==(l=null==(r=null==(s=null==u?void 0:u.file)?void 0:s.meta)?void 0:r.parse_meta)?void 0:l.parse_status)&&u.file&&(u.file=_(w({},u.file),{meta:_(w({},null==(c=u.file)?void 0:c.meta),{parse_meta:{parse_status:"failed",error_msg:t.error_msg,error_code:t.error_code,retry:t.retry}})}),tE.openOnce({type:"error",content:AE.t(t.error_msg)}),this.onPaseFail(this.fileItems,u))}),e.length?(this.parseTaskIds=e,this.loopGetParseStatus()):(clearTimeout(this.loopParse),this.loopParse=null,this.parseTaskIds=[])}else e()}):(clearTimeout(this.loopParse),this.loopParse=null,this.parseTaskIds=[])},2e3)}catch(t){clearTimeout(this.loopParse),this.loopParse=null,this.parseTaskIds=[]}})),C(this,"uploadFile",e=>j(this,null,function*(){const{file:t,fullContext:n=!1,uploadType:i,retryFile:a}=e;if(!this.validateFileCount(i))return!1;const o=a||this.beforeFileUpload(t,n,i);this.fileItems.push(o),a&&(o.status="uploading",this.onAddProcess(this.fileItems,o));const s=i===Lg.VIDEO,r=i===Lg.AUDIO,l=i===Lg.IMAGE;try{const e=GS(),n=yield ME.uploadFileToOss(t,{onUploadProgress:e=>{o.progress=e,this.updateFile(o),this.onAddProcess(this.fileItems,o)},onUploadFailed:e=>{let t="Upload failed. Please try again after your network connection is restored.";(null==e?void 0:e.errorCode)&&(t=e.info),tE.openOnce({type:"error",content:AE.t(t)}),o.status="upload_error","data_inspection_failed"===(null==e?void 0:e.errorCode)&&(o.greenNet="green_error"),this.updateFile(o),this.onAddFail(this.fileItems,o)},onResumeUpload:()=>{o.status="uploading",this.updateFile(o),this.onAddProcess(this.fileItems,o)},onUploadSuccess:(i,a)=>j(this,null,function*(){var c,u;const d=GS();let h=GS();var p;o.id=i,o.url=a,o.file=((e,t,n)=>{const{name:i,size:a,type:o}=e,s=(new Date).getTime();return{created_at:s,data:{},filename:i,hash:null,id:t,user_id:n,meta:{name:i,size:a,content_type:o},update_at:s}})(t,i,this.userId),s||l||r||(o.status="uploaded"),s&&(o.type="video",(yield(p=a,new Promise(e=>{const t=document.createElement("video");t.style.display="none",t.style.width="0%",t.style.height="0%",Object.assign(t,{controls:!1,autoplay:!1,muted:!0});let n=!1;t.onloadedmetadata=()=>{n||(n=!0,e(!0),document.body.removeChild(t))},t.onload=()=>{n||(n=!0,e(!0),document.body.removeChild(t))},t.onerror=()=>{n||(n=!0,e(!1),document.body.removeChild(t))},t.src=p,document.body.appendChild(t)})))?(h=GS(),o.showType="video"):o.showType="file",o.status="uploaded"),r&&(o.type="audio",(yield(e=>new Promise(t=>{const n=document.createElement("audio");n.style.display="none",n.style.width="0%",n.style.height="0%",Object.assign(n,{controls:!1,autoplay:!1,muted:!0});let i=!1;n.onloadedmetadata=()=>{i||(i=!0,t(!0),document.body.removeChild(n))},n.onload=()=>{i||(i=!0,t(!0),document.body.removeChild(n))},n.onerror=()=>{i||(i=!0,t(!1),document.body.removeChild(n))},n.src=e,document.body.appendChild(n)}))(a))?(h=GS(),o.showType="audio"):o.showType="file",o.status="uploaded"),l&&(o.type="image",(yield jE(a))?(h=GS(),o.showType="image"):o.showType="file",o.status="uploaded");let m=0;try{m=function(e,t,n=2){if("number"!=typeof e||"number"!=typeof t)throw new Error("");if(e<=0)throw new Error("0");if(t<=0)throw new Error("0");return Number((e/1048576/(t/1e3)).toFixed(n))}(t.size,Math.round(d-e),3)}catch(f){}dS("FileUpload-AllTime",{params:{et:"OTHER",c1:null==(c=null==o?void 0:o.file)?void 0:c.user_id,c4:o.type,c5:t.size,c6:Math.round(h-e),c7:Math.round(h-d),c8:Math.round(d-e),c9:m}}),n&&!ME.getTaskItem(n)||((null==(u=this.parsedFileTypes)?void 0:u.length)&&this.parsedFileTypes.includes(o.type)?this.startParse(o):this.onAddSuccess(this.fileItems,o))})});n?n.errorCode||(o.uploadTaskId=n,this.onAddProcess(this.fileItems,o)):(this.fileItems=this.fileItems.filter(e=>(null==e?void 0:e.itemId)!==o.itemId),this.onAddFail(this.fileItems,o))}catch(kX){"ossTokenError"!==kX.code&&tE.openOnce({type:"error",content:AE.t("Failed to upload file.")}),this.fileItems=this.fileItems.filter(e=>(null==e?void 0:e.itemId)!==o.itemId),this.onAddFail(this.fileItems,o)}})),C(this,"updateFile",e=>{const t=this.fileItems.findIndex(t=>t.itemId===e.itemId);t>-1&&this.fileItems.splice(t,1,e)}),C(this,"pushFile",e=>{Array.isArray(e)?this.fileItems=[...this.fileItems,...e]:this.fileItems.push(e)}),C(this,"setFiles",e=>{this.fileItems=e}),this.onAddProcess=e,this.onAddSuccess=t,this.onAddFail=n,this.onPaseSuccess=i,this.onPaseFail=a,this.userId=s,this.parsedFileTypes=o,AE=B()}updateLimitTypes(e){e&&(this.limitTypes=e)}getLimitTypes(){return this.limitTypes}updateLimitRules(e,t="custom"){"default"===t?(this.defaultLimitRules=At(jt(zg),e),this.limitRules=this.defaultLimitRules):this.limitRules=At(jt(this.defaultLimitRules),e);const n=["image/tiff"],i=[".tif",".tiff",".dib"],a=[".dib"],o=this.limitRules[Lg.IMAGE].accept_type,s=this.limitRules[Lg.IMAGE].accept_extension;Px()&&(this.limitRules[Lg.IMAGE].accept_extension=s.filter(e=>!a.includes(e))),Ax()&&(this.limitRules[Lg.IMAGE].accept_type=o.filter(e=>!n.includes(e)),this.limitRules[Lg.IMAGE].accept_extension=s.filter(e=>!i.includes(e)))}getLimitRules(){return this.limitRules}validateFile(e,t){return j(this,null,function*(){const n=this.validateFileType(e,t);if(!n||!this.isValidFileType(n))return!1;if(!this.validateFileCount(n))return!1;if(!this.validateFileSize(e,n))return!1;return!!(yield this.validateFileDuration(e,n))&&n})}addFile(e,t){return j(this,null,function*(){const n=(e=>{var t,n,i;if(e.type)return e;const a=null==(i=null==(n=null==(t=null==e?void 0:e.name)?void 0:t.split("."))?void 0:n.at(-1))?void 0:i.toLowerCase();return a&&!(a in NE)||!a?e:new File([e],e.name,{type:NE[a]})})(e),i=yield this.validateFile(n,t);return!!i&&(yield this.uploadFile({file:n,fullContext:!1,uploadType:i}),!0)})}retryFile(e){return j(this,null,function*(){e.file&&(yield this.uploadFile({file:e.file,fullContext:!1,uploadType:e.file_class,retryFile:e}))})}addFiles(e,t){return j(this,null,function*(){var n;if(0===(null==(n=e.filter(e=>!!e))?void 0:n.length))return tE.openOnce({type:"error",content:AE.t("File not found.")}),!1;const i=(yield Promise.allSettled(e.map(e=>this.addFile(e,t)))).filter(e=>"rejected"===e.status).map(e=>e.reason.message);return!(i.length>0&&i.length===e.length)&&this.fileItems})}removeFile(e){this.fileItems=this.fileItems.filter(t=>t.itemId!==e.itemId)}clearFiles(){this.fileItems=[]}getFiles(){return this.fileItems}getFileExtensions(e){var t,n,i;return`${null==(i=null==(n=null==(t=null==e?void 0:e.name)?void 0:t.split("."))?void 0:n.at(-1))?void 0:i.toLowerCase()}`||""}isValidFileType(e){return e&&Object.values(Lg).includes(e)}validateFileType(e,t){const n=e.type,i=this.getFileExtensions(e);if(t){const e=this.limitRules[t];return this.limitTypes.includes(t)&&(e.accept_type.includes(n)||e.accept_extension.includes(i))?t:void tE.openOnce({type:"error",content:AE.t("The selected model or feature does not support the file type you uploaded.")})}let a;if(Object.entries(this.limitRules).forEach(([e,t])=>{(t.accept_type.includes(n)||t.accept_extension.includes(i))&&(a=e)}),a&&this.limitTypes.includes(a))return a;tE.openOnce({type:"error",content:AE.t("The selected model or feature does not support the file type you uploaded.")})}validateFileSize(e,t){const n=this.limitRules[t];if(0==e.size)return AE.t("You cannot upload an empty file."),!1;if(e.size>1024*n.max_size*1024){const e={[Lg.IMAGE]:"Images",[Lg.AUDIO]:"Audio",[Lg.VIDEO]:"Video",[Lg.DOC]:"Document",[Lg.DEFAULT]:"TXT"};return tE.openOnce({type:"error",content:AE.t("{{type}} files are not allowed to exceed {{size}}",{type:AE.t(e[t]),size:`${n.max_size}M`})}),!1}return!0}validateFileDuration(e,t){return j(this,null,function*(){if(t!==Lg.VIDEO&&t!==Lg.AUDIO)return!0;const n=this.limitRules[t];if(t===Lg.VIDEO){const t=yield(e=>new Promise(t=>{const n=document.createElement("video");n.style.display="none",n.style.width="0%",n.style.height="0%",Object.assign(n,{controls:!1,autoplay:!1,muted:!0});const i=URL.createObjectURL(e);let a=!1;n.onloadedmetadata=()=>{if(!a){a=!0;const e=Math.round(1e3*n.duration);t(e),URL.revokeObjectURL(i),document.body.removeChild(n)}},n.onload=()=>{if(!a){a=!0;const e=Math.round(1e3*n.duration);t(e),URL.revokeObjectURL(i),document.body.removeChild(n)}},n.onerror=()=>{a||(a=!0,t(0),URL.revokeObjectURL(i),document.body.removeChild(n))},n.src=i,document.body.appendChild(n)}))(e);if(t>1e3*n.max_duration)return n.max_duration<60?tE.openOnce({type:"error",content:AE.t("Video duration should not exceed {{maxSeconds}} seconds",{maxSeconds:n.max_duration})}):tE.openOnce({type:"error",content:AE.t("Video duration should not exceed {{maxMins}} mins.",{maxMins:(n.max_duration/60).toFixed(0)})}),!1}if(t===Lg.AUDIO){const t=yield(e=>new Promise(t=>{const n=document.createElement("audio");n.style.display="none",n.style.width="0%",n.style.height="0%",Object.assign(n,{controls:!1,autoplay:!1,muted:!0});const i=URL.createObjectURL(e);let a=!1;n.onloadedmetadata=()=>{if(!a){a=!0;const e=Math.round(1e3*n.duration);t(e),URL.revokeObjectURL(i),document.body.removeChild(n)}},n.onload=()=>{if(!a){a=!0;const e=Math.round(1e3*n.duration);t(e),URL.revokeObjectURL(i),document.body.removeChild(n)}},n.onerror=()=>{a||(a=!0,t(0),URL.revokeObjectURL(i),document.body.removeChild(n))},n.src=i,document.body.appendChild(n)}))(e);if(t>1e3*n.max_duration)return tE.openOnce({type:"error",content:AE.t("Audio duration should not exceed {{maxMins}} minutes.",{maxMins:n.max_duration/60})}),!1}return!0})}validateFileCount(e){var t;const n={[Lg.IMAGE]:"In a single-turn conversation, up to {{number}} images can be uploaded.",[Lg.AUDIO]:"In a single-turn conversation, up to {{number}} audio files can be uploaded.",[Lg.VIDEO]:"In a single-turn conversation, up to {{number}} video can be uploaded.",[Lg.DOC]:"In a single-turn conversation, up to {{number}} documents can be uploaded.",[Lg.DEFAULT]:"In a single-turn conversation, up to {{number}} documents can be uploaded."},i=this.limitRules[e],a=((null==(t=this.fileItems.filter(t=>t.file_class===e))?void 0:t.length)||0)+1,o=i.max_count;if(a>o)return tE.openOnce({type:"error",content:AE.t(n[e],{number:o})}),!1;return this.fileItems.length>this.totalMaxCount?(tE.openOnce({type:"error",content:AE.t("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:this.totalMaxCount})}),!1):e}}const DE=(e,t="day",n)=>null===e?n.t("Only available for Plus members"):"month"===t?n.t("{{ number }} uses available within this month.",{number:e}):"day"===t?n.t("{{ number }} uses available within this day.",{number:e}):"hour"===t?n.t("{{ number }} uses available within this hour.",{number:e}):"",LE=({remains:e,unit:t="day",capability:n="",allowHtml:i=!1,currentI18n:a})=>i?((e,t,n="day",i)=>`<div class='chat-common-btn-tooltip-text'>\n          <div class='chat-common-btn-tooltip-main-title'>${i.t("{{ capability }}",{capability:i.t(e)})}\n          </div>\n          <div class='chat-common-btn-tooltip-sub-title'>${DE(t,n,i)}</div>\n        <div>`)(n,e,t,a):DE(e,t,a),FE={theme:"light",realTheme:"light",language:"en-US",showSidebar:!1,showSettingSidebar:!1,isSmallScreen:!1,isMiddleScreen:!1,showSettings:!1,showSettingsGeneralAudioList:!1,largeScreen:!1,showControls:!1,showArtifacts:!1,showWebDev:!1,showDeepResearch:!1,showCallOverlay:!1,isSharePage:!1,initInnerHeight:window.innerHeight,stepCurrent:0,showSlogan:!0,nativeInputFocused:!1,userActiveSidebar:!1,sideBarSearchText:"",showMemorySavedModal:!1,showMemoryUpdatedModal:!1,settingActionMenuItemId:"",closeSubscriptionPopupToSetting:!0,showH5PodcastDetail:!1,showTravel:!1,deepDetailTitle:"",sidebarListScrollTop:0,userMenuDropdownOpen:!1,activeChatMenuId:null,showSharePanel:!1,searchInputFocused:!1,omniButtonBackgroundImg:"https://img.alicdn.com/imgextra/i2/O1CN01sdDcX31h2oVI9jUiL_!!6000000004220-2-tps-96-96.png",sidebarFloatingPlaceholder:!1,showHeaderBorder:!1},zE=yb()(px(e=>w(w({},FE),(e=>({setTheme:t=>{if(e({theme:t}),"system"===t){const t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";e({realTheme:t})}else e({realTheme:t})},setRealTheme:t=>e({realTheme:t}),setLanguage:t=>e({language:t}),setSettingSidebar:t=>e({showSettingSidebar:t}),setIsSmallScreen:t=>e({isSmallScreen:t}),setSettingActionMenuItemId:t=>e({settingActionMenuItemId:t}),setCloseSubscriptionPopupToSetting:t=>e({closeSubscriptionPopupToSetting:t}),setIsMiddleScreen:t=>e({isMiddleScreen:t}),setShowSidebar:t=>e({showSidebar:t}),setSidebarFloatingPlaceholder:t=>e({sidebarFloatingPlaceholder:t}),setShowSettings:t=>e({showSettings:t}),setShowSettingsGeneralAudioList:t=>e({showSettingsGeneralAudioList:t}),setLargeScreen:t=>e({largeScreen:t}),setShowControls:t=>e({showControls:t}),setDeepDetailTitle:t=>e({deepDetailTitle:t}),setShowArtifacts:t=>e({showArtifacts:t}),setShowWebDev:t=>e({showWebDev:t}),setShowDeepResearch:t=>e({showDeepResearch:t}),setShowCallOverlay:t=>e({showCallOverlay:t}),setIsSharePage:t=>e({isSharePage:t}),setShowTravel:t=>e({showTravel:t}),setInitInnerHeight:t=>e({initInnerHeight:t}),setStepCurrent:t=>e({stepCurrent:t}),setShowSlogan:t=>e({showSlogan:t}),setNativeInputFocused:t=>e({nativeInputFocused:t}),setUserActiveSidebar:t=>e({userActiveSidebar:t}),setSideBarSearchText:t=>e({sideBarSearchText:t}),setShowMemorySavedModal:t=>e({showMemorySavedModal:t}),setShowMemoryUpdatedModal:t=>e({showMemoryUpdatedModal:t}),setShowH5PodcastDetail:t=>e({showH5PodcastDetail:t}),setSidebarListScrollTop:t=>e({sidebarListScrollTop:t}),setUserMenuDropdownOpen:t=>e({userMenuDropdownOpen:t}),setActiveChatMenuId:t=>e({activeChatMenuId:t}),setShowSharePanel:t=>e({showSharePanel:t}),setOmniButtonBackgroundImg:t=>e({omniButtonBackgroundImg:t}),setSearchInputFocused:t=>e({searchInputFocused:t}),setShowHeaderBorder:t=>e({showHeaderBorder:t})}))(e)),{name:"uiStore",store:"uiStore",enabled:!1})),UE={user:void 0},HE=yb()(px(e=>w(w({},UE),(e=>({setUser:t=>e({user:t}),fetchUser:(t=!0)=>j(void 0,null,function*(){const n=Hf();try{const{success:i,data:a}=yield __(t);if(i&&a)return e({user:a}),a.token&&localStorage.setItem("token",a.token),a;t&&tE.openOnce({type:"error",content:n.t(null==a?void 0:a.message)})}catch(i){}})}))(e)),{name:"userStore",store:"userStore",enabled:!1}));let BE=!1;const $E={subscriptionPlus:!1,paymentRequestId:"",showSubscriptionDetail:!1,showSubscriptionCheckLoading:!1,paymentSubscriptionStatus:null,paymentSubscriptionInfo:null,paymentUserNotifications:[],paymentIssueNotification:null,paymentExpiredNotification:null,paymentReminderNotification:null},qE=e=>({setSubscriptionPlus:t=>e({subscriptionPlus:t}),setPaymentRequestId:t=>e({paymentRequestId:t}),setShowSubscriptionDetail:t=>e({showSubscriptionDetail:t}),setShowSubscriptionCheckLoading:t=>e({showSubscriptionCheckLoading:t}),setPaymentSubscriptionStatus:t=>e({paymentSubscriptionStatus:t}),fetchPaymentSubscriptionStatus:()=>j(void 0,null,function*(){try{const{data:t}=yield j(void 0,null,function*(){return yield ow("/payment/get_subscription_status")});return t&&!t.code?(e({paymentSubscriptionStatus:t}),t):(t&&t.code,null)}catch(t){return null}}),setPaymentSubscriptionInfo:t=>e({paymentSubscriptionInfo:t}),fetchPaymentSubscriptionInfo:()=>j(void 0,null,function*(){var t;if(!["user","admin"].includes((null==(t=HE.getState().user)?void 0:t.role)||""))return;const n=zE.getState().language;try{const t=yield((e="en")=>j(void 0,null,function*(){return yield ow(`/configs/?code=page.${e}.payment.subscription-info`)}))((e=>{const t=e.split("-"),n=t[0].toLowerCase();return"zh"===n&&t.length>1?`${n}-${t[1].toLowerCase()}`:n})(n));if(!t)return;t.data.normal&&e({paymentSubscriptionInfo:t.data})}catch(i){}}),fetchPaymentUserNotifications:()=>j(void 0,null,function*(){var t;if(["user","admin"].includes((null==(t=HE.getState().user)?void 0:t.role)||"")&&!BE)try{BE=!0;const t=yield j(void 0,null,function*(){return yield ow("/notifications/payment")});if(!t)return void(BE=!1);const{data:{notifications:n=[]}=[]}=t;n&&(e({paymentIssueNotification:n.find(e=>"subscription_renewal_issue"===e.type)||null}),e({paymentExpiredNotification:n.find(e=>"subscription_expired"===e.type)||null}),e({paymentReminderNotification:n.find(e=>"subscription_expired_reminder"===e.type)||null})),e({paymentUserNotifications:n})}catch(n){}finally{BE=!1}})}),GE=yb()(fx(px(e=>w(w({},$E),qE(e)),{name:"paymentStore",store:"paymentStore",enabled:!1})));let VE=null;const WE=()=>{const e=HE.subscribe(e=>{var t,n;e.user&&(localStorage.setItem("userRole",String(null==(t=e.user)?void 0:t.role)),["admin","user"].includes(null==(n=e.user)?void 0:n.role)&&KE.getState().updateEquity())});VE=Ex.subscribe(e=>{var t,n;!UT()&&(null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_payment_and_quota)&&(VE&&VE(),GE.getState().fetchPaymentSubscriptionInfo(),GE.getState().fetchPaymentUserNotifications())});const t=GE.subscribe(e=>e.subscriptionPlus,(e,t)=>j(void 0,null,function*(){e!==t&&(yield GE.getState().fetchPaymentUserNotifications())}));return()=>{e(),VE&&VE(),t()}},QE={remains:-1,unit:"hour",amount:1},KE=fb()(lx((e,t)=>({modelsEquities:{},featuresEquities:{},isUpdating:!1,startAutoUpdate:!1,updateEquity:()=>j(void 0,null,function*(){yield t().resolveAllEquity()}),resetAllEquity:()=>j(void 0,null,function*(){e(e=>{Object.keys(e.modelsEquities).forEach(t=>{e.modelsEquities[t]=QE}),Object.keys(e.featuresEquities).forEach(t=>{e.featuresEquities[t]=QE})})}),getModelEquity:e=>{const n=t();return n.modelsEquities[e]?n.modelsEquities[e]:(n.updateEquityAndCache(e,QE,"model"),QE)},getFeatureEquity:e=>{const n=t();return n.featuresEquities[e]?n.featuresEquities[e]:(n.updateEquityAndCache(e,QE,"feature"),QE)},updateEquityAndCache:(t,n,i)=>{e(e=>{"model"===i?e.modelsEquities[t]&&Ot(e.modelsEquities[t],n)||(e.modelsEquities[t]=n):e.featuresEquities[t]&&Ot(e.featuresEquities[t],n)||(e.featuresEquities[t]=n)})},resolveAllEquity:()=>j(void 0,null,function*(){var n,i,a;if(!(null==(i=null==(n=Ex.getState().config)?void 0:n.features)?void 0:i.enable_payment_and_quota))return;if(!["user","admin"].includes((null==(a=HE.getState().user)?void 0:a.role)||""))return;const o=t();if(!o.isUpdating){e(e=>{e.isUpdating=!0});try{const e=yield(s=[...bv],j(void 0,null,function*(){return yield ow("/users/user/entitlement_quota",{method:"POST",data:JSON.stringify({features:s})})})),t=null==e?void 0:e.data;if(t&&t.model){const e=t.model;e&&Object.keys(e).length&&Object.keys(e).forEach(t=>{const n=e[t];if(n){const e=o.formatEquity(n);o.updateEquityAndCache(t,e,"model")}}),Object.keys(t).forEach(e=>{if("model"!==e){const n=t[e];if(n){const t=o.formatEquity(n);o.updateEquityAndCache(e,t,"feature")}}}),GE.getState().setSubscriptionPlus("subscription-plus"===t.user_tier)}}finally{e(e=>{e.isUpdating=!1})}var s}}),formatEquity:e=>({remains:e.times_left,unit:e.time_unit,amount:e.time_amount})}))),YE=()=>j(void 0,null,function*(){KE.getState().resolveAllEquity(),GE.getState().fetchPaymentUserNotifications()}),XE=()=>j(void 0,null,function*(){var e,t;(null==(t=null==(e=Ex.getState().config)?void 0:e.features)?void 0:t.enable_payment_and_quota)&&(KE.getState().startAutoUpdate=!0,document.addEventListener("visibilitychange",()=>j(void 0,null,function*(){"visible"===document.visibilityState&&YE()})),window.addEventListener("pageshow",YE),window.addEventListener("focus",YE))});Ex.subscribe(e=>{var t,n;!KE.getState().startAutoUpdate&&(null==(n=null==(t=e.config)?void 0:t.features)?void 0:n.enable_payment_and_quota)&&(KE.getState().resolveAllEquity(),XE())}),XE(),KE.getState().resolveAllEquity();const JE=(e,t)=>{if(t)return t;switch(e){case lg.PARSING:return Pv("Please wait, Qwen is still viewing the webpage content");case lg.SUCCESS:return Pv("Qwen successfully viewed the content of this webpage");case lg.FAIL:return Pv("Qwen was unable to view the content of this webpage");case lg.OUT_OF_LIMIT:return Pv("Qwen can only view up to 10 webpages per round");default:return Pv("Qwen was unable to view the content of this webpage")}},ZE=(e,t)=>{if(zx()&&Yx("1.0.0",!0))return[];const n=[];let i=0,a=e;"string"!=typeof a&&(a=String(a));return[...a.matchAll(/(https):\/\/([a-zA-Z0-9\-.]+\.[a-zA-Z]{2,})(:[0-9]+)?(\/[a-zA-Z0-9/+=%&_.~?@-]*)?(#[a-zA-Z0-9/+=%&_.~?-]*)?(?=\s|$|[^\u0080-\uFFFF])/g)].forEach((e,o)=>{var s,r;const l=e[0],c=e.index,u=c+l.length;i<c&&n.push({content:a.slice(i,c),type:rg.text});const d=void 0===t?lg.PARSING:(null==(s=t.find(e=>e.url===l))?void 0:s.status)||lg.FAIL;n.push({content:l,type:rg.url,title:JE(d,null==(r=null==t?void 0:t.find(e=>e.url===l))?void 0:r.title),status:d}),i=u}),i<(null==a?void 0:a.length)&&n.push({content:a.slice(i),type:rg.text}),n},ek=e=>{let t="";return e.forEach(e=>{t+=e.content,e.type===rg.url&&(t+=" ")}),t},tk=e=>ZE(e).filter(e=>e.type===rg.url).map(e=>e.content),nk=(e,t)=>e.map(e=>_(w({},e),{title:t.t(e.title||""),query:t.t(e.query||"")})),ik=(e,t)=>t.map(t=>_(w({},t),{value:e.t((null==t?void 0:t.value)||""),prompt:e.t((null==t?void 0:t.prompt)||"")})),ak=(e,t,n)=>{if(!t)return e;if("zh-CN"===n){let n=t.split(" ").filter(Boolean).map(e=>{return`\\b${t=e,t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\b`;var t}).join("|");const i=[...t].filter(e=>/[\u4e00-\u9fff]/.test(e));if(i.length>0){n+=(n?"|":"")+i.map(e=>`(${e})`).join("|")}const a=new RegExp(n,"gi");return e.replace(a,e=>`<span style="color: ${TE("#8F91A8","#AFB1C4")}; display: inline;">${e}</span>`)}if(e.includes(t)){const n=new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g");return e.replace(n,e=>`<span style="color: ${TE("#8F91A8","#AFB1C4")}; display: inline;">${e}</span>`)}return e},ok=(e,t=null)=>{const n=[...e],i=n.length,a=null==t||t<0?i:Math.min(t,i);for(let o=i-1;o>0;o--){const e=Math.floor(Math.random()*(o+1));[n[o],n[e]]=[n[e],n[o]]}return n.slice(0,a)},sk=e=>e===ng.ImageGeneration?"image_generation":e===ng.WebSearch?"web_search":e===ng.VideoGeneration?"video_generation":e,rk={[ng.VideoGeneration]:{fileType:["JPG","JPEG","PNG","BMP","WEBP"],mineType:["image/png","image/jpeg","image/bmp","image/webp"],extensions:[".png",".jpg",".jpeg",".bmp",".webp"]}},lk=(e,t,n,i,a,o,s)=>{var r;const l=null==(r=null==i?void 0:i.permissions)?void 0:r.chat;return t.map(t=>{var r,c,u,d,h,p;const m=e.t(t.value||"");let f=null;const g=t.subChatType||t.chatType;if(s){let t;g===ng.ImageGeneration?t=s.qT2IEquity:g===ng.VideoGeneration?t=s.qT2VEquity:g===ng.ImageEdit?t=s.qImageEditEquity:g===ng.DeepResearch&&(t=s.qDeepResearchEquity),t&&-1!==t.remains&&(f={disabled:null===t.remains||0===t.remains,msg:LE({remains:t.remains,unit:t.unit,allowHtml:!0,capability:m,currentI18n:e})})}n&&g!==ng.Txt2Txt&&(f={disabled:!0,msg:e.t("The function {{capability}} is not supported in battle mode.",{capability:m})}),0===(null==l?void 0:l[g])&&(f={disabled:!0,msg:e.t("Coming soon")}),5===(null==l?void 0:l[g])&&UT()&&(f={disabled:!0,msg:e.t("{{capability}} is not supported in guest mode.",{capability:m})});let v=!1;if(v=!((null==(c=null==(r=null==a?void 0:a.info)?void 0:r.meta)?void 0:c.chat_type)||[]).includes(g),v)return t.disabledInfo={disabled:!0,msg:e.t("{{model}} does not support {{capability}}",{model:null==a?void 0:a.name,capability:m})},t;if(!Pt(o)){let e=(null==(d=null==(u=null==i?void 0:i.features)?void 0:u.feature_file)?void 0:d[sk(g)])||Object.values(Fg);g!==ng.DeepResearch&&g!==ng.DeepThinking||(e=[Fg.FILE,Fg.IMAGE]);o.some(t=>e.includes(t.showType))||(f={disabled:!0,msg:""})}const y=null==(p=null==(h=null==i?void 0:i.features)?void 0:h.limits)?void 0:p[sk(g)];if(y){const e=o.filter(e=>"image"===e.type),t=y.image_max_count;"number"==typeof t&&e.length>t&&(f={disabled:!0,msg:Hf().t("In a single-turn conversation, up to {{number}} images can be uploaded.",{number:t})})}const b=rk[g];if(b){o.filter(e=>"image"===e.type).find(e=>{const{name:t="",file_type:n=""}=e;return!(b.mineType.includes(n)&&b.extensions.find(e=>t.toLowerCase().endsWith(e)))})&&(f={disabled:!0,msg:Hf().t(`Only ${b.fileType.join(", ")} files are supported.`)})}return t.disabledInfo=f||{disabled:!1,msg:""},t})},ck=(e,t,n=[],i,a,o)=>{var s;const r=null==(s=null==i?void 0:i.features)?void 0:s.feature_file,l=null==r?void 0:r[sk(t)];if(l&&!(null==l?void 0:l.includes(e)))return!0;if(n.some(t=>{const n=null==r?void 0:r[sk(t)];return n&&!(null==n?void 0:n.includes(e))}))return!0;const c=(e=>{const t=["default"];return Object.keys(Lg).forEach(n=>{const i=Lg[n];e.every(e=>{var t,n,a;return 1===(null==(a=null==(n=null==(t=null==e?void 0:e.info)?void 0:t.meta)?void 0:n.abilities)?void 0:a[i])})&&t.push(i)}),t})(a||[]).map(e=>"document"===e||"default"===e?Fg.FILE:"vision"===e?Fg.IMAGE:e);return!c.includes(e)||!(e!==Fg.IMAGE||t!==ng.VideoGeneration||!(null==o?void 0:o.some(e=>"image"===e.type)))},uk=(e,t,n,i,a=[],o)=>{var s,r,l,c,u,d,h,p,m,f;if(o&&(null==o?void 0:o.length)>1||(null==i?void 0:i.length)>1)return{disabled:!0,msg:Pv("The function {{capability}} is not supported in battle mode.",{capability:t})};if(!i||1===(null==i?void 0:i.length)&&!i[0])return{disabled:!1,msg:""};if(0===(null==(r=null==(s=null==n?void 0:n.permissions)?void 0:s.chat)?void 0:r[e]))return{disabled:!0,msg:Pv("Coming soon")};if(5===(null==(c=null==(l=null==n?void 0:n.permissions)?void 0:l.chat)?void 0:c[e])&&UT())return{disabled:!0,msg:Pv("{{capability}} is not supported in guest mode.",{capability:t})};const g=i[0],v=(null==(d=null==(u=null==g?void 0:g.info)?void 0:u.meta)?void 0:d.chat_type)||[],y=(null==(p=null==(h=null==g?void 0:g.info)?void 0:h.meta)?void 0:p.abilities)||{};let b=!1;if(b=e===ng.Thinking||e===ng.Mcp?!(null==y?void 0:y[e])||0===(null==y?void 0:y[e])||2===(null==y?void 0:y[e])||5===(null==y?void 0:y[e]):!v.includes(e),b)return{disabled:!0,msg:Pv("{{model}} does not support {{capability}}",{model:null==g?void 0:g.name,capability:t})};const x=(null==(f=null==(m=null==n?void 0:n.features)?void 0:m.feature_file)?void 0:f[sk(e)])||Object.values(Fg);return Object.values(Fg).some(e=>!(x.includes(e)||!a.some(t=>{return((n=t.file_class)===Lg.DOC||n===Lg.DEFAULT?Fg.FILE:n===Lg.IMAGE?Fg.IMAGE:n)===e;var n})))?{disabled:!0,msg:""}:{disabled:!1,msg:""}},dk=(e,t,n,i,a)=>{var o,s,r,l,c,u,d,h;if(!i||1===(null==i?void 0:i.length)&&!i[0])return{disabled:!1,msg:""};if(0===(null==(s=null==(o=null==n?void 0:n.permissions)?void 0:o.chat)?void 0:s[e]))return{disabled:!0,msg:Pv("Coming soon")};if(5===(null==(l=null==(r=null==n?void 0:n.permissions)?void 0:r.chat)?void 0:l[e])&&UT())return{disabled:!0,msg:Pv("{{capability}} is not supported in guest mode.",{capability:t})};const p=i[0],m=(null==(u=null==(c=null==p?void 0:p.info)?void 0:c.meta)?void 0:u.chat_type)||[],f=(null==(h=null==(d=null==p?void 0:p.info)?void 0:d.meta)?void 0:h.abilities)||{};let g,v=!1;return v=e===ng.Thinking||e===ng.Mcp?!(null==f?void 0:f[e])||0===(null==f?void 0:f[e]):!m.includes(e),v?{disabled:!0,msg:Pv("{{model}} does not support {{capability}}",{model:null==p?void 0:p.name,capability:t})}:(e===ng.DeepResearch?g=a.qDeepResearchEquity:e===ng.ImageGeneration?g=a.qT2IEquity:e===ng.VideoGeneration?g=a.qT2VEquity:e===ng.ImageEdit&&(g=a.qImageEditEquity),g&&null===(null==g?void 0:g.remains)||0===(null==g?void 0:g.remains)?{disabled:!0,msg:LE({remains:(null==g?void 0:g.remains)||0,currentI18n:Hf(),unit:null==g?void 0:g.unit})}:{disabled:!1,msg:""})};const hk=[ng.ImageGeneration,ng.VideoGeneration,ng.ImageEdit],pk=(e,t,n=[],i,a)=>{var o,s;if(["thinking","web_search"].includes(e)&&hk.includes(t))return!1;if(Array.isArray(a)){const t="web_search"===e?"search":e;if(a.map(e=>{var n,i,a;return null==(a=null==(i=null==(n=null==e?void 0:e.info)?void 0:n.meta)?void 0:i.abilities)?void 0:a[t]}).includes(2))return!1}if(e===sk(t)||n.includes(e))return!0;return function(...e){if(0===e.length)return[];let t=e[0];for(let n=1;n<e.length&&(t=t.filter(t=>e[n].includes(t)),0!==t.length);n++);return t}((null==(s=null==(o=null==i?void 0:i.features)?void 0:o.feature_feature)?void 0:s[sk(t)])||[e],...n.map(t=>{var n,a;return(null==(a=null==(n=null==i?void 0:i.features)?void 0:n.feature_feature)?void 0:a[sk(t)])||[e]})).includes(e)},mk=(e,t,n,i,a,o)=>{var s,r,l,c,u;const{disabled:d}=uk(e,t,n,i,a);return!d&&(1===(null==i?void 0:i.length)&&((null==(r=null==(s=null==n?void 0:n.permissions)?void 0:s.chat)?void 0:r[e])===o||(null==(u=null==(c=null==(l=i[0])?void 0:l.info)?void 0:c.meta)?void 0:u.abilities[e])===o))},fk=(e,t,n)=>t===ng.DeepResearch&&((e,t)=>{let n=Object.keys(e);t&&(n=jC(t,{messages:e}).map(e=>e.id));let i=!1;return n.filter(t=>{var n;const a=e[t];if(!a)return!1;let o=!1;return a.sub_chat_type===ng.DeepResearch&&(o=!!(null==(n=null==a?void 0:a.content_list)?void 0:n.find(e=>"PdfMdGen"===e.phase)),i=!0),!a.error&&"assistant"===a.role&&a.chat_type===ng.DeepResearch||o}).length>=2&&i})(e,n||""),gk=(e,t,n)=>t===ng.Travel&&((e,t)=>{let n=Object.keys(e);t&&(n=jC(t,{messages:e}).map(e=>e.id));let i=!1;return n.filter(t=>{var n;const a=e[t];if(!a)return!1;let o=!1;return(null==a?void 0:a.sub_chat_type)===ng.TRAVEL_RESEARCH&&(o=!!(null==(n=null==a?void 0:a.content_list)?void 0:n.find(e=>"PdfMdGen"===e.phase)),i=!0),!a.error&&"assistant"===a.role&&a.chat_type===ng.Travel||o}).length>=2&&i})(e,n||"");const vk=(e,t)=>{const n=null==e?void 0:e[t||""];return n?n.chat_type===ng.DeepResearch&&n.sub_chat_type===ng.DeepResearch?n:(null==n?void 0:n.parentId)?vk(e,null==n?void 0:n.parentId):null:null};class yk{constructor(){C(this,"paramsMap",{}),C(this,"addItem",(e,t)=>{if(!e)return{};this.paramsMap=_(w({},this.paramsMap),{[e]:t})}),C(this,"removeItem",e=>{if(!e)return{};delete this.paramsMap[e]}),C(this,"getParamsMap",()=>this.paramsMap),C(this,"getParams",e=>e?this.paramsMap[e]:{}),C(this,"setParams",(e,t)=>{if(!e)return{};this.paramsMap=_(w({},this.paramsMap),{[e]:w(w({},this.paramsMap[e]),t)})}),C(this,"setParamsForAll",e=>{this.paramsMap&&"{}"!==JSON.stringify(this.paramsMap)&&Object.keys(this.paramsMap).forEach(t=>{this.paramsMap[t]=w(w({},this.paramsMap[t]),e)})}),C(this,"clearParams",()=>{this.paramsMap={}})}}const bk=new class extends yk{constructor(){super(),C(this,"type","ModelStreamingInterfaceStatisticsEvent"),C(this,"sendEvent",e=>{var t;if(!e)return;const n=this.getParams(e);if(!n||"{}"===JSON.stringify(n))return;const{first_chunk_time:i=0,api_start_time:a=0,chunk_info_list:o=[],model_id:s,is_error:r=!1,is_leave:l=!1,is_stop:c=!1,error_info:u=null,x_request_id:d,chat_id:h="",chat_type:p=""}=n,m=i-a;let f=0,g=0,v=0,y=0,b=0,x=0;(null==o?void 0:o.length)>0&&(f=null==(t=o[o.length-1])?void 0:t.chunk_time,g=Math.max(...(o||[]).map(e=>e.interval_time)),v=o.reduce((e,t)=>e+t.chunk_size,0),y=o.reduce((e,t)=>e+t.interval_time,0),b=y/o.length,x=v/(f-i)*1e3);const w={et:"OTHER",c6:m,c7:g,c8:{avg_chunk_interval:Number(b.toFixed(2)),avg_char_rate:Number(x.toFixed(2)),model:s,api_start_time:a,total_chars:v,end_chunk_time:f,first_chunk_time:i,x_request_id:d,is_stop:c,is_error:r,is_leave:l,error_info:u,response_id:e,chat_id:h,chat_type:p}};cS("modelStreamingInterfaceStatistics",{params:w}),this.removeItem(e)}),C(this,"sendAllEvent",()=>{this.paramsMap&&"{}"!==JSON.stringify(this.paramsMap)&&(Object.keys(this.getParamsMap()).forEach(e=>{this.sendEvent(e)}),this.clearParams())}),C(this,"dealEventStreamChunkData",(e,t)=>{const n=this.getParams(e);let i=null==n?void 0:n.first_chunk_time;const a=null==n?void 0:n.api_start_time;let o=null==n?void 0:n.first_packet_time;!i&&a&&(i=null==t?void 0:t.chunk_time,o=i-a,this.setParams(e,{first_chunk_time:i,first_packet_time:o}));let s=null==n?void 0:n.chunk_info_list,r=(null==n?void 0:n.max_chunk_interval)||0;if(s&&0!==(null==s?void 0:s.length)){const e=(null==t?void 0:t.chunk_time)-s[s.length-1].chunk_time;s.push(_(w({},t),{interval_time:e})),r=Math.max(r,e)}else s=[_(w({},t),{interval_time:0})];this.setParams(e,{chunk_info_list:s,max_chunk_interval:r})})}};class xk{constructor(e){C(this,"instanceId"),this.instanceId=e}isCurrentRunningInstance(){return this.instanceId===xE.currentId}get(e){const t=vx.getState();if(e in t)return t[e]}set(e,t){if(!this.isCurrentRunningInstance())return;const n=vx.getState(),i=String(e),a=`set${i.charAt(0).toUpperCase()+i.slice(1)}`;"function"==typeof n[a]&&n[a](t)}changeHistory(e){vx.getState().updateHistoryByImmer(e)}forceSet(e,t){const n=vx.getState(),i=String(e),a=`set${i.charAt(0).toUpperCase()+i.slice(1)}`;"function"==typeof n[a]&&n[a](t)}getAvailableKeys(){const e=vx.getState();return Object.keys(e).filter(t=>!t.startsWith("set")&&"function"!=typeof e[t])}getAvailableSetters(){const e=vx.getState();return Object.keys(e).filter(t=>t.startsWith("set")&&"function"==typeof e[t])}hasKey(e){const t=vx.getState();return e in t&&!e.startsWith("set")&&"function"!=typeof t[e]}hasSetter(e){return"function"==typeof vx.getState()[`set${e.charAt(0).toUpperCase()+e.slice(1)}`]}subscribe(e){return vx.subscribe(e)}getState(){return vx.getState()}resetChatState(){const e=vx.getState();"function"==typeof e.resetChatState&&e.resetChatState()}getInstanceId(){return this.instanceId}}class wk extends xk{constructor(e){super(e),C(this,"localState",gx())}get(e){return this.localState[e]}set(e,t){this.localState[e]=t,this.isCurrentRunningInstance()&&super.set(e,t)}forceSet(e,t){super.forceSet(e,t)}forceSetAllState(){Object.keys(this.localState).forEach(e=>{this.forceSet(e,this.localState[e])})}getLocalState(){return w({},this.localState)}setLocalState(e){this.localState=w(w({},this.localState),e)}clearLocalState(){this.localState={}}resetChatState(){this.localState=gx(),this.isCurrentRunningInstance()&&super.resetChatState()}get isStopDisabled(){return this.get("isStopDisabled")}set isStopDisabled(e){this.set("isStopDisabled",e)}get currentChatPage(){return this.get("currentChatPage")}set currentChatPage(e){this.set("currentChatPage",e)}get chatLoaded(){return this.get("chatLoaded")}set chatLoaded(e){this.set("chatLoaded",e)}get isChat(){return this.get("isChat")}set isChat(e){var t;if(!1===e){if(null==(t=jC(this.history.currentId,this.history))?void 0:t.find(e=>"assistant"===e.role&&!e.done))return}this.set("isChat",e)}get chatPermission(){return this.get("chatPermission")}set chatPermission(e){this.set("chatPermission",e)}get chatId(){return this.get("chatId")}set chatId(e){this.set("chatId",e)}get chatTitle(){return this.get("chatTitle")}set chatTitle(e){this.set("chatTitle",e)}get projectId(){return this.get("projectId")}set projectId(e){this.set("projectId",e)}get emitSendPromptType(){return this.get("emitSendPromptType")}set emitSendPromptType(e){this.set("emitSendPromptType",e)}get history(){return this.get("history")}set history(e){this.set("history",e)}changeHistory(e){if(e&&"function"==typeof e){const t=JSON.parse(JSON.stringify(this.localState.history));e(t),this.localState.history=t,this.isCurrentRunningInstance()&&super.changeHistory(e)}else this.set("history",e)}get historyCurrentId(){return this.get("historyCurrentId")}set historyCurrentId(e){this.set("historyCurrentId",e)}get pinnedChats(){return this.get("pinnedChats")}set pinnedChats(e){this.set("pinnedChats",e)}get allSearchAndThinkLists(){return this.get("allSearchAndThinkLists")}set allSearchAndThinkLists(e){this.set("allSearchAndThinkLists",e)}get currentInputFeature(){return this.get("currentInputFeature")}set currentInputFeature(e){this.set("currentInputFeature",e)}get currentInputSubType(){return this.get("currentInputSubType")}set currentInputSubType(e){this.set("currentInputSubType",e)}get currentCitationInfo(){return this.get("currentCitationInfo")}set currentCitationInfo(e){this.set("currentCitationInfo",e)}get currentSearchSource(){return this.get("currentSearchSource")}set currentSearchSource(e){this.set("currentSearchSource",e)}get temporarySource(){return this.get("temporarySource")}set temporarySource(e){this.set("temporarySource",e)}get currentSearchLists(){return this.get("currentSearchLists")}set currentSearchLists(e){this.set("currentSearchLists",e)}get currentArtifactsMessage(){return this.get("currentArtifactsMessage")}set currentArtifactsMessage(e){this.set("currentArtifactsMessage",e)}get shareChatError(){return this.get("shareChatError")}set shareChatError(e){this.set("shareChatError",e)}get chatMode(){return this.get("chatMode")}set chatMode(e){this.set("chatMode",e)}get imageReasonData(){return this.get("imageReasonData")}set imageReasonData(e){this.set("imageReasonData",e)}get branchInfo(){return this.get("branchInfo")}set branchInfo(e){this.set("branchInfo",e)}}const _k=(e,t)=>{var n,i,a;const{phaseContentMode:o="single_answer"}={};if(!e)return"";if(null==e?void 0:e.content)return e.content;if(!Array.isArray(null==e?void 0:e.content_list))return"";if(!(null==e?void 0:e.content_list.length))return"";if("single_answer"===o){const t=null==(n=null==e?void 0:e.content_list)?void 0:n.findLast(e=>e.phase===og.IMAGE_GEN&&e.content);return t?(null==t?void 0:t.content)||"":(null==(a=null==(i=null==e?void 0:e.content_list)?void 0:i.find(e=>[og.ANSWER].includes(e.phase)))?void 0:a.content)||""}return null==e?void 0:e.content_list.filter(e=>e.phase===og.ANSWER).map(e=>(null==e?void 0:e.content)||"").join("")},Sk=e=>({meta:{subChatType:"translate",translateLanguage:e}}),Ck=(e,t,n)=>`${e}\n${t}\n\n${n.title}:`,Ek=(e,t)=>{var n,i,a;let o="";switch(e){case Ce.md:o=(null==(n=null==t?void 0:t.md)?void 0:n.link)||"";break;case Ce.pdf:o=(null==(i=null==t?void 0:t.pdf)?void 0:i.link)||"";break;case Ce.image:o=(null==(a=null==t?void 0:t.image)?void 0:a.link)||""}if(!o){const e=B();return void ht.openOnce({type:"error",content:e.t("Download failed: url error")})}try{yC({url:o,errorTexts:!0})}catch(s){const e=B();ht.openOnce({type:"error",content:e.t("Download failed")})}},kk=e=>{const t=e.match(/```[\s\S]*?```/g),n=[];t&&t.forEach(e=>{const t=e.split("\n")[0].replace("```","").trim().toLowerCase(),i=e.replace(/```[\s\S]*?\n/,"").replace(/```$/,"");n.push({lang:t,code:i})});let i="",a="",o="";const s=n.find(e=>"jsx"===e.lang),r=n.find(e=>"tsx"===e.lang);if(s){const{code:e}=s}else if(r){const{code:e}=r}else n.forEach(e=>{const{lang:t,code:n}=e;"html"===t?i+=n+"\n":"css"===t?a+=n+"\n":"javascript"!==t&&"js"!==t||(o+=n+"\n")});let l={type:"",iframeType:"",content:""};if(""!==i||""!==a||""!==o){let e="";e=""!==a||""!==o?`\n                        <!DOCTYPE html>\n                        <html lang="en">\n                        <head>\n                            <meta charset="UTF-8">\n                            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n              <style>\n                body {\n                  background-color: white; /* Ensure the iframe has a white background */\n                }\n\n                ${a}\n              </style>\n                        </head>\n                        <body>\n                            ${i}\n\n              <script>\n                              ${o}\n              <\/script>\n                        </body>\n                        </html>\n                    `:i,l={type:"iframe",iframeType:"html",content:e}}else for(const c of n)"svg"===c.lang||"xml"===c.lang&&c.code.includes("<svg")?l={type:"svg",iframeType:"html",content:c.code}:"jsx"===c.lang?l={type:"iframe",iframeType:"jsx",content:c.code}:"tsx"===c.lang&&(l={type:"iframe",iframeType:"tsx",content:c.code});return""===l.content&&(e.toLowerCase().startsWith("<!doctype html>")?l={type:"iframe",iframeType:"html",content:e}:e.toLowerCase().startsWith("import")&&(l={type:"iframe",iframeType:"jsx",content:e})),l};function Ik(e){return[og.IMAGE_GEN_THINK,og.IMAGE_GEN_WEB_SEARCH,og.IMAGE_GEN].includes(e)}function Tk(e){return[og.LOCAL_TOOL,og.TOOL,og.IMAGE_ZOOM_IN_TOOL,og.CODE_INTERPRETER,og.WEB_EXTRACTOR].includes(e)}function jk(e,t){e.push(t)}function Nk(e,t){const{extra:n,phase:i,subChatType:a}=t;if(a===ng.DeepResearch)e.extra=((e,t)=>{var n;const{extra:i={}}=e,{phase:a}=t,o={[ng.DeepResearch]:{}};let s=(null==i?void 0:i[ng.DeepResearch])||{};Array.isArray(s)||(s=[w(w({},s),(null==s?void 0:s.query)||{})]);const r=(null==(n=t.extra)?void 0:n[ng.DeepResearch])||{};switch(a){case pg.PdfMdGen:o[ng.DeepResearch]=t.extra;break;case pg.ResearchPlanning:case pg.ReportGeneration:case og.ANSWER:const e=Array.isArray(s)?s[0]:s;o[ng.DeepResearch]=_(w(w({},e),r),{id:a});break;default:Array.isArray(s)||(s=[]),Array.isArray(r)?o[ng.DeepResearch]=HC(s,r):o[ng.DeepResearch]=UC(s,_(w({},r),{phase:a}))}return{extra:o}})(e,{extra:n,phase:i}).extra;else if(a===ng.TRAVEL_RESEARCH){const t=((e,t)=>{var n;const{extra:i={}}=e,{phase:a}=t,o={[ng.TRAVEL_RESEARCH]:{}};let s=(null==i?void 0:i[ng.TRAVEL_RESEARCH])||{};Array.isArray(s)||(s=[w(w({},s),(null==s?void 0:s.query)||{})]);const r=(null==(n=t.extra)?void 0:n[ng.TRAVEL_RESEARCH])||{};switch(a){case pg.PdfMdGen:o[ng.TRAVEL_RESEARCH]=t.extra;break;case pg.ResearchPlanning:case pg.ReportGeneration:case og.ANSWER:const e=Array.isArray(s)?s[0]:s;o[ng.TRAVEL_RESEARCH]=_(w(w({},e),r),{id:a});break;default:Array.isArray(s)||(s=[]),Array.isArray(r)?o[ng.TRAVEL_RESEARCH]=HC(s,r):o[ng.TRAVEL_RESEARCH]=UC(s,_(w({},r),{phase:a}))}return{extra:o}})(e,{extra:n,phase:i}).extra;e.extra=t}else[og.THINKING_SUMMARY,og.BIO,og.WEB_SEARCH].includes(i)&&!Pt(n)&&(e.extra=jt(n))}function Pk(e){const{content_list:t,phase:n,value:i,role:a,status:o,extra:s,lang_code:r,mcp_name:l,tool_name:c,function_call:u,subChatType:d,splitLargeChunks:h,function_id:p,timestamp:m}=e;if(0===t.length||Ik(n))return void jk(t,{content:i,role:a,phase:n,status:o,extra:s,lang_code:r,mcp_name:l,tool_name:c,function_call:u,function_id:p,timestamp:m});const f=t.find(e=>e.function_id&&e.function_id===p);Tk(n)?function(e,t,n){const{value:i,phase:a,status:o,extra:s,function_id:r,timestamp:l,function_call:c,mcp_name:u,tool_name:d}=t,h=n||e.at(-1);(null==h?void 0:h.phase)===a&&!h.mcp_results&&h?(h.extra=w(w({},h.extra||{}),s||{}),c&&(h.function_call=c),h.status=o):jk(e,{content:i,phase:a,status:o,extra:s,function_id:r,timestamp:l,function_call:c,mcp_name:u,tool_name:d})}(t,{value:i,phase:n,status:o,extra:s,function_call:u,function_id:p,mcp_name:l,tool_name:c,timestamp:m},f):function(e,t,n){const{value:i,role:a,phase:o,status:s,timestamp:r,extra:l,function_id:c,subChatType:u,splitLargeChunks:d}=t,h=n||e.at(-1),p=(null==h?void 0:h.function_id)&&c&&h.function_id!==c;(null==h?void 0:h.phase)!==o||p?jk(e,{content:i,role:a,phase:o,timestamp:r,status:s,function_id:c,extra:jt(l)}):("string"==typeof i&&"string"==typeof h.content?function(e,t){e.content+=t}(h,i):i&&(h.content=i),h.role!==a&&(h.role=a),Nk(h,{extra:l,phase:o,subChatType:u}),h.status=s)}(t,{value:i,role:a,phase:n,status:o,extra:s,subChatType:d,splitLargeChunks:h,function_id:p,timestamp:m},f)}class Mk{constructor(e,t,n){C(this,"queue",[]),C(this,"batchTimer",null),C(this,"isProcessing",!1),C(this,"config"),C(this,"onBatchProcess"),C(this,"onError"),C(this,"itemIndex",0),this.config=e,this.onBatchProcess=t,this.onError=n||this.defaultErrorHandler}addToQueue(e){if(!this.config.enabled){const t=this.onBatchProcess([e]);return void(t instanceof Promise&&t.catch(e=>this.onError(e)))}const t={data:e,timestamp:Date.now(),index:this.itemIndex++};this.queue.push(t),this.config.debug,this.batchTimer||this.startBatchTimer()}startBatchTimer(){this.batchTimer&&clearTimeout(this.batchTimer),this.batchTimer=setTimeout(()=>{this.processBatch()},this.config.batchInterval)}processBatch(){if(!this.isProcessing&&0!==this.queue.length){this.isProcessing=!0;try{this.batchTimer&&(clearTimeout(this.batchTimer),this.batchTimer=null);const e=Math.min(this.queue.length,this.config.maxBatchSize),t=this.queue.splice(0,e);t.sort((e,t)=>e.index-t.index);const n=t.map(e=>e.data);this.config.debug;const i=this.onBatchProcess(n);i instanceof Promise&&i.catch(e=>this.onError(e))}catch(e){this.onError(e)}finally{this.isProcessing=!1,this.queue.length>0&&this.startBatchTimer()}}}flush(){if(this.queue.length>0)for(;this.queue.length>0;)if(this.processBatch(),this.queue.length>0){setTimeout(()=>{this.flush()},0);break}}flushSync(){return j(this,null,function*(){for(;this.queue.length>0;)this.isProcessing?yield new Promise(e=>setTimeout(e,1)):(this.processBatch(),this.queue.length>0&&(yield new Promise(e=>setTimeout(e,0))))})}clear(){this.queue=[],this.itemIndex=0,this.batchTimer&&(clearTimeout(this.batchTimer),this.batchTimer=null),this.isProcessing=!1}getStatus(){return{queueLength:this.queue.length,isProcessing:this.isProcessing,hasTimer:!!this.batchTimer}}updateConfig(e){this.config=w(w({},this.config),e),this.config.enabled||(this.flush(),this.clear())}destroy(){this.clear()}defaultErrorHandler(e){}}const Ak={batchInterval:20,maxBatchSize:50,enabled:!0,debug:!0};class Ok{constructor(e={},t,n){C(this,"config"),C(this,"performanceMetrics"),C(this,"startTime"),C(this,"lastProcessTime"),C(this,"onBatchProcess"),C(this,"onError"),this.config=w(_(w({},Ak),{enableSmartBatching:!0,enableDynamicInterval:!0,minBatchInterval:50,maxBatchInterval:200,enablePerformanceMonitoring:!0}),e),this.performanceMetrics={totalProcessed:0,averageBatchSize:0,averageProcessingTime:0,queueUtilization:0,throughput:0},this.startTime=Date.now(),this.lastProcessTime=Date.now(),this.onBatchProcess=t,this.onError=n}processSSEStream(e,t=!1,n=!0,i=!0){return P(this,null,function*(){try{const c=e.pipeThrough(new TextDecoderStream).pipeThrough(new EE).getReader(),u=this.createEnhancedIterator(c,t,n);if(!i){try{for(var a,o,s,r=M(u);a=!(o=yield new N(r.next())).done;a=!1){const e=o.value;yield e}}catch(o){s=[o]}finally{try{a&&(o=r.return)&&(yield new N(o.call(r)))}finally{if(s)throw s[0]}}return}const d=[];let h=!1,p=null,m=null,f=null;const g=()=>{f=new Promise(e=>{m=e})};g();const v=this.onBatchProcess,y=new Mk(this.config,e=>j(this,null,function*(){const t=performance.now();v&&(yield v(e));const n=this.mergeTextStreams(e);d.push(...n),m&&(m(),g());const i=performance.now(),a=y.getStatus();this.updatePerformanceMetrics(e.length,i-t,a.queueLength),this.config.enableDynamicInterval&&this.adjustBatchInterval(y)}),e=>{p=e,h=!0,m&&m(),this.onError&&this.onError(e)}),b=(()=>j(this,null,function*(){try{try{for(var e,t,n,i=M(u);e=!(t=yield i.next()).done;e=!1){const e=t.value;y.addToQueue(e)}}catch(t){n=[t]}finally{try{e&&(t=i.return)&&(yield t.call(i))}finally{if(n)throw n[0]}}yield y.flushSync(),h=!0,m&&m()}catch(a){p=a,h=!0,m&&m()}finally{y.destroy()}}))();for(;!h||d.length>0;)if(d.length>0)for(;d.length>0;){const e=d.shift();e&&(yield e)}else{if(h||!f)break;try{yield new N(Promise.race([f,new Promise(e=>setTimeout(e,10))]))}catch(l){}}if(yield new N(b),p)throw p}catch(l){throw l}})}createEnhancedIterator(e,t,n){return P(this,null,function*(){let t="";for(;;){const{value:i,done:a}=yield new N(e.read());if(a){yield{done:!0,value:""};break}if(!i)continue;const o=i.data;if(o.startsWith("[DONE]")){yield{done:!0,value:""};break}try{const e=this.parseSSEData(o);if(!e)continue;const n=this.createTextStreamUpdate(e);n&&(n.value&&(t=n.value),yield n)}catch(n){}}})}parseSSEData(e){try{return JSON.parse(e)}catch(kX){return null}}createTextStreamUpdate(e){var t,n,i,a,o,s,r,l,c,u,d,h,p,m,f;if(null==e?void 0:e["response.created"])return{done:!1,value:"",chatId:e["response.created"].chat_id,parentId:e["response.created"].parent_id,responseId:e["response.created"].response_id};if(null==e?void 0:e["response.stopped"])return{done:!0,value:"",isStop:!0};if("skip_think"===(null==(t=null==e?void 0:e["response.info"])?void 0:t.action))return{done:!1,value:"",isStopInThinking:!0};if(e.error)return"string"==typeof e.error?{done:!0,value:"",error:{code:"Internal_Server_Error",details:e.error},responseId:e.response_id}:{done:!0,value:"",error:e.error,responseId:e.response_id};if(e.sources)return{done:!1,value:"",sources:e.sources,responseId:e.response_id};if(e.selected_model_id)return{done:!1,value:"",selectedModelId:e.selected_model_id,responseId:e.response_id};if("KeepAlive"===(null==(a=null==(i=null==(n=e.choices)?void 0:n[0])?void 0:i.delta)?void 0:a.phase))return null;const g=null!=(l=null==(r=null==(s=null==(o=e.choices)?void 0:o[0])?void 0:s.delta)?void 0:r.content)?l:"",v=null==(u=null==(c=e.choices)?void 0:c[0])?void 0:u.delta;return"function"===(null==v?void 0:v.role)?(null==(d=null==v?void 0:v.extra)?void 0:d.web_search_info)?{done:!1,value:"",web_search_info:null!=(p=null==(h=null==v?void 0:v.extra)?void 0:h.web_search_info)?p:[],responseId:e.response_id,phase:null==v?void 0:v.phase,extra:null==v?void 0:v.extra,status:null==v?void 0:v.status,function_id:null==v?void 0:v.function_id,timestamp:Date.now()/1e3||e.timestamp}:{done:!1,value:null!=(m=null==v?void 0:v.content)?m:"",role:null==v?void 0:v.role,phase:null==v?void 0:v.phase,status:null==v?void 0:v.status,extra:null==v?void 0:v.extra,function_id:null==v?void 0:v.function_id,responseId:e.response_id,timestamp:Date.now()/1e3||e.timestamp}:{done:!1,value:g,role:null==v?void 0:v.role,phase:null==v?void 0:v.phase,status:null==v?void 0:v.status,usage:e.usage,extra:null==v?void 0:v.extra,lang_code:null==v?void 0:v.lang_code,functionCallType:null==(f=null==v?void 0:v.function_call)?void 0:f.name,function_id:null==v?void 0:v.function_id,function_call:null==v?void 0:v.function_call,mcp_name:null==v?void 0:v.mcp_name,tool_name:null==v?void 0:v.tool_name,responseId:e.response_id,timestamp:e.timestamp}}mergeFunctionCall(e,t){if(!t)return e;if(!e)return t;let n;return n="string"==typeof t.arguments?(e.arguments,t.arguments):"object"==typeof t.arguments&&null!==t.arguments?"object"==typeof e.arguments&&null!==e.arguments?At({},e.arguments,t.arguments):t.arguments:e.arguments||t.arguments,_(w(w({},e),t),{arguments:n})}mergeTextStreams(e){const t=[];return e.forEach(e=>{var n,i,a,o,s,r,l,c,u,d;if(e.phase===og.KEEPALIVE)return;if(0===t.length)return void t.push(jt(e));const h=(e=>{const n=e.responseId;for(let i=t.length-1;i>=0;i--){const e=t[i],a=e.responseId;if(!n&&!a)return e;if(n&&a&&n===a)return e}return null})(e);if(!h)return void t.push(e);const p=e.phase,m=h.phase;if(p&&Ik(p))t.push(e);else{if(p&&Tk(p)){if(m===p&&h.status!==sg.FINISHED&&e.status!==sg.FINISHED){h.extra=At({},h.extra,e.extra);const t=e.function_call||(null==(n=e.extra)?void 0:n.function_call),a=h.function_call||(null==(i=h.extra)?void 0:i.function_call);if(t){const e=this.mergeFunctionCall(a,t);h.function_call=e,h.extra&&(h.extra.function_call=e)}else a&&(h.function_call=a);e.mcp_name&&(h.mcp_name=e.mcp_name),e.tool_name&&(h.tool_name=e.tool_name),e.status&&(h.status=e.status),e.value&&(h.value+=e.value)}else t.push(jt(e));return}if(p&&m===p){"string"==typeof e.value&&"string"==typeof h.value?h.value+=e.value:e.value&&(h.value=e.value),e.role&&h.role!==e.role&&(h.role=e.role);const t=(null==(a=h.extra)?void 0:a[ng.DeepResearch])&&(null==(o=e.extra)?void 0:o[ng.DeepResearch]),n=(null==(s=h.extra)?void 0:s[ng.TRAVEL_RESEARCH])||(null==(r=e.extra)?void 0:r[ng.TRAVEL_RESEARCH]),i=t?ng.DeepResearch:n?ng.TRAVEL_RESEARCH:void 0;if(i&&p){const t={extra:h.extra||{},content:h.value,role:h.role,status:h.status};Nk(t,{extra:e.extra,phase:p,subChatType:i}),h.extra=t.extra}else h.extra=At({},h.extra,e.extra);e.lang_code&&(h.lang_code=e.lang_code),e.status&&(h.status=e.status);const u=e.function_call||(null==(l=e.extra)?void 0:l.function_call),d=h.function_call||(null==(c=h.extra)?void 0:c.function_call);if(u){const e=this.mergeFunctionCall(d,u);h.function_call=e,h.extra&&(h.extra.function_call=e)}else d&&(h.function_call=d);e.mcp_name&&(h.mcp_name=e.mcp_name),e.tool_name&&(h.tool_name=e.tool_name)}else if(p||m)t.push(jt(e));else if(e.role&&h.role===e.role){"string"==typeof e.value&&"string"==typeof h.value?h.value+=e.value:e.value&&(h.value=e.value),h.extra=At({},h.extra,e.extra);const t=e.function_call||(null==(u=e.extra)?void 0:u.function_call),n=h.function_call||(null==(d=h.extra)?void 0:d.function_call);if(t){const e=this.mergeFunctionCall(n,t);h.function_call=e,h.extra&&(h.extra.function_call=e)}else n&&(h.function_call=n);e.status&&(h.status=e.status),e.lang_code&&(h.lang_code=e.lang_code)}else t.push(jt(e))}}),t}updatePerformanceMetrics(e,t,n){if(!this.config.enablePerformanceMonitoring)return;this.performanceMetrics.totalProcessed+=e,this.performanceMetrics.averageBatchSize=(this.performanceMetrics.averageBatchSize+e)/2,this.performanceMetrics.averageProcessingTime=(this.performanceMetrics.averageProcessingTime+t)/2;const i=Date.now(),a=(i-this.lastProcessTime)/1e3;a>0&&(this.performanceMetrics.throughput=e/a),this.lastProcessTime=i,void 0!==n&&(this.performanceMetrics.queueUtilization=n/this.config.maxBatchSize)}adjustBatchInterval(e){const t=this.config.batchInterval,n=this.performanceMetrics.queueUtilization,i=this.performanceMetrics.throughput;let a=t;n>.8?a=Math.max(this.config.minBatchInterval,.8*t):n<.2&&i>100&&(a=Math.min(this.config.maxBatchInterval,1.2*t)),a!==t&&(this.config.batchInterval=a,e.updateConfig({batchInterval:a}),this.config.debug)}getPerformanceMetrics(){return w({},this.performanceMetrics)}getQueueStatus(){return{queueLength:Math.round(this.performanceMetrics.queueUtilization*this.config.maxBatchSize),isProcessing:!1,hasTimer:!1,utilization:this.performanceMetrics.queueUtilization}}updateConfig(e){this.config=w(w({},this.config),e)}destroy(){this.performanceMetrics={totalProcessed:0,averageBatchSize:0,averageProcessingTime:0,queueUtilization:0,throughput:0},this.startTime=Date.now(),this.lastProcessTime=Date.now()}}const Rk={batchInterval:100,maxBatchSize:30,enabled:!0,debug:!0,enableSmartBatching:!0,enableDynamicInterval:!0,minBatchInterval:5,maxBatchInterval:200,enablePerformanceMonitoring:!0},Dk={batchInterval:50,maxBatchSize:100,enabled:!0,debug:!1,enableSmartBatching:!0,enableDynamicInterval:!0,minBatchInterval:20,maxBatchInterval:100,enablePerformanceMonitoring:!0},Lk={batchInterval:30,maxBatchSize:20,enabled:!0,debug:!1,enableSmartBatching:!0,enableDynamicInterval:!0,minBatchInterval:10,maxBatchInterval:80,enablePerformanceMonitoring:!0},Fk={batchInterval:200,maxBatchSize:10,enabled:!0,debug:!0,enableSmartBatching:!0,enableDynamicInterval:!0,minBatchInterval:100,maxBatchInterval:500,enablePerformanceMonitoring:!0},zk={batchInterval:0,maxBatchSize:1,enabled:!1,debug:!1,enableSmartBatching:!1,enableDynamicInterval:!1,minBatchInterval:0,maxBatchInterval:0,enablePerformanceMonitoring:!1},Uk="high_performance",Hk="low_latency",Bk="debug",$k="disabled";function qk(e){switch(e){case Uk:return Dk;case Hk:return Lk;case Bk:return Fk;case $k:return zk;default:return Rk}}class Gk{constructor(){C(this,"streamingProcessor",null),C(this,"streamingMode","default"),this.initializeStreamingProcessor()}initializeStreamingProcessor(){const e=qk(this.streamingMode);this.streamingProcessor=new Ok(e,e=>j(this,null,function*(){}),e=>{})}updateStreamingMode(e){if(this.streamingMode=e,this.streamingProcessor){const t=qk(e);this.streamingProcessor.updateConfig(t)}}getStreamingStatus(){return this.streamingProcessor?{queueStatus:this.streamingProcessor.getQueueStatus(),performanceMetrics:this.streamingProcessor.getPerformanceMetrics()}:null}}const Vk="fev",Wk="0.1.38",Qk=()=>Wk,Kk=(e=((e=Vk)=>{const t=new URL(window.location.href);return new URLSearchParams(t.search).get(e)||"0.0.0"})(),t=Wk)=>{var n,i;const a=e.split(".").map(Number),o=t.split(".").map(Number),s=Math.max(a.length,o.length);for(let r=0;r<s;r++){const e=null!=(n=a[r])?n:0,t=null!=(i=o[r])?i:0;if(e>t)return"greater";if(e<t)return"less"}return"equal"},Yk=({loaded:e=!1,fixed:t=!0,absolute:n=!1,center:i=!1})=>{const a=$();return an.jsx("div",{className:Y("page-loading",{"page-loading-fixed":t&&!n,"page-loading-absolute":n&&!t,"page-loading-center":i&&!t&&!n}),style:{display:"flex",opacity:e?0:1,transition:"opacity 0.2s ease-in-out",pointerEvents:e?"none":"auto"},"aria-hidden":e,children:an.jsx("img",{width:40,src:"https://img.alicdn.com/imgextra/i3/O1CN01zaxxvj1p4f0VrY17j_!!6000000005307-54-tps-180-180.apng",alt:a.t("Loading...")})})},Xk=class e{constructor(){if(I(this,n,!1),I(this,i,null),I(this,a,()=>{k(this,n)||(T(this,n,!0),document.addEventListener("visibilitychange",k(this,o)))}),C(this,"destroy",()=>{k(this,r).call(this),document.removeEventListener("visibilitychange",k(this,o))}),I(this,o,()=>{document.hidden?k(this,r).call(this):this.subscribePolling()}),I(this,s,()=>{k(this,r).call(this),k(this,i)||T(this,i,window.setInterval(()=>j(this,null,function*(){var e,t;const n=yield((e="memory")=>j(void 0,null,function*(){return yield ow(`notifications/latest?type=${e}`,{method:"GET"})}))("memory");if((null==n?void 0:n.success)&&(null==(t=null==(e=n.data)?void 0:e.notifications)?void 0:t.length)>0){const e=n.data.notifications[0];Zk(e)}}),1e4))}),I(this,r,()=>{k(this,i)&&(window.clearInterval(k(this,i)),T(this,i,null))}),I(this,l,e=>{e?k(this,s).call(this):k(this,r).call(this)}),C(this,"subscribePolling",()=>{var e,t,n;const i=null==(e=Ex.getState().config)?void 0:e.memory_version,a=i&&"disable"!==i;UT()||zx()&&Yx("1.7.0")||!a||((null==(n=null==(t=NT.getState().settings)?void 0:t.memory)?void 0:n.enable_memory)&&!Sx.getState().temporaryChatEnabled&&k(this,l).call(this,!0),Sx.subscribe(e=>e.temporaryChatEnabled,e=>{var t,n;const i=null==(n=null==(t=NT.getState().settings)?void 0:t.memory)?void 0:n.enable_memory;k(this,l).call(this,i&&!e)}),NT.subscribe(e=>{var t,n;return null==(n=null==(t=e.settings)?void 0:t.memory)?void 0:n.enable_memory},e=>{const t=Sx.getState().temporaryChatEnabled;k(this,l).call(this,e&&!t)}))}),k(e,t))return k(e,t);T(e,t,this),k(this,a).call(this)}static getInstance(){return k(this,t)||T(this,t,new e),k(this,t)}};t=new WeakMap,n=new WeakMap,i=new WeakMap,a=new WeakMap,o=new WeakMap,s=new WeakMap,r=new WeakMap,l=new WeakMap,I(Xk,t,null);const Jk=Xk.getInstance(),Zk=e=>{var t,n;const{clearAllNotification:i,setNotification:a,clearNotificationById:o}=OT.getState();i(),a({type:"memory",message:Pv("Update Saved Memory"),description:Pv("Added {{latest}} new memories. Updated {{existing}} existing memories with new details.",{latest:null==(t=e.detail.new_memories)?void 0:t.length,existing:null==(n=e.detail.updated_memories)?void 0:n.length}),duration:1e4,onClickButton:e=>{o(e),zE.getState().setShowMemoryUpdatedModal(!0)},props:e}),Ex.getState().mobile&&ht.openOnce({type:"message",closable:!1,className:"memory-updated-saved-toast",duration:1e4,content:an.jsxs(an.Fragment,{children:[an.jsxs("div",{className:"memory-updated-saved-toast-content",children:[an.jsx("div",{className:"memory-updated-saved-toast-icon",children:an.jsx(pt,{type:"icon-line-information-circle"})}),an.jsx("div",{className:"memory-updated-saved-toast-text",children:Hf().t("Update Saved Memory")})]}),an.jsx("div",{className:"memory-updated-saved-toast-btn",onClick:()=>{const e=OT.getState().memoryNotification,t=zE.getState().setShowMemoryUpdatedModal,n={items:[...Rt(e,"detail.new_memories",[]).map(e=>({type:"new",markdown:e.content})),...Rt(e,"detail.updated_memories",[]).map(e=>({type:"updated",markdown:e.content})),...Rt(e,"detail.cleared_memories",[]).map(e=>({type:"cleared",markdown:e.content}))]};$x()?kT.adapter.invoke({method:"openMemoryWindow",params:Px()?n:JSON.stringify(n)}):t(!0),K.destroy()},children:Hf().t("View")})]})})};class eI{static createUserMessage(e,t){const n=rt(),i=RC(t.currentInputFeature),a=t.featureConfig||{thinking_enabled:!1,output_schema:"phase",research_mode:"normal"};return{userMessage:{fid:n,parentId:e.parentId,childrenIds:[],role:"user",content:e.content,user_action:e.userAction,files:e.files&&e.files.length>0?e.files:void 0,timestamp:Math.floor(Date.now()/1e3),models:t.models||[],chat_type:i,feature_config:a,extra:e.extra,sub_chat_type:t.subChatType||t.currentInputFeature},messageId:n}}static createResponseMessage(e,t){const n=rt(),i=RC(t.currentInputFeature),a=t.featureConfig||{thinking_enabled:!1,output_schema:"phase",research_mode:"normal"};return{responseMessage:{parentId:e.parentId,fid:n,childrenIds:[],role:"assistant",content:"",model:e.model.id,modelName:e.model.name,modelIdx:e.modelIdx,userContext:null,chat_type:i,user_action:e.userAction,info:[ng.ImageGeneration,ng.VideoGeneration].includes(t.currentInputFeature)?{size:TT.getState().visionSize}:void 0,merged:void 0,feature_config:a,extra:e.extra,timestamp:Math.floor(Date.now()/1e3),sub_chat_type:t.subChatType||t.currentInputFeature},messageId:n}}static createResponseMessages(e,t){return e.selectedModels.map((n,i)=>{const{responseMessage:a,messageId:o}=eI.createResponseMessage({parentId:e.parentId,model:n,modelIdx:i,userAction:e.userAction,extra:e.extra},t);return{message:a,messageId:o}})}static updateHistoryMessages(e,t){const{userMessage:n,responseMessages:i}=t,a=i.map(e=>e.messageId);if(n&&(n.message.childrenIds=a,e.messages[n.messageId]=n.message,n.message.parentId)){const t=e.messages[n.message.parentId];t&&(t.childrenIds=[...t.childrenIds||[],n.messageId])}i.forEach(({message:t,messageId:n})=>{e.messages[n]=t}),a.length>0?(e.currentId=a[0],e.currentResponseIds=a):n&&(e.currentId=n.messageId)}static updateUserMessageChildrenIds(e,t,n,i){const a=e.messages[t];a&&(a.childrenIds=[...a.childrenIds||[],n],i&&(i.models&&(a.models=i.models),i.feature_config&&(a.feature_config=w(w({},a.feature_config||{}),i.feature_config)),i.sub_chat_type&&(a.sub_chat_type=i.sub_chat_type),void 0!==i.extra&&(a.extra=i.extra)))}static updateParentMessageChildrenIds(e,t,n){const i=e.messages[t];i&&(i.childrenIds=[...i.childrenIds||[],n])}static getLastMessage(e){var t;if(!e||!e.currentId)return null;const n=jC(e.currentId,e);if(0===n.length)return null;let i=null==(t=n[n.length-1])?void 0:t.id,a=n[n.length-1];if(!i&&n.length>0){const e=[...n];for(;!i&&e.length>0;){const t=e.pop();if("assistant"===(null==t?void 0:t.role)&&(null==t?void 0:t.id)){i=t.id,a=t;break}}}return a&&"assistant"===a.role&&a.id?a:null}static deleteMessage(e,t){var n;const i=e.messages[t];if(!i)return{currentId:e.currentId,currentResponseIds:e.currentResponseIds};const a=i.parentId,o=null!=(n=i.childrenIds)?n:[],s=o.flatMap(t=>{var n,i;return t&&null!=(i=null==(n=e.messages[t])?void 0:n.childrenIds)?i:[]});a&&e.messages[a]&&(e.messages[a].childrenIds=[...e.messages[a].childrenIds.filter(e=>e!==t),...s]),s.forEach(t=>{t&&e.messages[t]&&(e.messages[t].parentId=a)}),[t,...o].forEach(t=>{t&&delete e.messages[t]});let r=a;if(a&&e.messages[a]){let t=e.messages[a].childrenIds||[];for(;t.length>0;){const n=t[t.length-1];if(!n||!e.messages[n])break;r=n,t=e.messages[n].childrenIds||[]}}return{currentId:r,currentResponseIds:r?[r]:[]}}static cloneResponseMessage(e,t,n){if(!n)return null;const i=_(w({},n),{fid:t,id:null,content:"",content_list:[]});e.messages[t]=i;const a=n.parentId;if(a&&e.messages[a]){const n=e.messages[a];n.childrenIds||(n.childrenIds=[]),n.childrenIds.includes(t)||n.childrenIds.push(t)}return i}}class tI extends wk{constructor({config:e,settings:t,user:n,chatMode:i="normal"}){const a=rt();super(a),C(this,"id"),C(this,"chatFiles",[]),C(this,"tags"),C(this,"models"),C(this,"isChatIntercept"),C(this,"subChatType",""),C(this,"userAction",Yf.CHAT),C(this,"stopResponseFlag",!1),C(this,"eventTarget",new EventTarget),C(this,"sessionId",rt()),C(this,"changeResponseIdMap",{}),C(this,"reconnectTimesMap",{}),C(this,"mcpLoopParams",{}),C(this,"mcpErrorServers",[]),C(this,"isLeave",!1),C(this,"isForceClear",!1),C(this,"share_id"),C(this,"config"),C(this,"settings"),C(this,"user"),C(this,"loadChat",e=>j(this,null,function*(){var t,n,i,a,o,s,r,l,c;if(!e)return;if(this.isChat)return this.isLeave=!1,this.chatLoaded=!0,this._emit(uE.CHAT_HISTORY_LOADED,{id:this.id,chatId:this.chatId,chatOptions:this.getChatOptions()}),this.forceSetAllState(),!0;this.chatLoaded=!1,this.share_id||this.resetChatState(),this.setChatId(e);const u=zE.getState().isSharePage,d=vx.getState().isCompareVersion,h=u?e.startsWith("t_")?yield(p={id:e},j(void 0,null,function*(){return yield ow(`/share/message/${p.id}`,{method:"GET"})})):yield(e=>j(void 0,null,function*(){return yield uw(),yield ow(`/chats/share/${e.share_id}`)}))({share_id:e}):yield R_({chat_id:e});var p;const{success:m,data:f}=h||{};let g="";if(u&&d&&"greater"===Kk())return g="invalid_gray_link",vx.setState({shareChatError:g}),void this.setStatus({isLeave:!0,isChat:!1});if(!m)return u&&!g&&vx.setState({shareChatError:"invalid"}),DT.getState().setChatProjectId(""),this.setStatus({isLeave:!0,isChat:!1}),void this.destroy();if(f.project_id&&DT.getState().setActiveChatDetails(f),!(null==(n=null==(t=null==f?void 0:f.chat)?void 0:t.history)?void 0:n.messages)||Pt(f.chat.history.messages))return DT.getState().setChatProjectId(""),this.history={currentId:null,currentResponseIds:[],messages:{}},void this.setStatus({isLeave:!0,isChat:!1});if("normal"===this.chatMode&&!u){const t=yield(e=>j(void 0,null,function*(){return yield ow(`chats/${e.chat_id}/tags`)}))({chat_id:e}).catch(()=>j(this,null,function*(){return{data:[]}}));this.tags=t.data}DT.getState().setChatProjectId((null==f?void 0:f.project_id)||""),this.reconnectTimesMap={},this.chatTitle=f.title||f.chat.title,this.projectId=(null==f?void 0:f.project_id)||"",this.models=f.chat.models,f.permissions&&(this.chatPermission=f.permissions),this.branchInfo=(null==(i=null==f?void 0:f.meta)?void 0:i.branch_info)||null;const v=PC(f.chat.history);Object.values(v.messages||{}).forEach(e=>{v.messages[e.id||""]=this.formatServerMessage(e)});const y=v.currentId||f.currentId||f.chat.currentId;let b=v.currentResponseIds||f.currentResponseIds||f.chat.currentResponseIds||[];const x=v.messages[v.currentId||""],w=x.chat_type||(null==(a=null==f?void 0:f.chat)?void 0:a.chat_type)||ng.Txt2Txt,_=(null==x?void 0:x.sub_chat_type)||(null==(s=null==(o=null==x?void 0:x.extra)?void 0:o.meta)?void 0:s.subChatType)||w;this.history={currentId:y,currentResponseIds:b,messages:v.messages},Object.values(this.history.messages||{}).forEach(e=>{"assistant"===e.role&&e.error&&"data_inspection_failed"===e.error.errorCode&&this.handleGreenNetErrorParentMsg(e._error,e.parentId||"")}),w!==ng.Artifacts||Ex.getState().mobile||u?Sx.setState({currentShowControl:ag.None}):(Sx.setState({currentShowControl:ag.Artifacts}),vx.setState({currentArtifactsMessage:x})),this.currentInputFeature=w,this.subChatType=_,this.currentInputSubType=_,this.chatFiles=(e=>{const t=Object.values((null==e?void 0:e.messages)||{}).filter(e=>"user"===e.role),n=[];return t.length&&t.forEach(e=>{e.files&&n.push(...e.files)}),n})(v),this.isChatIntercept=!1;const S=EI.getState().models,C=(f.chat.models||[]).map(e=>S.find(t=>t.id===e)).filter(Boolean);if(C.length||u)EI.getState().setSelectedModels(C);else if(S.length){const e=S.find(e=>e.name===x.modelName);e?EI.getState().setSelectedModels([e]):(EI.getState().setSelectedModels([S[0]]),tE.open({type:"error",content:Pv("The model used in this history has been deleted. Switching to the default model to continue.")}))}if([ng.ImageGeneration,ng.VideoGeneration].includes(w)){let e=null==(r=null==x?void 0:x.info)?void 0:r.size;const t=Array.isArray(x.content_list)&&x.content_list.find(e=>{var t;return e.phase===og.IMAGE_GEN&&(null==(t=null==e?void 0:e.extra)?void 0:t.output_image_hw)});if(!e&&t){const[n,i]=null==(c=null==(l=null==t?void 0:t.extra)?void 0:l.output_image_hw)?void 0:c[0];e=ug["1:1"],Object.values(ug).forEach(t=>{const[a,o]=t.split(":");Math.abs(Number(i)/Number(n)-Number(a)/Number(o))<.1&&(e=t)})}e&&TT.getState().setVisionSize(e)}const E=jC(y,this.history).find(e=>e.sub_chat_type===ng.DeepResearch&&!e.done&&"assistant"===e.role);b=[...new Set([...b,null==E?void 0:E.id])];const k=b.filter(e=>{const t=this.history.messages[e];return!!t&&((!(null==t?void 0:t.sub_chat_type)||![ng.Podcast].includes(t.sub_chat_type))&&(!t.done||!1))});return this._emit(uE.CHAT_HISTORY_LOADED,{id:this.id,chatId:this.chatId,chatOptions:this.getChatOptions()}),this.chatLoaded=!0,this.setStatus({isChat:!!k.length}),bC(v)&&(this.isStopDisabled=!0,k.length=0),k.length>0&&![ng.VideoGeneration].includes(w)&&(this._emit(uE.CHAT_BEGIN,{id:this.id}),k.map(e=>j(this,null,function*(){return setTimeout(()=>{dS("AsyncChat-Response",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:this.currentInputFeature,c7:_,c8:e}})}),yield this.retrievableFetchSSEResponse(e)}))),dS("AsyncChat-Load",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:this.currentInputFeature,c7:_}}),!0})),C(this,"saveChat",(e,t,n)=>{}),C(this,"handleMergeError",(e,t,n,i)=>j(this,null,function*(){const a=w({},i),{errorCode:o,errorMessage:s,errorMessageLocale:r}=yield this.handleGeneralError(e,t);a.error={content:Pv("Oops! There was an issue connecting to {{provider}}.",{provider:n})+" "+r,errorMessage:s,errorCode:"data_inspection_failed"===s?"data_inspection_failed":""},a.done=!0,a.statusHistory&&(a.statusHistory=a.statusHistory.filter(e=>"knowledge_search"!==e.action)),"data_inspection_failed"===o&&(a.content=""),this.changeHistory(e=>{e.messages[a.id]=a})})),C(this,"stopResponse",()=>j(this,null,function*(){var e,t;this.stopResponseFlag=!0,this.isStopDisabled=!0;const{currentResponseIds:n,messages:i}=this.history,a=n.filter(e=>i[e]&&!i[e].done||!1),o=null!=(t=null==(e=jC(this.history.currentId,this.history))?void 0:e.filter(e=>"assistant"===e.role&&!e.done).map(e=>e.id))?t:[],s=[...new Set([...a,...o])];this.chatId&&s.length&&s.forEach(e=>j(this,null,function*(){yield pS({chat_id:this.chatId,response_id:e})})),bk.setParamsForAll({is_stop:!0}),bk.sendAllEvent()})),C(this,"stopThinkingPhase",e=>j(this,null,function*(){const{messages:t}=this.history;if(!this.chatId||!e||!t[e]||"assistant"!==t[e].role)return;const n=t[e],{error:i,is_stop:a,content_list:o,done:s}=n,r=null==o?void 0:o.some(({phase:e})=>e===og.ANSWER);i||a||s||r||(this.updateResponseMessage(e,{is_stop_in_thinking:!0}),yield pS({chat_id:this.chatId,response_id:e,phase:"think"}))})),C(this,"handleGeneralError",(e,t)=>j(this,null,function*(){var n;let i,a="",o="",s="";if("quotaLimited"===(null==t?void 0:t.code)?i={code:null==t?void 0:t.code,detail:t.details,error:t.details}:(null==t?void 0:t.data)&&"Too_Many_Requests"===(null==(n=t.data)?void 0:n.code)||e&&"Too_Many_Requests"===(null==e?void 0:e.code)||null===t&&!e?i={code:"Too_Many_Requests",detail:Pv("Currently, there are too many requests in the queue. Please try again later."),error:Pv("Currently, there are too many requests in the queue. Please try again later.")}:e?i=e:t&&"error"===t.type?i={detail:t.info,error:t.content}:null!==t&&(i=(null==t?void 0:t.data)||t),i||(i=new Error("unknown error")),a=i.code||i.errorCode,"data_inspection_failed"===i.code){o=i.details,s=Pv(o);const e=this.formatGreenErrorMessage(i);e.errorMessage&&(o=e.errorMessage),e.errorMessageLocale&&(s=e.errorMessageLocale)}else i.code&&i.details?i.template?(o=i.template,s=Pv(i.template,{num:i.num})):(o=i.details,s=Pv(i.details)):"error"in i?i.error&&Object.hasOwnProperty.call(i.error,"message")?(o=i.error.message,s=Pv(o)):(o=i.error,s=Pv(o)):"message"in i?(o=i.message,s=Pv(o)):"quotaLimited"===i.code&&(o=i.details,s=Pv(o));return tE.openOnce({type:"error",content:s}),{errorCode:a,errorMessage:o,errorMessageLocale:s}})),C(this,"formatGreenErrorMessage",e=>{const{code:t,stage:n,modality:i=[],details:a}=e;let o="",s="";if("data_inspection_failed"===t)if(n&&i.length>0){const e=i.join(", "),t=null==i?void 0:i.map(e=>Pv(e)).join(", ");o=`Content security warning: ${n} ${e} data may contain inappropriate content!`,s=Pv(`Content security warning: ${n} {{fileType}} data may contain inappropriate content!`,{fileType:t})}else o=a,s=Pv(o);return{errorMessage:o,errorMessageLocale:s}}),C(this,"handleGreenNetErrorParentMsg",(e,t)=>{if("data_inspection_failed"!==(null==e?void 0:e.code)||!t)return;const{image_idx:n=[],video_idx:i=[],file_idx:a=[]}=e,o=this.history.messages[t];if((n.length||i.length||a.length)&&(null==o?void 0:o.files)){const e=[],t=[],s=[],r=[];o.files.map((n,i)=>{switch(n.type){case"image":e.push(i);break;case"video":t.push(i);break;case"file":s.push(i)}}),n.map(t=>r.push(e[t])),i.map(e=>r.push(t[e])),a.map(e=>r.push(s[e])),r.sort((e,t)=>e-t).map(e=>{var t;(null==(t=o.files)?void 0:t[e])&&(o.files[e].greenNet="green_error",o.files[e].url="")}),null!==(null==o?void 0:o.id)&&this.changeHistory(e=>{e.messages[o.id]=o})}}),C(this,"handleOpenAIError",(e,t,n)=>j(this,null,function*(){var i;const a=w({},n),{errorCode:o,errorMessage:s,errorMessageLocale:r}=yield this.handleGeneralError(e,t),l=a.id||a.fid;if(!l)return;const c=this.getModelForId(a.model);this.setStatus({isChat:!1}),this.isStopDisabled=!1,a.error={errorCode:o,errorMessage:s,content:Pv("Oops! There was an issue connecting to {{provider}}.",{provider:null!=(i=null==c?void 0:c.name)?i:null==c?void 0:c.id})+"\n"+(r||((null==t?void 0:t.info)?Pv(null==t?void 0:t.info):""))},a.done=!0,bk.setParams(l,{error_info:a.error,is_error:!0}),bk.sendEvent(l),a.statusHistory&&(a.statusHistory=a.statusHistory.filter(e=>"knowledge_search"!==e.action)),"data_inspection_failed"===o&&(a.content="",a.content_list=[],this.handleGreenNetErrorParentMsg(e,a.parentId)),!o&&[ng.ImageGeneration,ng.ImageEdit].includes(this.currentInputFeature)&&(a.error=void 0),this.changeHistory(e=>{e.messages[l]=a}),this._emit(uE.CHAT_SSE_ERROR,{id:this.id,chatId:this.chatId,history:jt(this.history),errorType:o}),this.isChat=!1})),C(this,"urlParsingBeforeSubmit",e=>j(this,null,function*(){var t;this._emit(uE.CHAT_PARSE_URL_BEGIN,{id:this.id,chatId:this.chatId});const n=tk(e);let i=[],a={};if(n.length>0){let e;try{e=yield(e=>j(void 0,null,function*(){return yield ow("/parse_url",{baseURL:"/api",method:"POST",data:{url_list:e}})}))(n);const o=(null==(t=null==e?void 0:e.data)?void 0:t.parse_data)||[],s=o.filter(e=>e.status===lg.SUCCESS);a={file_name_map:s.reduce((e,t)=>(e[t.oss_url]=t.url,e),{}),url_parse_result:o},i=s.map(e=>({type:"file",url:e.oss_url,file_class:"url"}))}catch(kX){this._emit(uE.CHAT_PARSE_URL_ERROR,{id:this.id})}}return this._emit(uE.CHAT_PARSE_URL_END,{id:this.id,chatId:this.chatId}),{hasUrl:!0,extra:a,urlFiles:i}})),C(this,"createNewChat",e=>j(this,null,function*(){var t;if(null==(t=this.history)?void 0:t.currentId){this.projectId=e||"";try{const{success:t,data:i}=yield(n={title:Pv("New Chat"),models:this.models,chat_mode:this.chatMode,chat_type:RC(this.currentInputFeature),timestamp:Date.now(),project_id:e||""},j(void 0,null,function*(){return yield uw(),yield ow("/chats/new",{method:"POST",data:n})})),a=i.id;if(t&&a){this.setChatId(a);const e="normal"===this.chatMode?this.chatId:this.chatMode;return fj.navigate(`/c/${e}`),i}const o=Pv((null==i?void 0:i.message)||"Error");throw tE.open({type:"error",content:o}),new Error(o)}catch(i){this._emit(uE.CHAT_ERROR,{id:this.id,chatId:this.chatId,error:i})}var n}})),C(this,"updateSubChatType",(e,t)=>{var n,i,a;this.subChatType=e;return _(w({},t),{extra:_(w({},null!=(n=t.extra)?n:{}),{meta:_(w({},null!=(a=null==(i=t.extra)?void 0:i.meta)?a:{}),{subChatType:e})})})}),this.id=a,xE.currentId=this.id,xE.addChat(this.id,this),xE.clearChatsStatus(),this.config=e,this.settings=t,this.user=n,this.chatMode=i}get token(){return zT()}_emit(e,...t){this.id===xE.currentId&&yE.emit(e,...t)}setChatId(e){this.chatId=e,this.setStatus({isLeave:!1})}setStatus({isChat:e,isLeave:t}){void 0!==e&&(this.isChat=e),void 0!==t&&(this.isLeave=t)}updateHistory(e){this.history=w(w({},this.history),e)}setChatOptions(e){Object.keys(e).forEach(t=>{t in this&&(this[t]=e[t])})}getChatOptions(){return{chatTitle:this.chatTitle,projectId:this.projectId,history:this.history,chatFiles:jt(this.chatFiles),tags:jt(this.tags),models:jt(this.models),isChatIntercept:this.isChatIntercept,currentInputFeature:this.currentInputFeature,isChat:this.isChat,subChatType:this.subChatType||this.currentInputSubType||this.currentInputFeature,permissions:jt(this.chatPermission)}}getChatOption(e){if(e in this){const t=this[e];return"object"==typeof t?jt(t):t}}submitPrompt(e){return j(this,arguments,function*({parentId:e,files:t=[],type:n,selectedModels:i,inputText:a,feature_config:o,sub_chat_type:s,extra:r,projectId:l}){var c,u,d,h,p,m,f,g,v,y;this.share_id=new URLSearchParams(window.location.search).get("shareId")||this.share_id||void 0;let b=a;const x=ZE(b);(x.length>1||(null==(c=null==x?void 0:x[0])?void 0:c.type)===rg.url)&&(b=ek(x));const w=[...t||[]],_=[...this.chatFiles||[]];if(_.push(...w.filter(e=>["doc","file","collection"].includes(e.type))),this.chatFiles=_.filter((e,t,n)=>n.findIndex(t=>JSON.stringify(t)===JSON.stringify(e))===t),null!==(null!=(h=null==(d=null==(u=this.config)?void 0:u.file)?void 0:d.max_count)?h:null)&&t.length+(null!=(m=null==(p=null==this?void 0:this.chatFiles)?void 0:p.length)?m:0)>Number(null==(g=null==(f=this.config)?void 0:f.file)?void 0:g.max_count))return void tE.open({type:"error",content:Pv("You can only chat with a maximum of {{maxCount}} file(s) at a time.",{maxCount:null==(y=null==(v=this.config)?void 0:v.file)?void 0:y.max_count})});this.models=i.map(({id:e})=>e),this.currentInputFeature=n,this.currentInputSubType=s||n,this.setStatus({isChat:!0});let S=e;if(!S&&this.history){const e=eI.getLastMessage(this.history);S=(null==e?void 0:e.id)||null}const C=o||this.getDefaultFeatureConfig(),{userMessage:E,messageId:k}=eI.createUserMessage({content:b,parentId:S,userAction:Yf.CHAT,files:(null==t?void 0:t.length)>0?t:void 0,extra:r},{currentInputFeature:this.currentInputFeature,subChatType:s||this.currentInputFeature,models:this.models||[],featureConfig:C});if(this.history){const e=this.updateSubChatType(this.subChatType,E);if(this.changeHistory(t=>{if(t.messages[k]=e,t.currentId=k,this.share_id&&S){const e=t.messages[S];e&&(e.childrenIds=[k])}else if(S){const e=t.messages[S];e&&-1===(e.childrenIds||[]).indexOf(k)&&(e.childrenIds=[...e.childrenIds||[],k])}}),this.checkForceClear())return;this.sendPrompt(e,{selectedModels:i,user_action:this.userAction,projectId:l})}})}sendPrompt(e,t){return j(this,arguments,function*(e,{selectedModels:t,user_action:n,userModelIds:i,projectId:a}){var o;if(!e.fid&&!e.id)return;const s=e.id||e.fid,r=i||e.models;if(this.checkForceClear())return;const l=this.history.messages[e.parentId||""],c=!!this.share_id&&(null==e?void 0:e.sub_chat_type)!==ng.INTERRUPT,u=!e.parentId&&"user"===e.role&&0===Object.values(this.history.messages).filter(e=>"user"!==e.role).length||l&&1===(null==(o=null==l?void 0:l.childrenIds)?void 0:o.length)&&this.branchInfo&&"/c/new-branch"===location.pathname||c||"/c/new-chat"===location.pathname,d=1===r.length&&e.childrenIds.length>1?e.childrenIds.filter(e=>!!e).findIndex(e=>this.history.messages[e].model===r[0]):void 0,h=[],p=[];for(const[f,g]of r.entries()){const e=t.find(({id:e})=>e===g);e?h.push(e):tE.open({type:"error",content:Pv("Model {{modelId}} not found",{modelId:g})})}const m=eI.createResponseMessages({parentId:s,selectedModels:h,userAction:n,extra:e.extra},{models:this.models||[],featureConfig:e.feature_config||this.getDefaultFeatureConfig(),subChatType:RC(null==e?void 0:e.sub_chat_type)||"",currentInputFeature:RC(e.chat_type)||"chat_type_undefined"});if(m.forEach((e,t)=>{const n=void 0!==d?d:t;n!==t&&(e.message.modelIdx=n),p.push({model:h[t],responseMessageId:e.messageId})}),this.changeHistory(t=>{var n,i;if(t.messages[s||""]=_(w({},e),{childrenIds:[...(null==(i=null==(n=t.messages[s||""])?void 0:n.childrenIds)?void 0:i.filter(e=>null!==e))||[],...m.map(e=>e.messageId)]}),this.changeResponseIdMap={},m.forEach(({message:e,messageId:n})=>{t.messages[n]=e}),m.length>0&&(t.currentId=m[0].messageId,t.currentResponseIds=m.map(e=>e.messageId)),null!==(null==e?void 0:e.parentId)&&!c){const n=t.messages[e.parentId];n&&-1===(n.childrenIds||[]).indexOf(s)&&(n.childrenIds=[...n.childrenIds||[],s])}}),this.isStopDisabled=!0,this._emit(uE.CHAT_BEGIN,{id:this.id}),ET.reset(["inputValue","files"]),u){if(!(yield this.createNewChat(a)))return this.changeHistory(e=>{e.currentId=null,e.currentResponseIds=[],e.messages={}}),void(this.isChat=!1);this._emit(uE.CHAT_CREATE_NEW_CHAT,{id:this.id,chatId:this.chatId}),this.isChat=!0,"normal"===this.chatMode&&(AC(),OC())}this.clearMcpParams(),this.checkForceClear()||(yield Promise.all(p.map(e=>this.sendPromptOpenAI(e.model,e.responseMessageId))))})}getDefaultFeatureConfig(){const{thinkingEnabled:e,researchMode:t}=Sx.getState();return{thinking_enabled:e,output_schema:"phase",research_mode:t?"advance":"normal"}}getMessageCreateConfig(e){return{currentInputFeature:this.currentInputFeature,subChatType:this.subChatType,models:this.models||[],featureConfig:e||this.getDefaultFeatureConfig()}}editSubmitPrompt(e){return j(this,arguments,function*({type:e,selectedModels:t,inputText:n,feature_config:i,subChatType:a,extra:o,messageId:s}){const r=this.history.messages[s],l=r.id||r.fid;this.setStatus({isChat:!0}),this.models=t.map(({id:e})=>e);const c=this.currentInputFeature;this.currentInputFeature=e,this.subChatType=a||(null==r?void 0:r.sub_chat_type);const u=i||{thinking_enabled:!1,output_schema:"phase"},d=w(w({},r.feature_config||{}),u),{userMessage:h,messageId:p}=eI.createUserMessage({files:(null==r?void 0:r.files)||void 0,content:n,parentId:r.parentId,userAction:Yf.EDIT,extra:w(w({},r.extra||{}),o||{})},this.getMessageCreateConfig(d)),m=eI.createResponseMessages({parentId:p,selectedModels:t,userAction:Yf.EDIT,extra:h.extra},this.getMessageCreateConfig(d));this.changeHistory(e=>{eI.updateHistoryMessages(e,{userMessage:{message:h,messageId:p},responseMessages:m})}),this.checkForceClear()||(dS("AsyncChat-ReSend",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:c,c6:this.currentInputFeature,c7:l}}),this.clearMcpParams(),yield Promise.all(m.map(({messageId:e,message:t})=>{const n=this.getModelForId(t.model);return this.sendPromptOpenAI(n,e)})))})}regenerateSubmitPrompt(e){return j(this,arguments,function*({type:e,selectedModels:t,feature_config:n,extra:i,userMessageId:a,modelIdx:o=0,sub_chat_type:s}){this.setStatus({isChat:!0}),this.models=t.map(({id:e})=>e);const r=this.currentInputFeature;this.currentInputFeature=e,this.subChatType=s;const l=this.history.messages[a],c=t[o],u=n||{thinking_enabled:!1,output_schema:"phase"},d=w(w({},l.feature_config||{}),u),h=_(w({},i||{}),{meta:_(w({},(null==i?void 0:i.meta)||{}),{subChatType:s})}),{responseMessage:p,messageId:m}=eI.createResponseMessage({parentId:a,model:c,modelIdx:o,userAction:Yf.RETRY,extra:h},this.getMessageCreateConfig(d));this.changeHistory(e=>{eI.updateUserMessageChildrenIds(e,a,m,{models:this.models,sub_chat_type:s,feature_config:d,extra:h||l.extra}),eI.updateHistoryMessages(e,{responseMessages:[{message:p,messageId:m}]})}),this.checkForceClear()||(dS("AsyncChat-ReGenerate",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:r,c6:this.currentInputFeature,c7:a}}),this.clearMcpParams(),yield this.sendPromptOpenAI(c,m))})}sendPromptOpenAI(e,t){return j(this,null,function*(){var n,i,a,o,s,r,l,c,u,d,h,p,m,f,g,v,y,b,x,S,C,E,k,I;const{emitSendPromptType:T}=vx.getState();if(!this.history||!t)return"";const N=w({},this.history.messages[t]),P=null==N?void 0:N.parentId;if(!P)return"";const M=w({},this.history.messages[P]);if(!M)return"";TT.getState().resetMessageInput(["inputValue","files"]),this.isStopDisabled=!0;let A={};"Qwen3-Max"===e.name&&(null==(n=M.feature_config)?void 0:n.thinking_enabled)||(A=yield this.urlParsingBeforeSubmit(M.content),A.hasUrl&&(M.extra=w(w({},M.extra||{}),A.extra)));let O=(null==M?void 0:M.sub_chat_type)||(null==(a=null==(i=M.extra)?void 0:i.meta)?void 0:a.subChatType);this.changeHistory(e=>{var n;N.extra=_(w({},(null==N?void 0:N.extra)||{}),{meta:{subChatType:O}}),e.messages[t]=N,M.extra=_(w({},(null==M?void 0:M.extra)||{}),{meta:_(w({},null==(n=null==M?void 0:M.extra)?void 0:n.meta),{subChatType:O})}),e.messages[N.parentId||""]=M}),this.subChatType=O;let R=this.currentInputFeature;R===ng.VideoGeneration&&(null==(o=null==M?void 0:M.files)?void 0:o.find(e=>"image"===e.type))&&(R=ng.Image2Video,O=ng.Image2Video);const D=(L=this.currentInputFeature,[ng.ImageGeneration,ng.VideoGeneration].includes(L));var L;let F=null==(d=null!=(u=null==(r=null==(s=null==e?void 0:e.info)?void 0:s.params)?void 0:r.stream_response)?u:null==(c=null==(l=this.settings)?void 0:l.params)?void 0:c.stream_response)||d;(this.subChatType===ng.Podcast||[ng.VideoGeneration,ng.Image2Video].includes(this.currentInputFeature))&&(F=!1);const z=!!(null==(h=this.mcpLoopParams)?void 0:h.messages),U=!!this.share_id&&(null==M?void 0:M.sub_chat_type)!==ng.INTERRUPT,H=N.user_action===Yf.RETRY,B=[...(null==A?void 0:A.urlFiles)||[],...(null==M?void 0:M.files)||[]],$=_(w(w(_(w({},M),{files:B,chat_type:R,sub_chat_type:YS((null==M?void 0:M.extra)||{})?"translate":O,parent_id:M.parentId}),H?{id:P,parent_id:null,parentId:null}:{}),U?{id:void 0,parent_id:null,parentId:null}:{}),{user_action:T,extra:_(w({},(null==M?void 0:M.extra)||{}),{meta:_(w({},(null==(p=null==M?void 0:M.extra)?void 0:p.meta)||{}),{subChatType:O})})});"Qwen3-Max"===e.name&&(null==(m=$.feature_config)?void 0:m.thinking_enabled)&&($.feature_config=_(w({},$.feature_config||{}),{thinking_format:"summary"}));const q=!((null==(f=null==$?void 0:$.models)?void 0:f.length)>1)&&(null==(v=null==(g=null==e?void 0:e.info)?void 0:g.meta)?void 0:v.auto_search);$.feature_config=_(w({},$.feature_config||{}),{auto_search:q});const G=(null==(y=this.mcpLoopParams)?void 0:y.messages)||[jt($)],V=Date.now(),W=e.id,Q=rt();let K;D||bk.setParams(t,{model_id:W,x_request_id:Q,api_start_time:V,chat_id:this.chatId,chat_type:null==N?void 0:N.chat_type,sub_chat_type:O}),0===Object.keys(this.mcpLoopParams).length&&(this._emit(uE.CHAT_SSE_BEGIN,{id:this.id,chatId:this.chatId,subChatType:this.subChatType,responseMessageId:t}),G[0]=yield this.connectMcp($,M));try{const t={};(null==(b=null==$?void 0:$.models)?void 0:b.length)>1&&(t.turn_id=N.parentId,t.modelIdx=N.modelIdx||0);const n=this.history.messages[M.parentId||""],i=(null==n?void 0:n.childrenIds)||[],a=0===i.filter(e=>{var t,n;return(null==(n=null==(t=this.history.messages)?void 0:t[e])?void 0:n.id)===e}).length,o=n&&!!this.branchInfo&&a&&M.parentId===(null==(x=this.branchInfo)?void 0:x.branch_message_id);o&&G[0]&&(G[0].parent_id=null,G[0].parentId=null);let s=z?N.id:$.parentId;H&&!z&&(s=null),K=yield((e,...t)=>j(void 0,[e,...t],function*(e,t={}){return dS("sendCompletionsRequestId",{params:{et:"OTHER"},paramsExtend:{request_id:null==t?void 0:t["X-Request-Id"]},aesParams:{c5:null==t?void 0:t["X-Request-Id"]}}),yield ow("/chat/completions",{method:"post",responseType:"stream",headers:w({"X-Accel-Buffering":"no"},t),params:{chat_id:e.chat_id},data:e})}))(w(w(w({stream:F,version:"2.1",incremental_output:dg,chat_id:this.chatId,origin_branch_message_id:o?M.parentId:void 0,chat_mode:this.chatMode,model:e.id,parent_id:o||U?null:s,messages:G,timestamp:Math.floor(Date.now()/1e3),share_id:U?this.share_id:void 0},t),D?{size:TT.getState().visionSize}:{}),F&&null!=(k=null==(E=null==(C=null==(S=e.info)?void 0:S.meta)?void 0:C.capabilities)?void 0:E.usage)&&k?{stream_options:{include_usage:!0}}:{}),{"X-Request-Id":Q}),yield KE.getState().updateEquity(),dS("generationCreateReturn",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:N.chat_type||this.currentInputFeature},aesParams:{c4:this.chatId,c5:N.chat_type||this.currentInputFeature,c7:O}})}catch(X){yield this.handleCompletionsSendError(X,t)}if(K&&K.data)if(K.success&&K.data){const e=yield this.handleCompletionsResponseSuccess(K,t);if((null==(I=null==e?void 0:e.changedResponseIds)?void 0:I.length)>0)return void e.changedResponseIds.forEach(e=>{const t=this.getResponseMessage(e);t&&this.finishChatUpdate(t,t.id||t.fid,W)})}else yield this.handleCompletionsResponseError(K,t);else yield this.handleCompletionsResponseNull(t);const Y=this.getResponseMessage(N.fid);Y&&this.finishChatUpdate(Y,N.id||N.fid||"",W)})}sendPromptOpenAIAndCallMcpTools(e,t,n){return j(this,null,function*(){const i=Object.keys(n),a={};for(const e of i){const t=n[e];a[e]=[];for(const n of t){const t=n.tool_name,i=n.params;if(["grantedOnce","granted"].includes(this.chatPermission.local_mcp)){const n=yield IC.callTool({serverName:e,toolName:t,toolArguments:i});n&&a[e].push({[t]:JSON.stringify(n.content)})}else"denied"===this.chatPermission.local_mcp&&a[e].push({[t]:"Tool call failed: User not authorized"})}}const o=w({},this.history.messages[t]);this.changeHistory(e=>{e.messages[t].content_list=[...(null==o?void 0:o.content_list)||[],{content:"",extra:{},mcp_results:a,phase:og.LOCAL_TOOL,status:sg.FINISHED}]});const s=_(w({},jt(o)),{role:"function",content:a});delete s.parentId,delete s.id,delete s.content_list,delete s.feature_config.mcp,delete s.feature_config.local_mcp,delete s.user_action,this.mcpLoopParams={messages:[s]},this.sendPromptOpenAI(e,t)})}clearMcpParams(){return j(this,null,function*(){this.mcpLoopParams={},this.mcpErrorServers=[]})}connectMcp(e,t){return j(this,null,function*(){const n=e,i=w({},t),a=i.id||i.fid||"";if(t.feature_config.mcp){if(t.feature_config.mcp.includes("amap")){const e=(yield HT())||void 0;n.extra=_(w({},n.extra),{location:e})}this.mcpErrorServers=yield IC.connect();const e=IC.getFormatAvailableServerMap();e&&Object.keys(e).length&&(n.feature_config=_(w({},n.feature_config),{local_mcp:e}),i.feature_config=_(w({},i.feature_config),{local_mcp:e})),this.changeHistory(e=>{e.messages[a]=i})}return n})}setLocalMcpPermission(e,t){return j(this,null,function*(){var n,i,a;if(this.chatPermission=_(w({},this.chatPermission),{local_mcp:e}),t){const{model:o,responseMessageId:s}=t;switch(e){case"grantedOnce":case"granted":case"denied":{const e=null==(i=null==(n=this.history.messages[s])?void 0:n.content_list)?void 0:i.findLast(e=>{var t;return e.phase===og.LOCAL_TOOL&&!!(null==(t=e.extra)?void 0:t.local_mcp)}),t=(null==(a=null==e?void 0:e.extra)?void 0:a.local_mcp)||{};if(!this.isChat){const e=Object.keys(t);this.mcpErrorServers=yield IC.connect(e)}this.sendPromptOpenAIAndCallMcpTools(o,s,t);break}}}})}finishChatUpdate(e,t,n){return j(this,null,function*(){var i,a,o,s,r,l,c,u,d,h,p,m,f,g,v,y,b;if(this.stopResponseFlag=!1,this.updateMessage(t,{chat_type:RC(e.chat_type)}),this.checkForceClear())return;const x=this.currentInputFeature===hg.WebSearch&&!(null==(i=e.content_list)?void 0:i.find(e=>[og.IMAGE_GEN_THINK,og.IMAGE_GEN_WEB_SEARCH,og.IMAGE_GEN].includes(e.phase))),S=jC(t,this.history);if(x&&(null==(a=this.history.messages[t])?void 0:a.done)&&!(null==(o=this.history.messages[t])?void 0:o.error)){const e=((null==S?void 0:S.length)?S:[{role:"user",content:"",extra:{meta:{}}}]).at(-1);try{const i=yield LC({stream:!1,modelIdx:0,model:n,chat_id:this.chatId,parent_id:null==e?void 0:e.id,timestamp:Math.floor(Date.now()/1e3)});let a=[];if((null==i?void 0:i.success)&&(null==i?void 0:i.data)){const e=KS(null==(c=null==(l=null==(r=null==(s=i.data)?void 0:s.choices)?void 0:r[0])?void 0:l.message)?void 0:c.content,[]);a=Array.isArray(e)?e:[]}(null==a?void 0:a.length)>0&&this.changeHistory(e=>{e.messages[t].info=_(w({},e.messages[t].info),{suggest:a})})}catch(P){}}const C=null==S?void 0:S.at(-1);if(vg(null==(d=null==(u=null==C?void 0:C.extra)?void 0:u.meta)?void 0:d.subChatType)&&(C.extra.endTime=window._currentTime_),this.checkForceClear())return;this.stopResponseFlag=!1;const E=S.filter(e=>"user"===e.role);let k=!1;2==Object.keys(this.history.messages).length&&(null==(h=this.models)?void 0:h[0])===n&&"data_inspection_failed"!==(null==(p=null==e?void 0:e.error)?void 0:p.errorCode)&&"normal"===this.chatMode&&(k=!0);const I=["RateLimited","ParallelLimited"].includes((null==(m=null==e?void 0:e.error)?void 0:m.errorCode)||""),T=(null==(f=this.branchInfo)?void 0:f.isTemp)&&!I,N=this.share_id&&this.chatId===vx.getState().chatId&&!I;if((k||T||N)&&0!==(null==(g=this.models)?void 0:g.length)){const e=yield R_({chat_id:this.chatId||""}).catch(()=>j(this,null,function*(){return null}));if(k){const t=null==(v=null==e?void 0:e.data)?void 0:v.title;this.updateChatTitleAndTags(t)}if((T||N)&&e){let t=e.data.chat.history;const n=Object.values(t.messages||{}),i=jC(t.currentId,t),a=jC(this.history.currentId,this.history);i.forEach((e,t)=>{const n=a[t];e.fid=n.fid}),t=PC(e.data.chat.history),n.forEach(e=>{t.messages[e.id||""]=this.formatServerMessage(e)}),this.updateHistory(t),this.share_id=I?this.share_id:"",this.branchInfo=(null==(b=null==(y=e.data)?void 0:y.meta)?void 0:b.branch_info)||null}}this._emit(uE.CHAT_MESSAGE_END,{id:this.id,chatMode:this.chatMode,chatId:this.chatId,userMessageLength:E.length,responseMessage:jt(e),history:jt(this.history)}),this.isLeave&&this.destroy(),this.setStatus({isChat:!1}),this.isStopDisabled=!1})}updateChatTitleAndTags(e){return j(this,null,function*(){if(this.checkForceClear())return;let t=Pv("New Chat");e&&(t=e),this.chatTitle=t,this._emit(uE.CHAT_MESSAGE_END_PROCESS,{id:this.id,chatId:this.chatId,process_type:"UPDATE_TITLE_AND_TAGS",title:t}),OC()})}updateToSaveMessage(e,t){return j(this,null,function*(){var n,i,a,o,s,r,l,c,u,d,h,p,m,f,g,v,y,b,x,_,S,C;if(this._emit(uE.CHAT_MESSAGE_EDIT_BEGIN,{chatId:this.chatId,history:this.history}),"user"===this.history.messages[e].role)this.changeHistory(n=>{n.messages[e].content=t}),yield F_({chat_id:this.chatId,message_id:e,content:t,content_list:[]}),this._emit(uE.CHAT_MESSAGE_EDIT_END,{instanceId:this.id,history:history});else{let E="",k=[];if((null==(i=null==(n=this.history)?void 0:n.messages[e])?void 0:i.content_list)&&(null==(o=null==(a=this.history)?void 0:a.messages[e])?void 0:o.content_list.length)){let n=-1;const i=[null==(s=this.history)?void 0:s.messages[e].chat_type,null==(r=this.history)?void 0:r.messages[e].sub_chat_type,null==(d=null==(u=null==(c=null==(l=this.history)?void 0:l.messages[e])?void 0:c.extra)?void 0:u.meta)?void 0:d.subChatType].includes(ng.WebSearch),a=null==(m=null==(p=null==(h=this.history)?void 0:h.messages[e])?void 0:p.content_list)?void 0:m.some(e=>e.phase===og.IMAGE_ZOOM_IN_TOOL);n=i||a?null!=(y=null==(v=null==(g=null==(f=this.history)?void 0:f.messages[e])?void 0:g.content_list)?void 0:v.findLastIndex(e=>e.phase===og.ANSWER||e.phase===og.DEEPTHINKING))?y:-1:null!=(_=null==(x=null==(b=this.history.messages[e])?void 0:b.content_list)?void 0:x.findIndex(e=>e.phase===og.ANSWER||e.phase===og.DEEPTHINKING))?_:-1,-1!==n&&this.changeHistory(i=>{var a,o;i.messages[e].content_list[Number(n)].content=t,i.messages[e].originalContent=null==(o=(null==(a=i.messages[e])?void 0:a.content_list)[Number(n)])?void 0:o.content}),k=this.history.messages[e].content_list}else this.changeHistory(n=>{n.messages[e].content=t,n.messages[e].originalContent=n.messages[e].content}),E=this.history.messages[e].content;this.changeHistory(t=>{t.messages[e].edited=!0}),this.history.messages[e].chat_type!==ng.Artifacts&&(null==(C=null==(S=this.history.messages[e].extra)?void 0:S.meta)?void 0:C.subChatType)!==ng.DeepResearchWebDev||yE.emit(dE.MESSAGE_EDIT_ARTIFACTS,{message:this.history.messages[e]}),yield F_(w(w({chat_id:this.chatId,message_id:e},E?{content:E}:{}),k.length?{content_list:k}:{})),this._emit(uE.CHAT_MESSAGE_EDIT_END,{instanceId:this.id,history:this.history})}})}saveAsCopyMessage(e,t){return j(this,null,function*(){var n,i,a,o,s,r,l,c,u,d,h,p,m,f;const g=this.history,v=(null==(n=null==g?void 0:g.messages[e])?void 0:n.content_list)&&(null==(i=null==g?void 0:g.messages[e])?void 0:i.content_list.length),y=jt(g.messages[e]),b=null==(a=null==y?void 0:y.error)?void 0:a.content;if(b){const e="data_inspection_failed"===b?Pv("Input or output data may contain inappropriate content."):b;y.error={content:e,errorMessage:b,errorCode:"data_inspection_failed"===b?"data_inspection_failed":""},tE.open({type:"error",content:Pv(e)})}(null==(s=null==(o=y.extra)?void 0:o.meta)?void 0:s.deploy)&&(y.extra.meta.deploy=void 0);const x=y.parentId,S=_(w({},y),{childrenIds:[],edited:!0,timestamp:Math.floor(Date.now()/1e3)});if(v){const e=[y.chat_type,y.sub_chat_type,null==(l=null==(r=null==y?void 0:y.extra)?void 0:r.meta)?void 0:l.subChatType].includes(ng.WebSearch),n=null==(c=null==y?void 0:y.content_list)?void 0:c.some(e=>e.phase===og.IMAGE_ZOOM_IN_TOOL);let i=-1;i=e||n?null!=(d=null==(u=null==S?void 0:S.content_list)?void 0:u.findLastIndex(e=>e.phase===og.ANSWER||e.phase===og.DEEPTHINKING))?d:-1:null!=(p=null==(h=null==S?void 0:S.content_list)?void 0:h.findIndex(e=>e.phase===og.ANSWER||e.phase===og.DEEPTHINKING))?p:-1,-1!==i&&(S.content_list[i].content=t)}else S.content=t;"data_inspection_failed"===b&&(S.content="");const C=yield(E={chat_id:this.chatId,message_id:e,content:S.content,content_list:S.content_list},j(void 0,null,function*(){return yield ow(`/chats/${E.chat_id}/messages/${E.message_id}/save_as_copy`,{method:"POST",data:{content:E.content,content_list:E.content_list,id:E.message_id}})}));var E;const{data:k}=C;return S.id=k.id,this.changeHistory(e=>{if(e.messages[k.id]=S,e.currentId=k.id,x){const t=[...e.messages[x].childrenIds,k.id];e.messages[x]=_(w({},e.messages[x]),{childrenIds:t})}}),this.history.messages[k.id].chat_type!==ng.Artifacts&&(null==(f=null==(m=this.history.messages[k.id].extra)?void 0:m.meta)?void 0:f.subChatType)!==ng.DeepResearchWebDev||yE.emit(dE.MESSAGE_EDIT_ARTIFACTS,{message:this.history.messages[k.id]}),this._emit(uE.CHAT_MESSAGE_EDIT_END,{instanceId:this.id,history:jt(this.history)}),{responseMessageId:k.id}})}deleteMessageById(e){return j(this,null,function*(){this.changeHistory(t=>{const n=eI.deleteMessage(t,e);t.currentId=n.currentId,t.currentResponseIds=n.currentResponseIds})})}destroy(){return j(this,null,function*(){(this.id!==xE.currentId&&!this.isChat||this.isForceClear)&&xE.removeChat(this.id)})}forceClear(){this.isForceClear=!0,this.stopResponseFlag=!0,this.isStopDisabled=!1,this.isLeave=!0,this.destroy()}checkForceClear(){return!!this.isForceClear&&(this.destroy(),!0)}handleCompletionsResponseNull(e){return j(this,null,function*(){this._emit(uE.CHAT_SSE_ERROR,{id:this.id,chatId:this.chatId,responseMessageId:e,errorType:"ResIsNULL"})})}handleCompletionsResponseError(e,t){return j(this,null,function*(){var n;const i=this.changeResponseIdMap[t]||t,a=this.getResponseMessage(i);this.handleOpenAIError(null,null==(n=null==e?void 0:e.json)?void 0:n.call(e),a)})}formatServerMessage(e){if("user"===e.role)return e;if(e.error&&e.error.code){const t=e.error;e._error=e.error;const n=this.getModelForId(e.model);let i="",a="",o="";if("data_inspection_failed"===t.code){const n=this.formatGreenErrorMessage(t);o="data_inspection_failed",i=n.errorMessage,a=n.errorMessageLocale,e.content="",e.content_list=[]}else{const e=t.details;void 0!==(null==e?void 0:e.errorCode)&&void 0!==(null==e?void 0:e.content)&&void 0!==(null==e?void 0:e.errorMessage)?(o=e.errorCode||t.code||"unknown_error",i=e.errorMessage,a=Pv(i)):(o=t.status_code||"unknown_error",i=t.detail||t.details||"",a=Pv(i))}const s=(null==e?void 0:e.modelName)||(null==n?void 0:n.name)||(null==n?void 0:n.id)||"Qwen";e.done=!0,e.error={errorCode:o,errorMessage:i,content:Pv("Oops! There was an issue connecting to {{provider}}.",{provider:s})+`\n${a}`}}return e}handleCompletionsResponseSuccess(e,t){return j(this,null,function*(){let n={};if(!!e.isStream)try{n=yield this.handleCompletionsResponseSSE(e.data,t)}catch(i){const e=this.changeResponseIdMap[t]||t;yield this.handleRetrievableFetchSSEError(e,i)}else n=yield this.handleCompletionsResponseJSON(e.data,t);return n})}handleCompletionsResponseJSON(e,t){return j(this,null,function*(){var n,i,a,o;let s=this.getResponseMessage(t);const r=null==e?void 0:e.data;if((null==r?void 0:r.message_id)&&(null==r?void 0:r.parent_id)){const{message_id:e,parent_id:n}=r;this.updateChatMessageIds(t,{parentId:n,respId:e}),this.updateCurrentResponseIdAfterIdChange(t,e),s=this.getResponseMessage(e)}if(null!==e&&e.success&&r){const{message_id:e}=r,t=r.messages.at(-1),l={done:!0};l.content=t.content,t.chat_type&&(l.chat_type=t.chat_type,t.chat_type===ng.Image2Video&&(l.chat_type=ng.VideoGeneration)),l.info=_(w({},r.usage||{}),{openai:!0,chatId:this.chatId});return((null==(i=null==(n=null==t?void 0:t.extra)?void 0:n.wanx)?void 0:i.task_id)||(null==(o=null==(a=null==t?void 0:t.extra)?void 0:a.aipodcast)?void 0:o.task_id)||"")&&(l.done=!1,l.extra=w(w({},(null==s?void 0:s.extra)||{}),t.extra),this._emit(uE.CHAT_SSE_FIRST_RECEIVE_MESSAGE,{id:this.id,chatId:this.chatId})),this.updateResponseMessage(e,l),{changedResponseIds:[e]}}yield this.handleOpenAIError(null,r||e,s)})}handleCompletionsResponseSSE(e,t){return j(this,null,function*(){var n;const i=new Gk;if(i.streamingProcessor){const a=i.streamingProcessor.processSSEStream(e,!!(null==(n=this.settings)?void 0:n.splitLargeChunks),!1,!0);return yield this.handleCompoletionsResponseStream(e,t,a)}return yield this.handleCompletionsResponseSSEFallback(e,t)})}handleCompletionsResponseSSEFallback(e,t){return j(this,null,function*(){var n;const i=yield IE(e,!!(null==(n=this.settings)?void 0:n.splitLargeChunks),!1);return yield this.handleCompoletionsResponseStream(e,t,i)})}handleCompoletionsResponseStream(e,t,n){return j(this,null,function*(){var e,i,a,o,s,r,l,c;const u=new Map;let d=0,h=t;const p=this.getResponseMessage(h);if(!p)return;const m=this.getModelForId(p.model),f=this.currentInputFeature,g=this.subChatType,v=new Map;let y=!1,b=!1;this.mcpErrorServers.length&&this.changeHistory(e=>{p&&(e.messages[t].extra=_(w({},p.extra||{}),{connectFailedMcp:this.mcpErrorServers.map(e=>e.name)}))});try{for(var x,S,C,E=M(n);x=!(S=yield E.next()).done;x=!1){const n=S.value,{value:m,role:x,phase:C,status:E,sources:I,selectedModelId:T,error:N,usage:P,functionCallType:M,web_search_info:A,code_interpreter_info:O,chunk_data:R,extra:D={},lang_code:L,function_call:F,chatId:z,parentId:U,done:H,isStop:B,isStopInThinking:$,mcp_name:q="",tool_name:G="",function_id:V="",timestamp:W}=n;let Q,K=n.responseId;if((null==(e=null==D?void 0:D.deep_research)?void 0:e.interrupt_id)&&"assistant"===x&&(K=null==(i=null==D?void 0:D.deep_research)?void 0:i.interrupt_id),K){if(Q=u.get(K),void 0===Q){Q=d,d++,u.set(K,Q);let e=null==(a=this.history.messages[K])?void 0:a.content_list;if(e=e?jt(e):void 0,v.set(Q,e||jt((null==(o=this.mcpLoopParams)?void 0:o.messages)?[...p.content_list||[]]:[])),z&&U){if(this.history.messages[K]){h=K;continue}const e=0===Q?t:t+"__MULTI__"+Q;if(0!==Q){const n=this.changeResponseIdMap[t]||t,i=this.getResponseMessage(n);i&&this.changeHistory(t=>{eI.cloneResponseMessage(t,e,i)})}this.updateChatMessageIds(e,{parentId:U,respId:K}),this.updateCurrentResponseIdAfterIdChange(e,K),this.updateResponseMessage(K,{responseIdx:Q}),u.size>1&&([...u.keys()].forEach(e=>{this.updateResponseMessage(e,{isMultiResponse:!0})}),this.changeHistory(e=>{var t;e.currentId=(null==(t=e.currentResponseIds)?void 0:t[0])||K})),h=K,this.stopResponseFlag||(this.isStopDisabled=!1);continue}}h=K}else{Q=0;const e=Array.from(u.entries()).find(([e,t])=>0===t);h=(null==e?void 0:e[0])||t,u.set(h,0)}const Y=v.get(Q)||jt((null==(s=this.mcpLoopParams)?void 0:s.messages)?[...p.content_list||[]]:[]),X=this.getResponseMessage(h);this.stopResponseFlag||(this.isStopDisabled=!1);const{local_mcp:J}=D||{};if(b||(b=C===og.LOCAL_TOOL&&E===sg.FINISHED&&!!Object.keys(J).length),!H&&(null==R?void 0:R.chunk_time)&&(null==R?void 0:R.chunk_size))bk.dealEventStreamChunkData(h,R);else{if(M){const e=!!(null==(r=null==X?void 0:X.feature_config)?void 0:r.thinking_enabled);"bio"!==M||e||Zk({notification_id:null==D?void 0:D.function_id,type:"functionCallType",detail:w({chat_id:this.chatId},(null==D?void 0:D.memory_operation_result)||{})}),this.updateResponseMessage(h,{functionCallType:M})}if(!M&&(null==X?void 0:X.functionCallType)&&this.updateResponseMessage(h,{functionCallType:null}),O&&this.updateResponseMessage(h,{codeInterpreterInfo:O,role:x}),N&&"The request is ended!"!==N.details&&"The request is finished!"!==N.details){yield this.handleOpenAIError(N,null,X);if([...u.keys()].every(e=>{var t;return!0===(null==(t=this.getResponseMessage(e))?void 0:t.done)}))break;continue}if(H||N&&("The request is ended!"===N.details||"The request is finished!"===N.details)){if(b)break;if(N)try{yield this.handleReconnectIsFinished(h)}catch(k){yield this.handleOpenAIError(k,null,X);break}[...u.keys()].forEach(e=>j(this,null,function*(){var t;if(bk.sendEvent(e),this.currentInputFeature===hg.WebSearch){const n=Y.length-1,i=Y.findIndex(e=>e.function_id===V),a=-1===i?n:i;Y[a].extra=_(w({},(null==(t=null==X?void 0:X.content_list)?void 0:t[a].extra)||{}),{web_search_info:[]}),this.updateResponseMessage(e,{content_list:jt(Y)})}B&&(this.updateResponseMessage(e,{is_stop:!0}),y=!0);const n={done:!0};if(N){const{errorCode:e,errorMessage:t,errorMessageLocale:i}=yield this.handleGeneralError(N,null);n.error={errorCode:e,errorMessage:t,content:i||((null==N?void 0:N.info)?Pv(null==N?void 0:N.info):"")}}this.updateResponseMessage(e,n),this.setStatus({isChat:!0}),this._emit(uE.CHAT_SSE_PROCESS,{id:this.id,chatId:this.chatId,responseMessageId:e,history:this.history})}));break}if($&&this.updateResponseMessage(h,{is_stop_in_thinking:!0}),P&&"{}"!==JSON.stringify(P)&&this.updateResponseMessage(h,{info:_(w({},P),{openai:!0,usage:P})}),T)this.updateResponseMessage(h,{selectedModelId:T,arena:!0});else if(I)this.updateResponseMessage(h,{sources:I});else if((!yg(f)||C)&&(""!=X.content||C||"\n"!=m)&&(C&&C!==og.KEEPALIVE&&(Pk({content_list:Y,phase:C,value:m,role:x,status:E,extra:D,lang_code:L,mcp_name:q,tool_name:G,function_call:F,timestamp:W,subChatType:g,function_id:V,splitLargeChunks:null==(l=this.settings)?void 0:l.splitLargeChunks}),v.set(Q,Y)),C!==og.KEEPALIVE)){if(!C){let e=X.content;null==(c=this.settings)||c.splitLargeChunks,e+=m,this.updateResponseMessage(h,{content:e})}this.updateResponseMessage(h,{content_list:jt(Y),extra:_(w({},(null==X?void 0:X.extra)||{}),{meta:{subChatType:g}})}),this.isChat=!0,this._emit(uE.CHAT_SSE_PROCESS,{id:this.id,chatId:this.chatId,responseMessageId:h,history:jt(this.history),setWebSearchInfo:!!A})}}}}catch(S){C=[S]}finally{try{x&&(S=E.return)&&(yield S.call(E))}finally{if(C)throw C[0]}}return this.mcpErrorServers.length&&(yield F_({chat_id:this.chatId,message_id:h,extra:{connectFailedMcp:this.mcpErrorServers.map(e=>e.name)}})),b?("prompt"!==this.chatPermission.local_mcp&&m&&this.setLocalMcpPermission(this.chatPermission.local_mcp,{model:m,responseMessageId:h}),void(yield D_({chat_id:this.chatId,chat:{permission:this.chatPermission}}))):(["grantedOnce","denied"].includes(this.chatPermission.local_mcp)&&this.setLocalMcpPermission("prompt"),[...u.keys()].forEach(e=>{const t=this.getResponseMessage(e);this._emit(uE.CHAT_SSE_END,{id:this.id,chatId:this.chatId,responseMessage:t,responseMessageId:e,model:m,permissions:this.chatPermission,history:jt(this.history)})}),{isMCPLoop:b,isStopResponse:y,changedResponseIds:[...u.keys()]})})}getResponseMessage(e){return this.history.messages[e]?w({},this.history.messages[e]):void 0}updateResponseMessage(e,t){this.changeHistory(n=>{var i;if(!n.messages[e])return;const a=n.messages[e];if(Object.keys(t).forEach(e=>{"[object Object]"===Object.prototype.toString.call(t[e])?a[e]=w(w({},a[e]||{}),t[e]):a[e]=t[e]}),t.codeInterpreterInfo&&(null==(i=a.content_list)?void 0:i.length)){const e=a.content_list.length-1;a.content_list[e].extra=_(w({},a.content_list[e].extra||{}),{code_interpreter_info:t.codeInterpreterInfo})}})}updateChatMessageIds(e,t){const{parentId:n,respId:i}=t;this.changeHistory(t=>{var a,o,s;const r=t.messages[e];if(!r)return;this.changeResponseIdMap[e]=i,r.id=i;const l=r.fid,c=(null==(a=t.messages)?void 0:a[r.parentId||""])||t.messages[n]||{},u=c.fid;c.id||(c.id=n);const d=null==(o=c.childrenIds)?void 0:o.findIndex(t=>t===e);if(d>-1){const e=[...c.childrenIds||[]];e[d]=i,c.childrenIds=e}if(c.parentId){const e=w({},t.messages[c.parentId]||{}),i=null==(s=e.childrenIds)?void 0:s.findIndex(e=>e===u);if(i>-1){const t=[...e.childrenIds||[]];t[i]=n,e.childrenIds=t}t.messages[c.parentId]=e}r.parentId=n,l&&t.messages[l]&&delete t.messages[l],t.messages[i]=r,t.messages[u]&&delete t.messages[u],t.messages[n]=c,t.currentId=i}),this._emit(uE.CHAT_SSE_ID_CHANGE,{id:this.id,chatId:this.chatId,responseMessageId:i,history:jt(this.history)})}updateCurrentResponseIdAfterIdChange(e,t){this.changeHistory(n=>{n.currentId=t;const i=n.currentResponseIds.findIndex(t=>t===e),a=n.currentResponseIds.findIndex(e=>e===t);i>-1?n.currentResponseIds[i]=t:-1===a&&n.currentResponseIds.push(t)})}updateMessage(e,t){var n;this.history.messages[e]&&(t.chat_type===ng.Image2Video&&(t.chat_type=ng.VideoGeneration,t.extra=_(w({},t.extra||{}),{meta:_(w({},(null==(n=t.extra)?void 0:n.meta)||{}),{subChatType:ng.VideoGeneration})})),this.changeHistory(n=>{n.messages[e]=w(w({},n.messages[e]),t)}),this._emit(uE.CHAT_MESSAGE_UPDATE,{instanceId:this.id,chatId:this.chatId,messageId:e,history:jt(this.history)}))}handleCompletionsSendError(e,t){return j(this,null,function*(){const n=this.getResponseMessage(t);dS("generationCreateReturn",{params:{et:"OTHER",c6:!1},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:(null==n?void 0:n.chat_type)||this.currentInputFeature,c7:this.subChatType}});const i={content:"",content_list:[],done:!0};this.stopResponseFlag&&(i.is_stop=!0),this.updateResponseMessage(t,i),this.changeHistory(e=>{e.currentId&&(e.messages[e.currentId].done=!0)}),this._emit(uE.CHAT_SSE_ERROR,{id:this.id,chatId:this.chatId,responseMessageId:t,errorType:e.name,history:jt(this.history)})})}handleCompletionsSSEError(e,t){return j(this,null,function*(){const n=this.changeResponseIdMap[t]||t,i=this.getResponseMessage(n);if("AbortError"===e.name||"User: Stop Response"===e){const t={done:!0,is_stop:!0};this.changeHistory(e=>{e.currentId&&(e.messages[e.currentId].done=!0)}),this.updateResponseMessage(n,t),this.setStatus({isChat:!1}),this.isStopDisabled=!1,this._emit(uE.CHAT_SSE_ERROR,{id:this.id,chatId:this.chatId,errorType:null==e?void 0:e.name,history:jt(this.history)})}else yield this.handleOpenAIError(e,null,i)})}retrievableFetchSSEResponse(e){return j(this,null,function*(){var t;this._emit(uE.CHAT_SCROLL_TO_BOTTOM,{id:this.id});const n=yield((e,...t)=>j(void 0,[e,...t],function*(e,t={}){return yield ow("/chat/completions",{method:"get",responseType:"stream",headers:w({"X-Accel-Buffering":"no"},t),toast:!1,params:e})}))({chat_id:this.chatId,response_id:e});if(!n.success||!n.data)return this.handleRetrievableFetchSSEError(e,new Error((null==(t=n.data)?void 0:t.message)||"Unknown error"));yield this.handleCompletionsResponseSuccess(n,e);const i=this.getResponseMessage(e);i&&this.finishChatUpdate(i,e,i.model)})}handleRetrievableFetchSSEError(e,t){return j(this,null,function*(){if("number"==typeof this.reconnectTimesMap[e]?this.reconnectTimesMap[e]+=1:this.reconnectTimesMap[e]=1,this.reconnectTimesMap[e]>10)return yield this.handleCompletionsSSEError(t,e);if(this.stopResponseFlag||"AbortError"===t.name)return this.handleCompletionsSSEError(t,e);if(this.isLeave)return;const n=this.changeResponseIdMap[e]||e;return tE.open({type:"warning",content:Pv("Network error, reconnecting..."),duration:3500}),dS("AsyncChat-Reconnect",{params:{et:"OTHER",c6:!0},paramsExtend:{chat_id:this.chatId,msg_type:this.currentInputFeature},aesParams:{c4:this.chatId,c5:this.currentInputFeature,c7:this.subChatType,c8:n}}),yield new Promise(e=>setTimeout(e,3e3)),yield this.retrievableFetchSSEResponse(n)})}handleReconnectIsFinished(e){return j(this,null,function*(){var t,n,i;const a=yield R_({chat_id:this.chatId||""}),o=null==(i=null==(n=null==(t=null==a?void 0:a.data)?void 0:t.chat)?void 0:n.history)?void 0:i.messages;if(o&&o[e]){const{content:t,content_list:n,error:i,modelName:a}=o[e];if((t||n)&&this.updateResponseMessage(e,{content:t,content_list:n}),i){const t={errorCode:i.code,errorMessage:i.message||i.details,content:Pv("Oops! There was an issue connecting to {{provider}}.",{provider:a})+`\n${Pv(i.message||i.details)}`};this.updateResponseMessage(e,{error:t})}}})}getModelForId(e){const{models:t}=EI.getState();return t.find(t=>t.id===e)}}C(tI,"modelsList",[]);class nI extends dt{constructor(){super({maxListeners:200}),C(this,"eventQueue"),C(this,"isPaused",!1),C(this,"eventListeners"),C(this,"maxListeners",20),C(this,"eventHistory"),C(this,"maxHistorySize",100),this.eventQueue=new Map,this.eventListeners=new Map,this.eventHistory=[],this.maxListeners=200}on(e,t){return this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(t),super.on(e.toString(),t)}firstOn(e,t){if(!e)return;const n=super.listeners(e);return n.length>0?(super.off(e.toString(),n[0]),super.prependListener(e.toString(),t)):super.on(e.toString(),t)}once(e,t){const n=(...i)=>{t(...i),this.eventListeners.has(e)&&this.eventListeners.get(e).delete(n)};return this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(n),super.once(e,n)}off(e,t){return t?(this.eventListeners.has(e)&&this.eventListeners.get(e).delete(t),super.off(e,t)):(this.eventListeners.has(e)&&this.eventListeners.delete(e),super.removeAllListeners(e)),this}emit(e,...t){return this.addToHistory(e,t[0]),this.isPaused?(this.eventQueue.has(e)||this.eventQueue.set(e,[]),this.eventQueue.get(e).push(t),!0):super.emit(e,...t)}pause(){this.isPaused=!0}resume(e=!0){this.isPaused=!1,e?this.processEventQueue():this.eventQueue.clear()}processEventQueue(){this.eventQueue.forEach((e,t)=>{e.forEach(e=>{super.emit(t,...e)})}),this.eventQueue.clear()}addToHistory(e,t){this.eventHistory.push({type:e,data:t,timestamp:Date.now()}),this.eventHistory.length>this.maxHistorySize&&this.eventHistory.shift()}getEventHistory(e,t){let n=this.eventHistory;return e&&(n=n.filter(t=>t.type===e)),t&&t>0&&(n=n.slice(-t)),n}clearEventHistory(){this.eventHistory=[]}getListenerCount(e){return this.listeners(e).length}getEventNames(){return Array.from(this.eventListeners.keys())}setMaxListeners(e){return this.maxListeners=e,this}getMaxListeners(){return this.maxListeners}createNamespace(e){return new iI(this,e)}}class iI{constructor(e,t){C(this,"controller"),C(this,"namespace"),this.controller=e,this.namespace=t}getNamespacedEvent(e){return`${this.namespace}:${e}`}on(e,t){return this.controller.on(this.getNamespacedEvent(e),t),this}once(e,t){return this.controller.once(this.getNamespacedEvent(e),t),this}off(e,t){return this.controller.off(this.getNamespacedEvent(e),t),this}emit(e,...t){return this.controller.emit(this.getNamespacedEvent(e),...t)}}class aI extends nI{destroy(){}handleError(e,t){this.emit("system:error",{code:"controller_error",message:e.message,timestamp:Date.now(),data:{context:t||this.constructor.name,stack:e.stack}})}}var oI=(e=>(e.INITIALIZED="initialized",e.LOADING="loading",e.READY="ready",e.PLAYING="playing",e.PAUSED="paused",e.STOPPED="stopped",e.UNSUPPORTED_LANGUAGE="unsupportedLanguage",e))(oI||{}),sI=(e=>(e.AUDIO_CONTEXT="audioContext",e.HTML_AUDIO="htmlAudio",e.SIMPLE_HTML_AUDIO="simpleHtmlAudio",e.HTML_AUDIO_CXT="htmlAudioCxt",e))(sI||{});class rI{constructor(e){C(this,"_state",oI.STOPPED),C(this,"options"),C(this,"audioContext",null),C(this,"gainNode",null),C(this,"audioCtxInitialized",!1),C(this,"isProcessingQueue",!1),C(this,"startTime",0),C(this,"currentTime",0),C(this,"audioBuffer",null),C(this,"bufferSize",8192),C(this,"minBufferSize",1024),C(this,"processedSamples",0),C(this,"isStreamPlaying",!1),C(this,"currentSource",null),C(this,"isWaitingForNextChunk",!1),C(this,"nextSource",null),C(this,"preloadThreshold",.5),C(this,"isPreloading",!1),C(this,"maxChunkSize",4096),C(this,"isFirstChunk",!0),C(this,"hasReceivedData",!1),C(this,"isDataComplete",!1),C(this,"preloadTimers",new Set),C(this,"sampleRate",24e3),C(this,"channels",1),this.options={onStateChange:e.onStateChange||(()=>{}),onError:e.onError||(()=>{})},this.initAudioContext()}initAudioContext(){return j(this,null,function*(){var e,t;try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination),this.gainNode.gain.value=1,this.audioCtxInitialized=!0,this.setState(oI.INITIALIZED)}catch(n){throw null==(t=(e=this.options).onError)||t.call(e,n),new Error("Web Audio API ")}})}appendPCMBuffer(e,t=!1){if(this.hasReceivedData||(this.setState(oI.LOADING),this.hasReceivedData=!0),!this.audioCtxInitialized)throw new Error("Web Audio API ");this.audioBuffer||(this.audioBuffer=new Float32Array(this.bufferSize),this.processedSamples=0);const n=this.pcmBufferToFloat32(e),i=Math.floor(this.currentTime*this.sampleRate)-this.processedSamples,a=i+n.length;if(this.audioBuffer.length<this.processedSamples+a){const e=new Float32Array(Math.max(this.processedSamples+a,2*this.audioBuffer.length));e.set(this.audioBuffer),this.audioBuffer=e}this.audioBuffer.set(n,this.processedSamples+i),this.currentTime=(this.processedSamples+a)/this.sampleRate,(a>=this.minBufferSize||t)&&(this.isStreamPlaying||this._state===oI.PLAYING||this._state===oI.STOPPED||this.startStreamingPlayback(),this._state!==oI.PLAYING||this.isProcessingQueue||this.processAudioBuffer(t)),t&&(this.isDataComplete=!0)}startStreamingPlayback(){var e;this.audioContext&&"suspended"===this.audioContext.state&&this.audioContext.resume(),this.isStreamPlaying=!0,this.startTime=(null==(e=this.audioContext)?void 0:e.currentTime)||0,this.isFirstChunk=!0,this.setState(oI.PLAYING)}processAudioBuffer(e=!1){var t,n;if(this._state!==oI.STOPPED&&this.isStreamPlaying&&this.audioBuffer&&!this.isProcessingQueue&&this.audioContext)if(this.currentSource&&this.currentSource.buffer)this.isWaitingForNextChunk=!0;else{this.isProcessingQueue=!0;try{const t=Math.floor(this.currentTime*this.sampleRate)-this.processedSamples;if(t<=0)return(e||this.isDataComplete)&&(this.isStreamPlaying=!1,this.setState(oI.STOPPED)),void(this.isProcessingQueue=!1);let n=Math.min(t,this.audioBuffer.length-this.processedSamples);if(e)n=Math.min(t,this.audioBuffer.length-this.processedSamples);else{if(this.isFirstChunk){const e=Math.min(512,this.minBufferSize);if(!(n>=e))return void(this.isProcessingQueue=!1);this.isFirstChunk=!1}if(!this.isFirstChunk&&(n=Math.min(n,this.maxChunkSize),n<this.minBufferSize&&!e))return void(this.isProcessingQueue=!1)}if(n<=0)return void(this.isProcessingQueue=!1);const i=this.audioContext.createBuffer(this.channels,n,this.sampleRate);for(let e=0;e<this.channels;e++){i.getChannelData(e).set(this.audioBuffer.subarray(this.processedSamples,this.processedSamples+n))}const a=this.audioContext.createBufferSource();a.buffer=i,a.connect(this.gainNode),this.currentSource=a;const o=this.audioContext.currentTime;let s;0===this.processedSamples?s=o:(s=this.startTime+this.processedSamples/this.sampleRate,s<o-.1?(this.startTime=o-this.processedSamples/this.sampleRate,s=o):s=Math.max(s,o)),a.start(s),a.onended=()=>{this.processedSamples+=n,this.currentSource=null;const t=Math.floor(this.currentTime*this.sampleRate);!(this.processedSamples<t)||e&&this.isDataComplete?(this.isStreamPlaying=!1,this.setState(oI.STOPPED)):this.isStreamPlaying&&!this.isProcessingQueue&&(this.isWaitingForNextChunk=!1,this.processAudioBuffer(e))},this.setupPreloadListener(a,n,e)}catch(i){this.currentSource=null,null==(n=(t=this.options).onError)||n.call(t,i)}this.isProcessingQueue=!1}}setupPreloadListener(e,t,n){const i=t/this.sampleRate*this.preloadThreshold,a=setTimeout(()=>{!this.isStreamPlaying||this.isPreloading||n||this._state!==oI.PLAYING||this.preloadNextChunk(),this.preloadTimers.delete(a)},1e3*i);this.preloadTimers.add(a);const o=e.onended;e.onended=()=>{clearTimeout(a),this.preloadTimers.delete(a),o&&o.call(e)}}preloadNextChunk(){if(this._state!==oI.STOPPED&&this.isStreamPlaying&&!this.isPreloading&&this.audioBuffer){this.isPreloading=!0;try{const e=Math.floor(this.currentTime*this.sampleRate)-this.processedSamples;if(e<=0)return void(this.isPreloading=!1);const t=Math.min(e,this.audioBuffer.length-this.processedSamples);if(t<=0)return void(this.isPreloading=!1);const n=this.audioContext.createBuffer(this.channels,t,this.sampleRate);for(let a=0;a<this.channels;a++){n.getChannelData(a).set(this.audioBuffer.subarray(this.processedSamples,this.processedSamples+t))}const i=this.audioContext.createBufferSource();i.buffer=n,i.connect(this.gainNode),this.nextSource=i}catch(e){}this.isPreloading=!1}}pcmBufferToFloat32(e){const t=new Float32Array(e.length/2);for(let n=0;n<e.length;n+=2){const i=e[n]|e[n+1]<<8;t[n/2]=32768&i?(i-65536)/32768:i/32768}return t}play(){return j(this,null,function*(){var e;if(!this.audioCtxInitialized)throw new Error("Web Audio API ");this._state!==oI.PLAYING&&this.hasReceivedData&&(this.audioContext&&"suspended"===this.audioContext.state&&(yield this.audioContext.resume()),this.isStreamPlaying=!0,0===this.processedSamples&&(this.startTime=(null==(e=this.audioContext)?void 0:e.currentTime)||0),this.setState(oI.PLAYING),this.audioBuffer&&!this.isProcessingQueue&&(this.isFirstChunk=!0,this.processAudioBuffer()))})}pause(){return j(this,null,function*(){if(!this.audioCtxInitialized)throw new Error("Web Audio API ");this.setState(oI.PAUSED)})}stop(){return j(this,null,function*(){if(!this.audioCtxInitialized)throw new Error("Web Audio API ");if(this.currentSource){try{this.currentSource.stop()}catch(e){}this.currentSource=null}if(this.nextSource){try{this.nextSource.stop()}catch(e){}this.nextSource=null}this.preloadTimers.forEach(e=>clearTimeout(e)),this.preloadTimers.clear(),this.isStreamPlaying=!1,this.isWaitingForNextChunk=!1,this.isPreloading=!1,this.setState(oI.STOPPED)})}reset(){return j(this,null,function*(){yield this.stop(),this.hasReceivedData=!1,this.isDataComplete=!1,this.audioBuffer=null,this.currentTime=0,this.startTime=0,this.processedSamples=0,this.isStreamPlaying=!1,this.isWaitingForNextChunk=!1,this.isPreloading=!1,this.isFirstChunk=!0,this.currentSource=null,this.nextSource=null,this.preloadTimers.forEach(e=>clearTimeout(e)),this.preloadTimers.clear(),this.setState(oI.STOPPED)})}resetPlayback(){return j(this,null,function*(){yield this.stop(),this.currentTime=0,this.startTime=0,this.processedSamples=0,this.isStreamPlaying=!1,this.isWaitingForNextChunk=!1,this.isPreloading=!1,this.isFirstChunk=!0,this.currentSource=null,this.nextSource=null,this.preloadTimers.forEach(e=>clearTimeout(e)),this.preloadTimers.clear(),this.audioBuffer&&this.hasReceivedData&&(this.currentTime=this.audioBuffer.length/this.sampleRate),this.hasReceivedData?this.setState(oI.READY):this.setState(oI.STOPPED)})}destroy(){this.stop(),this.preloadTimers.forEach(e=>clearTimeout(e)),this.preloadTimers.clear(),this.audioCtxInitialized&&(this.audioContext&&"closed"!==this.audioContext.state&&this.audioContext.close(),this.gainNode=null,this.audioContext=null),this.setState(oI.STOPPED)}setState(e){var t,n;this._state!==e&&(this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e))}get volume(){var e;if(!this.audioCtxInitialized)throw new Error("Web Audio API ");return(null==(e=this.gainNode)?void 0:e.gain.value)||0}set volume(e){if(!this.audioCtxInitialized)throw new Error("Web Audio API ");this.gainNode.gain.value=e}get state(){return this._state}get isReady(){return this._state===oI.READY}get isLoading(){return this._state===oI.LOADING}get isPlaying(){return this._state===oI.PLAYING}get isPaused(){return this._state===oI.PAUSED}get isStopped(){return this._state===oI.STOPPED}get hasData(){return this.hasReceivedData}get isComplete(){return this.isDataComplete}setAudioParams(e,t=1){this.sampleRate=e,this.channels=t}}class lI{constructor(e){C(this,"_state",oI.STOPPED),C(this,"options"),C(this,"audioElement",null),C(this,"audioCtxInitialized",!1),C(this,"bufferSize",8192),C(this,"minBufferSize",1024),C(this,"isStreamPlaying",!1),C(this,"isAudioCreated",!1),C(this,"audioChunks",[]),C(this,"hasReceivedData",!1),C(this,"isDataComplete",!1),C(this,"currentBlobURL",null),C(this,"playedChunksCount",0),C(this,"lastUpdateTime",0),C(this,"isUpdatingAudio",!1),C(this,"updateQueue",[]),C(this,"retryCount",0),C(this,"maxRetries",3),C(this,"isManuallyStopped",!1),C(this,"stopRequested",!1),C(this,"pendingTimeouts",new Set),C(this,"sampleRate",24e3),C(this,"channels",1),C(this,"bitsPerSample",16),C(this,"audioInitAbortHandler",()=>{}),C(this,"audioInitCanplayHandler",()=>{var e;this.setState(oI.READY),!(null==(e=this.audioElement)?void 0:e.paused)||this.isManuallyStopped||this.stopRequested||this.audioElement.play().catch(e=>{})}),C(this,"audioInitPlayHandler",()=>{this.setState(oI.PLAYING)}),C(this,"audioInitPauseHandler",()=>{this.setState(oI.PAUSED)}),C(this,"audioInitEndedHandler",()=>{if(this.isManuallyStopped||this.stopRequested)this.setState(oI.STOPPED);else if(this.setState(oI.STOPPED),this.isStreamPlaying&&!this.isDataComplete&&this.audioChunks.length>this.playedChunksCount&&!this.isManuallyStopped&&!this.stopRequested){const e=setTimeout(()=>{var t;this.pendingTimeouts.delete(e),(null==(t=this.audioElement)?void 0:t.paused)&&this.isStreamPlaying&&this.audioChunks.length>this.playedChunksCount&&!this.isManuallyStopped&&!this.stopRequested&&this.queueUpdate(()=>this.updateStreamingAudio())},100);this.pendingTimeouts.add(e)}else this.isDataComplete&&(this.isStreamPlaying=!1)}),C(this,"audioInitErrorHandler",e=>{var t,n;null==(n=(t=this.options).onError)||n.call(t,new Error(""))}),C(this,"audioCanPlayHandler",()=>{this.removeAudioEventListeners(),this.playAudio()}),C(this,"audioErrorHandler",()=>{var e,t;this.removeAudioEventListeners(),null==(t=(e=this.options).onError)||t.call(e,new Error(""))}),this.options={onStateChange:e.onStateChange||(()=>{}),onError:e.onError||(()=>{})},this.initHTMLAudio()}initHTMLAudio(){return j(this,null,function*(){var e,t;try{this.audioElement=document.createElement("audio"),this.audioElement.style.display="none",this.audioElement.preload="auto",this.audioElement.controls=!1,this.audioElement.volume=1,document.body.appendChild(this.audioElement),this.audioElement.addEventListener("abort",this.audioInitAbortHandler),this.audioElement.addEventListener("canplay",this.audioInitCanplayHandler),this.audioElement.addEventListener("play",this.audioInitPlayHandler),this.audioElement.addEventListener("pause",this.audioInitPauseHandler),this.audioElement.addEventListener("ended",this.audioInitEndedHandler),this.audioElement.addEventListener("error",this.audioInitErrorHandler),this.audioCtxInitialized=!0,this.setState(oI.INITIALIZED)}catch(n){throw null==(t=(e=this.options).onError)||t.call(e,n),new Error(" HTML Audio ")}})}appendPCMBuffer(e,t=!1){var n,i;if(this.isManuallyStopped||this.stopRequested)return;if(this.hasReceivedData||(this.setState(oI.LOADING),this.hasReceivedData=!0),!this.audioCtxInitialized)throw new Error(" HTML Audio ");this.audioChunks.push(e);if(this.audioChunks.reduce((e,t)=>e+t.length,0)>=this.minBufferSize&&!this.isStreamPlaying&&!this.isAudioCreated&&this.startStreamingPlayback(),this.isStreamPlaying&&this.isAudioCreated&&(null==(n=this.audioElement)?void 0:n.paused)){const e=Date.now();e-this.lastUpdateTime>200&&this.audioChunks.length>this.playedChunksCount&&(this.lastUpdateTime=e,this.queueUpdate(()=>this.updateStreamingAudio()))}t&&(this.isDataComplete=!0,this.isStreamPlaying?this.isAudioCreated&&(null==(i=this.audioElement)?void 0:i.paused)&&this.queueUpdate(()=>this.updateStreamingAudio()):this.startStreamingPlayback())}float32ToPCM(e){const t=new Uint8Array(2*e.length);for(let n=0;n<e.length;n++){const i=Math.max(-1,Math.min(1,e[n])),a=i<0?32768*i:32767*i,o=Math.round(a);t[2*n]=255&o,t[2*n+1]=o>>8&255}return t}startStreamingPlayback(){this.isStreamPlaying||this.isManuallyStopped||this.stopRequested||(this.isStreamPlaying=!0,this.setState(oI.PLAYING),this.queueUpdate(()=>this.updateStreamingAudio()))}waitForAudioLoadAndPlay(){this.audioElement&&(this.isManuallyStopped||this.stopRequested||(this.audioElement.readyState>=2?this.playAudio():(this.audioElement.addEventListener("canplay",this.audioCanPlayHandler),this.audioElement.addEventListener("error",this.audioErrorHandler))))}queueUpdate(e){this.isManuallyStopped||this.stopRequested||(this.isUpdatingAudio?this.updateQueue.push(e):this.executeUpdate(e))}executeUpdate(e){if(this.isManuallyStopped||this.stopRequested)this.processNextUpdate();else{this.isUpdatingAudio=!0;try{e()}catch(t){this.isUpdatingAudio=!1,this.processNextUpdate()}}}processNextUpdate(){if(this.isManuallyStopped||this.stopRequested)return this.updateQueue=[],void(this.isUpdatingAudio=!1);if(this.updateQueue.length>0){const e=this.updateQueue.shift();if(e){const t=setTimeout(()=>{this.pendingTimeouts.delete(t),this.executeUpdate(e)},50);this.pendingTimeouts.add(t)}}else this.isUpdatingAudio=!1}updateStreamingAudio(){var e,t;if(this.isManuallyStopped||this.stopRequested)this.processNextUpdate();else if(this.audioElement&&0!==this.audioChunks.length)if(this.audioChunks.length<=this.playedChunksCount)this.processNextUpdate();else if(this.audioElement.paused||this.audioElement.ended)try{const e=this.audioChunks.slice(this.playedChunksCount),t=e.reduce((e,t)=>e+t.length,0),n=new Uint8Array(t);let i=0;for(const s of e)n.set(s,i),i+=s.length;const a=this.createWAVFile(n);this.currentBlobURL&&URL.revokeObjectURL(this.currentBlobURL);const o=new Blob([a],{type:"audio/wav"});this.currentBlobURL=URL.createObjectURL(o),this.audioElement.src=this.currentBlobURL,this.isAudioCreated=!0,this.waitForAudioLoadAndPlay()}catch(n){null==(t=(e=this.options).onError)||t.call(e,n),this.processNextUpdate()}else this.processNextUpdate();else this.processNextUpdate()}playAudio(){if(this.isManuallyStopped||this.stopRequested)this.processNextUpdate();else if(this.audioElement){if(this.audioElement.readyState<2){const e=setTimeout(()=>{this.pendingTimeouts.delete(e),this.playAudio()},100);return void this.pendingTimeouts.add(e)}this.audioElement.paused?this.audioElement.play().then(()=>{this.playedChunksCount=this.audioChunks.length,this.retryCount=0,this.processNextUpdate()}).catch(e=>{var t,n;if(this.isManuallyStopped||this.stopRequested)return this.retryCount=0,void this.processNextUpdate();if("AbortError"===e.name||e.message.includes("interrupted"))if(this.retryCount++,this.retryCount<=this.maxRetries){const e=setTimeout(()=>{this.pendingTimeouts.delete(e),this.playAudio()},200*this.retryCount);this.pendingTimeouts.add(e)}else this.retryCount=0,this.processNextUpdate();else this.retryCount=0,null==(n=(t=this.options).onError)||n.call(t,e),this.processNextUpdate()}):this.processNextUpdate()}else this.processNextUpdate()}createWAVFile(e){const t=e.length,n=36+t,i=new ArrayBuffer(44+t),a=new DataView(i);a.setUint32(0,1380533830,!1),a.setUint32(4,n,!0),a.setUint32(8,1463899717,!1),a.setUint32(12,1718449184,!1),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,this.channels,!0),a.setUint32(24,this.sampleRate,!0),a.setUint32(28,this.sampleRate*this.channels*this.bitsPerSample/8,!0),a.setUint16(32,this.channels*this.bitsPerSample/8,!0),a.setUint16(34,this.bitsPerSample,!0),a.setUint32(36,1684108385,!1),a.setUint32(40,t,!0);return new Uint8Array(i,44).set(e),i}play(){return j(this,null,function*(){var e,t;if(!this.audioCtxInitialized)throw new Error(" HTML Audio ");if(this._state!==oI.PLAYING&&this.hasReceivedData)if(this.isStreamPlaying){if(this.audioElement)try{yield this.audioElement.play()}catch(n){null==(t=(e=this.options).onError)||t.call(e,n)}}else this.startStreamingPlayback()})}pause(){return j(this,null,function*(){if(!this.audioCtxInitialized)throw new Error(" HTML Audio ");this.audioElement&&this.audioElement.pause(),this.setState(oI.PAUSED)})}stop(){return j(this,null,function*(){if(!this.audioCtxInitialized)throw new Error(" HTML Audio ");if(this.stopRequested=!0,this.isManuallyStopped=!0,this.isStreamPlaying=!1,this.clearAllTimeouts(),this.updateQueue=[],this.isUpdatingAudio=!1,this.retryCount=0,this.audioElement)try{this.audioElement.pause(),this.audioElement.currentTime=0,this.audioElement.removeEventListener("ended",()=>{}),this.audioElement.removeEventListener("canplay",()=>{}),this.audioElement.removeEventListener("play",()=>{}),this.audioElement.removeEventListener("pause",()=>{}),this.audioElement.removeEventListener("error",()=>{})}catch(e){}this.setState(oI.STOPPED)})}reset(){return j(this,null,function*(){yield this.stop(),this.hasReceivedData=!1,this.isDataComplete=!1,this.audioChunks=[],this.isStreamPlaying=!1,this.isAudioCreated=!1,this.playedChunksCount=0,this.lastUpdateTime=0,this.isUpdatingAudio=!1,this.updateQueue=[],this.retryCount=0,this.stopRequested=!1,this.isManuallyStopped=!1,this.setState(oI.STOPPED)})}resetPlayback(){return j(this,null,function*(){yield this.stop(),this.isStreamPlaying=!1,this.isAudioCreated=!1,this.playedChunksCount=0,this.lastUpdateTime=0,this.isUpdatingAudio=!1,this.updateQueue=[],this.retryCount=0,this.stopRequested=!1,this.isManuallyStopped=!1,this.hasReceivedData?this.setState(oI.READY):this.setState(oI.STOPPED)})}destroy(){if(this.stop(),this.currentBlobURL&&(URL.revokeObjectURL(this.currentBlobURL),this.currentBlobURL=null),this.audioElement){try{this.audioElement.remove()}catch(e){}this.audioElement=null}this.clearAllTimeouts(),this.audioCtxInitialized=!1,this.isStreamPlaying=!1,this.isAudioCreated=!1,this.hasReceivedData=!1,this.isDataComplete=!1,this.audioChunks=[],this.playedChunksCount=0,this.lastUpdateTime=0,this.isUpdatingAudio=!1,this.updateQueue=[],this.retryCount=0,this.stopRequested=!1,this.isManuallyStopped=!1,this.setState(oI.STOPPED)}clearAllTimeouts(){this.pendingTimeouts.forEach(e=>{clearTimeout(e)}),this.pendingTimeouts.clear()}setAudioParams(e,t=1,n=16){this.sampleRate=e,this.channels=t,this.bitsPerSample=n}setState(e){var t,n;this._state!==e&&(this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e))}get volume(){var e;if(!this.audioCtxInitialized)throw new Error(" HTML Audio ");return(null==(e=this.audioElement)?void 0:e.volume)||0}set volume(e){if(!this.audioCtxInitialized)throw new Error(" HTML Audio ");this.audioElement&&(this.audioElement.volume=Math.max(0,Math.min(1,e)))}get state(){return this._state}get isReady(){return this._state===oI.READY}get isLoading(){return this._state===oI.LOADING}get isPlaying(){return this._state===oI.PLAYING}get isPaused(){return this._state===oI.PAUSED}get isStopped(){return this._state===oI.STOPPED}get hasData(){return this.hasReceivedData}get isComplete(){return this.isDataComplete}removeInitAudioEventListeners(){this.audioElement&&(this.audioElement.removeEventListener("abort",this.audioInitAbortHandler),this.audioElement.removeEventListener("canplay",this.audioInitCanplayHandler),this.audioElement.removeEventListener("play",this.audioInitPlayHandler),this.audioElement.removeEventListener("pause",this.audioInitPauseHandler),this.audioElement.removeEventListener("ended",this.audioInitEndedHandler),this.audioElement.removeEventListener("error",this.audioInitErrorHandler))}removeAudioEventListeners(){this.audioElement&&(this.audioElement.removeEventListener("canplay",this.audioCanPlayHandler),this.audioElement.removeEventListener("error",this.audioErrorHandler))}removeAllAudioEventListeners(){this.removeInitAudioEventListeners(),this.removeAudioEventListeners()}}class cI{constructor(e){C(this,"_state",oI.STOPPED),C(this,"options"),C(this,"audioElement",null),C(this,"audioContext",null),C(this,"mediaStreamDestination",null),C(this,"bufferQueue",[]),C(this,"sourceNodes",[]),C(this,"nextSchedule",0),C(this,"sampleRate",24e3),C(this,"channels",1),C(this,"isDataComplete",!1),C(this,"_isStreamPlaying",!1),C(this,"_isStreamStopped",!1),C(this,"isUserStopped",!1),C(this,"_isComplete",!1),C(this,"_isPaused",!1),C(this,"_isLoading",!1),C(this,"_isReady",!1),C(this,"_isError",!1),C(this,"_isDestroyed",!1),C(this,"audioCanPlayHandler",()=>{var e;this.setState(oI.READY),(null==(e=this.audioElement)?void 0:e.paused)&&!this.isUserStopped&&this.audioElement.play().catch(e=>{})}),this.options={onStateChange:e.onStateChange||(()=>{}),onError:e.onError||(()=>{})},this.initAudioContext()}initAudioContext(){var e,t;try{this.audioElement=document.createElement("audio"),this.audioElement.style.display="none",this.audioElement.preload="auto",this.audioElement.controls=!1,this.audioElement.volume=1,document.body.appendChild(this.audioElement),this.audioElement.addEventListener("canplay",this.audioCanPlayHandler),this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.mediaStreamDestination=this.audioContext.createMediaStreamDestination(),this.audioElement.srcObject=this.mediaStreamDestination.stream,this.setState(oI.INITIALIZED)}catch(n){throw null==(t=(e=this.options).onError)||t.call(e,n),new Error("Web Audio API ")}}appendPCMBuffer(e,t=!1){if(!this.audioContext)throw new Error("Web Audio API ");this.bufferQueue.push({buffer:e,isDone:t}),t&&(this.isDataComplete=!0),this._isStreamPlaying||this.isUserStopped||this.processBufferQueue()}processBufferQueue(){if(0===this.bufferQueue.length)return void(this._isStreamPlaying=!1);const{buffer:e,isDone:t}=this.bufferQueue.shift(),n=this.createAudioBufferFromPCM(e),i=this.audioContext.createBufferSource();i.buffer=n,i.connect(this.mediaStreamDestination),this.sourceNodes.push(i);const a=this.audioContext.currentTime;0===this.nextSchedule&&(this.nextSchedule=a),i.start(this.nextSchedule),this.nextSchedule+=n.duration,i.onended=()=>{const e=this.sourceNodes.indexOf(i);-1!==e&&this.sourceNodes.splice(e,1),this.bufferQueue.length>0&&this.processBufferQueue()}}createAudioBufferFromPCM(e){const t=this.audioContext.createBuffer(1,e.length/2,this.sampleRate),n=t.getChannelData(0),i=new DataView(e.buffer);for(let a=0,o=0;a<e.length;a+=2,o++){const e=i.getInt16(a,!0);n[o]=Math.max(-1,Math.min(1,e/32768))}return t}setState(e){var t,n;this._state!==e&&(this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e))}setAudioParams(e,t=1){this.sampleRate=e,this.channels=t}removeAllAudioEventListeners(){this.audioElement&&this.audioElement.removeEventListener("canplay",this.audioCanPlayHandler)}}class uI{constructor(e){C(this,"_state",oI.STOPPED),C(this,"options"),C(this,"audioElement",null),C(this,"audioPlayerInitlized",!1),C(this,"mediaSessionInitialized",!1),C(this,"mediaMetadata",{}),C(this,"audioChunks",[]),C(this,"playedChunksCount",0),C(this,"minBufferSize",30720),C(this,"currentBlobURL",null),C(this,"currentBlobChunkLength",0),C(this,"hasReceivedData",!1),C(this,"isDataComplete",!1),C(this,"isStreamPlaying",!1),C(this,"isUserStopped",!1),C(this,"isLoadingAudio",!1),C(this,"isRequestPlaying",!1),C(this,"sampleRate",24e3),C(this,"channels",1),C(this,"bitsPerSample",16),C(this,"pendingTasks",{playTaskId:null,processNextUpdateTaskId:null}),C(this,"audioInitAbortHandler",()=>{}),C(this,"audioInitCanplayHandler",()=>{this.setState(oI.READY)}),C(this,"audioInitPlayHandler",()=>{this.setState(oI.PLAYING)}),C(this,"audioInitPauseHandler",()=>{[oI.PAUSED,oI.STOPPED].includes(this.state)||this.setState(oI.PAUSED)}),C(this,"audioInitEndedHandler",()=>{if(this.isUserStopped||this.audioChunks.length===this.playedChunksCount&&this.isDataComplete)return this.isStreamPlaying=!1,this.isUserStopped=!1,void(this.state!==oI.STOPPED&&this.setState(oI.STOPPED));this.isStreamPlaying&&this.audioChunks.length>this.playedChunksCount&&this.processNextUpdate()}),C(this,"audioInitErrorHandler",e=>{var t,n;null==(n=(t=this.options).onError)||n.call(t,new Error(""))}),C(this,"audioCanPlayHandler",()=>{this.removeAudioEventListeners(),this.isLoadingAudio=!1,this.playAudio()}),C(this,"audioErrorHandler",()=>{var e,t;this.removeAudioEventListeners(),this.isLoadingAudio=!1,null==(t=(e=this.options).onError)||t.call(e,new Error(""))}),this.options={onStateChange:e.onStateChange||(()=>{}),onError:e.onError||(()=>{})},this.initHTMLAudio()}initHTMLAudio(){return j(this,null,function*(){var e,t;try{this.audioElement=document.createElement("audio"),this.audioElement.style.display="none",this.audioElement.preload="auto",this.audioElement.controls=!1,this.audioElement.volume=1,document.body.appendChild(this.audioElement),this.audioElement.addEventListener("abort",this.audioInitAbortHandler),this.audioElement.addEventListener("canplay",this.audioInitCanplayHandler),this.audioElement.addEventListener("play",this.audioInitPlayHandler),this.audioElement.addEventListener("pause",this.audioInitPauseHandler),this.audioElement.addEventListener("ended",this.audioInitEndedHandler),this.audioElement.addEventListener("error",this.audioInitErrorHandler),this.audioPlayerInitlized=!0,this.setState(oI.INITIALIZED)}catch(n){throw null==(t=(e=this.options).onError)||t.call(e,n),new Error(" HTML Audio ")}})}initMediaSession(){try{if(!("mediaSession"in navigator))return;this.setMediaMetadata({title:"QwenTTS ",artist:"QwenTTS",album:""}),navigator.mediaSession.setActionHandler("play",()=>{this.play().catch(e=>{})}),navigator.mediaSession.setActionHandler("pause",()=>{this.pause().catch(e=>{})}),navigator.mediaSession.setActionHandler("stop",()=>{this.stop().catch(e=>{})}),this.mediaSessionInitialized=!0}catch(e){}}setMediaMetadata(e){var t;if(this.mediaMetadata=w({},e),this.mediaSessionInitialized&&"mediaSession"in navigator)try{const n=(null==(t=e.artwork)?void 0:t.map(e=>({src:e.src,sizes:e.sizes||"512x512",type:e.type||"image/png"})))||[];navigator.mediaSession.metadata=new MediaMetadata({title:e.title||"QwenTTS ",artist:e.artist||"QwenTTS",album:e.album||"",artwork:n})}catch(n){}}updateMediaSessionPlaybackState(e){if(this.mediaSessionInitialized&&"mediaSession"in navigator)try{let t;switch(e){case oI.PLAYING:t="playing";break;case oI.PAUSED:t="paused";break;case oI.STOPPED:case oI.INITIALIZED:case oI.READY:default:t="none"}navigator.mediaSession.playbackState=t}catch(t){}}appendPCMBuffer(e,t=!1){if(!e&&t&&!this.hasReceivedData)return void this.setState(oI.STOPPED);this.hasReceivedData||(this.setState(oI.LOADING),this.hasReceivedData=!0),e&&this.audioChunks.push(new Uint8Array(e));const n=this.audioChunks.reduce((e,t)=>e+t.length,0);this.isStreamPlaying||this.isUserStopped||(n>=this.minBufferSize||t)&&this.startStreamingPlayback(),t&&(this.isDataComplete=!0)}float32ToPCM(e){const t=new Uint8Array(2*e.length);for(let n=0;n<e.length;n++){const i=Math.max(-1,Math.min(1,e[n])),a=i<0?32768*i:32767*i,o=Math.round(a);t[2*n]=255&o,t[2*n+1]=o>>8&255}return t}startStreamingPlayback(){this.isStreamPlaying||this.isUserStopped||(this.isStreamPlaying=!0,this.updateStreamingAudio())}waitForAudioLoadAndPlay(){this.isUserStopped||(this.audioElement.readyState>=2?this.playAudio():this.isLoadingAudio||(this.isLoadingAudio=!0,this.audioElement&&(this.audioElement.addEventListener("canplay",this.audioCanPlayHandler),this.audioElement.addEventListener("error",this.audioErrorHandler),this.audioElement.load())))}updateStreamingAudio(){var e,t;if(!this.isUserStopped)if(this.audioChunks.length!==this.playedChunksCount||this.isDataComplete)if(this.isLoadingAudio||this.isRequestPlaying||!this.audioElement.paused&&!this.audioElement.ended)this.processNextUpdate();else try{const e=this.audioChunks.length,t=this.audioChunks.slice(this.playedChunksCount);if(!t.length)return void(this.isDataComplete||this.processNextUpdate());const n=t.reduce((e,t)=>e+t.length,0),i=new Uint8Array(n);let a=0;for(const r of t)i.set(r,a),a+=r.length;this.currentBlobURL&&URL.revokeObjectURL(this.currentBlobURL);const o=this.createWAVFile(i),s=new Blob([o],{type:"audio/wav"});this.currentBlobURL=URL.createObjectURL(s),this.currentBlobChunkLength=e,this.audioElement.src=this.currentBlobURL,this.waitForAudioLoadAndPlay()}catch(n){null==(t=(e=this.options).onError)||t.call(e,n),this.processNextUpdate()}else this.processNextUpdate()}processNextUpdate(){this.pendingTasks.processNextUpdateTaskId&&clearTimeout(this.pendingTasks.processNextUpdateTaskId),this.pendingTasks.processNextUpdateTaskId=setTimeout(()=>{this.updateStreamingAudio()},50)}delayToPlayAudio(){this.pendingTasks.playTaskId&&clearTimeout(this.pendingTasks.playTaskId),this.pendingTasks.playTaskId=setTimeout(()=>{this.playAudio()},50)}playAudio(){this.isUserStopped||(this.audioElement.readyState<2?this.delayToPlayAudio():this.audioElement.paused&&!this.isRequestPlaying?(this.isRequestPlaying=!0,this.audioElement.play().then(()=>{this.playedChunksCount=this.currentBlobChunkLength,this.processNextUpdate()}).catch(e=>{this.isUserStopped||("AbortError"===e.name||e.message.includes("interrupted"))&&this.delayToPlayAudio()}).finally(()=>{this.isRequestPlaying=!1})):this.processNextUpdate())}createWAVFile(e){const t=e.length,n=36+t,i=new ArrayBuffer(44+t),a=new DataView(i);a.setUint32(0,1380533830,!1),a.setUint32(4,n,!0),a.setUint32(8,1463899717,!1),a.setUint32(12,1718449184,!1),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,this.channels,!0),a.setUint32(24,this.sampleRate,!0),a.setUint32(28,this.sampleRate*this.channels*this.bitsPerSample/8,!0),a.setUint16(32,this.channels*this.bitsPerSample/8,!0),a.setUint16(34,this.bitsPerSample,!0),a.setUint32(36,1684108385,!1),a.setUint32(40,t,!0);return new Uint8Array(i,44).set(e),i}play(){return j(this,null,function*(){if(!this.audioPlayerInitlized)throw new Error("HTML Audio ");this._state!==oI.PLAYING&&this.hasReceivedData&&(this.isStreamPlaying||this.startStreamingPlayback())})}pause(){return j(this,null,function*(){if(!this.audioPlayerInitlized)throw new Error("HTML Audio ");this.audioElement&&this.audioElement.pause(),this.setState(oI.PAUSED)})}stop(){return j(this,null,function*(){if(!this.audioPlayerInitlized)throw new Error("HTML Audio ");this.clearAllTimeouts(),this.isUserStopped=!0,this.isStreamPlaying=!1;try{yield this.audioElement.pause(),this.audioElement.currentTime=0}catch(e){}this.setState(oI.STOPPED)})}reset(){return j(this,null,function*(){this.isStreamPlaying=!1,this.playedChunksCount=0,this.currentBlobChunkLength=0,this.isUserStopped=!1,this.isRequestPlaying=!1,this.isLoadingAudio=!1,this.setState(oI.STOPPED)})}resetPlayback(){return j(this,null,function*(){yield this.reset()})}destroy(){return j(this,null,function*(){if(yield this.stop(),this.cleanupMediaSession(),this.currentBlobURL&&(URL.revokeObjectURL(this.currentBlobURL),this.currentBlobURL=null,this.currentBlobChunkLength=0),this.audioElement){try{this.audioElement.remove()}catch(e){}this.audioElement=null}this.setState(oI.STOPPED)})}cleanupMediaSession(){if(this.mediaSessionInitialized&&"mediaSession"in navigator)try{navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("stop",null),navigator.mediaSession.playbackState="none",navigator.mediaSession.metadata=null,this.mediaSessionInitialized=!1}catch(e){}}clearAllTimeouts(){this.pendingTasks.playTaskId&&(clearTimeout(this.pendingTasks.playTaskId),this.pendingTasks.playTaskId=null),this.pendingTasks.processNextUpdateTaskId&&(clearTimeout(this.pendingTasks.processNextUpdateTaskId),this.pendingTasks.processNextUpdateTaskId=null)}setAudioParams(e,t=1,n=16){this.sampleRate=e,this.channels=t,this.bitsPerSample=n}setState(e){var t,n;this._state=e,this.updateMediaSessionPlaybackState(e),null==(n=(t=this.options).onStateChange)||n.call(t,e)}get volume(){var e;if(!this.audioPlayerInitlized)throw new Error(" HTML Audio ");return(null==(e=this.audioElement)?void 0:e.volume)||0}set volume(e){if(!this.audioPlayerInitlized)throw new Error(" HTML Audio ");this.audioElement&&(this.audioElement.volume=Math.max(0,Math.min(1,e)))}get state(){return this._state}get isReady(){return this._state===oI.READY}get isLoading(){return this._state===oI.LOADING}get isPlaying(){return this._state===oI.PLAYING}get isPaused(){return this._state===oI.PAUSED}get isStopped(){return this._state===oI.STOPPED}get hasData(){return this.hasReceivedData}get isComplete(){return this.isDataComplete}removeInitAudioEventListeners(){this.audioElement&&(this.audioElement.removeEventListener("abort",this.audioInitAbortHandler),this.audioElement.removeEventListener("canplay",this.audioInitCanplayHandler),this.audioElement.removeEventListener("play",this.audioInitPlayHandler),this.audioElement.removeEventListener("pause",this.audioInitPauseHandler),this.audioElement.removeEventListener("ended",this.audioInitEndedHandler),this.audioElement.removeEventListener("error",this.audioInitErrorHandler))}removeAudioEventListeners(){this.audioElement&&(this.audioElement.removeEventListener("canplay",this.audioCanPlayHandler),this.audioElement.removeEventListener("error",this.audioErrorHandler))}removeAllAudioEventListeners(){this.removeInitAudioEventListeners(),this.removeAudioEventListeners()}}class dI{constructor(e){C(this,"_state",oI.STOPPED),C(this,"options"),C(this,"sampleRate",24e3),C(this,"channels",1),C(this,"bitsPerSample",16),C(this,"audioPlayer"),this.options={onStateChange:e.onStateChange||(()=>{}),onError:e.onError||(()=>{}),playerType:e.playerType||sI.HTML_AUDIO},this.options.playerType===sI.SIMPLE_HTML_AUDIO?this.audioPlayer=new lI({onStateChange:e=>{var t,n;this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e)},onError:this.options.onError}):this.options.playerType===sI.HTML_AUDIO?this.audioPlayer=new uI({onStateChange:e=>{var t,n;this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e)},onError:this.options.onError}):this.options.playerType===sI.HTML_AUDIO_CXT?this.audioPlayer=new cI({onStateChange:e=>{var t,n;this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e)},onError:this.options.onError}):this.audioPlayer=new rI({onStateChange:e=>{var t,n;this._state=e,null==(n=(t=this.options).onStateChange)||n.call(t,e)},onError:this.options.onError}),this.audioPlayer.setAudioParams(this.sampleRate,this.channels)}appendBase64PCM(e,t=!1){const n=this.base64ToArrayBuffer(e);(n||t)&&this.audioPlayer.appendPCMBuffer(n,t)}base64ToArrayBuffer(e){if(!e)return null;try{const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}catch(t){return null}}play(){return j(this,null,function*(){yield this.audioPlayer.play()})}pause(){return j(this,null,function*(){yield this.audioPlayer.pause()})}stop(){return j(this,null,function*(){yield this.audioPlayer.stop()})}reset(){return j(this,null,function*(){yield this.audioPlayer.reset()})}resetPlayback(){return j(this,null,function*(){yield this.audioPlayer.resetPlayback()})}destroy(){var e;null==(e=this.audioPlayer)||e.removeAllAudioEventListeners(),this.audioPlayer.destroy()}get volume(){return this.audioPlayer.volume}set volume(e){this.audioPlayer.volume=e}get state(){return this.audioPlayer.state}get isReady(){return this.audioPlayer.isReady}get isLoading(){return this.audioPlayer.isLoading}get isPlaying(){return this.audioPlayer.isPlaying}get isPaused(){return this.audioPlayer.isPaused}get isStopped(){return this.audioPlayer.isStopped}get hasData(){return this.audioPlayer.hasData}get isComplete(){return this.audioPlayer.isComplete}setAudioParams(e,t=1){this.sampleRate=e,this.channels=t,this.audioPlayer.setAudioParams(e,t)}}const hI=e=>j(void 0,null,function*(){return yield ow("/tts/voice/synthesis_text",{method:"POST",data:e})}),pI=e=>j(void 0,null,function*(){return yield ow("/tts/voice/clone",{method:"POST",data:e})}),mI=e=>j(void 0,null,function*(){return yield ow("/tts/voice/rename",{method:"POST",data:e})}),fI=e=>j(void 0,null,function*(){return yield ow(`/tts/voice/delete/${e.id}`,{method:"DELETE"})}),gI=()=>j(void 0,null,function*(){return yield ow("/tts/voice/list/detail",{method:"GET"})});class vI{constructor(e){C(this,"player"),C(this,"options"),C(this,"audioElement"),C(this,"chatId"),C(this,"messageId"),C(this,"dataLoadFailed",!1),C(this,"isLoadingData",!1),C(this,"isStoppedByUser",!1),C(this,"isDestroyed",!1),C(this,"hasReceivedData",!1),C(this,"play",()=>j(this,null,function*(){this.dataLoadFailed?yield this.startTTSStream():yield this.player.play()})),C(this,"stop",()=>j(this,null,function*(){this.isStoppedByUser=!0,yield this.player.stop()})),this.options=e,this.initPlayer()}setStateChangeCallback(e){this.options.onStateChange=e}startTTS(e,t=!1){return j(this,null,function*(){if(this.chatId=e.chatId,this.messageId=e.messageId,this.isStoppedByUser=!1,t||!this.hasData||this.dataLoadFailed)return yield this.startTTSStream();yield this.play()})}startTTSStream(){return j(this,null,function*(){var e,t,n;if(this.isLoadingData)return;this.isLoadingData=!0,this.dataLoadFailed=!1;const i=this.getTTSRequestData();if(!i)throw this.isLoadingData=!1,new Error("chatId or messageId is required");const{success:a,data:o,isStream:s}=yield(r=i,j(void 0,null,function*(){return yield uw(),yield ow(`/tts/completions?chat_id=${r.chat_id}`,{responseType:"stream",method:"POST",data:r})}));var r;if(!a)return this.handleDataLoadError(),void(this.isStoppedByUser||ht.open({type:"error",content:Tv.t("Failed to play voice, please try again later.")}));if(!s){const i=o,a=(null==(e=null==i?void 0:i.data)?void 0:e.code)||"Unknown";let s=Tv.t("Failed to play voice, please try again later."),r="error";return"RateLimited"===(null==(t=null==i?void 0:i.data)?void 0:t.code)&&(s=Tv.t("Reached rate limited: too many requests per minute.")),"UnsupportedLanguage"===(null==(n=null==i?void 0:i.data)?void 0:n.code)&&(s=Tv.t("Currently, only Chinese and English are supported. More languages are coming soon."),r="warning"),this.handleDataLoadError(a),void ht.open({type:r,content:s})}try{const e=yield IE(o,!1);try{for(var l,c,u,d=M(e);l=!(c=yield d.next()).done;l=!1){const e=c.value;if(this.isDestroyed)return;const{done:t,tts:n}=e;!this.hasReceivedData&&n&&(this.hasReceivedData=!0),(t||void 0!==n)&&this.player.appendBase64PCM(n,t),t&&!this.hasReceivedData&&(ht.open({type:"warning",content:Tv.t("Failed to load voice, nothing can be played.")}),this.handleDataLoadError())}}catch(c){u=[c]}finally{try{l&&(c=d.return)&&(yield c.call(d))}finally{if(u)throw u[0]}}this.dataLoadFailed=!1}catch(h){this.isStoppedByUser||ht.open({type:"error",content:Tv.t("Failed to load voice, please try again later.")}),yield this.player.stop(),this.handleDataLoadError()}finally{this.isLoadingData=!1}})}handleDataLoadError(e="Unknown"){return j(this,null,function*(){var t,n;this.dataLoadFailed=!0,this.isLoadingData=!1,"UnsupportedLanguage"===e&&(null==(n=null==(t=this.options)?void 0:t.onStateChange)||n.call(t,oI.UNSUPPORTED_LANGUAGE)),setTimeout(()=>j(this,null,function*(){yield this.clearCachedData()}),1e3)})}clearCachedData(){return j(this,null,function*(){yield this.player.reset()})}destroy(){this.isDestroyed=!0,this.player.destroy(),this.player=null,this.options=null,this.dataLoadFailed=!1,this.isLoadingData=!1,this.isStoppedByUser=!1}initPlayer(){this.player=new dI({onStateChange:e=>{var t;(null==(t=this.options)?void 0:t.onStateChange)&&this.options.onStateChange(e)}})}getTTSRequestData(){return this.chatId&&this.messageId?{chat_id:this.chatId,timestamp:Math.floor(Date.now()/1e3),messages:[{id:this.messageId,role:"assistant",sub_chat_type:"tts"}]}:null}resetPlayer(){this.player&&this.player.resetPlayback()}get hasData(){var e;return(null==(e=this.player)?void 0:e.hasData)||!1}get isComplete(){var e;return(null==(e=this.player)?void 0:e.isComplete)||!1}get isDataLoadFailed(){return this.dataLoadFailed}get isDataLoading(){return this.isLoadingData}get state(){return this.player.state}get volume(){return this.player.volume}set volume(e){this.player.volume=e}}const yI=class e{constructor(e=300){C(this,"instances",new Map),C(this,"currentPlayingKey",null),C(this,"maxInstances"),this.maxInstances=e}static getInstance(t){return e.instance||(e.instance=new e(t)),e.instance}generateKey(e,t){return`${e}:${t}`}createStateChangeCallback(e,t){return n=>{[oI.STOPPED,oI.PAUSED].includes(n)&&this.currentPlayingKey===e&&(this.currentPlayingKey=null),n===oI.PLAYING&&this.currentPlayingKey!==e&&(this.currentPlayingKey=e),t&&t(n)}}getTTSInstance(e,t,n){const i=this.generateKey(e,t);if(this.instances.has(i)){const e=this.instances.get(i);return e.lastUsed=Date.now(),n&&(e.onStateChange=n,e.instance.setStateChangeCallback(this.createStateChangeCallback(i,n))),e.instance}this.cleanupLRU();const a=this.createStateChangeCallback(i,n),o=new vI({onStateChange:a}),s=Date.now();return this.instances.set(i,{chatId:e,messageId:t,instance:o,createdAt:s,lastUsed:s,onStateChange:n}),o}startTTS(e,t,n){return j(this,null,function*(){const i=this.generateKey(e,t);if(this.currentPlayingKey===i)return;const a=this.instances.get(i);yield this.stopAllPlayer(i);const o=this.getTTSInstance(e,t,n);if(this.currentPlayingKey=i,a&&o.hasData)return yield o.resetPlayer(),void(yield o.play());const s=!a||!o.hasData;yield o.startTTS({chatId:e,messageId:t},s)})}stopAllPlayer(e){return j(this,null,function*(){const t=[];for(const[n,i]of this.instances.entries())n!==e&&t.push(i.instance.stop().catch(e=>{}));yield Promise.all(t),this.currentPlayingKey!==e&&(this.currentPlayingKey=null)})}resetAllTTS(){return j(this,null,function*(){for(const[e,t]of this.instances.entries())yield t.instance.resetPlayer()})}stopTTS(e,t){return j(this,null,function*(){const n=this.generateKey(e,t),i=this.instances.get(n);if(i)try{yield i.instance.stop(),this.currentPlayingKey===n&&(this.currentPlayingKey=null)}catch(a){}})}stopAllTTS(){return j(this,null,function*(){yield this.stopAllPlayer(""),this.currentPlayingKey=null})}destroyTTS(e,t){const n=this.generateKey(e,t),i=this.instances.get(n);if(i)try{i.instance.destroy(),this.instances.delete(n),this.currentPlayingKey===n&&(this.currentPlayingKey=null)}catch(a){}}destroyAllTTS(){for(const[t,n]of this.instances.entries())try{n.instance.destroy()}catch(e){}this.instances.clear(),this.currentPlayingKey=null}clearAllCache(){return j(this,null,function*(){yield this.stopAllTTS(),this.destroyAllTTS()})}cleanupLRU(){if(this.instances.size<this.maxInstances)return;const e=Array.from(this.instances.entries()).sort(([,e],[,t])=>e.lastUsed-t.lastUsed),t=this.instances.size-this.maxInstances+1;for(let i=0;i<t;i++){const[t,a]=e[i];if(t!==this.currentPlayingKey)try{a.instance.destroy(),this.instances.delete(t)}catch(n){}}}getCurrentPlayingInstance(){return this.currentPlayingKey&&this.instances.get(this.currentPlayingKey)||null}getAllInstances(){return Array.from(this.instances.values())}getInstanceCount(){return this.instances.size}hasInstance(e,t){const n=this.generateKey(e,t);return this.instances.has(n)}isPlaying(){return null!==this.currentPlayingKey}getMaxInstances(){return this.maxInstances}setMaxInstances(e){this.maxInstances=e,this.instances.size>this.maxInstances&&this.cleanupLRU()}forceCleanupLRU(){this.cleanupLRU()}updateInstanceStateCallback(e,t,n){const i=this.generateKey(e,t),a=this.instances.get(i);a&&(a.onStateChange=n,a.instance.setStateChangeCallback(this.createStateChangeCallback(i,n)))}};C(yI,"instance");let bI=yI;function xI(e){wE.add(pE.QWEN_EVENT_ON_DISLIKE_FEEDBACK,t=>{const{feedbackInfo:n,messageId:i}=(null==t?void 0:t.detail)||{};e.emit(dE.MESSAGE_FEEDBACK_SUBMIT,{feedbackInfo:{detail:n},messageId:i})}),wE.add(pE.QWEN_EVENT_ON_THEME_CHANGED,t=>{var n;e.adapter.setTheme(null==(n=null==t?void 0:t.detail)?void 0:n.theme)}),wE.add(pE.QWEN_EVENT_ON_LANG_CHANGED,t=>{var n;e.adapter.setLanguage(null==(n=null==t?void 0:t.detail)?void 0:n.lang)}),wE.add(pE.QWEN_EVENT_ON_INPUT_PANEL_ACTIVE,t=>{var n;const i=(null==(n=null==t?void 0:t.detail)?void 0:n.isActive)||!1;e.emit(dE.MESSAGE_INPUT_PANEL_ACTIVE,i)}),wE.add(pE.QWEN_EVENT_ON_CLEAR_ALL_CHATS,()=>{e.clearAllChat()}),wE.add(pE.QWEN_EVENT_ON_LOGOUT,()=>{null==localStorage||localStorage.removeItem("token"),null==localStorage||localStorage.removeItem("settings"),null==localStorage||localStorage.removeItem("locale"),e.adapter.invoke({method:"clearCookie"}),e.adapter.invoke({method:"deleteStoredInfo",params:{key:"chatNativeToken"}})}),wE.add(pE.QWEN_EVENT_ON_ALERTPOSITIVE_BUTTON_CLICK,()=>{e.emit(dE.MESSAGE_LEAVE_CONFIRM)}),wE.add(pE.QWEN_EVENT_ON_CHATCONFIG_CHANGE,e=>{const{actionScene:t}=(null==e?void 0:e.detail)||{},{thinking_enabled:n}=(null==t?void 0:t.featureConfig)||{},{setThinkingEnabled:i}=Sx.getState();i(null!=n&&n);const{setCurrentInputFeature:a}=vx.getState();(null==t?void 0:t.type)&&a(null==t?void 0:t.type)}),wE.add(pE.QWEN_EVENT_ON_DEPLOY_STATUS_CHANGE,t=>{const{status:n,shareUrl:i,shareId:a,isPublic:o}=(null==t?void 0:t.detail)||{};"deployed"!==n&&KE.getState().updateEquity(),e.emit(dE.MESSAGE_ARTIFACT_DEPLOY_CHANGE,"deployed"===n?{shareId:a,shareUrl:i,isPublic:o}:void 0)}),wE.add(mE.QWEN_CHAT_ONDOWNLOADSTART,()=>{ht.open({type:"loading",content:Pv("The file starts downloading.")})}),wE.add(mE.QWEN_CHAT_ONDOWNLOADCOMPLETE,e=>{const{detail:{success:t}}=e||{};t?ht.open({type:"success",content:Pv("File downloaded successfully")}):ht.open({type:"error",content:Pv("File download failed")})}),wE.add(pE.QWEN_EVENT_ON_USER_PROFILE_UPDATE,e=>{var t;const{user:n,setUser:i}=HE.getState();(null==(t=e.detail)?void 0:t.userName)&&i(_(w({},n||{}),{name:e.detail.userName}))}),wE.add(pE.QWEN_EVENT_ON_USER_PASSWORD_CHANGE,()=>{localStorage.token=FT("token")}),wE.add(pE.QWEN_EVENT_ON_EDIT_MESSAGE,t=>{const{inputText:n}=(null==t?void 0:t.detail)||{};e.emit(dE.MESSAGE_EDIT_SAVE,n)}),wE.add(pE.QWEN_EVENT_ON_SELECT_MODEL,t=>j(this,null,function*(){const{modelId:n}=(null==t?void 0:t.detail)||{};e.emit(fE.NAVBAR_MODEL_SELECT_CHANGE,[n])})),wE.add(pE.QWEN_EVENT_ON_OPEN_CHAT,t=>{var n,i,a,o,s,r;const l=null==(n=null==t?void 0:t.detail)?void 0:n.chatId,c=null==(i=null==t?void 0:t.detail)?void 0:i.messageId,u=(null==(a=null==t?void 0:t.detail)?void 0:a.shareId)||"",d=GT("shareId"),h=(null==(o=null==t?void 0:t.detail)?void 0:o.lang)||"",p=(null==(s=null==t?void 0:t.detail)?void 0:s.projectId)||"",{setTemporaryChatEnabled:m}=Sx.getState();if(u)Ax()&&(null==(r=null==e?void 0:e.adapter)||r.invoke({method:"setSendButtonEnabled",params:{value:!1}}),window.location.href=`/?shareId=${u}&lang=${h}`);else if(sessionStorage.setItem(xv,p),Pt(l)){d||e.adapter.invoke({method:"setSendButtonEnabled",params:{value:!0}});const t=sessionStorage.getItem(xg);if(sessionStorage.removeItem(xg),location.pathname.endsWith("/new-branch")&&t)return e.adapter.setNativeStopButton(!1),void e.updateChatInfo({status:"finished"});e.openNewChat({hideToast:!0})}else 36===(null==l?void 0:l.length)?(e.adapter.invoke({method:"setSendButtonEnabled",params:{value:!0}}),m(!1),fj.navigate(`/c/${l}${c?`?messageId=${c}`:""}`)):"temporary"===l&&(e.adapter.invoke({method:"setSendButtonEnabled",params:{value:!0}}),e.updateTemporaryChat(!0),e.emit(dE.MESSAGE_OPEN_TEMPORARY,!0))}),wE.add(pE.QWEN_SEND_MESSAGE,t=>j(this,null,function*(){var n,i;const a=(e=>{const{inputText:t="",actionScene:n={},imageList:i,modelId:a,audioList:o,fileList:s,videoList:r,selectedModels:l}=e,c=(({imageList:e=[],audioList:t=[],fileList:n=[],videoList:i=[]})=>[...e.map(e=>({url:e.imageUrl,type:"image",status:"success",file_class:"vision",showType:"image"})),...t.map(e=>({url:e.audioUrl,type:"audio",status:"success",file_class:"audio",size:+e.audioSize,name:e.audioName,showType:"audio"})),...n.map(e=>({url:e.fileUrl,type:"file",status:"success",file_class:"file",size:+e.fileSize,name:e.fileName,showType:"file"})),...i.map(e=>({url:e.videoUrl,type:"video",status:"success",file_class:"video",size:+e.videoSize,name:e.videoName,showType:"video"}))])({imageList:i,audioList:o,fileList:s,videoList:r});return _(w({inputText:t},n),{files:c,selectedModels:l||(a?[a]:[])})})(t.detail);a.newChat=!0;const o=B(),{type:s,translateLanguage:r}=a;let l=a.subType;const{currentInputFeature:c,setCurrentInputFeature:u,setEmitSendPromptType:d}=vx.getState(),{setThinkingEnabled:h,setResearchMode:p}=Sx.getState();let m=l||s||c;m===ng.WebDev&&(m=ng.Artifacts),m===ng.DeepResearchWebDev&&(m=s||ng.DeepResearch);const{featureConfig:f,ext:g,selectedModels:v}=a;p("advance"===(null==f?void 0:f.research_mode)),u(m||ng.Txt2Txt);const{thinking_budget:y,thinking_enabled:b}=f||{};if(h(null!=b&&b),y&&(null==v?void 0:v.length)){const{updateModelConfig:e}=NT.getState();e({[v[0]]:{thinking_budget:y}})}const x=e.getCurrentChatInstance();if(null==x?void 0:x.isChat)return void ht.open({type:"warning",content:o.t("In the conversation, please wait a moment.")});if(null==g?void 0:g.size){const{setVisionSize:e}=TT.getState();e(g.size)}"translate"===l&&r?(d(Yf.TRANSLATE),m="t2t",u(ng.Txt2Txt),a.extra=Sk(r)):(d(Yf.CHAT),m===ng.Txt2Txt&&void 0===l&&(l=ng.Txt2Txt),m===ng.WebSearch&&(l=ng.WebSearch));const S=sessionStorage.getItem(xv)||"";S&&""!==S&&setTimeout(()=>{sessionStorage.setItem(xv,"")},1e3),e.beforeSendMessage(_(w({},a),{chatType:m,subChatType:l,projectId:S})),e.emit(dE.MESSAGE_SENT_BEFORE,{id:null==(i=null==(n=e.getCurrentChatInstance)?void 0:n.call(e))?void 0:i.id,from:"native",data:a})})),wE.add(pE.QWEN_EVENT_ON_CLICK_STOP_BUTTON,()=>{const t=e.getCurrentChatInstance();null==t||t.stopResponse()}),wE.add(pE.QWEN_EVENT_ON_PAGE_PAUSE,()=>{bI.getInstance().stopAllPlayer()}),wE.add(pE.QWEN_EVENT_ON_PAGE_RESUME,()=>{}),wE.add(pE.QWEN_EVENT_ON_TSS_SPEAKER_CHANGE,()=>{bI.getInstance().clearAllCache()}),wE.add(pE.QWEN_EVENT_ON_PROMPT_SETTINGS_UPDATE,e=>j(this,null,function*(){if(e.detail){const{settings:t}=NT.getState();NT.setState({settings:_(w({},t),{personalization:_(w({},t.personalization),{name:e.detail.userName,enable_for_new_chat:e.detail.enable})})})}})),wE.add(pE.QWEN_EVENT_ON_AUDIO_FOCUS_CHANGE,e=>{const{status:t}=(null==e?void 0:e.detail)||{};"loss"===t&&bI.getInstance().stopAllPlayer()}),wE.add(pE.QWEN_EVENT_ON_POST_CONTENT_TO_MAIN_CHAT,t=>{const{name:n,content:i}=(null==t?void 0:t.detail)||{};if(n===ng.DeepResearchWebDev)e.beforeSendMessage({inputText:i,subChatType:ng.DeepResearchWebDev})}),wE.add(pE.QWEN_EVENT_ON_SEND_PODCAST,t=>j(this,null,function*(){var n;const i=null==(n=null==t?void 0:t.detail)?void 0:n.content;if(!i)return;e.closeShowControls();const{updateQwenChatSettingsbyNative:a}=NT.getState();a({aipodcast:i}),e.beforeSendMessage({inputText:Pv("Generate a podcast"),subChatType:ng.Podcast})})),wE.add(pE.QWEN_EVENT_ON_PLAYBACK_STATE_CHANGED,t=>{const n=(null==t?void 0:t.detail)||{};e.emit(fE.MESSAGE_AUDIO_PLAYBACK_CHANGED,n)}),wE.add(pE.QWEN_EVENT_ON_MEDIA_RATE_CHANGED,t=>{const{rate:n,id:i}=(null==t?void 0:t.detail)||{};e.emit(fE.MESSAGE_AUDIO_PLAYBACK_RATE_CHANGED,{rate:n,id:i})})}const wI=(e,t)=>{const n=t.map(e=>e.id);return e.filter(e=>n.includes(e))},_I=(e,t)=>t.filter(t=>e.includes(t.id)),SI=e=>e.map(e=>e.id),CI={models:[],isLoading:!1,selectedModels:[],selectedModelIds:[],visibleModels:[]},EI=yb()(px((e,t)=>_(w({},CI),{setModels:t=>e({models:t}),setIsLoading:t=>e({isLoading:t}),setSelectedModels:n=>{const i=t(),a=n.filter(e=>i.models.some(t=>t.id===(null==e?void 0:e.id)));e({selectedModels:a,selectedModelIds:SI(a)})},setSelectedModelIds:n=>{const i=t(),a=wI(n,i.models);e({selectedModelIds:a,selectedModels:_I(a,i.models)})},setVisibleModels:t=>e({visibleModels:t}),fetchModels:()=>j(void 0,null,function*(){var n;const i=t();if(i.models.length>0)return i.models;if(i.isLoading)return new Promise(e=>{const n=()=>{const i=t();i.isLoading?setTimeout(n,100):e(i.models)};n()});e({isLoading:!0});const a=yield j(void 0,null,function*(){return yield ow("/models",{baseURL:"/api"})});if(a.success&&a.data){const i=(null==(n=a.data)?void 0:n.data)||[];e({models:i,isLoading:!1});const o=t();if(o.selectedModelIds&&o.selectedModelIds.length>0){const t=wI(o.selectedModelIds,i);t.length!==o.selectedModelIds.length&&e({selectedModelIds:t,selectedModels:_I(t,i)})}return i}return tE.open({type:"error",content:a.data.message}),[]}),getModels:()=>{const e=t();return 0!==e.models.length||e.isLoading?e.models:e.fetchModels()}}),{name:"modelsStore",store:"modelsStore",enabled:!1})),kI=(e,t)=>{if(!e||0===e.length)return[];const n=e.map(e=>{const n=t.find(t=>t.id===e);if(n)return n.id;const i=t.find(t=>t.name===e);return i?i.id:null}).filter(e=>null!==e);return qx()||UT()?n.slice(0,1):n.slice(0,3)},II=(e,t)=>{try{const n=t||window.location.href;return new URL(n).searchParams.get(e)}catch(n){return null}},TI=e=>{switch(e){case ag.Artifacts:return"chatNativeArtifact";case ag.WebSearch:return"chatNativeSource";case ag.Thinking:case ag.ThinkingAndSearch:return"chatNativeSearchContent";case ag.DeepResearchLinkSource:case ag.DeepResearch:return"chatNativeDeepResearch";case ag.PdfViewer:return"chatNativePdfViewer";case ag.Feedback:return"chatNativeFeedback";case"chatNativeToken":return"chatNativeToken";case"transTargetLanguageKey":return"transTargetLanguageKey";case ag.ImageReason:return"chatNativeImageReason";default:return"chatNativeHistory"}},jI=e=>{const t=`${location.origin}/mobile/chatcontrols`;switch(e){case ag.Artifacts:return`${t}/artifacts`;case ag.WebSearch:return`${t}/search`;case ag.DeepResearchLinkSource:case ag.DeepResearch:return`${t}/deep_research`;case ag.PdfViewer:return`${t}/pdf_viewer`;case ag.Feedback:return`${t}/feedback`;default:return`${t}/${e}`}};var NI,PI,MI=(e=>(e.startSpeech="startSpeech",e.onAfterStart="onAfterStart",e.onBeforeEnd="onBeforeEnd",e.onBeforeStart="onBeforeStart",e.onAfterEnd="onAfterEnd",e.onConnectionStatusChange="onConnectionStatusChange",e.onOccurError="onOccurError",e.onDataChannelMsg="onDataChannelMsg",e.onUserStop="onUserStop",e.onInitialize="onInitialize",e.onConfigure="onConfigure",e.onAudioSubscribeStateChanged="onAudioSubscribeStateChanged",e.startTiming="startTiming",e.timePassed="timePassed",e.timeUp="timeUp",e.statusChange="statusChange",e.isRunningChange="isRunningChange",e.detectedSoundChange="detectedSoundChange",e.todayRemainingTimesChange="todayRemainingTimesChange",e.reset="reset",e.startCameraPreview="startCameraPreview",e.stopCameraPreview="stopCameraPreview",e.defaultEnabledVideo="defaultEnabledVideo",e.noCameraPermission="noCameraPermission",e.detectMicList="detectMicList",e.userVolumeChange="userVolumeChange",e.channelVolumeChange="channelVolumeChange",e.sendMessage="sendMessage",e.debugger="debugger",e.supportResult="supportResult",e.joinChannelTimeOut="joinChannelTimeOut",e.localDeviceException="localDeviceException",e))(MI||{});class AI{constructor(e){C(this,"context"),C(this,"onReport",null),this.context=e}init(e){this.onReport=e}getSearchToken(){const{model:e}=this.context,{localId:t,aliRtcAuthInfo:n}=e;let i=`localId=${t}`;return n&&"appId channelId userId nonce timestamp token sessionId role".split(" ").forEach(e=>{var t;const a=null!=(t=n[e])?t:"";i=`${i}&${e}=${a}`}),i}report(e,t={}){try{if(!this.onReport)return;const n={type:e,searchToken:this.getSearchToken(),params:t};this.onReport(n)}catch(n){}}}class OI{constructor(){C(this,"_isDefaultPrevented",!1),C(this,"_isStopped",!1)}get isDefaultPrevented(){return this._isDefaultPrevented}get isStopped(){return this._isStopped}preventDefault(){this._isDefaultPrevented=!0}stop(){this._isStopped=!0}}class RI{constructor(){C(this,"listeners",{})}on(e,t){const n=this.listeners[e]||[];return n.push(t),this.listeners[e]=n,()=>this.off(e,t)}pipe(e,t=!0){const{listeners:n}=this;Object.keys(n).forEach(t=>{(n[t]||[]).forEach(n=>e(t,n))}),t&&(this.listeners={})}off(e,t){const n=this.listeners[e]||[];this.listeners[e]=t?n.filter(e=>e!==t):[]}offAll(){Object.keys(this.listeners).forEach(e=>{this.listeners[e]=[]})}emit(e,t){const n=new OI,i=this.listeners[e]||[];for(const a of i)if(a(t,n),n.isStopped)break;return n}emitAsync(e,t){var n;n=()=>this.emit(e,t),"object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):"function"==typeof setTimeout?setTimeout(n,1):n()}}function DI(e){return Symbol(e)}class LI{constructor(e){var t;C(this,"context"),C(this,"states"),C(this,"eventer",new RI),this.context=e,this.isEnable&&(null==(t=this.onInitialize)||t.call(this))}get isEnable(){return!0}setStates(e){this.states&&(Object.assign(this.states,e),this.eventer.emit("stateChange",{states:this.states}))}getState(e){if(!this.states)throw new Error("Not provide state in your command");return this.states[e]}getStates(){return this.states}}class FI extends LI{constructor(){super(...arguments),C(this,"beforeUserVolume",0),C(this,"beforeChannelVolume",0),C(this,"handleAudioVolume",e=>{const{model:t}=this.context;e.forEach(e=>{const{userId:n,volume:i}=e;""===n?(t.setUserVolume(i),(this.beforeUserVolume>0&&0===i||0===this.beforeUserVolume&&i>this.beforeUserVolume)&&this.context.reporter.report(MI.userVolumeChange,{userVolume:i}),this.beforeUserVolume=i):(t.setChannelVolume(i),(this.beforeChannelVolume>0&&0===i||0===this.beforeChannelVolume&&i>this.beforeChannelVolume)&&this.context.reporter.report(MI.channelVolumeChange,{channelVolume:i}),this.beforeChannelVolume=i)})})}onAfterStart(){return j(this,null,function*(){const{aliRtcEngine:e}=this.context;e.on("audioVolume",this.handleAudioVolume),e.enableAudioVolumeIndication(100)})}onBeforeEnd(){return j(this,null,function*(){const{aliRtcEngine:e}=this.context;e.off("audioVolume",this.handleAudioVolume),e.enableAudioVolumeIndication(0)})}}"function"==typeof SuppressedError&&SuppressedError,(PI=NI||(NI={}))[PI.ERROR=0]="ERROR",PI[PI.WARN=1]="WARN",PI[PI.INFO=2]="INFO",PI[PI.LOG=3]="LOG",PI[PI.DEBUG=4]="DEBUG",NI.WARN;class zI extends LI{onBeforeEnd(){return j(this,null,function*(){this.context.reporter.report(MI.onBeforeEnd)})}onAfterEnd(){return j(this,null,function*(){this.context.reporter.report(MI.onAfterEnd)})}onBeforeStart(){return j(this,null,function*(){this.context.reporter.report(MI.onBeforeStart)})}onAfterStart(){return j(this,null,function*(){this.context.reporter.report(MI.onAfterStart)})}onConnectionStatusChange(e){return j(this,null,function*(){this.context.reporter.report(MI.onConnectionStatusChange,e)})}onOccurError(e){return j(this,null,function*(){this.context.reporter.report(MI.onOccurError,e)})}onDataChannelMsg(e){return j(this,null,function*(){this.context.reporter.report(MI.onDataChannelMsg,e)})}onUserStop(){return j(this,null,function*(){this.context.reporter.report(MI.onUserStop)})}onInitialize(){return j(this,null,function*(){this.context.reporter.report(MI.onInitialize)})}onConfigure(){return j(this,null,function*(){this.context.reporter.report(MI.onConfigure)})}onAudioSubscribeStateChanged(e){return j(this,null,function*(){this.context.reporter.report(MI.onConfigure,e)})}}function UI(e,t){const{aliRtcEngine:n,reporter:i}=e;i.report(MI.sendMessage,t);let a="";try{a=JSON.stringify(t)}catch(kX){}if(!a)return;const o=(new TextEncoder).encode(a).buffer,s=new Bt(o,$t.AliEngineDataMsgCustom);n.sendDataChannelMessage(s)}function HI(e){return{width:e.height,height:e.width}}function BI(e,t){return{displayResolution:{width:e[0],height:e[1]},webrtcResolution:{width:t[0],height:t[1]}}}function $I(){let e=null;return()=>e||(e=function(){if(jx()){const e=[screen.height,screen.width];return BI(e,e)}return BI([960,540],[1280,720])}())}function qI(e=200,t){return new Promise(n=>{setTimeout(()=>j(this,null,function*(){t&&(yield t()),n()}),e)})}function GI(e=200,t){return new Promise((n,i)=>{setTimeout(()=>j(this,null,function*(){i(t)}),e)})}class VI extends LI{constructor(){super(...arguments),C(this,"states",{requestId:null,dialogId:null,isStarted:!1}),C(this,"resolveStop",null)}onDataChannelMsg(e){return j(this,null,function*(){const{json:t}=e;if(!t)return;const{name:n}=t.header||{};"Started"!==n?"RespondingEnded"===n?this.handleRespondingEnded():"Stopped"===n&&this.handleStopped():this.handleStarted(t)})}handleStarted(e){const{header:t}=e,n={requestId:t.request_id,dialogId:t.dialog_id,isStarted:!0};UI(this.context,{header:{namespace:"VoiceChat",name:"StartedReceived",request_id:n.requestId,dialog_id:n.dialogId},payload:{}}),this.setStates(n)}handleRespondingEnded(){const e=this.getStates();e&&e.dialogId&&UI(this.context,{header:{namespace:"VoiceChat",name:"LocalRespondingEnded",request_id:e.requestId,dialog_id:e.dialogId},payload:{}})}handleStopped(){var e;null==(e=this.resolveStop)||e.call(this),this.resolveStop=null}onBeforeEnd(){return j(this,null,function*(){const e=this.getStates();e&&e.dialogId&&(UI(this.context,{header:{namespace:"VoiceChat",name:"Stop",request_id:e.requestId,dialog_id:e.dialogId},payload:{}}),yield Promise.race([new Promise(e=>{this.resolveStop=e}),qI(300)]))})}}class WI extends LI{constructor(){super(...arguments),C(this,"isMicOpenFailed",!1),C(this,"timeoutToEnd",null)}onBeforeStart(){return j(this,null,function*(){this.context.model.setStatus(Hg.Connecting)})}onAfterStart(){return j(this,null,function*(){const{model:e}=this.context;e.error||e.setStatus(Hg.Listening)})}onOccurError(e){return j(this,null,function*(){const{error:t}=e;switch(t.code){case qt.ERR_MIC_OPEN_FAIL:this.isMicOpenFailed=!0,this.context.model.setError({type:Bg.NoMicphonePermission});break;case qt.ERR_SDK_PUBLISH_AUDIO_STREAM_FAILED:this.isMicOpenFailed||this.context.model.setError({type:Bg.UnknownError});break;default:this.context.model.setError({type:Bg.UnknownError})}})}onUserStop(){return j(this,null,function*(){this.context.model.setStatus(Hg.Default)})}onDataChannelMsg(e){return j(this,null,function*(){const{controller:t,model:n}=this.context,{json:i}=e;if(i)try{const{name:e}=i.header||{};if("RespondingEnded"===e)return void n.setStatus(Hg.Listening);if("Error"===e){const{error_code:e}=i.payload||{};switch(e){case 40020003:case 40020002:case 40020001:n.setError({type:Bg.DataInputInspectionFailed});break;case 40042901:n.setError({type:Bg.CurrentConversationTimeout});break;case 40042902:n.setError({type:Bg.DailyConversationTimeout});break;default:n.setError({type:Bg.InternalServerError})}return void t.onEnd()}if("DialogStateChanged"===e){const{state:e}=i.payload||{};switch(e){case"Responding":n.setStatus(Hg.Speaking);break;case"Listening":n.setStatus(Hg.Listening);break;case"Thinking":n.setStatus(Hg.Thinking)}return}}catch(a){}})}onConnectionStatusChange(e){return j(this,null,function*(){const{status:t}=e,{controller:n,model:i}=this.context;switch(t){case Gt.AliRtcConnectionStatusConnecting:case Gt.AliRtcConnectionStatusReconnecting:i.setStatus(Hg.Connecting),this.reconnectingTimerStart();break;case Gt.AliRtcConnectionStatusConnected:this.clearTimeOut(),i.setStatus(Hg.Listening);break;case Gt.AliRtcConnectionStatusDisconnected:case Gt.AliRtcConnectionStatusFailed:this.clearTimeOut(),i.setError({type:Bg.ConnectionLost}),n.onEnd()}})}reconnectingTimerStart(){this.timeoutToEnd||(this.timeoutToEnd=setTimeout(()=>{this.context.model.isEnding||(this.context.model.setError({type:Bg.ConnectionLost}),this.context.controller.onEnd(),this.clearTimeOut())},1e4))}clearTimeOut(){this.timeoutToEnd&&(clearTimeout(this.timeoutToEnd),this.timeoutToEnd=null)}}var QI={exports:{}};QI.exports=function(){var e,t,n=1e3,i=6e4,a=36e5,o=864e5,s=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,r=31536e6,l=2628e6,c=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,u={years:r,months:l,days:o,hours:a,minutes:i,seconds:n,milliseconds:1,weeks:6048e5},d=function(e){return e instanceof y},h=function(e,t,n){return new y(e,n,t.$l)},p=function(e){return t.p(e)+"s"},m=function(e){return e<0},f=function(e){return m(e)?Math.ceil(e):Math.floor(e)},g=function(e){return Math.abs(e)},v=function(e,t){return e?m(e)?{negative:!0,format:""+g(e)+t}:{negative:!1,format:""+e+t}:{negative:!1,format:""}},y=function(){function m(e,t,n){var i=this;if(this.$d={},this.$l=n,void 0===e&&(this.$ms=0,this.parseFromMilliseconds()),t)return h(e*u[p(t)],this);if("number"==typeof e)return this.$ms=e,this.parseFromMilliseconds(),this;if("object"==typeof e)return Object.keys(e).forEach(function(t){i.$d[p(t)]=e[t]}),this.calMilliseconds(),this;if("string"==typeof e){var a=e.match(c);if(a){var o=a.slice(2).map(function(e){return null!=e?Number(e):0});return this.$d.years=o[0],this.$d.months=o[1],this.$d.weeks=o[2],this.$d.days=o[3],this.$d.hours=o[4],this.$d.minutes=o[5],this.$d.seconds=o[6],this.calMilliseconds(),this}}return this}var g=m.prototype;return g.calMilliseconds=function(){var e=this;this.$ms=Object.keys(this.$d).reduce(function(t,n){return t+(e.$d[n]||0)*u[n]},0)},g.parseFromMilliseconds=function(){var e=this.$ms;this.$d.years=f(e/r),e%=r,this.$d.months=f(e/l),e%=l,this.$d.days=f(e/o),e%=o,this.$d.hours=f(e/a),e%=a,this.$d.minutes=f(e/i),e%=i,this.$d.seconds=f(e/n),e%=n,this.$d.milliseconds=e},g.toISOString=function(){var e=v(this.$d.years,"Y"),t=v(this.$d.months,"M"),n=+this.$d.days||0;this.$d.weeks&&(n+=7*this.$d.weeks);var i=v(n,"D"),a=v(this.$d.hours,"H"),o=v(this.$d.minutes,"M"),s=this.$d.seconds||0;this.$d.milliseconds&&(s+=this.$d.milliseconds/1e3,s=Math.round(1e3*s)/1e3);var r=v(s,"S"),l=e.negative||t.negative||i.negative||a.negative||o.negative||r.negative,c=a.format||o.format||r.format?"T":"",u=(l?"-":"")+"P"+e.format+t.format+i.format+c+a.format+o.format+r.format;return"P"===u||"-P"===u?"P0D":u},g.toJSON=function(){return this.toISOString()},g.format=function(e){var n=e||"YYYY-MM-DDTHH:mm:ss",i={Y:this.$d.years,YY:t.s(this.$d.years,2,"0"),YYYY:t.s(this.$d.years,4,"0"),M:this.$d.months,MM:t.s(this.$d.months,2,"0"),D:this.$d.days,DD:t.s(this.$d.days,2,"0"),H:this.$d.hours,HH:t.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:t.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:t.s(this.$d.seconds,2,"0"),SSS:t.s(this.$d.milliseconds,3,"0")};return n.replace(s,function(e,t){return t||String(i[e])})},g.as=function(e){return this.$ms/u[p(e)]},g.get=function(e){var t=this.$ms,n=p(e);return"milliseconds"===n?t%=1e3:t="weeks"===n?f(t/u[n]):this.$d[n],t||0},g.add=function(e,t,n){var i;return i=t?e*u[p(t)]:d(e)?e.$ms:h(e,this).$ms,h(this.$ms+i*(n?-1:1),this)},g.subtract=function(e,t){return this.add(e,t,!0)},g.locale=function(e){var t=this.clone();return t.$l=e,t},g.clone=function(){return h(this.$ms,this)},g.humanize=function(t){return e().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},g.valueOf=function(){return this.asMilliseconds()},g.milliseconds=function(){return this.get("milliseconds")},g.asMilliseconds=function(){return this.as("milliseconds")},g.seconds=function(){return this.get("seconds")},g.asSeconds=function(){return this.as("seconds")},g.minutes=function(){return this.get("minutes")},g.asMinutes=function(){return this.as("minutes")},g.hours=function(){return this.get("hours")},g.asHours=function(){return this.as("hours")},g.days=function(){return this.get("days")},g.asDays=function(){return this.as("days")},g.weeks=function(){return this.get("weeks")},g.asWeeks=function(){return this.as("weeks")},g.months=function(){return this.get("months")},g.asMonths=function(){return this.as("months")},g.years=function(){return this.get("years")},g.asYears=function(){return this.as("years")},m}(),b=function(e,t,n){return e.add(t.years()*n,"y").add(t.months()*n,"M").add(t.days()*n,"d").add(t.hours()*n,"h").add(t.minutes()*n,"m").add(t.seconds()*n,"s").add(t.milliseconds()*n,"ms")};return function(n,i,a){e=a,t=a().$utils(),a.duration=function(e,t){var n=a.locale();return h(e,{$l:n},t)},a.isDuration=d;var o=i.prototype.add,s=i.prototype.subtract;i.prototype.add=function(e,t){return d(e)?b(this,e,1):o.bind(this)(e,t)},i.prototype.subtract=function(e,t){return d(e)?b(this,e,-1):s.bind(this)(e,t)}}}();const KI=H(QI.exports);function YI(e){return Q.duration(e).format("mm:ss")}Q.extend(KI);class XI extends LI{constructor(e,t={}){super(e),C(this,"states",{duringTime:0}),C(this,"interval",null),C(this,"options"),C(this,"maxTime",0),this.options=t}getDisplayDuringTime(){return YI(this.getState("duringTime"))}getDisplayMaxTime(){return YI(this.maxTime)}getDisplayTime(){return`${this.getDisplayDuringTime()} / ${this.getDisplayMaxTime()}`}clean(){this.interval&&(clearInterval(this.interval),this.interval=null)}handleTimeUp(){const{controller:e}=this.context;this.context.reporter.report(MI.timeUp),this.clean(),e.onEnd()}onConfigure(){return j(this,null,function*(){const{chatType:e}=this.options,{timeConfig:t}=this.context.controller;this.maxTime=t?1e3*(t[e||"voice"]||180):18e4})}onAfterStart(){return j(this,null,function*(){this.clean();const e=Date.now();this.context.reporter.report(MI.startTiming),this.interval=setInterval(()=>{var t,n;const i=Date.now(),a=Math.min(i-e,this.maxTime),o=1e3*Math.floor(1.023);this.setStates({duringTime:a}),null==(n=(t=this.options).onTimeChange)||n.call(t,{soon:a>=this.maxTime-1e4,duringTime:a,maxTime:this.maxTime,displayTime:this.getDisplayTime()}),o%1e4==0&&this.context.reporter.report(MI.timePassed,{ms:o}),a>=this.maxTime&&this.handleTimeUp()},500)})}onBeforeEnd(){return j(this,null,function*(){this.clean()})}}class JI{constructor(e){this.options=e}}class ZI extends JI{constructor(){super(...arguments),C(this,"interval",null),C(this,"protectTimes",null),C(this,"isAvailable",!0)}detect(){if(this.isProtected())return;const{videoElement:e,onDetectUnavailable:t,onDetectAvailable:n}=this.options,i=document.createElement("canvas"),{width:a,height:o}={width:4,height:4};i.width=a,i.height=o;const s=i.getContext("2d");if(!s)return;s.drawImage(e,0,0,a,o);const r=function(e){return 0===e.data.filter((e,t)=>t%4<3&&e>0).length}(s.getImageData(0,0,a,o));r?this.isAvailable&&(this.isAvailable=!1,t()):this.isAvailable||(this.isAvailable=!0,n())}isProtected(){return this.protectTimes&&this.protectTimes>Date.now()}start(){this.stop(),this.protectTimes=Date.now()+4e3,this.interval=setInterval(()=>{this.detect()},1e3)}pause(){this.stop()}resume(){this.start()}stop(){this.interval&&(clearInterval(this.interval),this.interval=null),this.protectTimes=null,this.isAvailable=!0}}class eT{constructor(){C(this,"funcs",[]),C(this,"isPretreated",!1)}addPretreat(e){this.isPretreated,this.funcs.push(e)}pretreat(){return j(this,null,function*(){try{if(0===this.funcs.length||this.isPretreated)return;const e=this.funcs;return this.funcs=[],Promise.all(e.map(e=>{return(t=e())instanceof Promise?t:null;var t}))}catch(e){}finally{this.isPretreated=!0}})}}var tT=(e=>(e[e.CAMERA_INVALID=-1]="CAMERA_INVALID",e[e.CAMERA_REAR=0]="CAMERA_REAR",e[e.CAMERA_FRONT=1]="CAMERA_FRONT",e))(tT||{});const nT=jx()?0:1,iT=!1,aT=$I(),oT=()=>{};const sT=class e extends LI{constructor(t,n={}){if(super(t),C(this,"beforeEnablePretreat",new eT),C(this,"cameraWorkDetector",null),C(this,"states",{isEnabledVideo:iT,hasCameraPermission:null,cameraDirection:nT}),C(this,"cameraInfo",null),C(this,"defaultEnabledDualVideoStream",false),C(this,"capturedStream",null),C(this,"options"),C(this,"delegation",new lT(this)),C(this,"cameraIsClose",!1),C(this,"commands",{[e.UseFrontCamera]:{run:()=>{if(1===this.getState("cameraDirection"))return;const{controller:t}=this.context;t.runCommand(e.ToggleCameraDirection)}},[e.UseRearCamera]:{run:()=>{if(0===this.getState("cameraDirection"))return;const{controller:t}=this.context;t.runCommand(e.ToggleCameraDirection)}},[e.ToggleCameraDirection]:{run:()=>j(this,null,function*(){var e,t;null==(e=this.cameraWorkDetector)||e.pause();const n=0===(i=this.getState("cameraDirection"))?1:1===i?0:i;var i;this.setStates({cameraDirection:n});const{aliRtcEngine:a}=this.context;yield a.switchCamera(),yield this.startCameraPreview(),null==(t=this.cameraWorkDetector)||t.resume()})},[e.EnableVideo]:{run:()=>j(this,null,function*(){var e;const{aliRtcEngine:t}=this.context;let n=!0;try{yield this.beforeEnablePretreat.pretreat(),yield t.enableLocalVideo(!0),yield this.startCameraPreview(),null==(e=this.cameraWorkDetector)||e.start(),this.setStates({isEnabledVideo:!0})}catch(i){n=!1}n||this.onNoCameraPermission()})},[e.DisableVideo]:{run:()=>j(this,null,function*(){var e;const{aliRtcEngine:t}=this.context;yield t.enableLocalVideo(!1),yield this.stopCameraPreview(),null==(e=this.cameraWorkDetector)||e.stop(),this.setStates({isEnabledVideo:!1})})},[e.ToggleVideo]:{run:()=>{const{controller:t}=this.context;this.getState("isEnabledVideo")?t.runCommand(e.DisableVideo):t.runCommand(e.EnableVideo)}}}),this.options=function(e){const t={videoElement:null,defaultEnabledVideo:iT,autoOpenCamera:!1,isEnableDetector:!1,onDetectCameraUnavailable:oT,onDetectCameraAvailable:oT};return Object.keys(e).forEach(n=>{const i=(e||{})[n];void 0!==i&&(t[n]=i)}),t}(n),this.states.isEnabledVideo=this.options.defaultEnabledVideo,!this.options.videoElement)throw new Error("videoElement must be provide");this.options.isEnableDetector&&(this.cameraWorkDetector=function(e){const t=S(e,[]);return new ZI(t)}({videoElement:this.options.videoElement,onDetectUnavailable:this.options.onDetectCameraUnavailable,onDetectAvailable:this.options.onDetectCameraAvailable}))}startCameraPreview(){return j(this,null,function*(){if(this.delegation.enabled)return yield this.delegation.startCameraPreview();const{videoElement:e}=this.options,{aliRtcEngine:t}=this.context;if(!e)return;const n=yield t.getVideoTrack({streamType:Vt.AliRtcSdkStreamTypeCapture});if(!n)return;const i=e.srcObject||new MediaStream;e.srcObject=i;const a=i.getVideoTracks();a.find(e=>e.id===n.id)||(a.forEach(e=>{i.removeTrack(e)}),i.addTrack(n)),e.play(),this.context.reporter.report(MI.startCameraPreview)})}stopCameraPreview(){return j(this,null,function*(){var e;if(this.delegation.enabled)return yield this.delegation.stopCameraPreview();null==(e=this.options.videoElement)||e.pause(),this.context.reporter.report(MI.stopCameraPreview)})}onBeforeStart(){return j(this,null,function*(){this.cameraIsClose=!1})}onConfigure(){return j(this,null,function*(){var e,t;if(this.context.reporter.report(MI.defaultEnabledVideo,{defaultEnabledVideo:this.options.defaultEnabledVideo}),this.options.autoOpenCamera){const e=yield j(void 0,null,function*(){try{return navigator.permissions&&navigator.permissions.query?(yield navigator.permissions.query({name:"camera"})).state:"not-supported"}catch(e){return"not-supported"}});if(["denied"].includes(e))throw this.onNoCameraPermission(),new $g({type:Bg.UnknownError});if(["prompt","not-supported"].includes(e)){const e=this.getState("cameraDirection"),t=yield(e=>j(void 0,null,function*(){const t=$I(),{displayResolution:n}=t();try{const t=e===tT.CAMERA_REAR?{exact:"environment"}:"user",{width:i,height:a}=jx()?HI(n):n;return(yield navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{ideal:i},height:{ideal:a},facingMode:t}})).getTracks().forEach(e=>{e.stop()}),!0}catch(i){return!1}}))(e);if(!t)throw this.onNoCameraPermission(),new $g({type:Bg.UnknownError})}}const{webrtcResolution:n}=aT(),{aliRtcEngine:i,aliRtcEngineConfigKeeper:a}=this.context;let o=!0;try{a.setAudioOnlyMode(!1),yield i.setCameraCapturerConfiguration({width:n.width,height:n.height,frameRate:30,bitrate:12e3,cameraDirection:this.getState("cameraDirection"),maxSendFrameRate:4}),this.defaultEnabledDualVideoStream&&Wt.isDualVideoStreamSupported()&&(i.setEnableDualVideoStream(!0,{width:n.width,height:n.height,frameRate:4}),i.setRemoteDefaultVideoStreamType(Qt.AliRtcVideoStreamTypeLow))}catch(s){o=!1}if(!this.options.defaultEnabledVideo)return this.setStates({isEnabledVideo:!1,hasCameraPermission:o}),void(yield i.enableLocalVideo(!1));yield this.beforeEnablePretreat.pretreat(),yield this.startCameraPreview(),null==(e=this.cameraWorkDetector)||e.start(),o||(null==(t=this.options.onNoCameraPermission)||t.call(this),this.context.reporter.report(MI.noCameraPermission)),this.setStates({isEnabledVideo:o,hasCameraPermission:o})})}onNoCameraPermission(){var e,t;null==(t=(e=this.options).onNoCameraPermission)||t.call(e),this.context.controller.onEnd()}onAfterStart(){return j(this,null,function*(){this.context.controller.isStopWhenPreparing||this.cameraIsClose||this.options.autoOpenCamera&&this.context.controller.runCommand(e.ToggleVideo)})}onBeforeEnd(){return j(this,null,function*(){var e;this.cameraIsClose=!0,this.stopCameraPreview(),null==(e=this.cameraWorkDetector)||e.stop()})}};C(sT,"UseFrontCamera",DI("UseFrontCamera")),C(sT,"UseRearCamera",DI("UseRearCamera")),C(sT,"ToggleCameraDirection",DI("ToggleCameraDirection")),C(sT,"EnableVideo",DI("EnableVideo")),C(sT,"DisableVideo",DI("DisableVideo")),C(sT,"ToggleVideo",DI("ToggleVideo"));let rT=sT;class lT{constructor(e){C(this,"command"),C(this,"capturedStream",null),this.command=e}get enabled(){return!1}startCameraPreview(){return j(this,null,function*(){yield this.stopCameraPreview();const{displayResolution:e}=aT();try{const t=0===this.command.getState("cameraDirection")?{exact:"environment"}:"user",{width:n,height:i}=jx()?HI(e):e,a=yield navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{ideal:n},height:{ideal:i},facingMode:t}}),{videoElement:o}=this.command.options;return o&&(this.capturedStream=a,o.srcObject=a,o.play()),!0}catch(t){return!1}})}stopCameraPreview(){var e;this.capturedStream&&(this.capturedStream.getTracks().forEach(e=>{e.stop()}),this.capturedStream=null,null==(e=this.command.options.videoElement)||e.pause())}}class cT{constructor(e){C(this,"context"),C(this,"isSettedAudioOnlyMode",!1),this.context=e}setAudioOnlyMode(e){const{aliRtcEngine:t}=this.context;t.setAudioOnlyMode(e),this.isSettedAudioOnlyMode=!0}finishConfigure(){const{aliRtcEngine:e}=this.context;e.setChannelProfile(Kt.AliRtcSdkCommunication),this.isSettedAudioOnlyMode||e.setAudioOnlyMode(!0),e.setParameter(JSON.stringify({data:{enablePubDataChannel:!0,enableSubDataChannel:!0,reportL1IP:!0}}))}}class uT{constructor(e,t=[]){C(this,"context"),C(this,"commands"),this.context=e,this.commands=t}asyncCall(e){this.commands.forEach(t=>{t.isEnable&&e(t)})}waitAll(e){const t=[];return this.commands.forEach(n=>{if(!n.isEnable)return;const i=e(n);i&&t.push(i)}),Promise.all(t)}waitOneByOne(e){return new Promise(t=>{(()=>{j(this,null,function*(){try{const{length:t}=this.commands;for(let n=0;n<t;n++){const t=this.commands[n];t.isEnable&&(yield e(t))}}catch(n){}finally{t()}})})()})}}function dT(e){return Q(e).format("YYYY-MM-DD HH:mm:ss")}class hT{constructor(e){C(this,"store",new Map),this.hooks=e}start(e){var t;const n=Date.now(),i={key:e,startAt:n};this.store.set(e,i),null==(t=this.hooks)||t.afterStart(_(w({},i),{datetime:dT(n),event:"start"}))}end(e){var t;const n=this.store.get(e),i=Date.now();if(!n)return;const a=i-n.startAt;this.store.delete(e),null==(t=this.hooks)||t.afterEnd(_(w({},n),{event:"end",datetime:dT(i),during:a}))}}class pT extends RI{constructor(e){super(),C(this,"context"),C(this,"localId",null),C(this,"status",Hg.Default),C(this,"error",null),C(this,"isMuted",!1),C(this,"isRemoteMuted",!1),C(this,"isRunning",!1),C(this,"isEnding",!1),C(this,"detectedSound",!1),C(this,"userVolume",0),C(this,"channelVolume",0),C(this,"todayRemainingTimes",null),C(this,"todayMaxTimes",10),C(this,"aliRtcAuthInfo",null),this.context=e}regenerateLocalId(){this.localId=rt()}setStatus(e){this.status=e,this.emit("statusChange",{status:e}),this.context.reporter.report(MI.statusChange,{status:e})}setIsMuted(e){this.isMuted=e,this.emit("isMutedChange",{isMuted:e})}setIsRemoteMuted(e){this.isRemoteMuted=e,this.emit("isRemoteMutedChange",{isRemoteMuted:e})}setIsRunning(e){this.isRunning=e,this.emit("isRunningChange",{isRunning:e}),this.context.reporter.report(MI.isRunningChange,{isRunning:e})}setIsEnding(e){this.isEnding=e,this.emit("isEndingChange",{isEnding:e})}setDetectedSound(e){this.detectedSound!==e&&(this.detectedSound=e,this.emit("detectedSoundChange",{detectedSound:e}),this.context.reporter.report(MI.detectedSoundChange,{detectedSound:e}))}setUserVolume(e){this.userVolume=e,this.emit("userVolumeChange",{userVolume:e})}setChannelVolume(e){this.channelVolume=e,this.emit("channelVolumeChange",{channelVolume:e})}setError(e){this.error=e,this.setStatus(Hg.Error)}setTodayRemainingTimes(e){this.todayRemainingTimes=e,this.emit("todayRemainingTimesChange",{todayRemainingTimes:e}),this.context.reporter.report(MI.todayRemainingTimesChange,{todayRemainingTimes:e})}setAliRtcAuthInfo(e){this.aliRtcAuthInfo=e,this.emit("aliRtcAuthInfoChange",{aliRtcAuthInfo:e})}reset(){this.status=Hg.Default,this.isMuted=!1,this.isRunning=!1,this.detectedSound=!1,this.userVolume=0,this.channelVolume=0,this.todayRemainingTimes=0,this.error=null,this.aliRtcAuthInfo=null,this.localId=null,this.context.reporter.report(MI.reset)}}class mT extends RI{constructor(e){super(),C(this,"context"),C(this,"preparing",!1),C(this,"isStopWhenPreparing",!1),C(this,"audioElement",null),C(this,"timeConfig"),C(this,"chatId",""),this.context=e}get model(){return this.context.model}startSpeech(){return j(this,null,function*(){var e,t;if(!this.preparing){this.model.reset(),this.model.regenerateLocalId();try{const{commandManager:e}=this.context;this.preparing=!0,yield e.waitAll(e=>{var t;return null==(t=e.onBeforeStart)?void 0:t.call(e)}),this.model.setIsRunning(!0),this.context.debugger.start("speech.getSpeechConfig");const{isSuccess:t,aliRtcAuthInfo:i,errorType:a,todayRemainTimes:o,timeConfig:s,chat_id:r}=yield this.context.options.getSpeechConfig(this.context);this.timeConfig=s,this.chatId=r,this.context.debugger.end("speech.getSpeechConfig");const l=yield Wt.isSupported();if(this.context.reporter.report(MI.supportResult,l),!l.support)return this.model.setError({type:Bg.NotSupported}),void this.onEnd();if(!t||!i)return this.model.setError({type:null!=a?a:Bg.InternalServerError}),void this.onEnd();this.model.setAliRtcAuthInfo(i);const c=this.context.aliRtcEngine;if("number"==typeof o&&this.model.setTodayRemainingTimes(o),!o||o<=0)return this.model.setError({type:Bg.TodayExhausted}),void this.onEnd();c.on("rtcLocalAudioStats",e=>{}),c.on("bye",e=>{}),c.on("dataChannelMsg",(t,n)=>{if(this.model.isEnding)return;let i=null;try{const e=(new TextDecoder).decode(n.data);i=JSON.parse(e)}catch(o){i=null}const a={message:n,json:i};e.asyncCall(e=>j(this,null,function*(){var t;return yield null==(t=e.onDataChannelMsg)?void 0:t.call(e,a)}))}),c.on("occurError",(t,n)=>j(this,null,function*(){if(this.model.isEnding)return;const i={error:t,uid:n};yield e.waitAll(e=>{var t;return null==(t=e.onOccurError)?void 0:t.call(e,i)}),yield this.onEnd()})),c.on("connectionStatusChange",(t,n)=>j(this,null,function*(){if(this.model.isEnding)return;const i={status:t,reason:n};yield e.waitAll(e=>{var t;return null==(t=e.onConnectionStatusChange)?void 0:t.call(e,i)})})),c.on("audioSubscribeStateChanged",(t,n,i)=>j(this,null,function*(){var a;if(this.model.isEnding)return;i===Yt.AliRtcStateSubscribed&&(this.audioElement=(null==(a=c.getUserInfo(t))?void 0:a.audioElement)||null);const o={uid:t,oldState:n,newState:i};yield e.waitAll(e=>{var t;return null==(t=e.onAudioSubscribeStateChanged)?void 0:t.call(e,o)})})),c.on("localDeviceException",(e,t)=>{this.model.isEnding||(this.context.reporter.report(MI.localDeviceException,{type:e,exception:t}),e===Xt.AliEngineLocalDeviceTypeMic&&(null==c||c.startAudioCapture()))}),yield e.waitAll(e=>{var t;return null==(t=e.onConfigure)?void 0:t.call(e)}),this.context.aliRtcEngineConfigKeeper.finishConfigure();try{this.context.debugger.start("speech.aliRtcEngine.joinChannel"),yield Promise.race([c.joinChannel(i,i.userId),GI(1e4)])}catch(n){return this.context.reporter.report(MI.joinChannelTimeOut),this.model.setError({type:Bg.UnknownError}),void(yield this.onEnd())}finally{this.context.debugger.end("speech.aliRtcEngine.joinChannel")}if(this.model.error)return;yield e.waitAll(e=>{var t;return null==(t=e.onAfterStart)?void 0:t.call(e)})}catch(n){let i=Bg.UnknownError;n instanceof $g&&(i=null==(t=null==(e=n.payload)?void 0:e.error)?void 0:t.type),this.model.setError({type:i}),yield this.onEnd()}finally{this.preparing=!1,this.isStopWhenPreparing&&(yield this.stopSpeech())}}})}stopSpeech(){return j(this,null,function*(){this.model.isRunning&&(this.preparing?this.isStopWhenPreparing=!0:(this.isStopWhenPreparing=!1,yield this.context.commandManager.waitAll(e=>j(this,null,function*(){var t;return null==(t=e.onUserStop)?void 0:t.call(e)})),yield this.onEnd()))})}onEnd(){return j(this,null,function*(){const{commandManager:e,aliRtcEngine:t}=this.context;if(this.model.setIsEnding(!0),this.model.isRunning){this.model.isMuted&&(yield this.unmute()),this.model.isRemoteMuted&&(yield this.unmuteRemote()),yield e.waitAll(e=>{var t;return null==(t=e.onBeforeEnd)?void 0:t.call(e)}),this.model.status!==Hg.Error&&this.model.setStatus(Hg.Default),this.model.setIsRunning(!1);try{const{aliRtcEngine:e}=this.context;yield e.stopPreview();try{yield VT(e.leaveChannel(),1e3)}catch(n){}e.destroy(),this.context.resetAliRtcEngine()}catch(n){}e.waitAll(e=>{var t;return null==(t=e.onAfterEnd)?void 0:t.call(e)}),this.model.setIsEnding(!1),t.off("localDeviceException")}})}mute(){return j(this,null,function*(){this.model.isMuted||this.validate(()=>{this.model.setIsMuted(!0),this.context.aliRtcEngine.muteLocalMic(!0)})})}unmute(){return j(this,null,function*(){this.model.isMuted&&this.validate(()=>{this.model.setIsMuted(!1),this.context.aliRtcEngine.muteLocalMic(!1)})})}muteRemote(){return j(this,null,function*(){this.model.isRemoteMuted||this.validate(()=>{this.model.setIsRemoteMuted(!0),this.audioElement&&(this.audioElement.muted=!0)})})}unmuteRemote(){return j(this,null,function*(){this.model.isRemoteMuted&&(yield this.validate(()=>j(this,null,function*(){this.model.setIsRemoteMuted(!1),this.audioElement&&(this.audioElement.muted=!1)})))})}validate(e){return j(this,null,function*(){this.model.isRunning&&(yield e())})}runCommand(e,...t){let n=null;return this.context.commands.forEach(i=>{var a,o;i.commands&&(n=null==(o=null==(a=i.commands)?void 0:a[e])?void 0:o.run.apply(this,t))}),n}findCommand(e){const t=this.context.commands.find(t=>t instanceof e);return t||t}getCommandState(e){var t,n;return null!=(n=null==(t=this.findCommand(e))?void 0:t.states)?n:{}}watchCommmandState(e,t){const n=this.findCommand(e);if(!n)return()=>{};return t({states:n.states||{}}),n.eventer.on("stateChange",t)}destroy(){const{model:e,commands:t}=this.context;e.offAll(),t.forEach(e=>{e.eventer.offAll()})}}const fT={getSpeechConfig(){return j(this,null,function*(){throw new Error("You need reimplement this method")})}};class gT{constructor(e){C(this,"controller",new mT(this)),C(this,"aliRtcEngine",new Wt),C(this,"aliRtcEngineConfigKeeper",new cT(this)),C(this,"model",new pT(this)),C(this,"commandManager",new uT(this,[new FI(this),new WI(this)])),C(this,"reporter",new AI(this)),C(this,"debugger"),C(this,"options",fT),e&&(this.options=e),this.debugger=new hT({afterStart:e=>{this.reporter.report(MI.debugger,e)},afterEnd:e=>{this.reporter.report(MI.debugger,e)}})}get commands(){return this.commandManager.commands}set commands(e){this.commandManager.commands=e}resetAliRtcEngine(){this.aliRtcEngine=new Wt,this.aliRtcEngineConfigKeeper=new cT(this)}}const vT=location.href.search("testing=1")>-1,yT="OMNI_TEST_BUTTON_ID",bT=e=>{var t;if(!window.location.host.includes("pre"))return;const n=document.getElementById(yT);n&&(null==(t=n.parentElement)||t.removeChild(n));const i=document.createElement("button");i.id=yT,i.style.position="fixed",i.style.left="0px",i.style.top="50px",i.style.zIndex="99999999",i.style.background="blue",i.style.color="white",i.style.padding="0 10px",i.textContent="Copy reqs",document.body.appendChild(i),i.addEventListener("click",()=>{WS(e),i.textContent="Copied"},!1)};function xT(){return j(this,null,function*(){let e="/voice/initialize/v2";location.host.indexOf("test.qwenlm.io")>-1&&(e="http://8.219.114.196/voice/initialize/v2");const t=yield fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"AudioAndVideo",mode:"duplex",voice:"Cherry",model_id:"omni"})}),n=yield t.json(),{app_id:i,user_id_client:a,channel:o,token:s,timestamp:r}=n;return bT(JSON.stringify(n,null,2)),{isSuccess:!0,aliRtcAuthInfo:{appId:i,userId:a,channelId:o,token:s,timestamp:r},todayRemainTimes:1}})}function wT(e){const{voice:t,type:n,projectId:i=""}=e,a={getSpeechConfig(e){return j(this,null,function*(){try{const e=yield SS(w({type:n,model_id:"omni",mode:"duplex",voice:t,timezone:(new Date).toString().replace(/\s*\(.+\)$/,"")},""!==i?{project_id:i}:{}));if(!e.success&&"ERR_NETWORK"===e.data.code)return{isSuccess:!1,errorType:Bg.ConnectionLost};if(!e)return{isSuccess:!1};const{app_id:a,user_id_client:o,channel:s,token:r,timestamp:l,status_code:c,times_left:u,audio_timeout:d,video_timeout:h,chat_id:p}=(null==e?void 0:e.data)||{};if(bT(JSON.stringify(e,null,2)),isNaN(u))return{isSuccess:!1};const m=u?parseInt(u):0;return 0===m?{isSuccess:!1,errorType:Bg.TodayExhausted}:429===c?{isSuccess:!1,errorType:Bg.Limited}:{isSuccess:!0,aliRtcAuthInfo:{appId:a,userId:o,channelId:s,token:r,timestamp:l},todayRemainTimes:m,timeConfig:{voice:d,video:h},chat_id:p}}catch(e){return{isSuccess:!1,errorType:Bg.ConnectionLost}}})}},o={getSpeechConfig:xT};vT&&K.warning("You are currently using the config for test, please make the config correct before deploy.");const s=new gT(vT?o:a);return s.reporter.init(e.onReport),s.commands=[new FI(s),new WI(s),new rT(s,{videoElement:e.videoElement,defaultEnabledVideo:e.defaultEnabledVideo,autoOpenCamera:e.autoOpenCamera,isEnableDetector:e.isEnableDetector,onNoCameraPermission:e.onNoCameraPermission,onDetectCameraUnavailable:()=>{var t;null==(t=e.onDetectCameraUnavailable)||t.call(e)},onDetectCameraAvailable:()=>{var t;null==(t=e.onDetectCameraAvailable)||t.call(e)}}),new XI(s,{onTimeChange:e.onTimeChange,chatType:e.chatType}),new zI(s),new VI(s)],s.controller}const _T=class e extends aI{constructor(e){super(),C(this,"adapter"),C(this,"defaultOptions"),C(this,"shareHistory",null),C(this,"__checkModuleHasEquity",(e,t=!0,n=4)=>e.some(e=>{var i,a,o;const s=KE.getState().getModelEquity(e),r=EI.getState().models.find(t=>t.id===e),l=(null==(o=null==(a=null==(i=null==r?void 0:r.info)?void 0:i.meta)?void 0:a.abilities)?void 0:o.thinking)!==n||t;return 0!==s.remains&&null!==(null==s?void 0:s.remains)&&l})),C(this,"editMessage",e=>j(this,null,function*(){const{messageId:t,content:n,history:i,submit:a=!0}=e,o=xE.getChat(xE.currentId||"");if(!a&&o)return yield o.updateToSaveMessage(t,n);const s=i.messages[t];if("assistant"===s.role){if(o){const{responseMessageId:e}=yield o.saveAsCopyMessage(t,n)}}else if("user"===s.role)return yield this.beforeSendMessage({inputText:n,messageId:t})})),C(this,"deleteMessage",(e,t)=>j(this,null,function*(){const n=Hf();var i;yield(i={chat_id:t,message_id:e},j(void 0,null,function*(){return yield ow(`/chats/${i.chat_id}/messages/${i.message_id}`,{method:"DELETE"})})).catch(e=>{tE.open({type:"error",content:n.t(e.message)})});const a=xE.getChat(xE.currentId||"");null==a||a.deleteMessageById(e)})),C(this,"regenerateResponse",(e,t)=>{var n;const i=Hf(),{isChat:a,chatId:o,setEmitSendPromptType:s}=vx.getState(),{visionGenerating:r,taskRunning:l}=Sx.getState(),{selectedModelIds:c}=EI.getState();if(a||r||l)return void tE.open({type:"warning",content:i.t("In the conversation, please wait a moment.")});if(!e)return;s(Yf.RETRY),dS("clkRegenerate",{params:{et:"CLK"},aesParams:{c4:null==e?void 0:e.feature_config,c5:null==e?void 0:e.id,c6:o},paramsExtend:{feature_config:null==e?void 0:e.feature_config,msg_id:null==e?void 0:e.id,chat_id:o}});const u=vx.getState().history;if(u.currentId&&null!==e.parentId){const i=u.messages[e.parentId],a=i.content;1===(null!=(n=null==i?void 0:i.models)?n:[...c]).length?this.beforeSendMessage({parentId:i.id,inputText:a,extra:t}):this.beforeSendMessage({parentId:i.id,inputText:a,modelIds:[e.model],modelIdx:e.modelIdx})}}),C(this,"loadChat",e=>j(this,null,function*(){const t=this.getCurrentChatInstance();if(!t)return;this.resetChatState();const n=yield t.loadChat(e);return xE.currentId===t.id&&Sx.setState({taskRunning:t.isChat}),n})),this.defaultOptions=e}static getInstance(t){if(!e.instance){if(!t)throw new Error("ChatController  defaultOptions ");e.instance=new e(t)}return e.instance}static destroyInstance(){e.instance&&(e.instance.destroy(),e.instance=null)}init(){this.registerEventListeners(),this.emit(uE.CHAT_INITIALIZED,{timestamp:Date.now()}),this.adapter=new cE}removeAllEvents(){wE.clear(),window.removeEventListener("resize",MC)}registerEventListeners(){this.removeAllEvents(),xI(this),window.visualViewport&&window.visualViewport.addEventListener("resize",()=>{this.emit(gE.VIEWPORT_RESIZE)}),window.addEventListener("resize",MC)}validateParams(e){var t;const{inputText:n,files:i=[],selectedModels:a,messages:o}=e;if(n.length>cg)throw new tg(Pv("Prompt cannot exceed {{value}} characters.",{value:cg}),eg.VALIDATION);if(""===n&&!(null==i?void 0:i.length))throw new tg(Pv("Please enter a prompt or upload a file."),eg.VALIDATION);if(Pt(a))throw new tg(Pv("Model not selected"),eg.VALIDATION);if(0!=o.length){const e=o.at(-1);if("role"===(null==e?void 0:e.role)&&1!=(null==e?void 0:e.done))throw new tg("",eg.VALIDATION)}if(i.length>0&&i.filter(e=>{var t,n,i;return"uploading"===e.status||"running"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)}).length>0)throw new tg(Pv(i.filter(e=>{var t,n,i;return"running"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)}).length>0?"Please wait until the uploaded or currently parsing file has finished processing before sending your message.":"Oops! There are files still uploading. Please wait for the upload to complete."),eg.VALIDATION);if(e.type===ng.DeepResearch){if(((null==(t=o.filter(e=>e.sub_chat_type===ng.INTERRUPT&&"assistant"===e.role))?void 0:t.length)||0)>4&&(null==e?void 0:e.sub_chat_type)===ng.INTERRUPT)throw new tg(Pv("During the planning phase of a deep research, you can only supplement information {{num}} times.",{num:5}),eg.VALIDATION)}}submitPrompt(e){const t=e,{userAction:n,singleChat:i}=t,a=S(t,["userAction","singleChat"]);if(n===Yf.RETRY)return void i.regenerateSubmitPrompt(a);if(n===Yf.EDIT)return void i.editSubmitPrompt(a);try{this.validateParams(e)}catch(r){const e=r instanceof Error?r.message:String(r);return this.emit(dE.MESSAGE_VALIDATE_ERROR,r),void(e&&tE.open({type:"error",content:e}))}const{files:o}=a;let s=o;o&&o.length>0&&(s=o.filter(e=>{var t,n,i;return"upload_error"!==e.status&&"failed"!==(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)}),ET.setFilterFailFiles(s)),ET.reset(["inputValue","files"]),i.submitPrompt(_(w({},a),{files:s})),Pt(null==a?void 0:a.messages)&&fj.navigate("/c/new-chat")}createChat({id:e,chatId:t}={}){let n=null;if(null!=t&&(n=xE.getChatByChatId(t)),!n&&e&&["local","guest"].includes(t||"")&&(n=xE.getChat(e)),n)xE.currentId=n.id,xE.clearChatsStatus();else{const{config:e}=Ex.getState(),{settings:t}=NT.getState(),{user:i}=HE.getState(),{chatMode:a="normal"}=vx.getState();n=new tI({config:e,settings:t,user:i,chatMode:a}),this.initSelectedModels()}return n}initSelectedModels(){return j(this,null,function*(){var e,t;const{setSelectedModelIds:n,models:i}=EI.getState(),{isSettingLoading:a,settings:o}=NT.getState(),s=Rt(o,"ui.models",[]);if(!i||0===i.length||!UT()&&a)return void setTimeout(()=>{this.initSelectedModels()},100);const r=new URLSearchParams(window.location.search),l=null==(e=r.get("model")||r.get("models"))?void 0:e.split(","),c=kI(l,i),u=kI(s,i);for(;KE.getState().isUpdating;)yield qI(50);c.length>0?n(yield this.checkModuleEquity([...c],!1)):(null==u?void 0:u.length)>0?n(yield this.checkModuleEquity(s,!1)):n(yield this.checkModuleEquity([null==(t=i[0])?void 0:t.id]))})}checkModuleEquity(){return j(this,arguments,function*(e=[],t=!1,n=!1){var i;const a=KE.getState().getFeatureEquity("thinking"),o=0!==(null==a?void 0:a.remains)&&null!==(null==a?void 0:a.remains),s=NT.getState().settings.ui.models;if(this.__checkModuleHasEquity(e,o))return n&&(yield EI.getState().setSelectedModelIds(e)),e;if(t&&tE.open({type:"warning",content:Pv("The currently selected model has no remaining uses, and another model has been switched to.")}),s){if(this.__checkModuleHasEquity(s,o))return n&&(yield EI.getState().setSelectedModelIds(s)),s}const{models:r}=EI.getState(),l=[(null==(i=r.find(e=>0!==KE.getState().getModelEquity(e.id).remains))?void 0:i.id)||""];return n&&(yield EI.getState().setSelectedModelIds(l)),l})}getCurrentChatInstance(){const{currentId:e}=xE;return e?xE.getChat(e):void 0}updateMultiChatHistory(e){var t;const{messageId:n}=e;let i=n;const a=vx.getState().history;let o=a.messages[i||""].childrenIds;for(;0!==o.length;)i=o.slice(-1)[0],o=(null==(t=a.messages[i||""])?void 0:t.childrenIds)||[];this.updateChatHistory({currentId:i})}updateChatHistory(e){const{currentId:t}=e,n=this.getCurrentChatInstance();null==n||n.updateHistory(e),t&&this.adapter.invoke({method:"updateChatInfo",params:{messageId:t,status:(null==n?void 0:n.isChat)?"running":"finished"}})}stopAllResponse(){xE.forceClearAllChat()}getChatParams(){var e;const{chatId:t}=vx.getState(),{selectedModels:n}=Sx.getState(),{settings:i}=NT.getState(),a=this.getCurrentChatInstance(),o=null==a?void 0:a.getChatOptions();return{id:t,chat:{title:(null==o?void 0:o.chatTitle)||"",models:[...n],system:null!=(e=i.system)?e:void 0,history:null==o?void 0:o.history,timestamp:Date.now()}}}downloadChatHistory(e="json"){this.adapter.downloadFile({fileType:e,chat:this.getChatParams()})}changeArtifact(e,t,n){return j(this,null,function*(){$x()?this.nativeArtifactsShow(t.messages[e],n):(null==t?void 0:t.currentId)&&t.messages[null==t?void 0:t.currentId]&&(Sx.setState({currentShowControl:ag.Artifacts}),zE.setState({showSidebar:!0}),Sx.setState({selectedArtifactsMessageId:e}))})}selectModel(e){dS("selectAModel",{params:{et:"CLK",c4:e}}),Sx.setState({showModelSelect:!1})}openNewChat(e){return j(this,null,function*(){const{hideToast:t=!1,sendEventTrack:n=!1,keepTemporaryMode:i=!1}=e||{};n&&dS("clkCreateChat",{params:{et:"CLK"}}),ET.reset(["inputValue","files","showDetail","wordsShowMore"]);const a=Sx.getState().temporaryChatEnabled;Sx.setState({webSearchEnabled:!1,visionGenerating:!1}),a&&(Sx.setState({taskRunning:!1}),Sx.setState({temporaryChatEnabled:i})),!t&&"/"===window.location.pathname&&Ex.getState().mobile&&Pt(this.shareHistory)?tE.openOnce({type:"success",content:Pv("Already in a new conversation")}):(yield fj.navigate(i?"/?temporary-chat=true":"/"),yield this.initSelectedModels(),yield this.resetChatState(),this.closeShowControls(),this.shareHistory=null)})}resetChatState(){return j(this,null,function*(){vx.getState().resetChatState(),ET.resetAll(),this.adapter.resetNativeState()})}updateTemporaryChat(e){return j(this,null,function*(){Sx.setState({temporaryChatEnabled:e,currentShowControl:ag.None}),this.resetChatState(),Pt(this.shareHistory)||(this.shareHistory=null,ET.reset(["inputValue","files","showDetail","wordsShowMore"])),e?yield fj.navigate("/?temporary-chat=true"):yield fj.navigate("/")})}webDeploy(e=!1){return j(this,null,function*(){})}changeChatPromot(){}clearAllChat(){return j(this,null,function*(){const{mobile:e}=Ex.getState();if(e)this.emit(dE.MESSAGE_CLEAR_ALL);else{this.stopAllResponse(),Sx.setState({taskRunning:!1}),yield N_().catch(e=>{tE.open({type:"error",content:Pv(e.message)})}),AC(),Sx.setState({reUpdateFolders:!0}),yield vx.setState({chatId:""}),fj.navigate("/");const t=document.getElementById("new-chat-button");setTimeout(()=>{null==t||t.click(),e&&zE.setState({showSidebar:!1})},0)}})}deleteSearchSource(e){return j(this,null,function*(){const t=this.getCurrentChatInstance();if(!t)return;const{currentId:n,extra:i={}}=e,{history:a}=t.getChatOptions();if(this.closeShowControls(),$x())this.adapter.invoke({method:"removeSearchReference",params:{reference:JSON.stringify({currentId:n,extra:i})}});else{vx.setState({emitSendPromptType:Yf.EDIT});const e=a.messages[n].parentId||"",o=rt(),s=_(w({},a.messages[e]||{}),{fid:o,childrenIds:[],extra:w(w({},a.messages[e].extra||{}),i),timestamp:Math.floor(Date.now()/1e3)});s.id&&delete s.id;const r=a.messages[e||""].parentId;r&&(a.messages[r].childrenIds=[...a.messages[r].childrenIds||[],o]),a.messages[o]=s,a.currentId=o,yield this.beforeSendMessage({inputText:s.content,extra:s.extra,parentId:e,messageId:e,singleChat:t})}})}stopResponse(){const e=this.getCurrentChatInstance();null==e||e.stopResponse()}stopThinkingPhase(e){const t=this.getCurrentChatInstance();null==t||t.stopThinkingPhase(e)}logout(){return j(this,null,function*(){Sx.setState({taskRunning:!1}),yield k_(),this.adapter.clearCookie(Xf.SETAPP),HE.setState({user:void 0}),location.href="/"})}closeShowControls(){try{Sx.setState({isSourcesVisible:!1,currentShowControl:ag.None}),zE.setState({showControls:!1}),vx.setState({currentCitationInfo:{messageId:"",citationIndex:0},currentArtifactsMessage:void 0}),this.adapter.invoke({method:"closeHalfWindow"})}catch(e){}}openArtifacts(e,t){var n;const i=Sx.getState().currentShowControl;if(!t&&e===(null==(n=vx.getState().currentArtifactsMessage)?void 0:n.id)&&i!==ag.None)return this.closeShowControls(),!1;const a=this.getChatOptions().history.messages[e];return Sx.setState({currentShowControl:ag.Artifacts}),vx.setState({currentArtifactsMessage:a}),!0}updataArtifacts(e,t){return j(this,null,function*(){const t=this.getChatOptions().history.messages[e];vx.setState({currentArtifactsMessage:t})})}checkInterrupt(e){var t;if(e!==ng.INTERRUPT)return!1;const n=null==(t=this.getChatOptions())?void 0:t.history;if(!n)return!1;const i=jC(n.currentId,n).filter(e=>"assistant"===e.role),a=i.findLastIndex(e=>e.chat_type===ng.DeepResearch&&e.sub_chat_type===ng.DeepResearch);if(-1===a)return!1;return i.slice(a+1).length>=5}beforeSendMessage(e){return j(this,null,function*(){var t,n,i,a,o,s,r,l,c,u,d,h,p,m;const f=Hf(),g=this.getCurrentChatInstance();if(!g)return;const{chatType:v}=e,{currentInputFeature:y,emitSendPromptType:b,currentInputSubType:x}=vx.getState(),S=NT.getState().mcpSettingList,C=v||y,{thinkingEnabled:E,mcpEnabled:k,researchMode:I}=Sx.getState(),{selectedModelIds:T}=EI.getState();$x()||(yield this.checkModuleEquity(T,!0,!0));const{models:j}=EI.getState(),{settings:N}=NT.getState(),{config:P}=Ex.getState(),{user:M}=HE.getState(),{temporaryChatEnabled:A}=Sx.getState(),{selectedModels:O}=EI.getState(),R=(null==e?void 0:e.selectedModels)||O||[],D=R.map(e=>"string"==typeof e?e:null==e?void 0:e.id),L=j.filter(({id:e})=>D.includes(e)),{history:F}=g.getChatOptions(),{nextModels:z,messages:U}=(({selectedModels:e,allModels:t,history:n})=>{let i=e;const a=e.map(e=>t.map(e=>e.id).includes(e)?e:"");return JSON.stringify(e)!==JSON.stringify(a)&&(i=a),{nextModels:i,messages:jC(n.currentId,n)}})({selectedModels:D,allModels:j,history:F});Sx.getState().setSelectedModels(z);let H=null;if(null==e?void 0:e.parentId)H=e.parentId;else if(0!==U.length){const e=U.filter(e=>"user"!==e.role);if(Pt(e))H=null==(t=null==U?void 0:U.at(-1))?void 0:t.id;else{const t=null==(n=null==e?void 0:e.at(-1))?void 0:n.id;H=t||(null==(i=null==e?void 0:e.at(-2))?void 0:i.id)}}Pt(H)&&(H=(null==(a=this.shareHistory)?void 0:a.currentId)||null);const B={thinking_enabled:E,local_mcp:Sx.getState().mcpEnabled?{}:void 0,output_schema:"phase",research_mode:I?"advance":"normal"},$=j.find(e=>e.id===D[0]);E&&1===R.length&&1===(null==(r=null==(s=null==(o=null==$?void 0:$.info)?void 0:o.meta)?void 0:s.abilities)?void 0:r.thinking_budget)&&(B.thinking_budget=N.model_config?(null==(l=N.model_config[D[0]])?void 0:l.thinking_budget)||(null==(u=null==(c=null==$?void 0:$.info)?void 0:c.meta)?void 0:u.max_thinking_generation_length):null==(h=null==(d=null==$?void 0:$.info)?void 0:d.meta)?void 0:h.max_thinking_generation_length),k&&Gx()&&(B.mcp=S.filter(e=>!e.type&&e.enabled).map(e=>e.id));const q=F.messages[H||""]||{};null==g||g.setChatOptions({settings:N,config:P,user:M,chatMode:UT()?"guest":A?"local":"normal"});const G=((e,t,n)=>{var i,a,o,s,r,l;const{chatType:c,subChatType:u,extra:d={}}=n;switch(c){case ng.ImageEdit:case ng.Artifacts:case ng.ImageGeneration:case ng.VideoGeneration:case ng.Image2Video:case ng.WebSearch:case ng.Txt2Txt:{if((null==(i=null==d?void 0:d.meta)?void 0:i.user_action)&&delete d.meta.user_action,[ig.OmniAudio,ig.OmniVideo].includes(u))return _(w({},n),{subChatType:ng.Txt2Txt});let e=u||c;return t&&"translate"===t||"translate"!==u||(e=n.chatType),_(w({},n),{subChatType:e})}case ng.DeepResearch:case ng.Travel:{const i=jt(d);let u="";return(null==(a=null==d?void 0:d.meta)?void 0:a.subChatType)&&"retry"===(null==(o=null==d?void 0:d.meta)?void 0:o.user_action)&&(u=null==(s=null==d?void 0:d.meta)?void 0:s.subChatType),(null==(r=null==i?void 0:i.meta)?void 0:r.user_action)&&(delete d.meta.user_action,delete i.meta.user_action),u=u||DC(c,t||"",e),c===ng.DeepResearch&&u===ng.INTERRUPT&&(i.deep_research_id=null==(l=e.find(e=>e.sub_chat_type===ng.DeepResearch&&"assistant"===e.role))?void 0:l.id),_(w({},n),{subChatType:u,extra:i})}}return n})(U,(null==e?void 0:e.subChatType)||(null==(p=this.shareHistory)?void 0:p.subChatType),{chatType:C,subChatType:(null==(m=this.shareHistory)?void 0:m.subChatType)||(null==e?void 0:e.subChatType)||x||"",extra:e.extra});if(this.checkInterrupt(G.subChatType))return void tE.openOnce({type:"warning",content:f.t("During the planning phase of a deep research, you can only supplement information {{num}} times.",{num:5})});const V=_(w({},e),{type:null==G?void 0:G.chatType,selectedModels:L,messages:U,userAction:b,userMessageId:null==q?void 0:q.id,globalConfig:P,history:F,parentId:H,feature_config:B,extra:G.extra||{},singleChat:g,sub_chat_type:G.subChatType});this.submitPrompt(V)})}copyMessage(){var e,t;const n=this.getCurrentChatInstance(),i=null==n?void 0:n.getChatOptions();((e,t,n,i)=>{j(void 0,null,function*(){t?(yield WS(yield NC(e)).catch(e=>{}))&&"function"==typeof n&&n():"function"==typeof i&&i()})})({id:vx.getState().chatId,chat:{title:vx.getState().chatTitle,models:[...Sx.getState().selectedModels],system:null!=(t=null==(e=NT.getState().settings)?void 0:e.system)?t:void 0,history:null==i?void 0:i.history,timestamp:Date.now()}},!(null==i?void 0:i.isChatIntercept),()=>{tE.open({type:"success",content:Pv("Copied to clipboard")})},()=>{tE.open({type:"error",content:Pv("Content security warning: output data may contain inappropriate content!")})})}getChatOptions(){const e=this.getCurrentChatInstance();if(e)return e.getChatOptions()}setChatOptions(e){const t=this.getCurrentChatInstance();t&&t.setChatOptions(e)}collectAllSearchAndThinList(e,t=!0){const n={};return e.forEach(e=>{var t,i,a,o,s,r;const l=null==(t=e.content_list)?void 0:t.some(e=>[og.WEB_SEARCH].includes(e.phase)),c=e.is_stop_in_thinking,u="learn"===e.chat_type||"learn"===e.sub_chat_type||"learn"===(null==(a=null==(i=e.extra)?void 0:i.meta)?void 0:a.subChatType),d=null==(o=null==e?void 0:e.feature_config)?void 0:o.thinking_enabled,h=e.chat_type===ng.DeepResearch;e.id&&(l||d||u||h)&&(n[e.id]={},n[e.id].webSearchInfo=c?[]:h?((null==e?void 0:e.content_list)||[]).filter(e=>e.phase===og.ANSWER).reduce((e,t)=>{var n,i;return e.push(...(null==(i=null==(n=t.extra)?void 0:n.deep_research)?void 0:i.references)||[]),e},[]).map(e=>_(w({},e),{icon:e.hostlogo||e.icon,hostlogo:e.hostlogo||e.icon,snippet:e.description||e.snippet})):BC((null==e?void 0:e.content_list)||[]),n[e.id].type=d?ag.Thinking:ag.WebSearch,l&&d&&h&&(n[e.id].type=ag.ThinkingAndSearch),d&&(n[e.id].contentList=null==(r=null==(s=null==e?void 0:e.content_list)?void 0:s.filter(e=>e.phase!==og.ANSWER))?void 0:r.map(e=>{var t;return e.phase===og.WEB_SEARCH?_(w({},e),{content:[null==(t=null==e?void 0:e.extra)?void 0:t.web_search_info]}):e.phase===og.CODE_INTERPRETER?_(w({},e),{contentTemplate:og.CODE_INTERPRETER}):w({},e)})))}),t&&vx.setState({allSearchAndThinkLists:w(w({},vx.getState().allSearchAndThinkLists),n)}),n}updateMessage(e,t){return j(this,null,function*(){const n=this.getCurrentChatInstance();n&&n.updateMessage(e,t)})}seleteOperation(e){const t=this.getCurrentChatInstance(),n=Hf();if(null==t?void 0:t.isChat)return void tE.open({type:"warning",content:n.t("In the conversation, please wait a moment.")});const{type:i,content:a,inputText:o,messageId:s,extra:r}=e;"explain"===i?this.beforeSendMessage({parentId:s,inputText:`${n.t("Explain this section to me in more detail")}\n\n\`\`\`\n${a.text}\n\`\`\``}):"ask"===i?this.beforeSendMessage({parentId:s,inputText:`\`\`\`\n${a.text}\n\`\`\`\n${o}`}):"translate"===i&&this.beforeSendMessage({parentId:s,inputText:a.text,extra:r,subChatType:"translate"})}toast(e){const t=Hf();$x()?this.adapter.invoke({method:"showToast",params:{type:"warning",text:t.t(e.content)}}):tE.open({type:"warning",content:t.t(e.content)})}getSelectLocalLanguageCode(e,t){return j(this,null,function*(){var n,i,a,o,s;const r=(null==e?void 0:e.language)||[];let l=(null==(n=r.find(e=>e.code===t))?void 0:n.code)||(null==(i=r[0])?void 0:i.code),c="";try{if($x()&&!Yx("1.4.0")){const e=yield null==(o=null==(a=window.QwenChat)?void 0:a.getStoredInfo)?void 0:o.call(a,{key:"transTargetLanguageKey"});c=null==(s=null==e?void 0:e.result)?void 0:s.value}else c=localStorage.getItem("transTargetLanguageKey")}catch(u){}return c&&r.find(e=>e.code===c)&&(l=c),l})}setSelectLocalLanguageCode(e){$x()?this.adapter.invoke({method:"storeInfo",params:{key:TI("transTargetLanguageKey"),value:e,needPersist:!0}}):localStorage.setItem("transTargetLanguageKey",e)}navigateToSiblingMessage(e,t,n){var i,a;const o=e.id||e.fid,s=t.indexOf(o);let r;r="previous"===n?Math.max(s-1,0):Math.min(s+1,t.length-1);const l=t[r];let c=t[r];const u=this.getChatOptions().history;if(o!==c){let e=u.messages[c].childrenIds;for(;0!==e.length;)c=e.at(-1),e=u.messages[c].childrenIds;this.updateChatHistory({currentId:c});Sx.getState().currentShowControl===ag.Artifacts&&this.openArtifacts(l);const{settings:t}=NT.getState();(null==(a=null==(i=t.ui)?void 0:i.scrollOnBranchChange)||a)&&setTimeout(()=>{(()=>{const e=document.querySelector(`#${bg}`);e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})()},300)}}nativeArtifactsShow(e,t,n){const{temporaryChatEnabled:i,currentShowControl:a,showDeleteDeployConfirm:o}=Sx.getState(),{currentInputFeature:s,chatId:r,branchInfo:l}=vx.getState(),{subscriptionPlus:c}=GE.getState(),u={message:e,temporaryChatEnabled:i,currentInputFeature:t||s,loading:!!n,currentShowControl:a,showDeleteDeployConfirm:o,subscriptionPlus:c,chatId:r,branchInfo:l};this.adapter.invoke({method:"storeInfo",params:{key:TI(ag.Artifacts),value:JSON.stringify(u)}}),this.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",content:`${jI(ag.Artifacts)}?id=${r}&messageId=${e.id}`}})}nativeArtifactsUpdata(e,t){const{temporaryChatEnabled:n,currentShowControl:i,showDeleteDeployConfirm:a}=Sx.getState(),{currentInputFeature:o,chatId:s,branchInfo:r}=vx.getState(),{subscriptionPlus:l}=GE.getState(),c={message:e,temporaryChatEnabled:n,currentInputFeature:o,loading:!!t,currentShowControl:i,chatId:s,showDeleteDeployConfirm:a,subscriptionPlus:l,branchInfo:r};this.adapter.invoke({method:"storeInfo",params:{key:TI(ag.Artifacts),value:JSON.stringify(c)}})}getCurrentChatsubChatType(){const e=this.getCurrentChatInstance();return null==e?void 0:e.subChatType}getCurrentChatMessageIdsSnapshot(){var e;return[...(null==(e=this.getCurrentChatInstance())?void 0:e.history.currentResponseIds)||[]]}getCurrentChatCurrentId(){var e;return null==(e=this.getCurrentChatInstance())?void 0:e.history.currentId}clearCookie(e){this.adapter.clearCookie(e)}openWindow(e,t){this.adapter.openWindow(e,t)}updateChatInfo(e){const{id:t,status:n,subChatType:i}=e;if(36!==(null==t?void 0:t.length))return;const{temporaryChatEnabled:a}=Sx.getState();let o=t;a&&(o="temporary"),this.adapter.invoke({method:"updateChatInfo",params:{chatId:o,status:n,subChatType:i}})}routeTologin(){this.adapter.routeTologin()}onUpdateVoice(e,t){const{config:n}=Ex.getState(),{ttsAudioTTSSpeakers:i}=MT.getState();if(!(null==n?void 0:n.audio_tts_speakers)||!i)return;const a=(t?n.audio_tts_speakers:i).find(t=>t.speaker===e);if(bI.getInstance().clearAllCache(),a){a.is_personal=!1;const{updateQwenChatSettings:e}=NT.getState();e(t?{tts_speaker:a}:{tts_speaker_v2:a})}}makeVideoOrImageByImageGen(e){return j(this,arguments,function*({chatType:e,subChatType:t,files:n}){const i=Sx.getState().temporaryChatEnabled;yield this.openNewChat({hideToast:!1,sendEventTrack:!1,keepTemporaryMode:i}),this.emit(vE.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,{suggestItem:{chatType:e,subChatType:t},active:!0}),n&&TT.getState().setFiles(n)})}newChatBranch(e){return j(this,null,function*(){var t,n,i,a;const o=this.getCurrentChatInstance();if(o){const s=this.createChat();Dt(s,o,(e,t,n)=>{if(!["__proto__","constructor","prototype"].includes(n||""))return["id","instanceId","chatId","eventTarget"].includes(n||"")||"function"==typeof e?e:jt(t)});const r={};let l=jt(o.history.messages[e]);for(l.childrenIds=[];l;){const e=l.id||"";r[e]=l,l=jt(o.history.messages[l.parentId||""]),l&&(l.childrenIds=[e])}if(this.closeShowControls(),s.setChatOptions({history:{messages:r,currentId:e,currentResponseIds:[]},isChat:!1,chatLoaded:!0,branchInfo:{isTemp:!0,branch_message_id:e,origin_chat_id:o.chatId||"",origin_chat_title:o.chatTitle||""}}),yield fj.navigate("/c/new-branch"),$x()){const r=o.history.messages[e],l=((null==(t=r.content_list)?void 0:t.length)||0)>3&&(null==(n=r.content_list)?void 0:n.find(e=>e.phase===og.PdfMdGen)),{thinking_enabled:c,thinking_budget:u,research_mode:d}=r.feature_config||{},h=o.getChatOption("currentInputFeature")||"",p={type:h,subType:o.getChatOption("subChatType")||"",featureConfig:w({thinking_enabled:c,research_mode:d},u?{thinking_budget:u}:{})},m={inputText:"",modelId:o.getChatOption("models")[0]||"",actionScene:p};switch(h){case ng.ImageGeneration:p.ext={size:"1:1"};break;case ng.VideoGeneration:p.ext={size:"16:9"};break;case ng.WebDev:p.type=ng.Artifacts;break;case ng.DeepResearch:2===jC(e,s.history).length?p.subType=ng.DeepResearch:p.subType=ng.Txt2Txt;break;case ng.Travel:2===jC(e,s.history).length?p.subType=ng.TRAVEL_RESEARCH:p.subType=ng.Txt2Txt;break}if(l&&r.sub_chat_type===ng.DeepResearch){const{name:e="",link:t="",size:n=0}=(null==(a=null==(i=null==l?void 0:l.extra)?void 0:i.deep_research)?void 0:a.pdf)||{};m.queryFile={fileName:e,fileSize:n,fileUrl:t,fileType:"application/pdf"}}sessionStorage.setItem(xg,"true"),yield this.adapter.invoke({method:"openMainChat",params:m}),Px()&&setTimeout(()=>{sessionStorage.removeItem(xg)},1e3)}return s.forceSetAllState(),vx.setState({chatId:""}),Sx.setState({taskRunning:!1,visionGenerating:!1}),s}return null})}destroy(){this.removeAllListeners(),this.removeAllEvents()}createShareChat(e){this.createChat().setChatOptions({history:w({},e),isChat:!1,chatLoaded:!0,subChatType:e.subChatType,currentInputFeature:e.chatType,currentInputSubType:e.subChatType})}};C(_T,"instance",null);let ST=_T;const CT=class e extends aI{constructor(){super(),C(this,"filesManager",null)}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(e){}triggerFocus(){this.emit(vE.MESSAGE_INPUT_TRIGGER_FOCUS)}notifyBlur(){this.emit(vE.MESSAGE_INPUT_ON_BLUR)}emitRecommendWordsClick(e){this.emit(vE.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,e)}getState(){return TT.getState()}getInputValue(){return TT.getState().inputValue}getFiles(){return TT.getState().files}setInputValue(e){TT.getState().setInputValue(e)}setFiles(e){TT.getState().setFiles(e)}updateFeatureType(e){TT.getState().updateFeatureType(e),TT.getState().setMessageType(e)}setMobileRecommendDetailVisible(e){TT.getState().setMobileRecommendDetailVisible(e)}setFileDragging(e){TT.getState().setFileDragging(e)}reset(e){TT.getState().resetMessageInput(e),this.filesManager&&(null==e?void 0:e.includes("files"))&&this.filesManager.clearFiles(),(null==e?void 0:e.includes("showDetail"))&&TT.getState().setShowDetail(!1),(null==e?void 0:e.includes("wordsShowMore"))&&TT.getState().setWordsShowMore(!1)}getDefaultThinkingEnable(){var e,t,n,i,a,o;const s=Ex.getState().config,r=EI.getState().selectedModels;let l=!1;return 1===(null==r?void 0:r.length)&&(l=3===(null==(t=null==(e=null==s?void 0:s.permissions)?void 0:e.chat)?void 0:t.thinking)||3===(null==(o=null==(a=null==(i=null==(n=r[0])?void 0:n.info)?void 0:i.meta)?void 0:a.abilities)?void 0:o.thinking)),l}resetAll(){this.reset(["inputValue","files","showDetail","wordsShowMore"]);const e=this.getDefaultThinkingEnable();Sx.setState({webSearchEnabled:!1,visionGenerating:!1,thinkingEnabled:e,mcpEnabled:!1})}sendPrompt(e){TT.getState().onPromptSend(e)}createFilesManager(e){return this.filesManager=new RE(e),this.filesManager}setFilterFailFiles(e){this.filesManager&&(TT.setState({files:e}),this.filesManager.setFiles(e))}};C(CT,"instance",null);const ET=CT.getInstance();ET.init();const kT=ST.getInstance({});kT.init();const IT={mobileRecommendDetailVisible:!1,visionSize:"9:16",messageInputPermissions:{enableThinking:{enable:!1,disabled:!1},enableSearch:{enable:!1,disabled:!1},enableMCP:{enable:!1,disabled:!1},enableSizeSelector:{enable:!1,disabled:!1},enableUpload:{enable:!1,disabled:!1},enableAdvanced:{enable:!1,disabled:!1}},inputValue:"",messageType:ng.Txt2Txt,files:[],fileDragging:!1,isFocus:!1,showDetail:!1,wordsShowMore:!1,selectedSuggest:""},TT=yb()(px((e,t)=>w(w({},IT),((e,t)=>({setMobileRecommendDetailVisible:t=>e({mobileRecommendDetailVisible:t}),setVisionSize:t=>e({visionSize:t}),setInputValue:t=>e({inputValue:t}),setFiles:t=>e({files:t}),setMessageType:({subChatType:t,chatType:n})=>{let i=n;t===ng.WebDev&&(i=ng.WebDev),e({messageType:i})},updateFeatureType:({subChatType:e,chatType:t})=>{const n={};e&&(n.currentInputSubType=e),t&&(n.currentInputFeature=t),vx.setState(n)},setMessageInputPermissions:t=>e({messageInputPermissions:t}),onPromptSend:e=>{const{inputValue:n,files:i}=t();kT.beforeSendMessage(w({inputText:n,files:i},e))},resetMessageInput:t=>{if(t&&t.length>0){const n={};t.forEach(e=>{n[e]=IT[e]}),e(n)}else e(IT)},setFileDragging:t=>{e({fileDragging:t})},setIsFocus:t=>{e({isFocus:t})},setShowDetail:t=>{e({showDetail:t})},setWordsShowMore:t=>{e({wordsShowMore:t})},setSelectedSuggest:t=>{e({selectedSuggest:t})}}))(e,t)),{name:"messageInputStore",store:"messageInputStore",enabled:!1})),jT={ui:{chatBubble:!0,autoTags:!0,largeTextAsFile:!0,scrollOnBranchChange:!0,landingPageMode:"",chatDirection:"LTR",params:{},models:[]},model_config:{},memory:{enable_memory:!0,enable_history_memory:!0,memory_version_reminder:!1},personalization:{name:"",description:"",style:void 0,instruction:"",enable_for_new_chat:!0}},NT=yb()(fx(lx(px((e,t)=>({isSettingLoading:!0,settings:jT,mcpSettingList:[],getSettings:()=>j(void 0,null,function*(){var n;e({isSettingLoading:!0});const i=yield j(void 0,null,function*(){return yield ow("/users/user/settings")});if(i.success&&i.data){const n=i.data||jT;return $x()?e({settings:_(w({},t().settings),{tts_speaker:n.tts_speaker,tts_speaker_v2:n.tts_speaker_v2,ui:{language:n.ui.language,scrollOnBranchChange:n.ui.scrollOnBranchChange},personalization:n.personalization||jT.personalization}),isSettingLoading:!1}):e({settings:_(w({},n),{personalization:n.personalization||jT.personalization}),isSettingLoading:!1}),n}return ht.open({type:"error",content:(null==(n=i.data)?void 0:n.message)||""}),e({isSettingLoading:!1}),jT}),setSettings:t=>j(void 0,null,function*(){var n;const i=yield CS(t);return i.success?e(e=>{e.settings=i.data}):ht.openOnce({type:"error",content:Pv(null==(n=null==i?void 0:i.data)?void 0:n.message)}),i}),setMcpSettingList:t=>e({mcpSettingList:t}),updateLocalUiSettings:t=>j(void 0,null,function*(){e(e=>{e.settings.ui=w(w({},e.settings.ui),t)})}),updateModelConfig:t=>e(e=>{e.settings.model_config=w(w({},e.settings.model_config),t)}),updateQwenChatSettingsbyNative:e=>j(void 0,null,function*(){yield CS(e)}),updateQwenChatSettings:n=>j(void 0,null,function*(){const i=t(),a=Iv(i.settings,n);e({settings:a,isSettingLoading:!1});const o=yield CS(n);o.success&&o.data||ht.openOnce({type:"error",content:Pv(o.data.message)})})}),{name:"settingsStore",store:"settingsStore",enabled:!1})))),PT={deepResearchEndTimes:{},knowledge:null,tools:null,functions:null,showMobileGenerateModeControl:!1,audioTTSSpeakers:[],ttsAudioTTSSpeakers:[],voiceCloneList:[],onNativeCalling:!1,unsupportedLanguageVoicePlayMessageIds:[],voicePlayingMessageId:"",ossUrls:[],subscriptionTestAreaEnable:!1,showRegionUnenablePayment:!1,entrySettingsRouter:"",voiceListSelected:"female"},MT=yb()(px(e=>w(w({},PT),(e=>({setDeepResearchEndTimes:t=>e({deepResearchEndTimes:t}),setKnowledge:t=>e({knowledge:t}),setTools:t=>e({tools:t}),setFunctions:t=>e({functions:t}),setShowMobileGenerateModeControl:t=>e({showMobileGenerateModeControl:t}),setAudioTTSSpeakers:t=>e({audioTTSSpeakers:t}),setTTSAudioTTSSpeakers:t=>e({ttsAudioTTSSpeakers:t}),setOnNativeCalling:t=>e({onNativeCalling:t}),setUnsupportedLanguageVoicePlayMessageIds:t=>e({unsupportedLanguageVoicePlayMessageIds:t}),setVoicePlayingMessageId:t=>e({voicePlayingMessageId:t}),setOssUrls:t=>e({ossUrls:t}),setShowRegionUnenablePayment:t=>e({showRegionUnenablePayment:t}),setVoiceCloneList:t=>e({voiceCloneList:t}),setEntrySettingsRouter:t=>e({entrySettingsRouter:t}),setVoiceListSelected:t=>e({voiceListSelected:t})}))(e)),{name:"temporaryStatusStore",store:"temporaryStatusStore",enabled:!1})),AT={notification:[],memoryNotification:void 0},OT=yb()(lx(px((e,t)=>w(w({},AT),((e,t)=>({setNotification:n=>{const{clearNotificationById:i}=t(),a=rt(),o=n,{duration:s=1e4,id:r=a,props:l}=o,c=S(o,["duration","id","props"]),u=setTimeout(()=>{0!==s&&i(r)},s),d=w({id:r,timer:u,duration:s},c);e(e=>{e.notification=[d,...e.notification],e.memoryNotification=l})},clearNotificationById:n=>{const{notification:i}=t(),a=i.find(e=>e.id===n);a&&clearTimeout(a.timer),e(e=>{e.notification=e.notification.filter(e=>e.id!==n)})},clearAllNotification:()=>{e(e=>{e.notification=[]})},setMemoryNotification:t=>{e(e=>{e.memoryNotification=t})}}))(e,t)),{name:"notificationStore",store:"notificationStore",enabled:!1}))),RT={projectSettingOpen:!1,projectName:"",projectIcon:"",instructionValue:"",showDeleteConfirm:!1,showEditModal:!1,operationProject:{},operationProjectFiles:[],deleteFiles:[],projectInfo:{},projectInfoFiles:[],showAllList:!1,activeProjectId:null,projectChats:[],projectArr:[],chatProjectId:null,moveNewProjectId:"",projectExpandChats:[],activeChatDetails:null},DT=yb()(px(e=>w(w({},RT),(e=>({setProjectSettingOpen:t=>e({projectSettingOpen:t}),setProjectName:t=>e({projectName:t}),setProjectIcon:t=>e({projectIcon:t}),setInstructionValue:t=>e({instructionValue:t}),setShowDeleteConfirm:t=>e({showDeleteConfirm:t}),setShowEditModal:t=>e({showEditModal:t}),setOperationProject:t=>e({operationProject:t}),setOperationProjectFiles:t=>e({operationProjectFiles:t}),setDeleteFiles:t=>e({deleteFiles:t}),setProjectInfo:t=>e({projectInfo:t}),setProjectInfoFiles:t=>e({projectInfoFiles:t}),setShowAllList:t=>e({showAllList:t}),setActiveProjectId:t=>e({activeProjectId:t}),setProjectChats:t=>e({projectChats:t}),setProjectArr:t=>e({projectArr:t}),setChatProjectId:t=>e({chatProjectId:t}),setMoveNewProjectId:t=>e({moveNewProjectId:t}),resetProjectState:()=>e(RT),setProjectExpandChats:t=>e({projectExpandChats:t}),setActiveChatDetails:t=>e({activeChatDetails:t})}))(e)),{name:"projectStore",store:"projectStore",enabled:!1})),LT=e=>{localStorage.removeItem(e)};function FT(e){const t=document.cookie.split(";").map(function(e){return e.trim().split("=")}).find(function(t){return(null==t?void 0:t[0])==e});return t?encodeURIComponent(t[1]||""):""}const zT=()=>(null==localStorage?void 0:localStorage.token)||FT("qwen_token")||FT("token"),UT=()=>{const e=HE.getState().user;return $x(),void 0===e},HT=()=>new Promise(e=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{const n={lat:t.coords.latitude,lon:t.coords.longitude};e(n)},t=>{e(null)},{timeout:3e3}):e(null)});const BT=e=>{if(!e)return;const t=document.createElement("canvas"),n=t.getContext("2d");if(t.width=100,t.height=100,!(()=>{const e=document.createElement("canvas"),t=e.getContext("2d");e.height=1,e.width=1;const n=new ImageData(e.width,e.height),i=n.data;for(let o=0;o<n.data.length;o+=1)i[o]=o%4!=3?Math.floor(256*Math.random()):255;t.putImageData(n,0,0);const a=t.getImageData(0,0,e.width,e.height).data;for(let o=0;o<a.length;o+=1)if(a[o]!==i[o])return!1;return!0})())return"https://img.alicdn.com/imgextra/i4/O1CN01HixsDs1PEZYpgigdP_!!6000000001809-0-tps-400-400.jpg";n.fillStyle="#615CED",n.fillRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.font="40px NotoSansHans",n.textAlign="center",n.textBaseline="middle";const i=(e=>{if(!e||0===e.length)return"";const t=e.normalize("NFC");return Array.from(t)[0]||""})(null==e?void 0:e.trim());return n.fillText(i.toUpperCase(),t.width/2,t.height/2),t.toDataURL()},$T=()=>{const e=document.getElementById("splash-screen");e&&e.remove()},qT=e=>{const t={};Object.keys(e).forEach(n=>{t[n]=_(w({},e[n]),{level:0})});const n=(e,i=new Set)=>{if(i.has(e.id))return 0;if(e.level>0||null===e.parent_id)return e.level;i.add(e.id);const a=t[e.parent_id];return e.level=a?n(a,new Set(i))+1:0,e.level};return Object.values(t).forEach(e=>{null===e.parent_id?e.level=0:n(e)}),t},GT=e=>{const t={},n=new URLSearchParams(window.location.search);for(const[i,a]of n.entries())t[i]=a;return t[e]||""},VT=(e,t,n="Operation timeout")=>Promise.race([e,new Promise((e,i)=>{setTimeout(()=>i(new Error(n)),t)})]);function WT(e){const t=new Date(e),n=zE.getState().language;if(isNaN(t.getTime()))throw new Error("Invalid timestamp");const i=new Date,a=new Date(i.getFullYear(),i.getMonth(),i.getDate()),o=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(a.getTime()===o.getTime())return"Today";if(t.getFullYear()===i.getFullYear())return new Intl.DateTimeFormat(n,{month:"short",day:"numeric"}).format(t);return`${t.getFullYear()} ${new Intl.DateTimeFormat(n,{month:"short",day:"numeric"}).format(t)}`}const QT=()=>"true"===localStorage.getItem(Qf),KT=A.createContext(null),YT={didCatch:!1,error:null};class XT extends A.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=YT}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(...e){var t,n;const{error:i}=this.state;null!==i&&(null==(n=(t=this.props).onReset)||n.call(t,{args:e,reason:"imperative-api"}),this.setState(YT))}componentDidCatch(e,t){var n,i;null==(i=(n=this.props).onError)||i.call(n,e,t)}componentDidUpdate(e,t){var n,i;const{didCatch:a}=this.state,{resetKeys:o}=this.props;a&&null!==t.error&&function(e=[],t=[]){return e.length!==t.length||e.some((e,n)=>!Object.is(e,t[n]))}(e.resetKeys,o)&&(null==(i=(n=this.props).onReset)||i.call(n,{next:o,prev:e.resetKeys,reason:"keys"}),this.setState(YT))}render(){const{children:e,fallbackRender:t,FallbackComponent:n,fallback:i}=this.props,{didCatch:a,error:o}=this.state;let s=e;if(a){const e={error:o,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof t)s=t(e);else if(n)s=A.createElement(n,e);else{if(void 0===i)throw o;s=i}}return A.createElement(KT.Provider,{value:{didCatch:a,error:o,resetErrorBoundary:this.resetErrorBoundary}},s)}}const JT=e=>{const[t,n]=A.useState("");return an.jsx(XT,{fallback:an.jsx("div",{className:"error-boundary-content",children:an.jsxs("div",{className:"error-boundary-tip",children:[an.jsx("img",{className:"error-boundary-icon",src:"https://img.alicdn.com/imgextra/i3/O1CN01xUtwzH1r8tvR6MPA4_!!6000000005587-2-tps-160-160.png",alt:""}),an.jsx("div",{className:"error-boundary-tip-text",children:Hf().t("Oops! Something unexpected happened.")}),an.jsx("div",{className:"error-boundary-tip-des",children:Hf().t("Try refreshing, and if the issue persists, please contact support.")}),an.jsx("div",{className:"error-boundary-tip-des error-boundary-tip-key",children:Hf().t("Failure code: {{code}}",{code:t})}),an.jsx("div",{className:"error-boundary-tip-button",onClick:()=>{window.location.replace(window.location.origin)},children:Hf().t("Refresh")})]})}),onError:(e,t)=>{const i=Date.now().toString();n(i),dS("sendErrorBoundary",{params:{et:"OTHER",c5:i,c6:e.toString(),c7:t.componentStack||"",c8:(null==e?void 0:e.stack)||""}})},children:e.children})},ZT=({children:e})=>{const[t,n]=A.useState(!1),i=pb(void 0,!1);return A.useEffect(()=>{(()=>{const e=document.getElementById("low-version-browser");i&&e?(e.remove(),n(!0)):!i&&e&&(e.style.display="flex",$T(),n(!0))})()},[i]),t&&i?an.jsx(JT,{children:e}):null},ej=()=>{const{setMobile:e}=Ex(),t=Ty(),n=A.useCallback(()=>{const n=Lx();if("undefined"!=typeof window&&window.location){const e=window.location.pathname,i=n||window.innerWidth<768,a=["/settings/model","/settings/account","/settings/about","/settings/voice","/settings/voice/clone","/settings/voice/design","/settings/change-password","/settings/personalization","/settings/personalization/memory","/settings/personalization/custom-instr"],o=["/settings/voice"];if(i&&e.includes("/settings/")&&!a.includes(e)){const n=e.replace(/\/settings\/.+/,"/settings");t(n)}else i||"/settings"!==e&&!o.includes(e)||t("/settings/general")}(e=>{e?document.documentElement.classList.add("mobile"):document.documentElement.classList.remove("mobile"),$x()&&document.documentElement.classList.add("native");const t=["iPad"].includes(Ox()),n=["tablet"].includes(Ox());t||n?document.documentElement.classList.add("is-tablet"):document.documentElement.classList.remove("is-tablet")})(n),e(n)},[t,e]);return A.useEffect(()=>(n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}),[]),{onResizeHandler:n}},tj=[{key:"both",label:"All"},{key:"male",label:"Male"},{key:"female",label:"Female"}],nj=[{code:"en-US",title:"English"},{code:"ar-BH",title:""},{code:"de-DE",title:"Deutsch"},{code:"es-ES",title:"Espaol"},{code:"fr-FR",title:"France"},{code:"hi-IN",title:""},{code:"it-IT",title:"Italiano"},{code:"ja-JP",title:""},{code:"ko-KR",title:""},{code:"pt-PT",title:"Portugal"},{code:"ru-RU",title:"Russia"},{code:"th-TH",title:""},{code:"zh-CN",title:""},{code:"zh-TW",title:""},{code:"zh-Dialect",title:"-"}],ij=(e=!1,t="light")=>"dark"===t?e?"https://img.alicdn.com/imgextra/i2/O1CN01J8AmJN1cZGSJ5xFjV_!!6000000003614-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01lSOiPA1VfwvV2cZw6_!!6000000002681-54-tps-60-60.apng":"light"===t?e?"https://img.alicdn.com/imgextra/i4/O1CN01Jwyf191eaIa5xowFe_!!6000000003887-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01pNHavt1CykU9z9sPI_!!6000000000150-54-tps-60-60.apng":void 0,aj=(e,t={genders:"both",languages:""})=>e.filter(e=>!!e.urls.some(e=>e.language===t.languages)&&("both"===t.genders||e.gender===t.genders)).sort((e,n)=>{var i,a;return((null==(i=n.urls.find(e=>e.language===t.languages))?void 0:i.sort)||0)-((null==(a=e.urls.find(e=>e.language===t.languages))?void 0:a.sort)||0)}),oj=e=>{const t=e.reduce((e,t)=>Array.from(new Set([...e,...t.urls.map(e=>e.language)])),[]);return nj.filter(e=>t.includes(e.code))},sj=(e,t,n="en-US")=>oj(e).map(e=>e.code).includes(t)?t:n,rj=[{key:"female",label:"Female"},{key:"male",label:"Male"},{key:"myVoice",label:"My Voice"}],lj=[{key:"both",label:"All"},{key:"male",label:"Male"},{key:"female",label:"Female"}],cj=[{code:"en-US",title:"English"},{code:"ar-BH",title:""},{code:"de-DE",title:"Deutsch"},{code:"es-ES",title:"Espaol"},{code:"fr-FR",title:"France"},{code:"hi-IN",title:""},{code:"it-IT",title:"Italiano"},{code:"ja-JP",title:""},{code:"ko-KR",title:""},{code:"pt-PT",title:"Portugal"},{code:"ru-RU",title:"Russia"},{code:"th-TH",title:""},{code:"zh-CN",title:""},{code:"zh-TW",title:""},{code:"zh-Dialect",title:"-"}],uj=(e=!1,t="light")=>"dark"===t?e?"https://img.alicdn.com/imgextra/i2/O1CN01J8AmJN1cZGSJ5xFjV_!!6000000003614-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01lSOiPA1VfwvV2cZw6_!!6000000002681-54-tps-60-60.apng":"light"===t?e?"https://img.alicdn.com/imgextra/i4/O1CN01Jwyf191eaIa5xowFe_!!6000000003887-54-tps-60-60.apng":"https://img.alicdn.com/imgextra/i1/O1CN01pNHavt1CykU9z9sPI_!!6000000000150-54-tps-60-60.apng":void 0,dj=(e=[],t={genders:"both",languages:""})=>e.filter(e=>!!e.urls.some(e=>e.language===t.languages)&&("both"===t.genders||e.gender===t.genders)).sort((e,n)=>{var i,a;return((null==(i=n.urls.find(e=>e.language===t.languages))?void 0:i.sort)||0)-((null==(a=e.urls.find(e=>e.language===t.languages))?void 0:a.sort)||0)}),hj=e=>{const t=e.reduce((e,t)=>Array.from(new Set([...e,...t.urls.map(e=>e.language)])),[]);return cj.filter(e=>t.includes(e.code))},pj=(e,t,n="en-US")=>hj(e).map(e=>e.code).includes(t)?t:n;let mj=null;const fj={navigate:(e,t)=>{mj&&mj(e,t)}},gj=({filesManager:e,appLayoutEmit:t,promptCallBack:n})=>{const i=$(),a=Ex(e=>e.mobile),o=TT(e=>e.setFiles),s=EI(e=>e.models),r=EI(e=>e.selectedModelIds),l=EI(e=>e.setSelectedModelIds),c=NT(e=>e.setSettings),u=NT(e=>e.updateModelConfig),d=vx(e=>e.history),h=TT(e=>e.setVisionSize),p=Sx(e=>e.setResearchMode),m=Sx(e=>e.setThinkingEnabled),f=new URLSearchParams(window.location.search),g=f.get("shareId"),v=f.get("lang"),y=Ty(),[b,x]=A.useState({visible:!1}),S=A.useCallback(e=>j(void 0,null,function*(){var t;const{messageList:n=[],context:i,parentId:a,chat_type:o}=e;let s=e.sub_chat_type;if(!Pt(i)&&n.length){let e=a,r=i;if(o===ng.DeepResearch&&s===ng.INTERRUPT){const i=n.slice(0,2);r=i.reduce((e,t)=>_(w({},e),{[t.id]:t}),{}),e=null==(t=i[i.length-1])?void 0:t.id,s=ng.DeepResearch}const l={shareId:g,currentId:e,messages:Object.fromEntries(Object.entries(r).map(([e,t])=>[e,_(w({},t),{isShare:!0,fid:e})])),currentResponseIds:[e],chatType:o,subChatType:s};kT.createShareChat(l),kT.shareHistory=l,Promise.resolve().then(()=>{yE.emit(uE.CHAT_HISTORY_LOADED)})}else{const e={shareId:g,chatType:o,subChatType:s};kT.shareHistory=e}}),[g]),C=A.useCallback((e,t,n)=>{const i=EI.getState().models,a=EI.getState().selectedModelIds,{availableModelId:o,availableModelName:s}=(e=>{var t,n,i;const{modelName:a="",selectedModels:o=[],chatType:s,models:r=[],thinking:l}=e,c=r.find(e=>e.name===a),u=o.map(e=>{const{name:t}=r.find(t=>t.id===e)||{};return t});if(u.includes(a)||c){if(!l)return{availableModelId:(null==c?void 0:c.id)||o[0],availableModelName:(null==c?void 0:c.name)||u[0]||""};if(null==(i=null==(n=null==(t=null==c?void 0:c.info)?void 0:t.meta)?void 0:n.capabilities)?void 0:i.thinking)return{availableModelId:c.id,availableModelName:c.name}}const d=r.find(e=>{var t,n,i,a,o,r;return l?(null==(n=null==(t=e.info)?void 0:t.meta.chat_type)?void 0:n.includes(s))&&(null==(a=null==(i=e.info)?void 0:i.meta.capabilities)?void 0:a.thinking):null==(r=null==(o=e.info)?void 0:o.meta.chat_type)?void 0:r.includes(s)});return{availableModelId:(null==d?void 0:d.id)||r[0].id,availableModelName:(null==d?void 0:d.name)||r[0].name}})({modelName:e,selectedModels:a,models:i,chatType:t,thinking:n});return l([o]),x({visible:s!==e,type:"model"}),o},[l]),E=A.useCallback((e,t)=>{var n,i,a,o,s,r;const{shareMessage:l,sharedContent:c}=t;if(e===ng.ImageGeneration){const[e,t]=(null==(o=null==(a=null==(i=null==(n=null==l?void 0:l.content_list)?void 0:n[0])?void 0:i.extra)?void 0:a.output_image_hw)?void 0:o[0])||[];let s=ug["1:1"];Object.values(ug).forEach(n=>{const[i,a]=n.split(":");Math.abs(Number(t)/Number(e)-Number(i)/Number(a))<.1&&(s=n)}),h(s)}else if(e===ng.VideoGeneration){const e=`${(null==(s=null==c?void 0:c[0])?void 0:s.size[0])||16}:${(null==(r=null==c?void 0:c[0])?void 0:r.size[1])||9}`;h(e)}},[h]),k=A.useCallback(t=>{const n=[...t||[]].map(e=>{var t,n,i,a;if("image"===e.showType){const o=null==(i=null==(n=null==(t=e.url.split("?"))?void 0:t[0])?void 0:n.split("/"))?void 0:i.at(-1);e.name=e.name||o,e.file_type=e.file_type||`image/${null==(a=o.split("."))?void 0:a.at(-1)}`}return e});null==e||e.pushFile(n),o([...n])},[e,o]),I=A.useCallback((e,t)=>{m(null==e?void 0:e.thinking_enabled),(null==e?void 0:e.thinking_enabled)&&(UT()?u({[t]:{thinking_budget:e.thinking_budget}}):c({model_config:{[t]:{thinking_budget:e.thinking_budget}}})),"advance"===(null==e?void 0:e.research_mode)&&p(!0)},[p,c,m,u]),T=A.useCallback(e=>{$x()&&kT.adapter.invoke({method:"setSendButtonEnabled",params:{value:e}})},[]),N=A.useCallback(()=>j(void 0,null,function*(){var e,t,i,a,o,s,r,l;if(!d.currentId&&g){T(!1);try{const u=yield(c={shareId:g},j(void 0,null,function*(){return yield uw(),yield ow(`/community/share/${c.shareId}`,{toast:!1})}));if((null==u?void 0:u.success)&&!(null==u?void 0:u.data))return(()=>{const e=new URL(window.location.href),t=e.origin+e.pathname;window.history.replaceState({},document.title,t)})(),void x({visible:!0,type:"deleted"});if($x()&&!Pt(null==(e=null==u?void 0:u.data)?void 0:e.context)&&"/"===location.pathname)return void y(`/c/new-chat?shareId=${g}&lang=${v}`);if(u.success&&u.data){const e=(null==(t=null==u?void 0:u.data)?void 0:t.shared_message)||{},c=(null==(i=null==u?void 0:u.data)?void 0:i.shared_content)||{},{modelName:d,chat_type:h,sub_chat_type:p,files:m,content:f="",parentId:g,feature_config:v={},id:y}=(null==(a=null==u?void 0:u.data)?void 0:a.last_user_message)||{};let b=[];if(Pt(null==(o=null==u?void 0:u.data)?void 0:o.context)||(b=jC(null==e?void 0:e.id,{messages:_(w({},null==(s=null==u?void 0:u.data)?void 0:s.context),{[y]:null==(r=null==u?void 0:u.data)?void 0:r.last_user_message,[e.id]:e})})),yield S({messageList:b,context:null==(l=null==u?void 0:u.data)?void 0:l.context,parentId:g,chat_type:h,sub_chat_type:p}),$x())return;if(h===ng.DeepResearch&&p===ng.INTERRUPT){const e=null==b?void 0:b[2];null==n||n((null==e?void 0:e.content)||""),k(null==e?void 0:e.files)}else null==n||n(f),k(m);const x=C(d,h,!!v.thinking_enabled);let T=p;T===ng.Image2Video?T=ng.VideoGeneration:T===ng.INTERRUPT&&(T=ng.DeepResearch),kT.emit(vE.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,{suggestItem:{chatType:h===ng.Image2Video?ng.VideoGeneration:h,subChatType:T,value:f},active:h!==ng.Txt2Txt}),I(v,x),E(h,{shareMessage:e,sharedContent:c})}}catch(u){}finally{T(!0),$T()}var c}else T(!0)}),[I,k,S,E,C,d.currentId,y,v,T,n,g]),P=A.useMemo(()=>{var e;return an.jsxs(mt,{visible:b.visible,title:i.t("Tips"),onCancel:()=>x({visible:!1}),headerBorderNone:!0,maskClosable:!0,closable:!a,type:"confirm",actions:[{text:i.t("Got it"),type:a?"brandprimary":"tertiary",rounded:"circle",onClick:()=>x({visible:!1})}],children:["model"===(null==b?void 0:b.type)?i.t("The model originally used to generate this work is no longer available. Weve automatically switched you to: {{modelName}}.",{modelName:null==(e=s.find(e=>e.id===r[0]))?void 0:e.name}):"","deleted"===(null==b?void 0:b.type)?i.t("This creations original full chat has been deleted and is no longer viewable."):""]})},[i,a,s,r,null==b?void 0:b.type,b.visible]);return A.useEffect(()=>{t&&!$x()||N()},[]),{renderTipsModels:P}},vj=()=>{var e;const t=Ex(e=>e.setConfig),n=Ex(e=>e.config),i=MT(e=>e.setAudioTTSSpeakers),a=MT(e=>e.setTTSAudioTTSSpeakers),o=HE(e=>e.fetchUser),s=Ex(e=>e.mobile),r=NT(e=>e.getSettings),l=HE(e=>e.user),c=Ty(),u=A.useRef(!1),d=EI(e=>e.getModels),h=zE(e=>e.setTheme),p=zE(e=>e.setLanguage),m=NT(e=>e.settings)||{},f=NT(e=>e.updateLocalUiSettings),{i18n:g}=$(),[v]=ab(),y=zE(e=>e.isSharePage),{ui:b}=m,x=null==b?void 0:b.theme,w=null!=(e=null==b?void 0:b.language)?e:g.language;let _=!1;const S=v.get("shareId");gj({appLayoutEmit:!0}),A.useEffect(()=>{mj=c},[c]);const[C,E]=A.useState(!1);ej();A.useEffect(()=>{const e=II("theme");x&&!e&&(h(x),JC(x))},[x,h]);const k=A.useCallback(()=>{const e=pb(void 0,s),t=document.getElementById("low-version-browser");e&&(null==t||t.remove()),!e&&t&&(t.style.display="flex",$T(),E(!0))},[s]),I=A.useCallback(e=>j(void 0,null,function*(){var t,n,o,s,r,l;try{const{data:{audio_tts_speakers:t}}=yield(l=e,j(void 0,null,function*(){return yield ow("/configs/",{headers:{"Accept-Language":`${l},${l.split("-")[0]};q=0.9`}})}));i(t)}catch(c){}try{const{data:{audio_tts_speakers:i}}=yield(e=>j(void 0,null,function*(){return yield ow("/tts/config",{headers:{"Accept-Language":`${e},${e.split("-")[0]};q=0.9`}})}))(e);if(a(i),UT()||"pending"===(null==(t=HE.getState().user)?void 0:t.role)||0===(null==i?void 0:i.length))return;const l=aj(i||[],{languages:pj(i,e),genders:"female"});if(0===l.length)return;if(""===(null==(n=null==m?void 0:m.tts_speaker_v2)?void 0:n.speaker)){const e=l[0];(null==m?void 0:m.tts_speaker_v2)&&i.every(e=>{var t;return e.speaker!==(null==(t=m.tts_speaker_v2)?void 0:t.speaker)})?(null==(o=null==m?void 0:m.tts_speaker_v2)?void 0:o.is_personal)||kT.onUpdateVoice(e.speaker):((null==m?void 0:m.tts_speaker_v2)||(null==(s=null==m?void 0:m.tts_speaker_v2)?void 0:s.is_personal))&&(null==(r=m.tts_speaker_v2)?void 0:r.speaker)||kT.onUpdateVoice(e.speaker)}}catch(c){}}),[i,a,m.tts_speaker_v2]);A.useEffect(()=>{void 0!==b.language&&null!==b.language&&j(void 0,null,function*(){const e=v.get("lang"),t=yield jv(),i=(null==n?void 0:n.default_locale)||"en-US";let a="";if(e)a=kv(t,[e],i);else if(w)zx()||(a=w);else if(localStorage.getItem("locale"))a=localStorage.getItem("locale");else{const e=navigator.languages||[navigator.language||navigator.userLanguage];a=kv(t,e,i)}g.changeLanguage(a),p(a),I(a)}),$x()&&localStorage.locale&&""===b.language&&f({language:localStorage.locale})},[b.language]),A.useEffect(()=>{$x()&&localStorage.theme&&(JC(localStorage.theme),f({theme:localStorage.theme}))},[f]);const T=()=>j(void 0,null,function*(){var e;let t=zT();if($x()){let a={};try{(null==window?void 0:window.QwenChat)||(yield(n=1e3,new Promise(e=>{setTimeout(e,n)})));let t={};Yx("1.2.10")||(t=yield kT.adapter.invoke({method:"getStoredInfo",params:{key:"chatNativeToken"}})),a=JSON.parse(null==(e=null==t?void 0:t.result)?void 0:e.value)}catch(i){}t=FT("token")||(null==a?void 0:a.token),localStorage.token=t||""}var n;return t});A.useEffect(()=>{u.current&&hS(null==l?void 0:l.id)},[location.pathname]);const N=["/auth","/reset","/s/","/legal-agreement/terms-of-service","/legal-agreement/privacy-policy","/legal-agreement/usage-policy","/legal-agreement/contact-us","/legal-agreement/models","/legal-agreement/about","/mobile/chatcontrols/"],P=A.useCallback(()=>j(void 0,null,function*(){var e;const t=yield o(!1);if(_)return void c("/auth");if(!t){if(!l){if(!N.some(e=>location.pathname.startsWith(e))&&"/"!==location.pathname){if(S)return;c("/",{replace:!0})}return}return location.pathname.length>=36&&!y?void c("/c/guest"):(null==(e=kT.adapter)||e.clearCookie(Xf.SETAPP),void(zx()?kT.adapter.routeTologin():c("/auth")))}if("user"!==t.role)return;yield r(),yield d(),Jk.subscribePolling(),zx()&&kT.adapter.saveCookie(localStorage.token,Xf.SETAPP),$x()&&kT.adapter.invoke({method:"storeInfo",params:{key:TI("chatNativeToken"),value:JSON.stringify({token:localStorage.token}),needPersist:!0}});const n=t.id;n&&(cS("setUid",{params:{et:"OTHER",c1:n}}),Object.defineProperty(window,"userId",{value:n,writable:!0})),zx()||$x()||(yield j(void 0,null,function*(){const e=new URLSearchParams(window.location.search).get("temporary-chat");UT()||"true"!==e||(yield kT.updateTemporaryChat(!0))}))}),[o,l,y,c]),M=()=>j(void 0,null,function*(){var e;(()=>{const e=II("qsrc");e&&cS("reportingSource",{params:{et:"OTHER",c2:e}})})();const n=II("theme");JC(null!=(e=null!=n?n:null==localStorage?void 0:localStorage.theme)?e:"system");if(!(yield j(void 0,null,function*(){let e=null;try{const{data:t}=(yield mS())||{};e=t}catch(n){e=null}return e?(t(e),WE(),!0):(c("/error"),!1)})))return;yield T(),d(),yield P(),u.current=!0,hS(null==l?void 0:l.id);new URLSearchParams(window.location.search).get("shareId")||$T(),E(!0),j(void 0,null,function*(){var e;db().then(e=>{Ex.getState().setIsDisableGuestAccess(e.isPrivate)}),zx()&&(document.body.style.setProperty("padding-top",Qx()),document.body.style.setProperty("padding-bottom",Kx()),document.getElementById("splash-screen")||(kT.adapter.invoke({method:"onPageReady"}),kT.adapter.resetNativeState())),Gx()&&(null==(e=window.electronAPI)||e.on_event("set_cookie",e=>j(void 0,null,function*(){e&&(localStorage.token=e),window.location.replace("/")})))})});return A.useEffect(()=>(_="/c/guest"===location.pathname,k(),uw(),M(),(()=>{if(new URLSearchParams(window.location.search).get("shareId")){const e=document.getElementById("logo-description"),t=g.t("Preparing to customize the creation...");e&&t&&(e.innerText=g.t("Preparing to customize the creation..."))}})(),()=>{var e;null==(e=window.electronAPI)||e.on_event(void 0),ST.destroyInstance()}),[]),A.useEffect(()=>{w&&!(null==l?void 0:l.id)&&I(w)},[I,w,null==l?void 0:l.id]),an.jsx(ZT,{children:C&&an.jsx("div",{className:"app",children:an.jsx(Hy,{})})})},yj=e=>Symbol.iterator in e,bj=e=>"entries"in e,xj=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),i=t instanceof Map?t:new Map(t.entries());if(n.size!==i.size)return!1;for(const[a,o]of n)if(!i.has(a)||!Object.is(o,i.get(a)))return!1;return!0};function wj(e,t){return!!Object.is(e,t)||"object"==typeof e&&null!==e&&"object"==typeof t&&null!==t&&(Object.getPrototypeOf(e)===Object.getPrototypeOf(t)&&(yj(e)&&yj(t)?bj(e)&&bj(t)?xj(e,t):((e,t)=>{const n=e[Symbol.iterator](),i=t[Symbol.iterator]();let a=n.next(),o=i.next();for(;!a.done&&!o.done;){if(!Object.is(a.value,o.value))return!1;a=n.next(),o=i.next()}return!!a.done&&!!o.done})(e,t):xj({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)})))}function _j(e){const t=z.useRef(void 0);return n=>{const i=e(n);return wj(t.current,i)?t.current:t.current=i}}const Sj=({className:e="size-5",color:t="currentColor",style:n,containerClassName:i=""})=>an.jsx("div",{className:i,style:n,children:an.jsxs("svg",{className:Y("circle-spinner",e),viewBox:"0 0 24 24",fill:t,xmlns:"http://www.w3.org/2000/svg",children:[an.jsx("path",{d:"M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z",opacity:".25",fill:t}),an.jsx("path",{d:"M10.14,1.16a11,11,0,0,0-9,8.92A1.59,1.59,0,0,0,2.46,12,1.52,1.52,0,0,0,4.11,10.7a8,8,0,0,1,6.66-6.61A1.42,1.42,0,0,0,12,2.69h0A1.57,1.57,0,0,0,10.14,1.16Z",className:"spinner_ajPY",fill:t})]})}),Cj="index-module__model-selector-loading___mkq-P",Ej="index-module__model-selector-loading-text___Klahu",kj=()=>{const e=$();return an.jsxs(X,{className:Cj,align:"center",gap:8,children:[an.jsx(Sj,{containerClassName:"spinner"}),an.jsx("div",{className:Ej,children:e.t("Model loading...")})]})},Ij=A.memo(({showRegister:e=!1,size:t="small",rounded:n,buttonClass:i})=>{const{t:a}=$();return an.jsxs(X,{className:"auth-buttons",align:"center",gap:8,children:[an.jsx(Zy,{to:"/auth",onClick:e=>{Gx()&&(e.preventDefault(),kT.adapter.openWindow(`${window.location.origin}/auth?callback=qwen://open`)),dS("clkLogOn",{params:{et:"CLK"}})},children:an.jsx(ft,{size:t,rounded:n,buttonClass:i,children:a("Log in")})}),e&&an.jsx(Zy,{to:"/auth?mode=register",onClick:e=>{Gx()&&(e.preventDefault(),kT.adapter.openWindow(`${window.location.origin}/auth?mode=register&callback=qwen://open`)),dS("clkRegister",{params:{et:"CLK"}})},children:an.jsx(ft,{type:"ghost",size:t,rounded:n,buttonClass:i,children:a("Sign up")})})]})}),Tj=({equity:e,onUpdate:t})=>{const{i18n:n}=$(),i=Ex(e=>e.mobile),a=GE(e=>e.subscriptionPlus);return an.jsxs("div",{className:"qwen-chat-equity-message-content",children:[an.jsx("div",{className:"qwen-chat-equity-message-text",children:LE({remains:null==e?void 0:e.remains,unit:null==e?void 0:e.unit,currentI18n:n})}),i&&!zx()&&!a&&an.jsx("div",{className:"qwen-chat-equity-message-btn",onClick:t,children:n.t("Upgrade")})]})},jj=()=>{const e=zE(e=>e.setSettingActionMenuItemId),t=zE(e=>e.setCloseSubscriptionPopupToSetting),n=Ty();return{updateEquityHandlerByMessage:A.useCallback(()=>j(void 0,null,function*(){K.destroy(),yield t(!1),yield e("subscription"),n("/settings")}),[n,t,e])}},Nj="index-module__mobile-model-selector___-iaic",Pj="index-module__model-selector-name___zc6Lm",Mj="index-module__model-selector-plus___qJZrZ",Aj="index-module__text___M-u73",Oj="index-module__model-selector-icon___K91li",Rj="index-module__mobile-model-selector-popup-wrapper___RJ8rs",Dj="index-module__mobile-model-selector-popup___Qe6C-",Lj="index-module__model-list___7F09n",Fj="index-module__model-list-pb24___zQIso",zj="index-module__model-item___8rK-g",Uj="index-module__model-item-name___admtE",Hj="index-module__model-item-desc___hQkXJ",Bj="index-module__model-item-selected___V53cX",$j="index-module__model-list-view-more___zxWR7",qj="index-module__auth-buttons___UJdJJ",Gj=({visibleModels:e})=>{var t,n;const i=$();Ty();const{pathname:a}=ky(),o=GE(e=>e.subscriptionPlus),s=vx(e=>e.projectId),r=Ex(e=>e.mobile),l=EI(e=>e.isLoading),c=EI(e=>e.selectedModels),u=EI(e=>e.selectedModelIds),d=EI(e=>e.setSelectedModels),{updateEquityHandlerByMessage:h}=jj(),[p,m]=A.useState(!1),[f,g]=A.useState(!1),v=l||0===c.length;A.useMemo(()=>!a.includes("/p/")&&!s,[a,s]);const y=()=>{m(!1),g(!1)},b=e=>{if(u.includes(e.id))return;const{disabled:t,content:n}=(e=>{const t=KE.getState().getModelEquity(e);let n=!1,i="";return null!==t.remains&&0!==t.remains||(n=!0,i=an.jsx(Tj,{equity:t,onUpdate:h})),{disabled:n,content:i}})(e.id);t?ht.open({type:"warning",content:n,closable:o}):(d([e]),y())};return v?an.jsx(kj,{}):an.jsxs("div",{className:Nj,children:[an.jsxs(X,{onClick:()=>{m(!0)},align:"center",gap:4,children:[an.jsx("div",{className:Pj,children:null==(t=c[0])?void 0:t.name}),r&&o&&an.jsx("div",{className:Mj,children:an.jsx("div",{className:Aj,children:"Plus"})}),an.jsx(pt,{className:Oj,type:"icon-fill-triangle-down-01"})]}),an.jsxs(gt,{open:p,heightType:f?"full":"auto",onClose:y,leftFirstIcon:"icon-line-chevron-left-02",title:i.t("Models"),destroyOnHidden:!0,className:Dj,style:{paddingBottom:Kx()},rootClassName:Rj,children:[an.jsxs(X,{className:Y(Lj,{[Fj]:f}),vertical:!0,gap:20,children:[null==(n=f?e:e.slice(0,4))?void 0:n.map(e=>{var t,n,a,o;return an.jsxs(X,{className:zj,gap:24,onClick:()=>b(e),children:[an.jsxs(X,{vertical:!0,gap:2,flex:1,children:[an.jsx("div",{className:Uj,children:e.name}),an.jsx("div",{className:Hj,children:(null==(n=null==(t=null==e?void 0:e.info)?void 0:t.meta)?void 0:n.short_description)?i.t(null==(o=null==(a=null==e?void 0:e.info)?void 0:a.meta)?void 0:o.short_description):i.t("No model description available")})]}),u.includes(e.id)&&an.jsx(pt,{className:Bj,type:"icon-line-check-02"})]},e.id)}),!UT()&&!f&&an.jsx(X,{className:$j,onClick:()=>g(!0),children:i.t("Expand more models")})]}),UT()&&an.jsx("div",{className:qj,children:an.jsx(Ij,{rounded:"circle",size:"large",showRegister:!0})})]})]})},Vj=({isPro:e=!1,showUpgrade:t=!1,showTopBorder:n=!1,onClick:i})=>{const a=$(),o=GE(e=>e.fetchPaymentSubscriptionInfo),s=GE(e=>e.paymentSubscriptionInfo),r=A.useMemo(()=>e?{title:a.t("Qwen Plus"),iconType:"icon-line-star-02",desc:null==s?void 0:s.plus.description}:{title:a.t("Qwen"),iconType:"icon-line-free",desc:null==s?void 0:s.normal.description},[a,e,null==s?void 0:s.normal.description,null==s?void 0:s.plus.description]);return A.useEffect(()=>{o()},[]),an.jsxs("div",{className:Y("chat-model-selector-pro-info",{"chat-model-selector-pro-info-top-border":n}),children:[an.jsx("div",{className:"chat-model-selector-pro-info-avatar",children:an.jsx(pt,{type:r.iconType,className:"chat-model-selector-pro-info-avatar-icon"})}),an.jsxs("div",{className:"chat-model-selector-pro-info-middle",children:[an.jsx("div",{className:"chat-model-selector-pro-info-title",children:r.title}),an.jsx("div",{className:"chat-model-selector-pro-info-des",children:r.desc})]}),t&&an.jsx(ft,{type:"tertiary",rounded:"circle",onClick:i,children:a.t("Upgrade")})]})},Wj=()=>{},Qj=A.createContext({open:!1,onOpenChange:Wj,battle:!1,onBattleChange:Wj,disabledBattle:!1}),Kj={modelIntro:"index-module__model-intro___Jg3XY",introText:"index-module__intro-text___qZWCH",introIcon:"index-module__intro-icon___wumYu",battleText:"index-module__battle-text___gRTDg"},Yj=()=>{const e=$(),t=Ty(),n=Ex(e=>e.mobile),{battle:i,onBattleChange:a,disabledBattle:o}=A.useContext(Qj);return an.jsxs(X,{className:Kj.modelIntro,align:"center",justify:"space-between",children:[an.jsxs(X,{className:Kj.intro,gap:4,children:[an.jsx("div",{className:Kj.introText,children:e.t("Model")}),!UT()&&an.jsx(vt,{title:!n&&e.t("Model description"),children:an.jsx(pt,{className:Kj.introIcon,type:"icon-line-information-circle",onClick:()=>{t("/settings/model")}})})]}),!UT()&&an.jsxs(X,{className:Kj.battle,gap:8,align:"center",children:[an.jsx("div",{className:Kj.battleText,children:e.t("Model Comparison")}),an.jsx(yt,{disabled:o,checked:i,onChange:a})]})]})},Xj="index-module__model-list___-NnN5",Jj="index-module__model-item___MkLlj",Zj="index-module__model-item-not-allowed___nYbxz",eN="index-module__model-item-selected___0WMb1",tN="index-module__model-item-name___X8Hec",nN="index-module__model-set-default-icon-hidden___SzTEt",iN="index-module__model-item-content___ydaoe",aN="index-module__model-set-default-icon___Ibwo2",oN="index-module__model-item-desc___sIEVp",sN="index-module__model-item-operation___nMq-D",rN="index-module__radio___4fhLr",lN="index-module__checkbox___cSlSd",cN=({models:e,className:t,renderSubscribePrefix:n})=>{const i=$(),a=EI(e=>e.selectedModelIds),o=EI(e=>e.selectedModels),s=EI(e=>e.setSelectedModels),r=NT(e=>{var t,n;return null==(n=null==(t=e.settings)?void 0:t.ui)?void 0:n.models}),l=NT(e=>e.updateQwenChatSettings),{battle:c,onOpenChange:u}=A.useContext(Qj);Sx(e=>e.thinkingEnabled),Sx(e=>e.setWebSearchEnabled),TT(e=>e.setShowDetail),TT(e=>e.updateFeatureType),vx(e=>e.currentInputFeature);const d=e=>{if(c)if(a.includes(e.id)){const t=o.filter(t=>(null==t?void 0:t.id)!==e.id);0!==t.length&&s(t)}else{[...o,e].length<=3&&s([...o,e])}else s([e]);c||u(!1)};return an.jsx("div",{className:Y(Xj,t),children:null==e?void 0:e.map((e,t)=>{var s,u,h,p;const m=a.includes(e.id),f=!!c&&(!m&&o.length>=3),g=null==r?void 0:r.includes(e.id);return an.jsxs(X,{className:Y(Jj,{[eN]:m,[Zj]:f}),align:"center",gap:8,onClick:()=>d(e),children:[null==n?void 0:n(0===t),an.jsxs(X,{flex:1,vertical:!0,className:iN,children:[an.jsxs(X,{className:tN,gap:8,align:"center",children:[an.jsx("span",{children:e.name}),an.jsx(vt,{title:g?i.t("Cancel default"):i.t("Set as default"),children:an.jsx(pt,{className:Y(aN,{[nN]:!g}),type:g?"icon-fill-pin-01":"icon-line-pin-01",onClick:t=>{var n,a;t.stopPropagation(),n=e.id,a=g?"remove":"add",j(void 0,null,function*(){"add"===a?(yield l({ui:{models:[n]}}),ht.open({type:"success",content:i.t("Default model updated"),closable:!1})):(yield l({ui:{models:void 0}}),ht.open({type:"success",closable:!1,content:i.t("The default model has been cleared.")}))})}})})]}),an.jsx("div",{className:oN,children:(null==(u=null==(s=null==e?void 0:e.info)?void 0:s.meta)?void 0:u.short_description)?i.t(null==(p=null==(h=null==e?void 0:e.info)?void 0:h.meta)?void 0:p.short_description):i.t("No model description available")})]}),an.jsx("div",{className:sN,children:c?an.jsx(bt,{className:lN,disabled:!m&&o.length>=3,checked:m,style:{},onChange:()=>d(e)}):m&&an.jsx(pt,{className:rN,type:"icon-line-check-02"})})]},e.id)})})},uN={modelSelectorText:"index-module__model-selector-text___XvWe0",modelSelectorIcon:"index-module__model-selector-icon___-po5j",subscribePrefix:"index-module__subscribe-prefix___O3z8I",subscribePrefixNobg:"index-module__subscribe-prefix-nobg___gpBRA",modelSelectorPopup:"index-module__model-selector-popup___TGWn8",modelSelectorPopupSecondary:"index-module__model-selector-popup-secondary___Ukrgv",moreModelList:"index-module__more-model-list___5IZ7S",viewMore:"index-module__view-more___iP0nb",viewMoreText:"index-module__view-more-text___DlmZJ",viewMoreIcon:"index-module__view-more-icon___45kdG",divider:"index-module__divider___fFhyz",upgradeSubscribe:"index-module__upgrade-subscribe___-q1Bl"},dN=({disabled:e,visibleModels:t})=>{var n;const i=$(),a=EI(e=>e.isLoading),o=EI(e=>e.selectedModels),s=EI(e=>e.setSelectedModels),r=Ex(e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_payment_and_quota}),l=Ex(e=>{var t,n,i,a;return(null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_payment)&&(null==(a=null==(i=null==e?void 0:e.config)?void 0:i.features)?void 0:a.enable_payment_and_quota)}),c=GE(e=>e.subscriptionPlus),u=GE(e=>e.setShowSubscriptionDetail),d=A.useRef(null),[h,p]=A.useState(!1),[m,f]=A.useState(!1),g=a||0===o.length,v=(null==t?void 0:t.slice(0,4))||[],y=(null==t?void 0:t.slice(4))||[],b=e=>{e&&dS("clkSelectModelBtn",{params:{et:"CLK"}}),p(e)},x=e=>UT()||!r?null:e?an.jsx("div",{className:uN.subscribePrefix,children:an.jsx(pt,{type:"icon-line-free"})}):an.jsx("div",{className:Y(uN.subscribePrefix,uN.subscribePrefixNobg)});return A.useEffect(()=>{e?f(!1):h||f(o.length>1)},[e,o,h]),g?an.jsx(kj,{}):an.jsx(Qj.Provider,{value:{open:h,onOpenChange:b,battle:m,onBattleChange:e=>{!e&&o.length>1&&s([o[0]]),f(e)},disabledBattle:e},children:an.jsx(xt,{open:h,onOpenChange:b,placement:"bottomLeft",menu:null,popupRender:()=>an.jsxs("div",{className:uN.modelSelectorPopup,children:[an.jsx(Yj,{}),an.jsx(cN,{models:v,renderSubscribePrefix:x}),UT()?an.jsxs(an.Fragment,{children:[an.jsx("div",{className:uN.divider}),an.jsx(Ij,{showRegister:!0,size:"middle",rounded:"circle",buttonClass:uN.authButtons})]}):an.jsxs(an.Fragment,{children:[an.jsx("div",{ref:d,style:{position:"relative"},children:an.jsx(xt,{trigger:["hover"],menu:null,overlayStyle:{left:"100%",top:"0",right:"0",bottom:"0"},getPopupContainer:e=>e,popupRender:()=>an.jsx("div",{className:Y(uN.modelSelectorPopup,uN.modelSelectorPopupSecondary),children:an.jsx(cN,{models:y,className:uN.moreModelList})}),children:an.jsxs(X,{className:uN.viewMore,align:"center",justify:"space-between",gap:8,children:[x(!1),an.jsx(X,{className:uN.viewMoreText,flex:1,children:i.t("Expand more models")}),an.jsx(pt,{className:uN.viewMoreIcon,type:"icon-line-chevron-right"})]})})}),l&&!c&&an.jsxs("div",{className:uN.upgradeSubscribe,children:[an.jsx("div",{className:uN.divider}),an.jsx(Vj,{isPro:!0,showUpgrade:!0,onClick:()=>{b(!1),u(!0)}})]})]})]}),children:an.jsxs(X,{className:uN.modelSelector,align:"center",gap:6,children:[an.jsx("div",{className:uN.modelSelectorText,children:(null==o?void 0:o.length)>1?`${o.length} ${i.t("Models")}`:null==(n=o[0])?void 0:n.name}),an.jsx(pt,{className:uN.modelSelectorIcon,type:"icon-line-chevron-down"})]})})})},hN=()=>{const e=vx(e=>e.currentInputFeature),t=EI(e=>e.visibleModels),{thinkingEnabled:n,mcpEnabled:i}=Sx(_j(e=>({thinkingEnabled:e.thinkingEnabled,mcpEnabled:e.mcpEnabled}))),a=Ex(e=>e.mobile),{temporary:o,userRole:s}=HE(_j(e=>{var t,n,i,a;return{temporary:null==(i=null==(n=null==(t=e.user)?void 0:t.permissions)?void 0:n.chat)?void 0:i.temporary,userRole:null==(a=e.user)?void 0:a.role}})),r="user"!==s||(null==o||o);return a?an.jsx(Gj,{visibleModels:t,disabled:e!==ng.Txt2Txt||n||i,showTemporaryChatControl:r}):an.jsx(dN,{visibleModels:t,disabled:e!==ng.Txt2Txt||n||i,showTemporaryChatControl:r})},pN=({isShow:e,children:t,title:n})=>{const i=Ex(e=>e.mobile);return(null!=e?e:!i)?an.jsx(vt,{title:n,children:t}):an.jsx(an.Fragment,{children:t})},mN=()=>{const{t:e}=$(),t=qx(),n=TT(e=>e.setMobileRecommendDetailVisible);return an.jsx("div",{onClick:()=>{t&&"/"!==window.location.pathname&&n(!1),kT.openNewChat(),dS("clkCreateChat",{params:{et:"CLK"}})},className:"new-chat",children:an.jsx(pN,{title:e("New Chat"),children:an.jsx(pt,{type:t?"icon-line-message-alert-plus":"icon-line-edit-contained"})})})},fN=({isSetting:e=!1})=>{const t=Ex(e=>e.mobile),n=zE(e=>e.showSidebar),i=zE(e=>e.setShowSidebar),a=zE(e=>e.setUserActiveSidebar),o=zE(e=>e.setSettingSidebar),s=zE(e=>e.showSettingSidebar);return UT()||!e&&n?null:an.jsx("div",{id:Vf.SIDEBAR_TOGGLE_BUTTON,className:"sidebar-toggle-button",onClick:()=>{e?o(!s):(i(!n),a(!0))},children:an.jsx(pt,{type:t?"icon-line-menu-04":"icon-line-sidePanel",className:"sidebar-toggle-icon"})})},gN=e=>{const{chatId:t,show:n,onClose:i}=e,a=$(),[o,s]=A.useState(null),r=A.useRef(!1),l=Ex(e=>e.mobile),c=Sx(e=>e.taskRunning),u=A.useCallback(()=>j(void 0,null,function*(){var e;let n;try{if(n=yield(o=t,j(void 0,null,function*(){return yield ow(`/chats/${o}/share`,{method:"POST"})})),!n.success)return ht.open({type:"error",content:a.t(null==(e=n.data)?void 0:e.message)}),i(),""}catch(kX){}var o;if(!n)throw i(),new Error("sharedChat is null");const r=yield R_({chat_id:t});return s(r.data),`${window.location.origin}/s/${n.data.id}`}),[t,a,i]),d=A.useCallback(e=>!o||!!e&&((null==o?void 0:o.id)!==e.id||(null==o?void 0:o.share_id)!==e.share_id),[o]),h=A.useCallback(()=>j(void 0,null,function*(){if(c)return void ht.openOnce({type:"error",content:a.t("The current chat is not yet complete, please wait for a while and retry.")});if(r.current)return;r.current=!0;const e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);try{if(Rx()||e||Px())try{let e=yield u();if(!e)return void(r.current=!1);if(e+=`?${Vk}=${Qk()}`,dS("clkShareCopyLink",{params:{et:"CLK",c6:e},paramsExtend:{chat_id:t}}),navigator.clipboard&&navigator.clipboard.write)try{yield navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([e],{type:"text/plain"})})])}catch(n){try{yield navigator.clipboard.writeText(e)}catch(o){if(!(yield WS(e)))throw new Error("All copy methods failed")}}else{if(!(yield WS(e)))throw new Error("Clipboard API not available and fallback failed")}}catch(s){}else{let e=yield u();if(!e)return void(r.current=!1);e+=`?${Vk}=${Qk()}`,dS("clkShareCopyLink",{params:{et:"CLK",c6:e},paramsExtend:{chat_id:t}}),setTimeout(()=>{WS(e)},0)}ht.open({type:"success",content:a.t("Copied shared chat URL to clipboard!")}),i()}catch(l){}r.current=!1}),[t,a,i,u,c]);return A.useEffect(()=>{j(void 0,null,function*(){if(t&&n){const e=yield R_({chat_id:t});d(e)&&s(e.data)}else s(null)})},[t,n]),o?l?an.jsx(mt,{visible:n,header:!1,footer:!1,closable:!1,size:"small",maskClosable:!0,onCancel:i,children:an.jsxs("div",{className:"mobile-share-modal",children:[an.jsx("div",{className:"mobile-share-modal-title",children:a.t("Share Chat")}),an.jsxs("div",{className:"mobile-share-modal-content",children:[an.jsx("div",{className:"mobile-share-modal-content-main",children:(null==o?void 0:o.share_id)?an.jsxs(an.Fragment,{children:[zx()&&!Yx("1.0.0")?an.jsxs(an.Fragment,{children:[a.t("You have shared this chat"),an.jsx("span",{children:a.t("before")}),"."]}):an.jsx(an.Fragment,{children:an.jsxs("a",{href:`/s/${o.share_id}`,target:"_blank",children:[a.t("You have shared this chat"),an.jsxs("span",{children:[a.t("before"),"."]})]})}),a.t("Click here to"),an.jsx("button",{onClick:()=>j(void 0,null,function*(){if(yield Q_(t).catch(e=>(ht.open({type:"error",content:a.t(e.message)}),null))){const e=yield R_({chat_id:t});s(e.data)}}),children:a.t("delete this link")}),a.t("and create a new shared link.")]}):a.t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")}),an.jsx("div",{className:"mobile-share-modal-content-end",children:an.jsx("div",{className:"mobile-share-modal-content-end-content",children:an.jsx("div",{})})})]}),an.jsxs("div",{className:"mobile-share-modal-footer",children:[an.jsx(ft,{onClick:h,children:(null==o?void 0:o.share_id)?a.t("Update and Copy Link"):a.t("Copy Link")}),an.jsx(ft,{type:"link",onClick:i,children:a.t("Cancel")})]})]})}):an.jsx(mt,{className:"web-share-modal",size:"small",title:a.t("Share Chat"),onCancel:i,visible:n,headerBorderNone:!0,onOk:h,okText:o.share_id?a.t("Update and Copy Link"):a.t("Copy Link"),cancelButtonProps:{hidden:!0},okButtonProps:{iconFontType:"icon-Link1",iconFontStyle:{fontSize:12},type:"brandprimary",size:"middle",buttonStyle:{height:"36px"},rounded:"circle"},children:an.jsx("div",{children:an.jsx("div",{className:"share-modal-main",children:an.jsx("div",{className:"share-modal-main-content",children:o.share_id?an.jsxs(an.Fragment,{children:[Gx()?an.jsxs("a",{className:"share-modal-main-conten-link",children:[a.t("You have shared this chat"),an.jsx("span",{onClick:e=>Jx(e,`${window.location.origin}/s/${o.share_id}`),children:a.t("before")}),"."]}):an.jsxs("a",{href:`/s/${o.share_id}`,className:"share-modal-main-conten-link",target:"_blank",children:[a.t("You have shared this chat"),an.jsxs("span",{children:[a.t("before"),"."]})]}),a.t("Click here to"),an.jsx("button",{onClick:()=>j(void 0,null,function*(){if(yield Q_(t).catch(e=>(ht.open({type:"error",content:a.t(e.message)}),null))){const e=yield R_({chat_id:t});s(e.data)}}),children:a.t("delete this link")}),a.t("and create a new shared link.")]}):a.t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")})})})}):null},vN=()=>{const e=DT(e=>e.setOperationProjectFiles),t=DT(e=>e.setProjectArr),n=()=>j(void 0,null,function*(){try{const e=yield j(void 0,null,function*(){return yield ow("/projects/")});if(e.success){const n=Array.isArray(null==e?void 0:e.data)?e.data:[];return t(n),n}return[]}catch(e){return[]}});return{getNewProjectList:n,getProjectFilesList:t=>j(void 0,null,function*(){try{const{data:i,success:a}=yield IS(t);if(!a)return void("Not_Found"===i.code&&n());if(!(null==i?void 0:i.files)||!Array.isArray(i.files))return;const o=i.files.map(e=>_(w({},e),{uploadStatus:"success"}));return yield e(o),o}catch(i){}}),getProjectChatList:(e,t=1)=>j(void 0,null,function*(){try{const{data:n,success:i}=yield TS(e,t);if(!i)return;return n}catch(n){}}),extractProjectId:e=>{const t=e.match(/^\/p\/([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12})/i);return t?t[1]:null}}},yN=()=>{const e=vx(e=>e.currentChatPage),t=Sx(e=>e.setFolders),n=$(),i=Ex(e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_project}),a=()=>j(void 0,null,function*(){const{data:e}=yield(t=i,j(void 0,null,function*(){return yield ow("/folders/"+(t?"?exclude_project=true":""))}));var t;return e});return{getChatListData:e=>j(void 0,null,function*(){const{data:t}=yield M_({page:e,exclude_project:!0});return t||[]}),getAllTagsData:()=>j(void 0,null,function*(){const{data:e}=yield j(void 0,null,function*(){return yield uw(),yield ow("/chats/all/tags")});return e}),getChatListBySearchTextData:(t,...n)=>j(void 0,[t,...n],function*(t,n=e){const{data:i}=yield O_({text:t,page:n});return i}),getPinnedChatListData:()=>j(void 0,null,function*(){const{data:e,success:t}=yield A_();return t?e:[]}),getFoldersData:a,initFolders:()=>j(void 0,null,function*(){const e=yield a().catch(e=>(ht.open({type:"error",content:n.t(e.message)}),[])),i={};for(const t of e)i[t.id]=w(w({},i[t.id]||{}),t);for(const t of e)t.parent_id&&(i[t.parent_id]||(i[t.parent_id]={}),i[t.parent_id].childrenIds=i[t.parent_id].childrenIds?[...i[t.parent_id].childrenIds,t.id]:[t.id],i[t.parent_id].childrenIds.sort((e,t)=>i[t].updated_at-i[e].updated_at));t(i)})}},bN=e=>{const t=new URLSearchParams(e||"");return{icon:t.get("icon")||"",style:t.get("style")||""}},xN=({styleTop:e=0,styleLeft:t=0,isAdd:n=!1,chatId:i="",projectId:a,onClose:o=()=>{}})=>{const{i18n:s}=$(),r=Ty(),{getNewProjectList:l,getProjectChatList:c}=vN(),{getChatListData:u,initFolders:d,getPinnedChatListData:h}=yN(),p=Ex(e=>e.mobile),m=DT(e=>e.projectArr),f=bx(e=>e.setChats),g=bx(e=>e.setPinnedChats),v=DT(e=>e.setOperationProject),y=DT(e=>e.setProjectSettingOpen),b=DT(e=>e.setOperationProjectFiles),x=DT(e=>e.setShowEditModal),w=DT(e=>e.setMoveNewProjectId),_=DT(e=>e.setProjectExpandChats),S=DT(e=>e.activeProjectId),C=DT(e=>e.setProjectChats),E=zE(e=>e.setActiveChatMenuId),[k,I]=A.useState(null),T=m.length>=20;return A.useEffect(()=>{if(!n){if(document.querySelector(".project-panel-container")){let n={top:e,left:t};e+308>window.innerHeight&&(n={top:window.innerHeight-414,left:t}),I(n)}}},[n,e,t]),an.jsx("div",{className:"project-panel",style:n?{}:{position:"fixed",top:`${null==k?void 0:k.top}px`,left:`${null==k?void 0:k.left}px`,display:(null==k?void 0:k.top)?"block":"none"},children:an.jsxs("div",{className:"project-panel-container "+(p?"project-panel-container-mobile":""),children:[n&&!T&&an.jsxs(J.Item,{className:"project-panel-add "+(T?"project-panel-add-disabled":""),onClick:()=>{T||(v({}),y(!1),b([]),x(!0),w(i),o())},children:[an.jsx(pt,{type:"icon-line-folder-plus",className:"project-panel-add-icon"}),an.jsx("div",{className:"project-panel-add-text",children:s.t("New Project")})]},"project-panel-add"),an.jsx("div",{className:"project-panel-list",children:m.slice(n?0:5,m.length).filter(e=>!a||e.id!==a).map(e=>{const t=bN(e.icon);return an.jsxs("div",{className:"project-panel-item",onClick:()=>j(void 0,null,function*(){if(i){const t=yield jS(e.id,[i]).catch(e=>(ht.open({type:"error",content:s.t(e.message)}),null));if(t&&t.success){E(null);const t=yield u(1);if(f(t),l(),!p){const e=yield h();Array.isArray(e)&&g(e)}if(yield d(),S){const e=yield c(String(S));Array.isArray(e)&&_(e)}const n=yield c(String(e.id));Array.isArray(n)&&C(n),r(`/p/${e.id}`),o()}else"Not_Found"===(null==t?void 0:t.data.code)&&(l(),o())}else r(`/p/${e.id}`)}),children:[e.icon?t.icon.includes("icon-")?an.jsx(pt,{type:t.icon,className:`project-panel-item-icon ${t.style}`}):an.jsx("div",{className:"project-panel-item-icon",children:Sv[t.icon]}):an.jsx(pt,{type:"icon-line-folder-01",className:`project-panel-item-icon ${t.style}`}),an.jsx("div",{className:"project-panel-item-text",children:e.name})]},e.id)})})]})})},{saveAs:wN}=Tx,_N=({shareHandler:e=()=>{},cloneChatHandler:t=()=>{},archiveChatHandler:n=()=>{},renameHandler:i=()=>{},deleteHandler:a=()=>{},chatId:o,show:s,onClose:r=()=>{},children:l,onChange:c=()=>{},projectChat:u=!1,projectChatPined:d=!1,projectId:h,isMobileClickOpen:p=!1,tagsDropdownOffsetAuto:m=!1})=>{const f=$(),g=Ty(),{getNewProjectList:v,getProjectChatList:y,extractProjectId:b}=vN(),{getChatListData:x}=yN(),w=Ex(e=>e.mobile),_=bx(e=>e.pinnedChats),S=Sx(e=>e.taskRunning),C=Sx(e=>e.visionGenerating),E=zE(e=>e.setShowSidebar),k=DT(e=>e.activeProjectId),I=DT(e=>e.setProjectExpandChats),T=DT(e=>e.setProjectChats),[N,P]=A.useState(!1),M=bx(e=>e.setChats),O=bx(e=>e.setPinnedChats),R=vx(e=>e.chatId),D=Ex(e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_project}),[L,F]=A.useState(!1),[z,U]=A.useState(!1),H=A.useCallback(()=>j(void 0,null,function*(){dS("clkStickyChat",{params:{et:"CLK"},aesParams:{c4:o},paramsExtend:{chat_id:o}}),U(!0),yield V_(o).catch(e=>(ht.open({type:"error",content:f.t(e.message)}),null)),c(),U(!1)}),[o,f,c]),B=A.useCallback(e=>j(void 0,null,function*(){const t=e.chat.history;return jC(t.currentId,t).reduce((e,t)=>{if("assistant"===t.role){if(t.content_list&&Array.isArray(t.content_list)){const e=(null==(n=t)?void 0:n.content_list)&&(null==(i=null==n?void 0:n.content_list)?void 0:i.length)?null==(o=null==(a=null==n?void 0:n.content_list)?void 0:a.filter(e=>(null==e?void 0:e.phase)===og.ANSWER))?void 0:o.map(e=>e.content).join("\n"):"";t.content=e.replace(/\[\[\d+\]\]/g,"")||""}else t.content=t.content.replace(/\[\[\d+\]\]/g,"")||"";t.content=t.content.replace(/\[\[\d+\]\]/g,"")}var n,i,a,o;return`${e}### ${t.role.toUpperCase()}\n${t.content}\n\n`},"").trim()}),[]),q=A.useCallback((e="clkdownloadBtn")=>{dS(e,{params:{et:"CLK",c5:"chatList"},aesParams:{c4:o},paramsExtend:{chat_id:o}})},[o]),G=A.useCallback(()=>{r(),w&&E(!1)},[w,r,E]),V=A.useCallback(()=>j(void 0,null,function*(){try{const e=yield jS("",[o]).catch(e=>(ht.open({type:"error",content:f.t(e.message)}),null));if(null==e?void 0:e.success){v();const e=yield A_();Array.isArray(e.data)&&O(e.data);const t=yield x(1);if(M(t),k){const e=yield y(String(k));Array.isArray(e)&&I(e)}if(location.pathname.includes("/p/")){const e=b(location.pathname);if(e){const t=yield y(String(e));Array.isArray(t)&&T(t)}}o===R&&g(`/p/${h}`,{replace:!0})}else"Not_Found"===(null==e?void 0:e.data.code)&&v()}catch(e){}}),[k,o,R,b,x,v,y,f,g,h,M,O,T,I]),W=A.useCallback(()=>{dS("clkShareBtn",{params:{et:"CLK",c5:"chatList"},aesParams:{c4:o},paramsExtend:{chat_id:o}}),e()},[e,o]),Q=A.useCallback(()=>j(void 0,null,function*(){const e=(yield R_({chat_id:o})).data;if(!e)return;q();const t=yield B(e),n=new Blob([t],{type:"text/plain;charset=utf-8"}),i=`chat-${e.title}.txt`;if(Dx())try{yield tC(n,i)}catch(kX){ht.open({type:"warning",content:kX})}else wN(n,i)}),[o,q,B]),K=A.useCallback(()=>j(void 0,null,function*(){var e,t;const n=(yield R_({chat_id:o})).data;if(n){q();const i={};for(const o in n.chat.history.messages)(null==(e=n.chat.history.messages)?void 0:e.hasOwnProperty(o))&&(i[o]=Tt(n.chat.history.messages[o],["webSearchInfo","extra.web_search_info"]),"assistant"===i[o].role&&(null==(t=i[o])?void 0:t.content)&&(i[o].content=i[o].content.replace(/\[\[\d+\]\]/g,"")));n.chat.history.messages=i,n.chat.messages&&n.chat.messages.length&&(n.chat.messages=n.chat.messages.map(e=>{const t=Tt(e,["webSearchInfo","extra.web_search_info"]);return"assistant"===t.role&&(null==i?void 0:i.content)&&(t.content=t.content.replace(/\[\[\d+\]\]/g,"")),t}));const a=new Blob([JSON.stringify([n])],{type:"application/json;charset=utf-8"});wN(a,`chat-export-${Date.now()}.json`)}}),[o,q]),Y=A.useCallback(()=>an.jsx(J,{mode:"inline",className:"chat-menu-content",id:"menu-content",children:w?an.jsxs(an.Fragment,{children:[an.jsxs(J.Item,{className:"chat-menu-item",onClick:e=>{null==e||e.domEvent.stopPropagation(),null==e||e.domEvent.preventDefault(),i()},children:[f.t("Rename"),an.jsx(pt,{type:"icon-line-edit-contained",className:"chat-menu-item-icon-20"})]},"rename-mobile"),an.jsxs(J.Item,{className:"chat-menu-item",disabled:S||C,onClick:e=>{null==e||e.domEvent.stopPropagation(),null==e||e.domEvent.preventDefault(),C||S||t()},children:[f.t("Clone"),an.jsx(pt,{type:"icon-line-clone-01",className:"chat-menu-item-icon-18"})]},"clone-mobile"),an.jsxs(J.Item,{className:"chat-menu-item",onClick:t=>{null==t||t.domEvent.stopPropagation(),null==t||t.domEvent.preventDefault(),e()},children:[f.t("Share"),an.jsx(pt,{type:"icon-line-share-01",className:"chat-menu-item-icon-18"})]},"share-mobile"),an.jsx(J.Divider,{className:"chat-menu-hr"}),D&&an.jsx(Z,{className:"chat-menu-submenu chat-menu-submenu-move",popupClassName:"chat-menu-submenu-project",title:f.t("Move to Project"),icon:an.jsx(pt,{type:"icon-line-folder-01"}),popupOffset:[-280,0],onClick:e=>{null==e||e.domEvent.stopPropagation(),null==e||e.domEvent.preventDefault()},children:an.jsx(xN,{isAdd:!0,chatId:o,projectId:h,onClose:G})},"moveToProject"),u&&D&&an.jsxs(J.Item,{className:"chat-menu-item ",onClick:e=>{null==e||e.domEvent.stopPropagation(),null==e||e.domEvent.preventDefault(),V()},children:[f.t("Move from Project"),an.jsx(pt,{type:"icon-line-arrow-curve-left-right"})]},"SwapProject"),an.jsx(J.Divider,{className:"chat-menu-hr"}),an.jsxs(J.Item,{className:"chat-menu-item chat-menu-delete-item",danger:!0,onClick:e=>{null==e||e.domEvent.stopPropagation(),null==e||e.domEvent.preventDefault(),a()},children:[f.t("Delete"),an.jsx(pt,{type:"icon-line-trash-01",className:"chat-menu-item-icon-18"})]},"delete-mobile")]}):an.jsxs(an.Fragment,{children:[an.jsx(J.Item,{onClick:H,className:"chat-menu-item",children:z?an.jsx("div",{className:"chat-menu-item-pin-loading",children:an.jsx(wt,{})}):L?an.jsxs(an.Fragment,{children:[an.jsx(pt,{type:"icon-line-unpin-01"}),an.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Unpin")})]}):an.jsxs(an.Fragment,{children:[an.jsx(pt,{type:"icon-line-pin-01"}),an.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Pin")})]})},"pin"),an.jsxs(J.Item,{className:"chat-menu-item",onClick:i,children:[an.jsx(pt,{type:"icon-line-edit-contained"}),an.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Rename")})]},"rename"),an.jsxs(J.Item,{className:"chat-menu-item "+(S?"chat-menu-item-task-running":""),disabled:S||C,onClick:()=>{C||S||t()},children:[an.jsx(pt,{type:"icon-line-clone-01"}),an.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Clone")})]},"clone"),an.jsxs(J.Item,{className:"chat-menu-item",onClick:n,children:[an.jsx(pt,{type:"icon-line-archive-02"}),an.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Archive")})]},"archive"),an.jsxs(J.Item,{className:"chat-menu-item",onClick:W,children:[an.jsx(pt,{type:"icon-a-share20"}),an.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Share")})]},"share"),an.jsxs(Z,{className:"chat-menu-submenu",title:f.t("Download"),icon:an.jsx(pt,{type:"icon-line-download-02"}),children:[an.jsx(J.Item,{className:"chat-menu-item",onClick:K,children:f.t("Export chat (.json)")},"json"),an.jsx(J.Item,{className:"chat-menu-item",onClick:Q,children:f.t("Plain text (.txt)")},"txt")]},"download"),D&&an.jsx(Z,{className:"chat-menu-submenu",popupClassName:"chat-menu-submenu-project",title:f.t("Move to Project"),icon:an.jsx(pt,{type:"icon-line-folder-01"}),children:an.jsx(xN,{isAdd:!0,chatId:o,projectId:h,onClose:G})},"moveToProject"),u&&D&&an.jsxs(J.Item,{className:"chat-menu-item",onClick:V,children:[an.jsx(pt,{type:"icon-line-arrow-curve-left-right"}),an.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Move from Project")})]},"SwapProject"),an.jsxs(J.Item,{className:"chat-menu-item chat-menu-item-error",onClick:a,children:[an.jsx(pt,{type:"icon-line-trash-01"}),an.jsx("span",{className:"chat-menu-item-icon-text",children:f.t("Delete")})]},"delete")]})}),[w,H,z,L,f,i,S,C,n,W,K,Q,o,h,G,u,V,a,c,t,e]);return A.useEffect(()=>{s&&F(d||_.find(e=>e.id===o))},[o,_,s,d]),A.useEffect(()=>{const e=document.getElementById("menu-content");if(!p&&e&&w){const t=t=>{if(s){(null==e?void 0:e.contains(t.target))||r()}};return document.addEventListener("click",t),()=>{document.removeEventListener("click",t)}}},[s,w,r]),an.jsx(ee,{open:s,onOpenChange:e=>{e||r()},trigger:p?["click"]:w?[]:["click"],popupRender:Y,placement:"bottomLeft",children:an.jsx("div",{className:"chat-menu-trigger",children:l})})},SN=A.memo(e=>{const{placeholder:t="",rows:n=1,maxLength:i=1e3,maxRows:a,isMcp:o=!1,showMaxLength:s=!0,autoFocus:r=!1,onKeyDown:l}=e,[c,u]=A.useState(""),[d,h]=A.useState(n>1),p=A.useRef(null),m=A.useRef(null),f=A.useCallback(t=>{var n;u(t.target.value),null==(n=e.onChange)||n.call(e,t.target.value)},[e]),g=()=>{var e,t,i,a,o,s,r,l,c,u;if(!(null==(t=null==(e=p.current)?void 0:e.resizableTextArea)?void 0:t.textArea)||n>1)return;const d=null==(a=null==(i=p.current)?void 0:i.resizableTextArea)?void 0:a.textArea.getBoundingClientRect(),f=null==(o=m.current)?void 0:o.getBoundingClientRect(),g=null==(l=null==(r=null==(s=p.current)?void 0:s.resizableTextArea)?void 0:r.textArea)?void 0:l.value,v=document.createElement("span");v.style.font=window.getComputedStyle(null==(u=null==(c=p.current)?void 0:c.resizableTextArea)?void 0:u.textArea).font,v.style.visibility="hidden",v.style.position="absolute",v.textContent=g,document.body.appendChild(v);const y=v.offsetWidth;document.body.removeChild(v);const b=d.left+y,x=(null==f?void 0:f.left)||0;h(b>x)};return A.useEffect(()=>{var t;u(null!=(t=e.value)?t:"")},[e.value]),A.useEffect(()=>{setTimeout(()=>{g()},0)},[]),an.jsxs("div",{className:"comment-textarea",children:[an.jsx(te.TextArea,{ref:p,rows:a?void 0:n,maxLength:i,placeholder:t,value:c,onChange:f,onInput:g,autoSize:!!a&&{maxRows:a||4},onKeyDown:l,autoFocus:r,className:""+(o?"comment-textarea-mcp":"")}),s&&an.jsx("div",{className:Y("comment-textarea-count",{"comment-textarea-count-position":!d,"comment-textarea-count-error":c.length>=i}),children:an.jsxs("div",{ref:m,children:[c.length,"/",i]})})]})}),CN=({isShow:e,chatProjectId:t})=>{const n=Ty(),i=$(),a=qx(),o=Sx(e=>e.temporaryChatEnabled),s=vx(e=>e.chatId);vx(e=>e.currentInputFeature);const[r,l]=A.useState(!1),c=zE(e=>e.setActiveChatMenuId),u=bx(e=>e.setPinnedChats),d=Sx(e=>e.setTaskRunning),h=zE(e=>e.setShowSidebar),p=Ex(e=>e.mobile),[m,f]=A.useState(""),[g,v]=A.useState(!1),y=A.useRef(null),b=vx(e=>e.chatTitle),[x,w]=A.useState(!1),_=vx(e=>e.setChatTitle),S=bx(e=>e.chats),C=bx(e=>e.pinnedChats),[E,k]=A.useState(!1),[I,T]=A.useState([]),N=DT(e=>e.setChatProjectId),[P,M]=A.useState(!1),{getPinnedChatListData:O}=yN(),R=A.useCallback(()=>j(void 0,null,function*(){OC(),AC();const e=yield O();Array.isArray(e)&&u(e)}),[O,u]),D=A.useCallback(()=>{M(!1)},[]),L=A.useCallback(()=>j(void 0,null,function*(){p&&h(!1),kT.openNewChat(),N("")}),[p,N,h]),F=A.useCallback(e=>j(void 0,null,function*(){const t=yield W_(e).catch(e=>(ht.open({type:"error",content:i.t(e.message)}),null));if(null==t?void 0:t.success){kT.shareHistory=null,n(`/c/${t.data.id}`),yield AC();const e=yield A_();Array.isArray(e.data)&&u(e.data),OC()}else ht.open({type:"error",content:i.t(null==t?void 0:t.data.message)})}),[i,n,u]),z=A.useCallback(e=>j(void 0,null,function*(){(yield q_(e).catch(e=>{ht.open({type:"error",content:i.t(e.message)})}))&&s===e&&(d(!1),R(),t?n(`/p/${t}`,{replace:!0}):yield L())}),[s,t,L,i,n,R,d]),U=A.useCallback(()=>j(void 0,null,function*(){var e;c(null),f(b||""),v(!0),null==(e=y.current)||e.focus()}),[c,b]);A.useCallback(e=>{let t=[];if(e)for(const n in e)e[n].items&&Array.isArray(e[n].items.chats)&&(t=t.concat(e[n].items.chats));return t},[]);const H=A.useCallback(e=>j(void 0,null,function*(){var a,o;w(!1),e===s&&d(!1);const r=yield G_(e).catch(e=>(ht.open({type:"error",content:i.t(e.message)}),null));null==(a=null==S?void 0:S.filter(e=>e.id===s))||a.length,null==(o=null==C?void 0:C.filter(e=>e.id===s))||o.length,r&&(R(),s===e&&t?n(`/p/${t}`,{replace:!0}):L())}),[s,t,S,L,i,n,R,C,d]),B=A.useMemo(()=>an.jsxs(mt,{visible:x,title:i.t("Delete chat"),className:"chat-item-delete-confirm",closable:!1,headerBorderNone:!0,maskClosable:!0,onCancel:()=>w(!1),size:"small",actions:[{text:i.t("Cancel"),type:"tertiary",size:"large",rounded:"circle",onClick:()=>{w(!1)}},{text:i.t("Delete"),type:"dangerprimary",size:"large",rounded:"circle",onClick:()=>{H(s)}}],children:[!(E||!I.length)&&an.jsxs(an.Fragment,{children:[i.t("The chat contains the following deployed content. Once the chat is deleted, the associated links will no longer be accessible. Please confirm to proceed."),an.jsx("div",{className:"deploy-url-container",children:I.map(e=>an.jsx("div",{className:"deploy-url-item",children:e},e))})]}),!E&&i.t("This action will permanently delete all the chats you've created and cannot be undone. Please confirm to proceed.")]}),[H,E,I,i,s,x]),q=A.useMemo(()=>!(!t||""===t),[t]),G=A.useMemo(()=>an.jsx(_N,{show:r,chatId:s,projectChat:q,projectId:t,cloneChatHandler:()=>{c(null),F(s),dS("clkCloneChat",{params:{et:"CLK"},aesParams:{c4:s},paramsExtend:{chat_id:s}})},shareHandler:()=>{c(null),M(!0)},archiveChatHandler:()=>{z(s)},renameHandler:U,deleteHandler:()=>{c(null),w(!0)},onClose:()=>{l(!1)},onChange:R,children:null,isMobileClickOpen:p,tagsDropdownOffsetAuto:!0}),[r,s,q,t,U,R,p,c,F,z]),V=A.useCallback((e,t)=>j(void 0,null,function*(){if(0!==t.trim().length)if(""===t)ht.open({type:"error",content:i.t("Title cannot be an empty string.")});else{if(!(yield D_({chat_id:e,chat:{title:t}}).catch(e=>{ht.open({type:"error",content:i.t(e.message)})})).success)return void _(b||"");e===s&&_(t),R()}else _(b||"")}),[s,i,R,b,_]),W=A.useMemo(()=>an.jsx(mt,{visible:g,className:"qwen-chat-comp-item-rename-modal",title:i.t("Rename Chat"),headerBorderNone:!0,closable:!p,size:"small",cancelText:i.t("Cancel"),onCancel:()=>{v(!1),f("")},okText:i.t("Confirm"),actions:[{text:i.t("Cancel"),type:"tertiary",rounded:"circle",onClick:()=>{v(!1),f("")}},{text:i.t("Confirm"),rounded:"circle",disabled:!m.trim(),onClick:()=>j(void 0,null,function*(){yield V(s,m),R(),v(!1)})}],children:an.jsx("div",{className:"rename-confirm",children:an.jsx("div",{className:"rename-confirm-content",children:an.jsx(SN,{showMaxLength:!1,value:m,onChange:f,maxLength:100,maxRows:4,placeholder:i.t("Enter your message"),autoFocus:!0})})})}),[V,i,s,p,R,m,g]);return!e&&a||UT()||!s||!s&&!o||o?null:an.jsxs("div",{className:"chat-extension-modal",children:[an.jsxs(X,{className:"chat-extension-modal-icon",align:"center",justify:"center",onClick:()=>{r||l(!r)},children:[an.jsx(pt,{type:"icon-line-more-01"}),G]}),W,B,an.jsx(gN,{show:P,chatId:s,onClose:D})]})},EN=({show:e,onClose:t=()=>{},editHandler:n=()=>{},deleteHandler:i=()=>{}})=>{const{i18n:a}=$(),o=Ex(e=>e.mobile);return A.useEffect(()=>{const n=document.getElementById("menu-content");if(n&&o){const i=i=>{if(e){(null==n?void 0:n.contains(i.target))||t()}};return document.addEventListener("click",i),()=>{document.removeEventListener("click",i)}}},[e,o,t]),an.jsx(ee,{open:e,onOpenChange:e=>{e||t()},trigger:["click"],popupRender:()=>an.jsxs(J,{mode:"inline",className:"project-operation-menu-content",children:[an.jsxs(J.Item,{className:"project-operation-menu-item",onClick:n,children:[an.jsx(pt,{type:"icon-line-edit-contained",className:"project-operation-menu-item-icon"}),an.jsx("div",{className:"project-operation-menu-item-text",children:a.t("Edit Project")})]},"edit"),an.jsxs(J.Item,{className:"project-operation-menu-item project-item-delete",onClick:i,children:[an.jsx(pt,{type:"icon-line-trash-01",className:"project-operation-menu-item-icon"}),an.jsx("div",{className:"project-operation-menu-item-text",children:a.t("Delete Project")})]},"delete")]}),placement:"bottomLeft",children:an.jsx("div",{className:"project-operation-menu-trigger"})})},kN=({center:e=!1})=>{const t=$(),n=Ex(e=>e.mobile),i=GE(e=>e.paymentReminderNotification),a=GE(e=>e.fetchPaymentUserNotifications),[o,s]=A.useState({visible:!1,icon:"icon-line-star-02",text:"",onClose:void 0}),r=A.useCallback(()=>j(void 0,null,function*(){if(null==i?void 0:i.type)try{const{data:{code:e}}=yield BS([null==i?void 0:i.type]);e||a()}catch(e){}}),[a,null==i?void 0:i.type]);return A.useEffect(()=>{i&&!o.visible?s({visible:Boolean(i),icon:"icon-line-star-02",text:t.t(n?"{{number}} days":"Your Plus subscription will end in {{number}} days. Renew soon!",{number:Q(1e3*Number(i.detail.subscription_expired_at)).diff(Q(),"days")+1}),onClose:r}):!i&&o.visible&&s({visible:!1,icon:"icon-line-star-02",text:"",onClose:void 0})},[t,n,r,i,o.visible]),o.visible&&an.jsxs("div",{className:Y("qwen-chat-nav-bar-warning-info",{"qwen-chat-nav-bar-warning-info-center":e}),children:[an.jsx(pt,{type:o.icon,className:"qwen-chat-nav-bar-warning-info-icon"}),an.jsx("div",{className:"qwen-chat-nav-bar-warning-info-text",children:o.text}),o.onClose&&an.jsx("div",{className:"qwen-chat-nav-bar-warning-info-close",onClick:o.onClose,children:an.jsx(pt,{type:"icon-line-x-02",className:"qwen-chat-nav-bar-warning-info-icon"})})]})},IN=()=>{const e=$(),t=Ex(e=>e.mobile),n=Sx(e=>e.temporaryChatEnabled);return an.jsx(vt,{title:e.t("Temporary Chat"),show:!t,placement:"bottomLeft",children:an.jsxs(X,{align:"center",justify:"center",className:"temporary-chat-entry "+(n&&!t?"temporary-chat-entry-out":""),onClick:()=>j(void 0,null,function*(){yield kT.updateTemporaryChat(!n)}),children:[an.jsx(pt,{type:n?"icon-line-privateon-chat-01":"icon-line-private-chat-01",className:n&&!t?"temporary-chat-entry-out-icon":"temporary-chat-entry-icon"}),n&&!t&&an.jsxs(an.Fragment,{children:[an.jsx("span",{className:"temporary-chat-entry-text",children:e.t("Temporary Chat")}),an.jsx(pt,{type:"icon-line-x-02",className:"temporary-chat-entry-out-close"})]})]})})},TN=()=>{const e=HE(_j(e=>e.user)),t=ky(),{pathname:n}=ky(),{getProjectFilesList:i}=vN(),a=Ty(),[o,s]=z.useState(!1),r=DT(e=>e.setShowEditModal),l=DT(e=>e.projectInfo),c=DT(e=>e.setOperationProject),u=DT(e=>e.setShowDeleteConfirm),d=zE(e=>e.setActiveChatMenuId),h=zE(e=>e.activeChatMenuId),p=vx(e=>e.projectId),m=A.useCallback(()=>j(void 0,null,function*(){s(!1),(yield i(l.id))&&(yield c(JSON.parse(JSON.stringify(l))),r(!0))}),[i,l,c,r]),f=A.useCallback(()=>{s(!1),c(JSON.parse(JSON.stringify(l))),u(!0)},[l,c,u]),g=A.useMemo(()=>e&&n.includes("/p/")?an.jsxs("div",{className:"herder-project-edit-btn",children:[an.jsx("div",{onClick:e=>{e.stopPropagation(),s(!0),h&&d("")},children:an.jsx(pt,{type:"icon-line-more-01",className:"chat-item-drag-web-default-btn-icon"})}),o&&an.jsx(EN,{show:o,onClose:()=>{s(!1)},editHandler:m,deleteHandler:f})]}):e&&p&&""!==p?an.jsx(CN,{isShow:!0,chatProjectId:p||""}):e?e&&"/"===t.pathname?an.jsx(IN,{}):!e||p||n.includes("/p/")?null:an.jsx(an.Fragment,{children:an.jsx(mN,{})}):an.jsxs(X,{gap:16,children:[an.jsx(mN,{}),an.jsx(Ij,{rounded:"circle"})]}),[h,f,m,t.pathname,n,p,d,o,e]),v=A.useMemo(()=>e&&p&&""!==p?an.jsx(pt,{type:"icon-line-chevron-left",onClick:()=>{a(`/p/${p}`)},className:"header-left-project-back"}):e&&!p?an.jsx(fN,{}):void 0,[a,p,e]);return an.jsx("header",{className:"header-mobile",children:an.jsxs("div",{className:"header-content",children:[an.jsxs("div",{className:"header-left",children:[v,an.jsx(hN,{})]}),an.jsxs("div",{className:"header-right",children:[an.jsx(kN,{}),g]})]})})},jN=()=>{const{getProjectFilesList:e}=vN(),t=HE(_j(e=>e.user)),[n,i]=z.useState(!1),a=DT(e=>e.setShowEditModal),o=DT(e=>e.projectInfo),s=DT(e=>e.setOperationProject),r=DT(e=>e.setShowDeleteConfirm),{pathname:l}=ky(),c=DT(e=>e.projectName),u=DT(e=>e.setProjectName),d=DT(e=>e.projectIcon),h=DT(e=>e.setProjectIcon),p=EI(e=>e.selectedModelIds),m=Ty(),f=vx(e=>e.projectId),g=DT(e=>e.projectChats),v=Sx(e=>e.temporaryChatEnabled),y=zE(e=>e.showHeaderBorder),b=vx(e=>e.chatId);A.useEffect(()=>{var e;f&&(e=f,j(void 0,null,function*(){const t=yield NS(e);t.success&&(u(t.data.name),h(t.data.icon))}))},[f,h,u]);A.useMemo(()=>location.pathname.includes("/p/")&&g.length>0,[g]);const x=d?bN(d):{icon:"icon-line-folder-01",style:""};return an.jsx("header",{className:Y("header-desktop",{"header-desktop-border":y&&"/"!==location.pathname}),children:an.jsxs("div",{className:"header-content",id:"qwen-chat-header-content",children:[an.jsxs("div",{className:"header-left",id:"qwen-chat-header-left",children:[f&&""!==f&&an.jsxs("div",{className:"herder-project",onClick:()=>{m(`/p/${f}`)},children:[d?x.icon.includes("icon-")?an.jsx(pt,{type:x.icon,className:`herder-project-icon ${x.style}`}):an.jsx("div",{className:"herder-project-icon",children:x.icon}):an.jsx(pt,{type:"icon-line-folder-01",className:`herder-project-icon ${x.style}`}),an.jsx("div",{className:"project-name",children:c})]}),f&&""!==f&&an.jsx(pt,{type:"icon-line-Slash",className:"herder-project-piont"}),!t&&an.jsx(mN,{}),an.jsx(hN,{})]}),an.jsx(kN,{center:p.length<=1}),an.jsx("div",{className:"header-right",id:"qwen-chat-header-right",children:l.includes("/p/")?an.jsxs("div",{className:"herder-project-edit-btn",children:[an.jsx("div",{onClick:e=>{e.stopPropagation(),i(!0)},children:an.jsx(pt,{type:"icon-line-more-01",className:"chat-item-drag-web-default-btn-icon"})}),n&&an.jsx(EN,{show:n,onClose:()=>{i(!1)},editHandler:()=>j(void 0,null,function*(){yield i(!1),(yield e(o.id))&&(yield s(JSON.parse(JSON.stringify(o))),a(!0))}),deleteHandler:()=>{i(!1),s(JSON.parse(JSON.stringify(o))),r(!0)}})]}):an.jsxs(an.Fragment,{children:[an.jsx(CN,{chatProjectId:f||""}),t?!b||v?an.jsx(IN,{}):null:an.jsx(Ij,{showRegister:!0,size:"small",rounded:"circle",buttonClass:"header-right-auth-button"})]})})]})})},NN=["icon-line-folder-01","icon-line-Investing","icon-line-lightbulb-03","icon-image-icon","icon-line-video-01","icon-line-audio","icon-line-star-02","icon-line-rename-01","icon-line-Travel","icon-line-globe-07","icon-line-deepresearch-02","icon-line-Wallet","icon-line-like-unselected","icon-line-Exercise","icon-line-Food-02","icon-line-coffee","icon-line-markdown","icon-line-Plants","icon-line-cat","icon-line-dog","icon-line-Transportation-02","icon-line-book-02","icon-line-Vacation","icon-line-calendar","icon-line-computer","icon-line-Volume","icon-line-Data","icon-line-email-01"],PN=["character-primary-text","red-500","yellow-400","green-600","blue-500","violet-500","electricviolet-500"],MN=({icon:e=NN[0],style:t=PN[0],onIconChange:n=()=>{},onIconClose:i=()=>{}})=>{const{t:a}=$(),o=Ex(e=>e.mobile),[s,r]=A.useState(()=>e.startsWith("icon-")||!e?"icon":"emoji"),[l,c]=A.useState(e),[u,d]=A.useState(PN.find(e=>e===t)||PN[0]);A.useEffect(()=>{c(e),d(PN.find(e=>e===t)||PN[0]),r(e.startsWith("icon-")||!e?"icon":"emoji")},[e,t]);const h=e=>{const t={icon:e,style:u};t.style="emoji"===s?"":u,c(e),d(t.style),n(t)};return an.jsxs("div",{className:"project-icon-picker",children:[an.jsxs("div",{className:"project-icon-picker-tab",children:[[{key:"icon",label:"Icon"},{key:"emoji",label:"Emoji"}].map(e=>an.jsx("div",{className:"project-icon-picker-tab-item "+(e.key===s?"active":""),onClick:()=>(e=>{r(e)})(e.key),children:a(e.label)},e.key)),o&&an.jsx("div",{className:"project-icon-picker-close",onClick:i,children:an.jsx(pt,{type:"icon-line-x-01",className:"project-icon-picker-close-icon"})})]}),o&&an.jsx("div",{className:"project-icon-picker-icon",children:l.startsWith("icon-")?an.jsx(pt,{type:l,className:`${u} `}):l||an.jsx(pt,{type:"icon-line-folder-01",className:"character-primary-text"})}),an.jsx("div",{className:"project-icon-picker-icons",children:"icon"===s?an.jsx(an.Fragment,{children:NN.map(e=>an.jsx("div",{className:`project-icon-picker-icons-item ${o?"":u} ${l===e?"active":""}`,onClick:()=>h(e),children:an.jsx(pt,{type:e})},e))}):"emoji"===s?an.jsx(an.Fragment,{children:(navigator.userAgent.includes("Windows")?_v:wv).map(e=>an.jsx("div",{className:"project-icon-picker-icons-item project-icon-picker-icons-emoji "+(l===e?"active":""),onClick:()=>h(e),children:e},e))}):null}),"icon"===s&&an.jsxs(an.Fragment,{children:[an.jsx("div",{className:"project-icon-picker-divider"}),an.jsx("div",{className:"project-icon-picker-style icon",children:PN.map(e=>an.jsx("div",{className:`project-icon-picker-style-color ${e} ${e===u?"active":""}`,onClick:()=>d(e),children:e===u&&an.jsx("div",{className:`project-icon-picker-style-color-circle ${e}`})},e))})]})]})},AN=({data:e,setData:t,isProjectDetail:n})=>{const{t:i}=$(),a=Ex(e=>e.mobile),[o,s]=A.useState(!1),[r,l]=A.useState(""),[c,u]=A.useState({icon:"",style:""});A.useEffect(()=>{u(bN(null==e?void 0:e.icon))},[null==e?void 0:e.icon]);const d=n=>{let i=`icon=${n.icon}`;if(n.style&&(i+=`&style=${n.style}`),!a)return t(_(w({},e),{icon:i})),u(bN(i)),void s(!1);l(i)},h=()=>an.jsx("div",{className:"project-new-name-edit-icon-picker-popover",children:an.jsx(MN,{icon:c.icon,style:c.style,onIconChange:d})}),p=()=>{var t;return an.jsx("div",{className:"project-new-name-edit-icon "+(n?"project-new-name-edit-project":""),onClick:()=>{s(!0)},children:!(null==e?void 0:e.icon)||(null==(t=c.icon)?void 0:t.startsWith("icon-"))?an.jsx(pt,{type:c.icon||"icon-line-plus-01",className:`project-new-name-edit-icon-default ${c.style}`}):an.jsx("div",{className:"project-new-name-edit-emoji",children:Sv[c.icon]})})};return a?an.jsxs(an.Fragment,{children:[an.jsx(gt,{open:o,onClose:()=>{s(!1)},push:!1,heightType:"full",className:"project-new-name-edit-icon-mobile-container",children:an.jsxs("div",{className:"project-new-name-edit-icon-mobile",children:[an.jsx(MN,{icon:c.icon,style:c.style,onIconChange:d,onIconClose:()=>{s(!1)}}),an.jsx(ft,{type:"brandprimary",rounded:"circle",buttonClass:"project-new-name-edit-icon-done",size:"large",onClick:()=>{t(_(w({},e),{icon:r})),u(bN(r)),s(!1)},children:i("Done")})]})}),p()]}):an.jsx(ne,{open:o,arrow:!1,onOpenChange:e=>s(e),content:h,trigger:["click"],placement:"bottomLeft",classNames:{root:"project-icon-trigger-popover-shell "},children:p()})},ON=({data:e,setData:t})=>{const{i18n:n}=$(),[i,a]=A.useState(e.name||""),[o,s]=A.useState([]),r=zE(e=>e.language),l=DT(e=>e.setProjectSettingOpen),c=A.useMemo(()=>r||n.language,[n.language,r]),u=A.useCallback(()=>j(void 0,null,function*(){const e=yield j(void 0,null,function*(){return yield ow("/configs/?code=projectTitle")});if(e.success){const{language:t,projectIcon:n,projectInstruction:i,projectTitle:a}=e.data,o=n.map((e,n)=>{const o=a[n],s=i[n];return{icon:`icon=${e}&style=${PN[0]}`,title:t[c][o],instruction:t[c][s]}});s(o)}}),[c]);A.useEffect(()=>{u()},[u]);return A.useEffect(()=>{a(e.name||"")},[e]),an.jsxs("div",{className:"project-new-name",children:[an.jsxs("div",{className:"project-new-name-edit",children:[an.jsx(AN,{data:e,setData:t}),an.jsx(_t,{className:"project-new-name-edit-input",value:i,onChange:n=>{a(n),t(_(w({},e),{name:n}))},placeholder:n.t("Project Name"),maxLength:150})]}),an.jsx("div",{className:"project-new-name-examples",children:o.map((n,i)=>an.jsx(ft,{iconFontType:bN(n.icon).icon,type:"ghost",shape:"circle",onClick:()=>{return i=n,l(!0),a(i.title),void t(_(w({},e),{icon:i.icon,name:i.title,custom_instruction:i.instruction}));var i},children:n.title},i))})]})},RN=({value:e="",items:t=[{label:"",value:"default",info:""}],onChange:n,disabled:i})=>{const[a,o]=A.useState(!1),s=$(),r=A.useRef(null);return an.jsx("div",{className:"project-memory-select-container "+(i?"project-memory-select-containe-disabled":""),onClick:()=>{i||o(!a)},children:an.jsx(vt,{title:i?s.t("Memory settings cannot be changed later."):"",children:an.jsx(ie,{ref:r,open:a,value:e,disabled:i,onChange:e=>{null==n||n(e),o(!1)},className:"project-memory-selector",popupMatchSelectWidth:!1,placement:"bottomRight",suffixIcon:an.jsx(pt,{type:a?"icon-line-chevron-up":"icon-line-chevron-down",className:"project-memory-selector-arrow"}),optionRender:t=>an.jsxs("div",{className:"project-memory-selector-item",children:[an.jsxs("div",{className:"project-memory-selector-item-text",children:[an.jsx("div",{className:"project-memory-selector-item-name",children:t.data.label}),an.jsx("div",{className:"project-memory-selector-item-info",children:t.data.info})]}),e===t.data.value&&an.jsx(pt,{type:"icon-line-check-02",className:"project-memory-selector-item-checked"})]}),options:t})})})},DN=({data:e,setData:t})=>{const{i18n:n}=$(),i=Ex(e=>e.mobile);A.useEffect(()=>{e.memory_span||t(_(w({},e),{memory_span:"default"}))},[e,t]);const a=A.useMemo(()=>[{value:"default",label:n.t("Default"),info:n.t("Chats will access and contribute to your account-wide memories.")},{value:"project_only",label:n.t("Project-only"),info:n.t("Memories are isolated to this project and won't affect your main account.")}],[n]);return an.jsxs("div",{className:"project-memory-container",children:[an.jsxs("div",{className:"project-memory-info",children:[an.jsx("div",{className:"project-memory-info-text",children:n.t("Memory")}),!i&&an.jsx(vt,{title:n.t("Choose whether this project has its own isolated memory or shares context with your global memory."),children:an.jsx(pt,{type:"icon-line-information-circle",className:"project-memory-info-tooltip"})})]}),i?an.jsx("div",{className:"project-memory-select-mobile",children:a.map(n=>an.jsxs("div",{className:"project-memory-select-mobile-item "+(e.id?"project-memory-select-mobile-item-disabled":""),onClick:()=>{e.id||t(_(w({},e),{memory_span:n.value}))},children:[an.jsxs("div",{className:"project-memory-selector-mobile-item-text",children:[an.jsx("div",{className:"project-memory-selector-mobile-item-name",children:n.label}),an.jsx("div",{className:"project-memory-selector-mobile-item-info",children:n.info})]}),e.memory_span===n.value&&an.jsx(pt,{type:"icon-line-check-02",className:"project-memory-selector-mobile-item-checked"})]},n.value))}):an.jsx(RN,{disabled:!!e.id,items:a,value:e.memory_span,onChange:n=>{t(_(w({},e),{memory_span:n}))}})]})},LN=({title:e,tooltip:t="",props:n})=>{const i=Ex(e=>e.mobile);return an.jsxs("div",{className:"project-instruction-container",children:[an.jsxs("div",{className:"project-instruction-label",children:[e&&an.jsx("div",{className:"project-instruction-label-text",children:e}),t&&!i&&an.jsx(vt,{title:t,children:an.jsx(pt,{type:"icon-line-information-circle",className:"project-instruction-label-tooltip"})})]}),an.jsx("div",{className:"project-instruction-textarea",children:an.jsx(St,w({},n))})]})},FN=({file:e,actions:t=["delete"],onReUpload:n,onDownload:i,onDelete:a,isMobileProjectDetail:o})=>{var s,r,l;const[c,u]=A.useState(!1),d=Ex(e=>e.mobile),{i18n:h}=$(),p={download:{icon:"icon-download",text:"Download"},delete:{icon:"icon-line-trash-01",text:"Delete"}},m=A.useMemo(()=>{var t,n;const i=(null==(t=e.name)?void 0:t.lastIndexOf("."))||-1;return(null==(n=null==e?void 0:e.name)?void 0:n.slice(i+1))||""},[e.name]),f=(()=>{var t,n,i,a,o,s,r,l,c;const u=Ug[e.file_type||e.type]||Ug.others;let d=u.bg,h=u.icon;if(Mg.includes(m)&&(h="icon-playground",d="#3F3F47"),null==(i=null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)switch(null==(s=null==(o=null==(a=null==e?void 0:e.file)?void 0:a.meta)?void 0:o.parse_meta)?void 0:s.parse_status){case"success":return{icon:h,bg:d};case"failed":return(null==(c=null==(l=null==(r=null==e?void 0:e.file)?void 0:r.meta)?void 0:l.parse_meta)?void 0:c.retry)?{icon:"icon-regenerate",bg:d}:u;case"running":return{icon:"icon-loading-icon",bg:d};default:return""}switch(e.uploadStatus){case"success":return{icon:h,bg:d};case"uploading":default:return{icon:"icon-loading-icon",bg:d};case"error":return{icon:"icon-regenerate",bg:d}}})(),g=A.useMemo(()=>{var t,n,i,a,o,s,r,l;if(null==(i=null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)switch(null==(s=null==(o=null==(a=null==e?void 0:e.file)?void 0:a.meta)?void 0:o.parse_meta)?void 0:s.parse_status){case"success":default:return"parsed";case"failed":return"parsed_error";case"running":return"parsing"}switch(e.uploadStatus){case"success":return(null==(l=null==(r=null==e?void 0:e.file)?void 0:r.meta)?void 0:l.parse_meta)?"success":"parsed";case"uploading":return"uploading";case"error":return"error";default:return"success"}},[e.uploadStatus,null==(l=null==(r=null==(s=e.file)?void 0:s.meta)?void 0:r.parse_meta)?void 0:l.parse_status]),v=t=>{switch(t){case"download":i(e);break;case"delete":a(e)}},y=A.useMemo(()=>"green_error"===e.greenNet,[e.greenNet]);return an.jsxs("div",{className:Y("project-file-card",{"project-file-card-greening":y}),children:[an.jsxs("div",{className:"project-file-card-left",children:[an.jsx("div",{className:"project-file-card-left-icon",onClick:()=>{"error"===e.uploadStatus&&n(e)},style:y?{}:{backgroundColor:f.bg},children:y?an.jsx(pt,{type:"icon-line-file-none",className:"fileitem-icon"}):an.jsx(pt,{type:f.icon,className:e.uploadStatus})}),an.jsxs("div",{className:"project-file-card-left-info",children:[an.jsx("div",{className:"project-file-card-left-info-name",children:an.jsx("div",{className:"project-file-card-left-info-text",children:e.name})}),an.jsx("div",{className:"project-file-card-left-info-size",children:an.jsxs("div",{className:"project-file-card-left-info-text",children:[an.jsx("span",{children:((e,t=1)=>{if(0===e)return"0 B";const n=["B","K","M"],i=Math.floor(Math.log(e)/Math.log(1024)),a=n[Math.min(i,n.length-1)];return`${(e/Math.pow(1024,i)).toFixed(t)}${a}`})(e.size)}),"parsing"===g&&an.jsx("span",{children:h.t("Parsing...")}),"parsed_error"===g&&!y&&an.jsx("span",{className:"project-file-error",children:h.t("Parsing failed")}),"error"===g&&!y&&an.jsx("span",{className:"project-file-error",children:h.t("Upload failed")}),y&&an.jsx("span",{className:"fileitem-file-error",children:h.t("Invalid File")})]})})]})]}),an.jsx("div",{className:"project-file-card-right",children:an.jsx("div",{className:"project-file-card-right-actions",children:d&&o?an.jsx(ee,{open:c,onOpenChange:e=>{e||u(!1)},trigger:["click"],popupRender:()=>an.jsx(J,{mode:"inline",className:"project-file-operation-menu-content",children:t.map(e=>"download"===e&&"parsed"===g||"delete"===e?an.jsxs(J.Item,{className:"project-file-operation-menu-item "+("delete"===e?"project-file-item-delete":""),onClick:()=>v(e),children:[an.jsx("div",{className:"project-file-operation-menu-item-text",children:h.t(p[e].text)}),an.jsx(pt,{className:"project-file-operation-menu-item-icon",type:p[e].icon})]},e):null)}),placement:"bottomLeft",children:an.jsx("div",{onClick:()=>{u(!0)},children:an.jsx(pt,{type:"icon-line-more-01",className:"project-file-card-right-actions-icon "})})}):an.jsx(an.Fragment,{children:t.map(e=>"download"===e&&"parsed"===g||"delete"===e?an.jsx("div",{className:"project-file-card-right-actions-icon",onClick:()=>v(e),children:an.jsx(pt,{type:p[e].icon})},e):null)})})})]})},zN=({files:e=[],actions:t=["delete"],onReUpload:n,onDownload:i,onDelete:a,isMobileProjectDetail:o})=>{const s=DT(e=>e.deleteFiles),r=e.filter(e=>!s.includes(e.file_id||e.itemId));return an.jsx(an.Fragment,{children:r.length?an.jsx("div",{className:"project-file-list",children:r.map(e=>an.jsx(FN,{file:e,actions:t,onReUpload:n,onDownload:i,onDelete:a,isMobileProjectDetail:o},e.file_id||e.itemId))}):null})},UN=B();class HN{constructor(e){if(C(this,"input"),C(this,"options"),this.input=e,!this.input)throw new Error(" input ");this.input.addEventListener("change",this.handleFileSelect.bind(this)),this.input.addEventListener("error",this.handleError)}setInputAcceptAttribute(){var e,t;const n=null==(t=null==(e=this.options)?void 0:e.acceptedTypes)?void 0:t.join(","),i="image/*"===n?"image":"file";Dx()&&"file"===i?this.input.removeAttribute("accept"):(this.input.setAttribute("accept",n||""),this.input.setAttribute("data-type",i))}handleError(){}updateOptions(e){this.options=e,this.setInputAcceptAttribute()}triggerUpload(){this.input.click()}handleFileSelect(e){var t,n;const i=null==(t=e.target)?void 0:t.files,a=Array.from(i||[]);0!==a.length&&(null==(n=this.options)||n.callBack(a),this.input.value="")}static validateFile(e,t){var n,i,a;if(!e)throw new Error("");let o=e;"md"===(null==(a=null==(i=null==(n=null==e?void 0:e.name)?void 0:n.split("."))?void 0:i.at(-1))?void 0:a.toLowerCase())&&""===e.type&&(o=new File([e],e.name,{type:"text/markdown"}));const{maxSize:s=0,acceptType:r="*"}=t||{};if(s){const e=o.size<=s,t=UN.t("File size should not exceed {{maxSize}} MB.",{maxSize:s/1024/1024});if(!e)throw tE.openOnce({type:"error",message:t}),new Error(t)}const l=e.type,c=l.startsWith("image/")?"image":l.startsWith("video/")?"video":l.startsWith("audio/")?"audio":"file";if("file"===r)if(["image","video","audio"].includes(c))throw new Error(` ${e.type}  ${r} `);return o}clearSelectedFiles(){this.input.value=""}destroy(){this.input.removeEventListener("change",this.handleFileSelect),this.input.removeEventListener("error",this.handleError)}}const BN=({styles:e,ref:t})=>{var n,i,a;const o=GE(e=>e.subscriptionPlus),s=Ex(e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_payment_and_quota}),r=GE(e=>e.setShowSubscriptionDetail),l=HE(e=>e.user),c=Ex(e=>e.mobile),u=Ex(e=>e.config),d=DT(e=>e.operationProjectFiles),h=DT(e=>e.setOperationProjectFiles),p=DT(e=>e.deleteFiles),m=A.useRef(null),f=A.useRef(null),{i18n:g}=$(),v=A.useMemo(()=>new RE({onAddProcess:(e,t)=>{if(t){const e=_(w({},t),{uploadStatus:"uploading"}),n=DT.getState().operationProjectFiles;h([jt(_(w({},e),{uploadStatus:"uploading"})),...n.filter(t=>t.itemId!==e.itemId)])}},onAddSuccess:(e,t)=>{var n,i,a;const o=_(w({},t),{uploadStatus:"success"}),s=DT.getState().operationProjectFiles;e.length&&e.some(e=>e.itemId===t.itemId)&&!p.includes(o.itemId)&&(h([jt(o),...s.filter(e=>e.itemId!==o.itemId)]),dS("uploadedFileData",{params:{et:"OTHER",c1:null==(n=null==t?void 0:t.file)?void 0:n.user_id,c4:null==t?void 0:t.id,c5:null==t?void 0:t.name,c6:t.file_type,c7:(null==(i=null==t?void 0:t.file)?void 0:i.meta)?JSON.stringify(null==(a=null==t?void 0:t.file)?void 0:a.meta):"",c8:t.status}}))},onAddFail:(e,t)=>{if(t){const e=_(w({},t),{uploadStatus:"uploading"===t.status?"uploading":"error"}),n=DT.getState().operationProjectFiles;h([jt(e),...n.filter(t=>t.itemId!==e.itemId)])}dS("uploadedFileErr",{params:{et:"OTHER"}})},onPaseSuccess:(e,t)=>{const n=_(w({},t),{uploadStatus:"success"}),i=DT.getState().operationProjectFiles;e.length&&e.some(e=>e.itemId===t.itemId)&&!p.includes(n.itemId)&&h([jt(n),...i.filter(e=>e.itemId!==n.itemId)])},onPaseFail:(e,t)=>{if(t){const e=_(w({},t),{uploadStatus:"uploading"===t.status?"uploading":"error"}),n=DT.getState().operationProjectFiles;h([jt(e),...n.filter(t=>t.itemId!==e.itemId)])}},userId:null==l?void 0:l.id,parsedFileTypes:[Fg.FILE]}),[p,h,null==l?void 0:l.id]);A.useEffect(()=>{t&&(t.current=v)},[t,v]);A.useEffect(()=>{var e;const t=null==(e=null==u?void 0:u.features)?void 0:e.limits;t&&v.updateLimitRules(OE(t))},[v,null==(n=null==u?void 0:u.features)?void 0:n.limits]),A.useEffect(()=>{m.current&&(f.current=new HN(m.current))},[]);const y=A.useMemo(()=>{var e,t,n;return(null==(n=null==(t=null==(e=null==u?void 0:u.features)?void 0:e.limits)?void 0:t.project)?void 0:n.project_file_max_count)||5},[null==(i=null==u?void 0:u.features)?void 0:i.limits]),b=A.useMemo(()=>{var e,t,n;return(null==(n=null==(t=null==(e=null==u?void 0:u.features)?void 0:e.limits)?void 0:t.project)?void 0:n.project_max_count)||20},[null==(a=null==u?void 0:u.features)?void 0:a.limits]),x=A.useMemo(()=>s&&o?b:y,[s,y,b,o]),S=A.useMemo(()=>{if(!x)return!0;return DT.getState().operationProjectFiles.length-p.length>=x},[d.length,p.length,x]),C=A.useMemo(()=>s?o?g.t(S?"File limit reached. Maximum {{number}} files allowed.":"Upload up to {{number}} files.",{number:b}):an.jsx(q,{i18nKey:S?"File limit reached. {{upgrade}} to increase your limit to {{filesNumber}} files.":"Free plan includes {{fileNumber}} files. {{upgrade}} to add up to {{filesNumber}} files.",values:{fileNumber:y,filesNumber:b,upgrade:"<a />"},components:{a:an.jsx("span",{className:"qwen-chat-project-file-list-tooltip-enable-link",onClick:()=>{r(!0)},children:g.t("Upgrade to plus")})}}):g.t(S?"File limit reached. Maximum {{number}} files allowed.":"Upload up to {{number}} files.",{number:x}),[s,S,g,x,o,y,b,r]);return A.useEffect(()=>{v.updateLimitRules(At(jt(zg),{[Lg.DOC]:{max_count:x}}))},[x,v]),an.jsxs(an.Fragment,{children:[an.jsx(vt,{show:Boolean(C),rootClassName:"qwen-chat-project-file-list-tooltip",title:C,children:an.jsx(ft,{type:"tertiary",rounded:"circle",buttonClass:"project-file-list-add",disabled:S,size:"small",onClick:()=>{return e="document",j(void 0,null,function*(){var t,n;null==(t=f.current)||t.updateOptions({acceptedTypes:lC(e),type:e,callBack:t=>{const n=d.length-p.length,i=o?b:y;if(n+t.length>i){const a=t.slice(0,i-n);return tE.open({type:"error",content:g.t("In a single-turn conversation, up to {{number}} documents can be uploaded.",{number:i})}),void v.addFiles(a,e)}v.addFiles(t,e)}}),null==(n=f.current)||n.triggerUpload()});var e},buttonStyle:w({},e),children:g.t("Add Files")})}),an.jsx("input",{ref:m,type:"file",id:"filesUpload",multiple:!c,style:{display:"none"}})]})},$N=({data:e,setData:t})=>{const{i18n:n}=$(),i=Ex(e=>e.mobile),a=DT(e=>e.projectSettingOpen),o=DT(e=>e.setProjectSettingOpen),s=DT(e=>e.operationProjectFiles),r=DT(e=>e.deleteFiles),l=DT(e=>e.setDeleteFiles),c=A.useRef(null),u=e=>{var t;null==(t=null==c?void 0:c.current)||t.removeFile(e),l([...r,e.file_id||e.itemId])},d=e=>{u(e)};return A.useEffect(()=>{kT.on(uE.FILE_PASE_REMOVE,d)},[]),an.jsxs("div",{className:"advanced-settings-container",children:[an.jsxs("div",{className:"advanced-settings-title",onClick:()=>{o(!a)},children:[an.jsx("div",{className:"advanced-settings-title-text",children:n.t("Advanced Settings")}),an.jsx(pt,{type:a?"icon-line-chevron-down":"icon-line-chevron-right",className:"advanced-settings-title-icon"})]}),a&&an.jsxs("div",{className:"advanced-settings-content",children:[an.jsx(DN,{data:e,setData:t}),an.jsx(LN,{title:n.t("Instructions"),tooltip:`${n.t("Define the specific role, tone, and response format you expect Qwen Chat to follow for this project.")}`,props:{value:e.custom_instruction||"",onChange:n=>{t(_(w({},e),{custom_instruction:n}))},minRows:2,maxRows:10,maxLength:1e3,placeholder:n.t("What should the AI know about this project? (e.g., specific rules, tone, or formatting)")}}),an.jsxs("div",{className:"project-file-list-container",children:[an.jsxs("div",{className:"project-file-list-title",children:[an.jsxs("div",{className:"project-file-list-info",children:[an.jsx("div",{className:"project-file-list-info-text",children:n.t("Files")}),!i&&an.jsx(vt,{title:n.t("Upload documents, images, or code to serve as a knowledge base for Qwen Chat within this project."),children:an.jsx(pt,{type:"icon-line-information-circle",className:"project-file-list-info-tooltip"})})]}),an.jsx(BN,{ref:c})]}),an.jsx(zN,{files:s,actions:["delete"],onReUpload:e=>j(void 0,null,function*(){var t,n,i,a;e&&"failed"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)?null==(a=null==c?void 0:c.current)||a.startParse(e,!0):e&&e.uploadTaskId&&(yield ME.resumeUpload(e.uploadTaskId))}),onDownload:e=>{},onDelete:u})]})]})]})},qN=e=>j(void 0,null,function*(){const t=DT.getState().projectInfo,n=DT.getState().setProjectInfo;if(e)try{const{data:i,success:a}=yield IS(e);if(!a)return void i.code;if(!(null==i?void 0:i.files)||!Array.isArray(i.files))return;const o=i.files.map(e=>_(w({},e),{uploadStatus:"success"}));n(_(w({},t),{fileLength:o.length}))}catch(i){}}),GN=({editData:e,onCancel:t,operationProjectRef:n})=>{const{t:i}=$(),{getNewProjectList:a,extractProjectId:o}=vN(),{getChatListData:s,getPinnedChatListData:r}=yN(),l=Ex(e=>e.mobile),c=DT(e=>e.deleteFiles),u=DT(e=>e.moveNewProjectId),d=DT(e=>e.operationProjectFiles),h=DT(e=>e.setProjectInfo),p=DT(e=>e.projectSettingOpen),m=DT(e=>e.setProjectSettingOpen),f=DT(e=>e.showEditModal);DT(e=>e.setShowEditModal);const g=DT(e=>e.setProjectIcon),v=DT(e=>e.setProjectName),y=DT(e=>e.chatProjectId),b=bx(e=>e.setPinnedChats),[x,S]=A.useState(e),[C,E]=A.useState(!1),k=Ty(),I=A.useRef(!1);A.useEffect(()=>{S(e)},[e]),A.useEffect(()=>{n&&(n.current=x)},[x,n]);const T=A.useMemo(()=>d.filter(e=>!c.includes(e.itemId)).some(e=>{var t,n,i;return"uploading"===e.status||"running"===(null==(i=null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)}),[c,d]),N=()=>j(void 0,null,function*(){if(I.current)return;I.current=!0;const e=_(w({},x),{memory_span:x.memory_span||"default",icon:(null==x?void 0:x.icon)?null==x?void 0:x.icon:"icon=icon-line-folder-01&style=character-primary-text"});d.length&&p?e.files=d.filter(e=>!e.file_id&&"success"===e.uploadStatus&&"success"===e.greenNet).filter(e=>!c.includes(e.itemId)):e.files=[];const n=yield(o=w({},e),j(void 0,null,function*(){return yield ow("/projects/",{method:"POST",data:o})}));var o;if(n.success){const{data:e}=n;if(u){const n=yield jS(e.id,[u]).catch(e=>(ht.open({type:"error",content:i(e.message)}),I.current=!1,null));if(n.success){if(s(1),a(),OC(),AC(),!l){const e=yield r();Array.isArray(e)&&b(e)}return t("createHandle"),void k(`/p/${e.id}`)}"Not_Found"===(null==n?void 0:n.data.code)&&a()}a(),t("createHandle"),k(`/p/${e.id}`)}I.current=!1}),P=()=>j(void 0,null,function*(){if(I.current)return;const e=d.filter(e=>{var t,n,i,a,o;return!e.file_id&&("success"===e.uploadStatus&&!(null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)||"success"===(null==(o=null==(a=null==(i=null==e?void 0:e.file)?void 0:i.meta)?void 0:a.parse_meta)?void 0:o.parse_status)||"success"===e.uploadStatus&&"success"===e.greenNet)}).filter(e=>!c.includes(e.itemId));I.current=!0;if((yield kS(_(w({},x),{add_files:e,delete_files:c}),x.id)).success){if(I.current=!1,location.pathname.includes("/p/")){const e=o(location.pathname);h(w({},x)),x.id===e&&qN(x.id)}y===x.id&&(v(x.name),g(x.icon)),a(),t("updateHandle")}I.current=!1});A.useEffect(()=>{E(!(null==x?void 0:x.name)||!(null==x?void 0:x.name.trim()))},[null==x?void 0:x.custom_instruction,null==x?void 0:x.name,c.length,d.length,p]),A.useEffect(()=>{if(x.id){const e=d.length-c.length>0;(x.custom_instruction||e)&&f&&m(!0)}},[x,c.length,d.length,m,f]),A.useEffect(()=>{x.id||m(!1)},[x.id]);return l&&f?an.jsx(gt,{open:f,onClose:()=>{t()},push:!1,heightType:"full",className:"project-edit-modal-menu-container",children:an.jsxs("div",{className:"project-edit-modal-menu-box",children:[an.jsxs("div",{className:"project-edit-modal-menu-header",children:[an.jsx("div",{className:"project-edit-modal-menu-header-text",children:i((null==x?void 0:x.id)?"Edit project":"New Project")}),an.jsx("div",{className:"project-edit-modal-menu-header-close",onClick:()=>{t()},children:an.jsx(pt,{type:"icon-line-x-01",className:"project-edit-modal-menu-header-icon"})})]}),an.jsxs("div",{className:"project-edit-modal-menu-content",children:[an.jsx(ON,{data:x,setData:S}),an.jsx($N,{data:x,setData:S})]}),an.jsx("div",{className:"project-edit-modal-menu-buttons",children:x.id?an.jsxs(an.Fragment,{children:[an.jsx(ft,{type:"tertiary",rounded:"circle",buttonClass:"project-edit-modal-menu-button-cancel",size:"large",onClick:()=>{t()},children:i("Cancel")}),an.jsx(ft,{type:"brandprimary",rounded:"circle",buttonClass:"project-edit-modal-menu-button-save",size:"large",disabled:C,onClick:P,children:i("Save")})]}):an.jsx(ft,{type:"brandprimary",rounded:"circle",buttonClass:"project-edit-modal-menu-button-create",size:"large",disabled:C||T,onClick:N,children:i("Create project")})})]})}):an.jsxs(mt,{className:"project-edit-modal",visible:f,title:i((null==x?void 0:x.id)?"Edit project":"New Project"),headerBorderNone:!0,onCancel:()=>{t()},actions:[{text:i((null==x?void 0:x.id)?"Save":"Create project"),type:"brandprimary",rounded:"circle",buttonClass:"project-edit-modal-button",size:"middle",disabled:C||T,onClick:()=>{x.id?P():N()}}],children:[an.jsx(ON,{data:x,setData:S}),an.jsx($N,{data:x,setData:S})]})},VN=({onCancel:e,onConfirm:t})=>{const n=$(),i=Ex(e=>e.mobile);return an.jsx(mt,{visible:!0,title:n.t("Discard this project?"),closable:!0,headerBorderNone:!0,onCancel:e,className:"project-delete-modal",actions:[{text:n.t("Cancel"),type:"tertiary",onClick:e,rounded:"circle",size:i?"large":"middle"},{text:n.t("Confirm"),type:"dangerprimary",onClick:t,rounded:"circle",size:i?"large":"middle"}],size:"small",children:n.t("Your project hasn't been saved yetclosing this window will discard all your input, including any ongoing work.")})},WN=()=>{const e=$(),t=DT(e=>e.setShowEditModal),n=DT(e=>e.setOperationProject),i=DT(e=>e.setShowDeleteConfirm),a=!Fx(),o=DT(e=>e.showDeleteConfirm),s=DT(e=>e.setProjectSettingOpen),r=DT(e=>e.operationProject),l=DT(e=>e.operationProjectFiles),c=DT(e=>e.setOperationProjectFiles),{getNewProjectList:u}=vN(),d=Ex(e=>e.mobile),h=Ty(),p=DT(e=>e.deleteFiles),m=DT(e=>e.setDeleteFiles),f=DT(e=>e.setMoveNewProjectId),g=DT(e=>e.setChatProjectId),v=DT(e=>e.showEditModal),[y,b]=A.useState(!1),x=e=>{const i=l.filter(e=>"uploading"===e.status).map(e=>e.itemId);l.forEach(e=>{var t,n,i;"running"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)&&kT.emit(uE.FILE_PASE_REMOVE,e)}),b(!1),s(!1),n({}),t(!1),m(i),c([]),f("")},w=A.useRef([]),_=A.useRef(r);return A.useEffect(()=>{if(v){const e=[];l.forEach(t=>{e.push(t.itemId||t.file_id)}),w.current=e}else w.current=[]},[v]),an.jsxs(an.Fragment,{children:[a?an.jsx(TN,{}):an.jsx(jN,{}),an.jsx(GN,{editData:r,operationProjectRef:_,onCancel:e=>{var t,n;let i=!0;if(e||(null==(t=_.current)?void 0:t.custom_instruction)===r.custom_instruction&&(null==(n=_.current)?void 0:n.name)===r.name||(i=!1),!e&&i){const e=l.filter(e=>!(p.includes(e.itemId)||p.includes(e.file_id)));if(w.current.length!==e.length)i=!1;else{i=e.every(e=>{var t,n,i;return(w.current.includes(e.itemId)||w.current.includes(e.file_id))&&"uploading"!==e.status&&"running"!==(null==(i=null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)})}}i?x():b(!0)}}),an.jsx(mt,{visible:o,title:e.t("Delete this project?"),closable:!1,headerBorderNone:!0,onCancel:()=>{i(!1)},className:"project-delete-modal",actions:[{text:e.t("Cancel"),type:"tertiary",onClick:()=>{i(!1)},rounded:"circle",size:d?"large":"middle"},{text:e.t("Delete"),type:"dangerprimary",onClick:()=>j(void 0,null,function*(){const e=yield(t=null==r?void 0:r.id,j(void 0,null,function*(){return yield ow(`/projects/${t}`,{method:"DELETE"})}));var t;(e.success||"Not_Found"===e.data.code)&&(u(),g(""),h("/")),i(!1)}),rounded:"circle",size:d?"large":"middle"}],size:"small",children:e.t("This action cannot be undone. All files and chats within this project will be permanently deleted.")}),y&&an.jsx(VN,{onCancel:()=>{b(!1)},onConfirm:()=>{x()}})]})},QN=({greetingText:e,userName:t})=>{const n=EI(e=>e.selectedModels),{i18n:i}=$(),a=Sx(e=>e.temporaryChatEnabled);return Pt(n)?an.jsxs("div",{className:"placeholder-logo-pc-container placeholder-loading-container",children:[an.jsx(Sj,{className:"spinner"}),an.jsx("span",{className:"loading-text",children:i.t("Model loading...")})]}):n.length>1?an.jsx("div",{className:Y("placeholder-logo-pc-container"),children:an.jsx(X,{className:"placeholder-logo-pc-container-multi-model",vertical:!0,children:an.jsx(X,{align:"center",justify:"center",children:n.map((e,t)=>an.jsxs(z.Fragment,{children:[an.jsx("div",{className:"placeholder-logo-text",children:null==e?void 0:e.name}),t!==n.length-1&&an.jsx(pt,{type:"icon-line-compare",className:"icon-compare"})]},null==e?void 0:e.id))})})}):an.jsxs("div",{className:Y("placeholder-logo-pc-container"),children:[an.jsx("div",{className:"placeholder-logo-text",children:a?i.t("Temporary Chat"):e}),a&&an.jsx("div",{className:"placeholder-logo-text-desc",children:i.t("This chat won't appear in history and your messages will not be saved.")})]})},KN=({greetingText:e,userName:t,theme:n})=>{const{i18n:i}=$(),a=Sx(e=>e.temporaryChatEnabled),o=TT(e=>e.isFocus);return(e=>{var t;const n=A.useRef((null==(t=window.visualViewport)?void 0:t.height)||window.innerHeight),i=A.useCallback(()=>{var t,i;((null==(t=window.visualViewport)?void 0:t.height)||window.innerHeight)<n.current-10?e(!0):(e(!1),null==(i=window.scrollTo)||i.call(window,0,0))},[e]);A.useEffect(()=>{if($x())return;const e=window.visualViewport;return n.current=(null==e?void 0:e.height)||window.innerHeight,e?e.addEventListener("resize",i):window.addEventListener("resize",i),()=>{e?e.removeEventListener("resize",i):window.removeEventListener("resize",i)}},[i])})(TT(e=>e.setIsFocus)),o?null:a&&!UT()?an.jsx("div",{className:"placeholder-logo-container",children:an.jsxs("div",{className:"ph5-temporary-container",children:[an.jsx(pt,{className:"ph5-temporary-icon",type:"icon-line-private-chat-01"}),an.jsx("div",{className:"ph5-temporary-title",children:i.t("Temporary Chat")}),an.jsx("div",{className:"ph5-temporary-description",children:i.t("This chat won't appear in history and your messages will not be saved.")})]})}):an.jsxs("div",{className:"placeholder-logo-container",children:[an.jsx("img",{src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/${"dark"===n?"qwen_icon_dark_84":"qwen_icon_light_84"}.png`,className:"logo-img",alt:"logo"}),an.jsxs("div",{className:"placeholder-logo-text",children:[an.jsx("p",{children:e}),an.jsx("p",{children:UT()?i.t("Ask Qwen, Know More."):t||""})]})]})};function YN({children:e=null,fallback:t=null}){const[n,i]=A.useState(!1);return A.useEffect(()=>{i(!0)},[]),n?an.jsx(A.Suspense,{fallback:null,children:e}):"function"==typeof t?t():an.jsx(an.Fragment,{children:t})}function XN(){var e;const t=null==(e=null==globalThis?void 0:globalThis.localStorage)?void 0:e.getItem("theme");return t||function(){var e;return(null==globalThis?void 0:globalThis.matchMedia)&&(null==(e=globalThis.matchMedia("(prefers-color-scheme: dark)"))?void 0:e.matches)?"dark":"light"}()}const JN=z.memo(({greetingText:e})=>{const t=XN();return an.jsxs("div",{className:"placeholder-logo-container",children:[an.jsx("img",{src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/${"dark"===t?"qwen_icon_dark_84":"qwen_icon_light_84"}.png`,className:"logo-img",alt:"logo"}),an.jsxs("div",{className:"placeholder-logo-text",children:[an.jsx("p",{children:e}),an.jsx("p",{children:"Ask Qwen, Know More."})]})]})}),ZN=({greetingText:e})=>{const t=Ex(e=>e.mobile),n=zE(e=>e.theme),i=HE(e=>e.user),a=NT(e=>{var t,n;return null==(n=null==(t=e.settings)?void 0:t.personalization)?void 0:n.enable_for_new_chat}),o=NT(e=>{var t,n;return null==(n=null==(t=e.settings)?void 0:t.personalization)?void 0:n.name}),s=A.useMemo(()=>a?o||(null==i?void 0:i.name)||"":(null==i?void 0:i.name)||"",[o,a,null==i?void 0:i.name]);return t?an.jsx(KN,{greetingText:e,userName:s,theme:n}):an.jsx(QN,{greetingText:e,userName:s})},eP=z.memo(({greetingText:e})=>an.jsx(YN,{fallback:an.jsx(JN,{greetingText:e}),children:an.jsx(ZN,{greetingText:e})})),tP=[{label:"1:1",key:"1:1",icon:an.jsx(pt,{type:"icon-line-size-11-01"})},{label:"3:4",key:"3:4",icon:an.jsx(pt,{type:"icon-line-size-34-01"})},{label:"4:3",key:"4:3",icon:an.jsx(pt,{type:"icon-line-size-43-01"})},{label:"16:9",key:"16:9",icon:an.jsx(pt,{type:"icon-line-size-169-01"})},{label:"9:16",key:"9:16",icon:an.jsx(pt,{type:"icon-line-size-916-01"})}],nP=({value:e,onChange:t,offset:n,disabled:i=!1})=>{const[a,o]=A.useState(!1);return an.jsx(ae,{theme:{token:{colorPrimary:"#615CED",controlItemBgActive:"#E1E1FE",borderRadiusLG:12,borderRadiusSM:12}},children:an.jsx(ee,{open:a,disabled:i,overlayClassName:"size-selector-popup",onOpenChange:e=>{o(e)},placement:"bottomLeft",trigger:["click"],menu:{items:tP,selectable:!0,onSelect:e=>{t(e.key),dS("selectImageScale",{params:{et:"CLK",c4:e.key}})},selectedKeys:e},align:n?{offset:n}:void 0,children:an.jsxs(oe,{className:"selector-text",size:4,children:[e[0],an.jsx(pt,{type:"icon-fill-triangle-down",className:"selector-icon "+(a?"rotate-180":"")})]})})})},iP=({text:e="",messageType:t="",disabled:n=!1,showSizeSelector:i=!0,showDividingLine:a=!0,fullBgColor:o=!0,showIcon:s=!1,showCloseBtn:r=!0,IsDeepResearchRounds:l=!1,isPlanning:c=!1})=>{const{updateFeatureType:u,setMobileRecommendDetailVisible:d,visionSize:h,setVisionSize:p}=TT(),{i18n:m}=$(),[f,g]=A.useState(!1),[v,y]=A.useState(!1),b=A.useMemo(()=>fv.find(e=>(null==e?void 0:e.subChatType)?e.subChatType===t:e.chatType===t),[t]),x=A.useMemo(()=>an.jsxs("div",{className:"prompt-input-func-type-popover-content",children:[an.jsxs("div",{className:"prompt-input-func-type-popover-header",children:[an.jsx("p",{className:"prompt-input-func-type-popover-title",children:m.t("Need to adjust?")}),an.jsx("div",{className:"prompt-input-func-type-popover-close-box",onClick:()=>{g(!1)},children:an.jsx(pt,{type:"icon-close-4",className:"prompt-input-func-type-popover-close-icon"})})]}),an.jsx("div",{className:"prompt-input-func-type-popover-body",children:m.t("You can provide more information to steer the research.")})]}),[m]),w=A.useCallback(e=>{c&&(v?g(!1):(y(!0),g(e)))},[v,c]);return an.jsxs("div",{className:Y("prompt-input-input-func-type-mobile",{"prompt-input-input-func-type-mobile-transparent":!o,"prompt-input-input-func-type-mobile-no-border":!a,"prompt-input-input-func-type-mobile-disabled":n||l}),children:[n||l?an.jsxs("div",{className:"prompt-input-input-func-button-disabled",children:[an.jsx(ne,{classNames:{root:"propmpt-input-func-type-popover-container"},trigger:"click",placement:"topLeft",autoAdjustOverflow:!0,arrow:!1,content:x,open:f,onOpenChange:w,children:an.jsx("div",{className:"func-text",children:e})}),i&&an.jsx("div",{className:"prompt-input-input-func-button-size-selector",children:h})]}):an.jsxs("button",{className:"prompt-input-input-func-button",children:[s&&an.jsx("img",{src:null==b?void 0:b.url,className:"chat-prompt-suggest-button-img",alt:""}),an.jsx("div",{children:e}),i&&an.jsx(nP,{value:[h],onChange:p,offset:[(s?0:22)-100,20]})]}),r&&an.jsx("div",{className:"prompt-input-input-func-type-mobile-right",onClick:e=>{e.stopPropagation(),u({subChatType:ng.Txt2Txt,chatType:ng.Txt2Txt}),d(!1)},children:an.jsx(pt,{type:"icon-line-x-02"})})]})};var aP={},oP={exports:{}};!function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports}(oP);var sP=oP.exports,rP={exports:{}},lP={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(lP);var cP=lP.exports;!function(e){var t=cP.default;function n(i,a){if("function"==typeof WeakMap)var o=new WeakMap,s=new WeakMap;return(e.exports=n=function(e,n){if(!n&&e&&e.__esModule)return e;var i,a,r={__proto__:null,default:e};if(null===e||"object"!=t(e)&&"function"!=typeof e)return r;if(i=n?s:o){if(i.has(e))return i.get(e);i.set(e,r)}for(var l in e)"default"!==l&&{}.hasOwnProperty.call(e,l)&&((a=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,l))&&(a.get||a.set)?i(r,l,a):r[l]=e[l]);return r},e.exports.__esModule=!0,e.exports.default=e.exports)(i,a)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(rP);var uP=rP.exports;const dP=G(se);var hP={},pP={exports:{}},mP={exports:{}};!function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports}(mP);var fP=mP.exports,gP={exports:{}};!function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,o,s,r=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=o.call(n)).done)&&(r.push(i.value),r.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw a}}return r}},e.exports.__esModule=!0,e.exports.default=e.exports}(gP);var vP=gP.exports,yP={exports:{}},bP={exports:{}};!function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i},e.exports.__esModule=!0,e.exports.default=e.exports}(bP);var xP=bP.exports;!function(e){var t=xP;e.exports=function(e,n){if(e){if("string"==typeof e)return t(e,n);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}(yP);var wP=yP.exports,_P={exports:{}};!function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports}(_P);var SP=_P.exports;!function(e){var t=fP,n=vP,i=wP,a=SP;e.exports=function(e,o){return t(e)||n(e,o)||i(e,o)||a()},e.exports.__esModule=!0,e.exports.default=e.exports}(pP);var CP=pP.exports,EP={},kP=uP.default;Object.defineProperty(EP,"__esModule",{value:!0}),EP.default=function(e){var t=IP.useRef();return t.current=e,IP.useCallback(function(){for(var e,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return null===(e=t.current)||void 0===e?void 0:e.call.apply(e,[t].concat(i))},[])};var IP=kP(A);var TP={},jP={};Object.defineProperty(jP,"__esModule",{value:!0}),jP.default=function(){return!("undefined"==typeof window||!window.document||!window.document.createElement)};var NP=sP.default,PP=uP.default;Object.defineProperty(TP,"__esModule",{value:!0}),TP.useLayoutUpdateEffect=TP.default=void 0;var MP=PP(A),AP=(0,NP(jP).default)()?MP.useLayoutEffect:MP.useEffect,OP=function(e,t){var n=MP.useRef(!0);AP(function(){return e(n.current)},t),AP(function(){return n.current=!1,function(){n.current=!0}},[])};TP.useLayoutUpdateEffect=function(e,t){OP(function(t){if(!t)return e()},t)},TP.default=OP;var RP={},DP=uP.default,LP=sP.default;Object.defineProperty(RP,"__esModule",{value:!0}),RP.default=function(e){var t=zP.useRef(!1),n=zP.useState(e),i=(0,FP.default)(n,2),a=i[0],o=i[1];return zP.useEffect(function(){return t.current=!1,function(){t.current=!0}},[]),[a,function(e,n){if(n&&t.current)return;o(e)}]};var FP=LP(CP),zP=DP(A);var UP=sP.default;Object.defineProperty(hP,"__esModule",{value:!0}),hP.default=function(e,t){var n=t||{},i=n.defaultValue,a=n.value,o=n.onChange,s=n.postState,r=(0,qP.default)(function(){return GP(a)?a:GP(i)?"function"==typeof i?i():i:"function"==typeof e?e():e}),l=(0,HP.default)(r,2),c=l[0],u=l[1],d=void 0!==a?a:c,h=s?s(d):d,p=(0,BP.default)(o),m=(0,qP.default)([d]),f=(0,HP.default)(m,2),g=f[0],v=f[1];(0,$P.useLayoutUpdateEffect)(function(){var e=g[0];c!==e&&p(c,e)},[g]),(0,$P.useLayoutUpdateEffect)(function(){GP(a)||u(a)},[a]);var y=(0,BP.default)(function(e,t){u(e,t),v([d],t)});return[h,y]};var HP=UP(CP),BP=UP(EP),$P=TP,qP=UP(RP);function GP(e){return void 0!==e}var VP={},WP={};const QP=G(re);var KP={};Object.defineProperty(KP,"__esModule",{value:!0}),KP.default=function(e,t){var n=Object.assign({},e);Array.isArray(t)&&t.forEach(function(e){delete n[e]});return n};var YP=sP.default,XP=uP.default;Object.defineProperty(WP,"__esModule",{value:!0}),WP.VariantContext=WP.NoStyleItemContext=WP.NoFormStyle=WP.FormProvider=WP.FormItemPrefixContext=WP.FormItemInputContext=WP.FormContext=void 0;var JP=XP(A),ZP=QP,eM=YP(KP);WP.FormContext=JP.createContext({labelAlign:"right",layout:"horizontal",itemRef:()=>{}}),WP.NoStyleItemContext=JP.createContext(null);WP.FormProvider=e=>{const t=(0,eM.default)(e,["prefixCls"]);return JP.createElement(ZP.FormProvider,Object.assign({},t))},WP.FormItemPrefixContext=JP.createContext({prefixCls:""});const tM=WP.FormItemInputContext=JP.createContext({});WP.NoFormStyle=({children:e,status:t,override:n})=>{const i=JP.useContext(tM),a=JP.useMemo(()=>{const e=Object.assign({},i);return n&&delete e.isFormItemInput,t&&(delete e.status,delete e.hasFeedback,delete e.feedbackIcon),e},[t,n,i]);return JP.createElement(tM.Provider,{value:a},e)},WP.VariantContext=JP.createContext(void 0);var nM={},iM={},aM={},oM=sP.default;Object.defineProperty(aM,"__esModule",{value:!0}),aM.default=function(e){return e&&"object"===(0,sM.default)(e)&&(e.$$typeof===rM||e.$$typeof===lM)&&e.type===cM};var sM=oM(cP),rM=Symbol.for("react.element"),lM=Symbol.for("react.transitional.element"),cM=Symbol.for("react.fragment");var uM=sP.default;Object.defineProperty(iM,"__esModule",{value:!0}),iM.default=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[];return hM.default.Children.forEach(t,function(t){(null!=t||n.keepEmpty)&&(Array.isArray(t)?i=i.concat(e(t)):(0,dM.default)(t)&&t.props?i=i.concat(e(t.props.children,n)):i.push(t))}),i};var dM=uM(aM),hM=uM(A);var pM={};const mM=G(le);var fM={};Object.defineProperty(fM,"__esModule",{value:!0}),fM.default=void 0;var gM=(0,A.createContext)({});fM.default=gM;var vM={},yM=uP.default;Object.defineProperty(vM,"__esModule",{value:!0}),vM.default=function(e,t,n){var i=bM.useRef({});"value"in i.current&&!n(i.current.condition,t)||(i.current.value=e(),i.current.condition=t);return i.current.value};var bM=yM(A);var xM={},wM={exports:{}},_M={exports:{}},SM={exports:{}},CM={exports:{}};!function(e){var t=cP.default;e.exports=function(e,n){if("object"!=t(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var a=i.call(e,n||"default");if("object"!=t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports}(CM);var EM=CM.exports;!function(e){var t=cP.default,n=EM;e.exports=function(e){var i=n(e,"string");return"symbol"==t(i)?i:i+""},e.exports.__esModule=!0,e.exports.default=e.exports}(SM);var kM=SM.exports;!function(e){var t=kM;e.exports=function(e,n,i){return(n=t(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e},e.exports.__esModule=!0,e.exports.default=e.exports}(_M);var IM=_M.exports;!function(e){var t=IM;function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}e.exports=function(e){for(var i=1;i<arguments.length;i++){var a=null!=arguments[i]?arguments[i]:{};i%2?n(Object(a),!0).forEach(function(n){t(e,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports}(wM);var TM=wM.exports,jM={exports:{}},NM={exports:{}};!function(e){var t=xP;e.exports=function(e){if(Array.isArray(e))return t(e)},e.exports.__esModule=!0,e.exports.default=e.exports}(NM);var PM=NM.exports,MM={exports:{}};!function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports}(MM);var AM=MM.exports,OM={exports:{}};!function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports}(OM);var RM=OM.exports;!function(e){var t=PM,n=AM,i=wP,a=RM;e.exports=function(e){return t(e)||n(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports}(jM);var DM=jM.exports,LM={exports:{}};!function(e){var t=fP,n=AM,i=wP,a=SP;e.exports=function(e){return t(e)||n(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports}(LM);var FM=LM.exports,zM={};Object.defineProperty(zM,"__esModule",{value:!0}),zM.default=function(e,t){for(var n=e,i=0;i<t.length;i+=1){if(null==n)return;n=n[t[i]]}return n};var UM=sP.default;Object.defineProperty(xM,"__esModule",{value:!0}),xM.default=WM,xM.merge=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=QM(t[0]);return t.forEach(function(e){!function t(n,a){var o,s=new Set(a),r=(0,GM.default)(e,n),l=Array.isArray(r);if(l||(o=r,"object"===(0,HM.default)(o)&&null!==o&&Object.getPrototypeOf(o)===Object.prototype)){if(!s.has(r)){s.add(r);var c=(0,GM.default)(i,n);l?i=WM(i,n,[]):c&&"object"===(0,HM.default)(c)||(i=WM(i,n,QM(r))),KM(r).forEach(function(e){t([].concat((0,$M.default)(n),[e]),s)})}}else i=WM(i,n,r)}([])}),i};var HM=UM(cP),BM=UM(TM),$M=UM(DM),qM=UM(FM),GM=UM(zM);function VM(e,t,n,i){if(!t.length)return n;var a,o=(0,qM.default)(t),s=o[0],r=o.slice(1);return a=e||"number"!=typeof s?Array.isArray(e)?(0,$M.default)(e):(0,BM.default)({},e):[],i&&void 0===n&&1===r.length?delete a[s][r[0]]:a[s]=VM(a[s],r,n,i),a}function WM(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.length&&i&&void 0===n&&!(0,GM.default)(e,t.slice(0,-1))?e:VM(e,t,n,i)}function QM(e){return Array.isArray(e)?[]:{}}var KM="undefined"==typeof Reflect?Object.keys:Reflect.ownKeys;var YM={},XM={};Object.defineProperty(XM,"__esModule",{value:!0}),XM.call=iA,XM.default=void 0,XM.note=tA,XM.noteOnce=oA,XM.preMessage=void 0,XM.resetWarned=nA,XM.warning=eA,XM.warningOnce=aA;var JM={},ZM=XM.preMessage=function(e){};function eA(e,t){}function tA(e,t){}function nA(){JM={}}function iA(e,t,n){t||JM[n]||(e(!1,n),JM[n]=!0)}function aA(e,t){iA(eA,e,t)}function oA(e,t){iA(tA,e,t)}aA.preMessage=ZM,aA.resetWarned=nA,aA.noteOnce=oA,XM.default=aA;var sA=uP.default;Object.defineProperty(YM,"__esModule",{value:!0}),YM.devUseWarning=YM.default=YM.WarningContext=void 0,YM.noop=cA,YM.resetWarned=function(){(0,lA.resetWarned)()};var rA=sA(A),lA=sA(XM);function cA(){}const uA=cA;YM.WarningContext=rA.createContext({}),YM.devUseWarning=()=>{const e=()=>{};return e.deprecated=cA,e},YM.default=uA;var dA={};Object.defineProperty(dA,"__esModule",{value:!0}),dA.default=void 0;var hA=A;dA.default=(0,hA.createContext)(void 0);var pA={},mA={},fA={},gA={};Object.defineProperty(gA,"__esModule",{value:!0}),gA.default=void 0;gA.default={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"};var vA={},yA={},bA={},xA={};Object.defineProperty(xA,"__esModule",{value:!0}),xA.commonLocale=void 0,xA.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0};var wA=sP.default;Object.defineProperty(bA,"__esModule",{value:!0}),bA.default=void 0;var _A=wA(TM),SA=xA,CA=(0,_A.default)((0,_A.default)({},SA.commonLocale),{},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",week:"Week",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",dateFormat:"M/D/YYYY",dateTimeFormat:"M/D/YYYY HH:mm:ss",previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"});bA.default=CA;var EA={};Object.defineProperty(EA,"__esModule",{value:!0}),EA.default=void 0;EA.default={placeholder:"Select time",rangePlaceholder:["Start time","End time"]};var kA=sP.default;Object.defineProperty(yA,"__esModule",{value:!0}),yA.default=void 0;var IA=kA(bA),TA=kA(EA);const jA={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},IA.default),timePickerLocale:Object.assign({},TA.default)};yA.default=jA;var NA=sP.default;Object.defineProperty(vA,"__esModule",{value:!0}),vA.default=void 0;var PA=NA(yA);vA.default=PA.default;var MA=sP.default;Object.defineProperty(fA,"__esModule",{value:!0}),fA.default=void 0;var AA=MA(gA),OA=MA(vA),RA=MA(yA),DA=MA(EA);const LA="${label} is not a valid ${type}",FA={locale:"en",Pagination:AA.default,DatePicker:RA.default,TimePicker:DA.default,Calendar:OA.default,global:{placeholder:"Please select",close:"Close"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckAll:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",deselectAll:"Deselect all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand",collapse:"Collapse"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:LA,method:LA,array:LA,object:LA,number:LA,date:LA,boolean:LA,integer:LA,float:LA,regexp:LA,email:LA,url:LA,hex:LA},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty",transparent:"Transparent",singleColor:"Single",gradientColor:"Gradient"}};fA.default=FA;var zA=sP.default;Object.defineProperty(mA,"__esModule",{value:!0}),mA.changeConfirmLocale=function(e){if(e){const t=Object.assign({},e);return BA.push(t),HA=$A(),()=>{BA=BA.filter(e=>e!==t),HA=$A()}}HA=Object.assign({},UA.default.Modal)},mA.getConfirmLocale=function(){return HA};var UA=zA(fA);let HA=Object.assign({},UA.default.Modal),BA=[];const $A=()=>BA.reduce((e,t)=>Object.assign(Object.assign({},e),t),UA.default.Modal);var qA={};Object.defineProperty(qA,"__esModule",{value:!0}),qA.default=void 0;const GA=(0,A.createContext)(void 0);qA.default=GA;var VA={},WA=sP.default,QA=uP.default;Object.defineProperty(VA,"__esModule",{value:!0}),VA.default=void 0;var KA=QA(A),YA=WA(qA),XA=WA(fA);VA.default=(e,t)=>{const n=KA.useContext(YA.default);return[KA.useMemo(()=>{var i;const a=t||XA.default[e],o=null!==(i=null==n?void 0:n[e])&&void 0!==i?i:{};return Object.assign(Object.assign({},"function"==typeof a?a():a),o||{})},[e,t,n]),KA.useMemo(()=>{const e=null==n?void 0:n.locale;return(null==n?void 0:n.exist)&&!e?XA.default.locale:e},[n])]},function(e){var t=sP.default,n=uP.default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.ANT_MARK=void 0,Object.defineProperty(e,"useLocale",{enumerable:!0,get:function(){return s.default}});var i=n(A),a=mA,o=t(qA),s=t(VA);e.ANT_MARK="internalMark";e.default=e=>{const{locale:t={},children:n,_ANT_MARK__:s}=e;i.useEffect(()=>(0,a.changeConfirmLocale)(null==t?void 0:t.Modal),[t]);const r=i.useMemo(()=>Object.assign(Object.assign({},t),{exist:!0}),[t]);return i.createElement(o.default.Provider,{value:r},n)}}(pA);var JA={},ZA={};Object.defineProperty(ZA,"__esModule",{value:!0}),ZA.defaultPresetColors=ZA.default=void 0;const eO=ZA.defaultPresetColors={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},tO=Object.assign(Object.assign({},eO),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,\n'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',\n'Noto Color Emoji'",fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});ZA.default=tO;var nO={},iO={};const aO=G(ce);var oO={};const sO=G(ue);Object.defineProperty(oO,"__esModule",{value:!0}),oO.default=function(e,{generateColorPalettes:t,generateNeutralColorPalettes:n}){const{colorSuccess:i,colorWarning:a,colorError:o,colorInfo:s,colorPrimary:r,colorBgBase:l,colorTextBase:c}=e,u=t(r),d=t(i),h=t(a),p=t(o),m=t(s),f=n(l,c),g=e.colorLink||e.colorInfo,v=t(g),y=new rO.FastColor(p[1]).mix(new rO.FastColor(p[3]),50).toHexString();return Object.assign(Object.assign({},f),{colorPrimaryBg:u[1],colorPrimaryBgHover:u[2],colorPrimaryBorder:u[3],colorPrimaryBorderHover:u[4],colorPrimaryHover:u[5],colorPrimary:u[6],colorPrimaryActive:u[7],colorPrimaryTextHover:u[8],colorPrimaryText:u[9],colorPrimaryTextActive:u[10],colorSuccessBg:d[1],colorSuccessBgHover:d[2],colorSuccessBorder:d[3],colorSuccessBorderHover:d[4],colorSuccessHover:d[4],colorSuccess:d[6],colorSuccessActive:d[7],colorSuccessTextHover:d[8],colorSuccessText:d[9],colorSuccessTextActive:d[10],colorErrorBg:p[1],colorErrorBgHover:p[2],colorErrorBgFilledHover:y,colorErrorBgActive:p[3],colorErrorBorder:p[3],colorErrorBorderHover:p[4],colorErrorHover:p[5],colorError:p[6],colorErrorActive:p[7],colorErrorTextHover:p[8],colorErrorText:p[9],colorErrorTextActive:p[10],colorWarningBg:h[1],colorWarningBgHover:h[2],colorWarningBorder:h[3],colorWarningBorderHover:h[4],colorWarningHover:h[4],colorWarning:h[6],colorWarningActive:h[7],colorWarningTextHover:h[8],colorWarningText:h[9],colorWarningTextActive:h[10],colorInfoBg:m[1],colorInfoBgHover:m[2],colorInfoBorder:m[3],colorInfoBorderHover:m[4],colorInfoHover:m[4],colorInfo:m[6],colorInfoActive:m[7],colorInfoTextHover:m[8],colorInfoText:m[9],colorInfoTextActive:m[10],colorLinkHover:v[4],colorLink:v[6],colorLinkActive:v[7],colorBgMask:new rO.FastColor("#000").setA(.45).toRgbString(),colorWhite:"#fff"})};var rO=sO;var lO={},cO={};Object.defineProperty(cO,"__esModule",{value:!0}),cO.default=void 0;cO.default=e=>{let t=e,n=e,i=e,a=e;return e<6&&e>=5?t=e+1:e<16&&e>=6?t=e+2:e>=16&&(t=16),e<7&&e>=5?n=4:e<8&&e>=7?n=5:e<14&&e>=8?n=6:e<16&&e>=14?n=7:e>=16&&(n=8),e<6&&e>=2?i=1:e>=6&&(i=2),e>4&&e<8?a=4:e>=8&&(a=6),{borderRadius:e,borderRadiusXS:i,borderRadiusSM:n,borderRadiusLG:t,borderRadiusOuter:a}};var uO=sP.default;Object.defineProperty(lO,"__esModule",{value:!0}),lO.default=function(e){const{motionUnit:t,motionBase:n,borderRadius:i,lineWidth:a}=e;return Object.assign({motionDurationFast:`${(n+t).toFixed(1)}s`,motionDurationMid:`${(n+2*t).toFixed(1)}s`,motionDurationSlow:`${(n+3*t).toFixed(1)}s`,lineWidthBold:a+1},(0,dO.default)(i))};var dO=uO(cO);var hO={};Object.defineProperty(hO,"__esModule",{value:!0}),hO.default=void 0;hO.default=e=>{const{controlHeight:t}=e;return{controlHeightSM:.75*t,controlHeightXS:.5*t,controlHeightLG:1.25*t}};var pO={},mO={};function fO(e){return(e+8)/e}Object.defineProperty(mO,"__esModule",{value:!0}),mO.default=function(e){const t=Array.from({length:10}).map((t,n)=>{const i=n-1,a=e*Math.pow(Math.E,i/5),o=n>1?Math.floor(a):Math.ceil(a);return 2*Math.floor(o/2)});return t[1]=e,t.map(e=>({size:e,lineHeight:fO(e)}))},mO.getLineHeight=fO;var gO=sP.default;Object.defineProperty(pO,"__esModule",{value:!0}),pO.default=void 0;var vO=gO(mO);pO.default=e=>{const t=(0,vO.default)(e),n=t.map(e=>e.size),i=t.map(e=>e.lineHeight),a=n[1],o=n[0],s=n[2],r=i[1],l=i[0],c=i[2];return{fontSizeSM:o,fontSize:a,fontSizeLG:s,fontSizeXL:n[3],fontSizeHeading1:n[6],fontSizeHeading2:n[5],fontSizeHeading3:n[4],fontSizeHeading4:n[3],fontSizeHeading5:n[2],lineHeight:r,lineHeightLG:c,lineHeightSM:l,fontHeight:Math.round(r*a),fontHeightLG:Math.round(c*s),fontHeightSM:Math.round(l*o),lineHeightHeading1:i[6],lineHeightHeading2:i[5],lineHeightHeading3:i[4],lineHeightHeading4:i[3],lineHeightHeading5:i[2]}};var yO={};Object.defineProperty(yO,"__esModule",{value:!0}),yO.default=function(e){const{sizeUnit:t,sizeStep:n}=e;return{sizeXXL:t*(n+8),sizeXL:t*(n+4),sizeLG:t*(n+2),sizeMD:t*(n+1),sizeMS:t*n,size:t*n,sizeSM:t*(n-1),sizeXS:t*(n-2),sizeXXS:t*(n-3)}};var bO={},xO={};Object.defineProperty(xO,"__esModule",{value:!0}),xO.getSolidColor=xO.getAlphaColor=void 0;var wO=sO;xO.getAlphaColor=(e,t)=>new wO.FastColor(e).setA(t).toRgbString();xO.getSolidColor=(e,t)=>new wO.FastColor(e).darken(t).toHexString(),Object.defineProperty(bO,"__esModule",{value:!0}),bO.generateNeutralColorPalettes=bO.generateColorPalettes=void 0;var _O=aO,SO=xO;bO.generateColorPalettes=e=>{const t=(0,_O.generate)(e);return{1:t[0],2:t[1],3:t[2],4:t[3],5:t[4],6:t[5],7:t[6],8:t[4],9:t[5],10:t[6]}};bO.generateNeutralColorPalettes=(e,t)=>{const n=e||"#fff",i=t||"#000";return{colorBgBase:n,colorTextBase:i,colorText:(0,SO.getAlphaColor)(i,.88),colorTextSecondary:(0,SO.getAlphaColor)(i,.65),colorTextTertiary:(0,SO.getAlphaColor)(i,.45),colorTextQuaternary:(0,SO.getAlphaColor)(i,.25),colorFill:(0,SO.getAlphaColor)(i,.15),colorFillSecondary:(0,SO.getAlphaColor)(i,.06),colorFillTertiary:(0,SO.getAlphaColor)(i,.04),colorFillQuaternary:(0,SO.getAlphaColor)(i,.02),colorBgSolid:(0,SO.getAlphaColor)(i,1),colorBgSolidHover:(0,SO.getAlphaColor)(i,.75),colorBgSolidActive:(0,SO.getAlphaColor)(i,.95),colorBgLayout:(0,SO.getSolidColor)(n,4),colorBgContainer:(0,SO.getSolidColor)(n,0),colorBgElevated:(0,SO.getSolidColor)(n,0),colorBgSpotlight:(0,SO.getAlphaColor)(i,.85),colorBgBlur:"transparent",colorBorder:(0,SO.getSolidColor)(n,15),colorBorderSecondary:(0,SO.getSolidColor)(n,6)}};var CO=sP.default;Object.defineProperty(iO,"__esModule",{value:!0}),iO.default=function(e){EO.presetPrimaryColors.pink=EO.presetPrimaryColors.magenta,EO.presetPalettes.pink=EO.presetPalettes.magenta;const t=Object.keys(kO.defaultPresetColors).map(t=>{const n=e[t]===EO.presetPrimaryColors[t]?EO.presetPalettes[t]:(0,EO.generate)(e[t]);return Array.from({length:10},()=>1).reduce((e,i,a)=>(e[`${t}-${a+1}`]=n[a],e[`${t}${a+1}`]=n[a],e),{})}).reduce((e,t)=>e=Object.assign(Object.assign({},e),t),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),t),(0,IO.default)(e,{generateColorPalettes:MO.generateColorPalettes,generateNeutralColorPalettes:MO.generateNeutralColorPalettes})),(0,NO.default)(e.fontSize)),(0,PO.default)(e)),(0,jO.default)(e)),(0,TO.default)(e))};var EO=aO,kO=ZA,IO=CO(oO),TO=CO(lO),jO=CO(hO),NO=CO(pO),PO=CO(yO),MO=bO;var AO=sP.default;Object.defineProperty(nO,"__esModule",{value:!0}),nO.default=void 0;var OO=mM,RO=AO(iO);const DO=(0,OO.createTheme)(RO.default);nO.default=DO,function(e){var t=sP.default;Object.defineProperty(e,"__esModule",{value:!0}),e.defaultConfig=e.DesignTokenContext=void 0,Object.defineProperty(e,"defaultTheme",{enumerable:!0,get:function(){return a.default}});var n=t(A),i=t(ZA),a=t(nO);const o=e.defaultConfig={token:i.default,override:{override:i.default},hashed:!0};e.DesignTokenContext=n.default.createContext(o)}(JA);var LO={},FO=uP.default;Object.defineProperty(LO,"__esModule",{value:!0}),LO.defaultPrefixCls=LO.defaultIconPrefixCls=LO.Variants=LO.ConfigContext=LO.ConfigConsumer=void 0,LO.useComponentConfig=function(e){const t=zO.useContext(BO),{getPrefixCls:n,direction:i,getPopupContainer:a}=t,o=t[e];return Object.assign(Object.assign({classNames:qO,styles:qO},o),{getPrefixCls:n,direction:i,getPopupContainer:a})};var zO=FO(A);const UO=LO.defaultPrefixCls="ant",HO=LO.defaultIconPrefixCls="anticon";LO.Variants=["outlined","borderless","filled","underlined"];const BO=LO.ConfigContext=zO.createContext({getPrefixCls:(e,t)=>t||(e?`${UO}-${e}`:UO),iconPrefixCls:HO}),{Consumer:$O}=BO;LO.ConfigConsumer=$O;const qO={};var GO={},VO={},WO={};Object.defineProperty(WO,"__esModule",{value:!0}),WO.default=function(e,t){if(!e)return!1;if(e.contains)return e.contains(t);var n=t;for(;n;){if(n===e)return!0;n=n.parentNode}return!1};var QO=sP.default;Object.defineProperty(VO,"__esModule",{value:!0}),VO.clearContainerCache=function(){tR.clear()},VO.injectCSS=oR,VO.removeCSS=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=sR(e,t);if(n){iR(t).removeChild(n)}},VO.updateCSS=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=iR(n),a=aR(i),o=(0,KO.default)((0,KO.default)({},n),{},{styles:a});!function(e,t){var n=tR.get(e);if(!n||!(0,XO.default)(document,n)){var i=oR("",t),a=i.parentNode;tR.set(e,a),e.removeChild(i)}}(i,o);var s=sR(t,o);if(s){var r,l,c;if(null!==(r=o.csp)&&void 0!==r&&r.nonce&&s.nonce!==(null===(l=o.csp)||void 0===l?void 0:l.nonce))s.nonce=null===(c=o.csp)||void 0===c?void 0:c.nonce;return s.innerHTML!==e&&(s.innerHTML=e),s}var u=oR(e,o);return u.setAttribute(nR(o),t),u};var KO=QO(TM),YO=QO(jP),XO=QO(WO),JO="data-rc-order",ZO="data-rc-priority",eR="rc-util-key",tR=new Map;function nR(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).mark;return e?e.startsWith("data-")?e:"data-".concat(e):eR}function iR(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function aR(e){return Array.from((tR.get(e)||e).children).filter(function(e){return"STYLE"===e.tagName})}function oR(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,YO.default)())return null;var n=t.csp,i=t.prepend,a=t.priority,o=void 0===a?0:a,s=function(e){return"queue"===e?"prependQueue":e?"prepend":"append"}(i),r="prependQueue"===s,l=document.createElement("style");l.setAttribute(JO,s),r&&o&&l.setAttribute(ZO,"".concat(o)),null!=n&&n.nonce&&(l.nonce=null==n?void 0:n.nonce),l.innerHTML=e;var c=iR(t),u=c.firstChild;if(i){if(r){var d=(t.styles||aR(c)).filter(function(e){if(!["prepend","prependQueue"].includes(e.getAttribute(JO)))return!1;var t=Number(e.getAttribute(ZO)||0);return o>=t});if(d.length)return c.insertBefore(l,d[d.length-1].nextSibling),l}c.insertBefore(l,u)}else c.appendChild(l);return l}function sR(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=iR(t);return(t.styles||aR(n)).find(function(n){return n.getAttribute(nR(t))===e})}var rR=sP.default;Object.defineProperty(GO,"__esModule",{value:!0}),GO.getStyle=pR,GO.registerTheme=function(e,t){const n=pR(e,t);(0,uR.default)()&&(0,dR.updateCSS)(n,`${hR}-dynamic-theme`)};var lR=aO,cR=sO,uR=rR(jP),dR=VO;rR(YM);const hR=`-ant-${Date.now()}-${Math.random()}`;function pR(e,t){const n={},i=(e,t)=>{let n=e.clone();return n=(null==t?void 0:t(n))||n,n.toRgbString()},a=(e,t)=>{const a=new cR.FastColor(e),o=(0,lR.generate)(a.toRgbString());n[`${t}-color`]=i(a),n[`${t}-color-disabled`]=o[1],n[`${t}-color-hover`]=o[4],n[`${t}-color-active`]=o[6],n[`${t}-color-outline`]=a.clone().setA(.2).toRgbString(),n[`${t}-color-deprecated-bg`]=o[0],n[`${t}-color-deprecated-border`]=o[2]};if(t.primaryColor){a(t.primaryColor,"primary");const e=new cR.FastColor(t.primaryColor),o=(0,lR.generate)(e.toRgbString());o.forEach((e,t)=>{n[`primary-${t+1}`]=e}),n["primary-color-deprecated-l-35"]=i(e,e=>e.lighten(35)),n["primary-color-deprecated-l-20"]=i(e,e=>e.lighten(20)),n["primary-color-deprecated-t-20"]=i(e,e=>e.tint(20)),n["primary-color-deprecated-t-50"]=i(e,e=>e.tint(50)),n["primary-color-deprecated-f-12"]=i(e,e=>e.setA(.12*e.a));const s=new cR.FastColor(o[0]);n["primary-color-active-deprecated-f-30"]=i(s,e=>e.setA(.3*e.a)),n["primary-color-active-deprecated-d-02"]=i(s,e=>e.darken(2))}t.successColor&&a(t.successColor,"success"),t.warningColor&&a(t.warningColor,"warning"),t.errorColor&&a(t.errorColor,"error"),t.infoColor&&a(t.infoColor,"info");return`\n  :root {\n    ${Object.keys(n).map(t=>`--${e}-${t}: ${n[t]};`).join("\n")}\n  }\n  `.trim()}var mR={},fR=uP.default;Object.defineProperty(mR,"__esModule",{value:!0}),mR.default=mR.DisabledContextProvider=void 0;var gR=fR(A);const vR=gR.createContext(!1);mR.DisabledContextProvider=({children:e,disabled:t})=>{const n=gR.useContext(vR);return gR.createElement(vR.Provider,{value:null!=t?t:n},e)},mR.default=vR;var yR={},bR={},xR=uP.default;Object.defineProperty(bR,"__esModule",{value:!0}),bR.default=bR.SizeContextProvider=void 0;var wR=xR(A);const _R=wR.createContext(void 0);bR.SizeContextProvider=({children:e,size:t})=>{const n=wR.useContext(_R);return wR.createElement(_R.Provider,{value:t||n},e)},bR.default=_R;var SR=sP.default;Object.defineProperty(yR,"__esModule",{value:!0}),yR.default=void 0;var CR=A,ER=SR(mR),kR=SR(bR);yR.default=function(){return{componentDisabled:(0,CR.useContext)(ER.default),componentSize:(0,CR.useContext)(kR.default)}};var IR={},TR={},jR=sP.default;Object.defineProperty(TR,"__esModule",{value:!0}),TR.default=void 0;var NR=jR(cP),PR=jR(XM);TR.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new Set;return function e(t,a){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=i.has(t);if((0,PR.default)(!s,"Warning: There may be circular references"),s)return!1;if(t===a)return!0;if(n&&o>1)return!1;i.add(t);var r=o+1;if(Array.isArray(t)){if(!Array.isArray(a)||t.length!==a.length)return!1;for(var l=0;l<t.length;l++)if(!e(t[l],a[l],r))return!1;return!0}if(t&&a&&"object"===(0,NR.default)(t)&&"object"===(0,NR.default)(a)){var c=Object.keys(t);return c.length===Object.keys(a).length&&c.every(function(n){return e(t[n],a[n],r)})}return!1}(e,t)};var MR={};const AR=G(de);var OR={},RR={};Object.defineProperty(RR,"__esModule",{value:!0}),RR.PresetColors=void 0,RR.PresetColors=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"],function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"PresetColors",{enumerable:!0,get:function(){return t.PresetColors}});var t=RR}(OR);var DR={},LR={},FR={};Object.defineProperty(FR,"__esModule",{value:!0}),FR.default=void 0,FR.default="5.29.3";var zR=sP.default;Object.defineProperty(LR,"__esModule",{value:!0}),LR.default=void 0;var UR=zR(FR);LR.default=UR.default;var HR={},BR={};Object.defineProperty(BR,"__esModule",{value:!0}),BR.default=void 0;var $R=sO;function qR(e){return e>=0&&e<=255}BR.default=function(e,t){const{r:n,g:i,b:a,a:o}=new $R.FastColor(e).toRgb();if(o<1)return e;const{r:s,g:r,b:l}=new $R.FastColor(t).toRgb();for(let c=.01;c<=1;c+=.01){const e=Math.round((n-s*(1-c))/c),t=Math.round((i-r*(1-c))/c),o=Math.round((a-l*(1-c))/c);if(qR(e)&&qR(t)&&qR(o))return new $R.FastColor({r:e,g:t,b:o,a:Math.round(100*c)/100}).toRgbString()}return new $R.FastColor({r:n,g:i,b:a,a:1}).toRgbString()};var GR=sP.default;Object.defineProperty(HR,"__esModule",{value:!0}),HR.default=function(e){const{override:t}=e,n=KR(e,["override"]),i=Object.assign({},t);Object.keys(WR.default).forEach(e=>{delete i[e]});const a=Object.assign(Object.assign({},n),i),o=1200,s=1600;if(!1===a.motion){const e="0s";a.motionDurationFast=e,a.motionDurationMid=e,a.motionDurationSlow=e}return Object.assign(Object.assign(Object.assign({},a),{colorFillContent:a.colorFillSecondary,colorFillContentHover:a.colorFill,colorFillAlter:a.colorFillQuaternary,colorBgContainerDisabled:a.colorFillTertiary,colorBorderBg:a.colorBgContainer,colorSplit:(0,QR.default)(a.colorBorderSecondary,a.colorBgContainer),colorTextPlaceholder:a.colorTextQuaternary,colorTextDisabled:a.colorTextQuaternary,colorTextHeading:a.colorText,colorTextLabel:a.colorTextSecondary,colorTextDescription:a.colorTextTertiary,colorTextLightSolid:a.colorWhite,colorHighlight:a.colorError,colorBgTextHover:a.colorFillSecondary,colorBgTextActive:a.colorFill,colorIcon:a.colorTextTertiary,colorIconHover:a.colorText,colorErrorOutline:(0,QR.default)(a.colorErrorBg,a.colorBgContainer),colorWarningOutline:(0,QR.default)(a.colorWarningBg,a.colorBgContainer),fontSizeIcon:a.fontSizeSM,lineWidthFocus:3*a.lineWidth,lineWidth:a.lineWidth,controlOutlineWidth:2*a.lineWidth,controlInteractiveSize:a.controlHeight/2,controlItemBgHover:a.colorFillTertiary,controlItemBgActive:a.colorPrimaryBg,controlItemBgActiveHover:a.colorPrimaryBgHover,controlItemBgActiveDisabled:a.colorFill,controlTmpOutline:a.colorFillQuaternary,controlOutline:(0,QR.default)(a.colorPrimaryBg,a.colorBgContainer),lineType:a.lineType,borderRadius:a.borderRadius,borderRadiusXS:a.borderRadiusXS,borderRadiusSM:a.borderRadiusSM,borderRadiusLG:a.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:a.sizeXXS,paddingXS:a.sizeXS,paddingSM:a.sizeSM,padding:a.size,paddingMD:a.sizeMD,paddingLG:a.sizeLG,paddingXL:a.sizeXL,paddingContentHorizontalLG:a.sizeLG,paddingContentVerticalLG:a.sizeMS,paddingContentHorizontal:a.sizeMS,paddingContentVertical:a.sizeSM,paddingContentHorizontalSM:a.size,paddingContentVerticalSM:a.sizeXS,marginXXS:a.sizeXXS,marginXS:a.sizeXS,marginSM:a.sizeSM,margin:a.size,marginMD:a.sizeMD,marginLG:a.sizeLG,marginXL:a.sizeXL,marginXXL:a.sizeXXL,boxShadow:"\n      0 6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowSecondary:"\n      0 6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowTertiary:"\n      0 1px 2px 0 rgba(0, 0, 0, 0.03),\n      0 1px 6px -1px rgba(0, 0, 0, 0.02),\n      0 2px 4px 0 rgba(0, 0, 0, 0.02)\n    ",screenXS:480,screenXSMin:480,screenXSMax:575,screenSM:576,screenSMMin:576,screenSMMax:767,screenMD:768,screenMDMin:768,screenMDMax:991,screenLG:992,screenLGMin:992,screenLGMax:1199,screenXL:o,screenXLMin:o,screenXLMax:1599,screenXXL:s,screenXXLMin:s,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`\n      0 1px 2px -2px ${new VR.FastColor("rgba(0, 0, 0, 0.16)").toRgbString()},\n      0 3px 6px 0 ${new VR.FastColor("rgba(0, 0, 0, 0.12)").toRgbString()},\n      0 5px 12px 4px ${new VR.FastColor("rgba(0, 0, 0, 0.09)").toRgbString()}\n    `,boxShadowDrawerRight:"\n      -6px 0 16px 0 rgba(0, 0, 0, 0.08),\n      -3px 0 6px -4px rgba(0, 0, 0, 0.12),\n      -9px 0 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowDrawerLeft:"\n      6px 0 16px 0 rgba(0, 0, 0, 0.08),\n      3px 0 6px -4px rgba(0, 0, 0, 0.12),\n      9px 0 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowDrawerUp:"\n      0 6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowDrawerDown:"\n      0 -6px 16px 0 rgba(0, 0, 0, 0.08),\n      0 -3px 6px -4px rgba(0, 0, 0, 0.12),\n      0 -9px 28px 8px rgba(0, 0, 0, 0.05)\n    ",boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),i)};var VR=sO,WR=GR(ZA),QR=GR(BR),KR=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n};var YR=sP.default;Object.defineProperty(DR,"__esModule",{value:!0}),DR.default=function(){const{token:e,hashed:t,theme:n,override:i,cssVar:a}=XR.default.useContext(eD.DesignTokenContext),o=`${ZR.default}-${t||""}`,s=n||eD.defaultTheme,[r,l,c]=(0,JR.useCacheToken)(s,[tD.default,e],{salt:o,override:i,getComputedToken:rD,formatToken:nD.default,cssVar:a&&{prefix:a.prefix,key:a.key,unitless:aD,ignore:oD,preserve:sD}});return[s,c,t?l:"",r,a]},DR.unitless=DR.ignore=DR.getComputedToken=void 0;var XR=YR(A),JR=mM,ZR=YR(LR),eD=JA,tD=YR(ZA),nD=YR(HR),iD=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n};const aD=DR.unitless={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},oD=DR.ignore={motionBase:!0,motionUnit:!0},sD={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},rD=(e,t,n)=>{const i=n.getDerivativeToken(e),{override:a}=t,o=iD(t,["override"]);let s=Object.assign(Object.assign({},i),{override:a});return s=(0,nD.default)(s),o&&Object.entries(o).forEach(([e,t])=>{const{theme:n}=t,i=iD(t,["theme"]);let a=i;n&&(a=rD(Object.assign(Object.assign({},s),i),{override:i},n)),s[e]=a}),s};DR.getComputedToken=rD;var lD={},cD={};Object.defineProperty(cD,"__esModule",{value:!0}),cD.textEllipsis=cD.resetIcon=cD.resetComponent=cD.operationUnit=cD.genLinkStyle=cD.genIconStyle=cD.genFocusStyle=cD.genFocusOutline=cD.genCommonStyle=cD.clearFix=void 0;var uD=mM;cD.textEllipsis={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"};cD.resetComponent=(e,t=!1)=>({boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none",fontFamily:t?"inherit":e.fontFamily});const dD=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}});cD.resetIcon=dD;cD.clearFix=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}});cD.genLinkStyle=e=>({a:{color:e.colorLink,textDecoration:e.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive},"&:active, &:hover":{textDecoration:e.linkHoverDecoration,outline:0},"&:focus":{textDecoration:e.linkFocusDecoration,outline:0},"&[disabled]":{color:e.colorTextDisabled,cursor:"not-allowed"}}});cD.genCommonStyle=(e,t,n,i)=>{const a=`[class^="${t}"], [class*=" ${t}"]`,o=n?`.${n}`:a,s={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let r={};return!1!==i&&(r={fontFamily:e.fontFamily,fontSize:e.fontSize}),{[o]:Object.assign(Object.assign(Object.assign({},r),s),{[a]:s})}};const hD=(e,t)=>({outline:`${(0,uD.unit)(e.lineWidthFocus)} solid ${e.colorPrimaryBorder}`,outlineOffset:null!=t?t:1,transition:"outline-offset 0s, outline 0s"});cD.genFocusOutline=hD;const pD=(e,t)=>({"&:focus-visible":hD(e,t)});cD.genFocusStyle=pD;cD.genIconStyle=e=>({[`.${e}`]:Object.assign(Object.assign({},{display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),{[`.${e} .${e}-icon`]:{display:"block"}})});cD.operationUnit=e=>Object.assign(Object.assign({color:e.colorLink,textDecoration:e.linkDecoration,outline:"none",cursor:"pointer",transition:`all ${e.motionDurationSlow}`,border:0,padding:0,background:"none",userSelect:"none"},pD(e)),{"&:hover":{color:e.colorLinkHover,textDecoration:e.linkHoverDecoration},"&:focus":{color:e.colorLinkHover,textDecoration:e.linkFocusDecoration},"&:active":{color:e.colorLinkActive,textDecoration:e.linkHoverDecoration}});var mD=uP.default;Object.defineProperty(lD,"__esModule",{value:!0}),lD.genSubStyleComponent=lD.genStyleHooks=lD.genComponentStyleHook=void 0;var fD=A,gD=AR,vD=LO,yD=cD,bD=mD(DR);const{genStyleHooks:xD,genComponentStyleHook:wD,genSubStyleComponent:_D}=(0,gD.genStyleUtils)({usePrefix:()=>{const{getPrefixCls:e,iconPrefixCls:t}=(0,fD.useContext)(vD.ConfigContext);return{rootPrefixCls:e(),iconPrefixCls:t}},useToken:()=>{const[e,t,n,i,a]=(0,bD.default)();return{theme:e,realToken:t,hashId:n,token:i,cssVar:a}},useCSP:()=>{const{csp:e}=(0,fD.useContext)(vD.ConfigContext);return null!=e?e:{}},getResetStyles:(e,t)=>{var n;const i=(0,yD.genLinkStyle)(e);return[i,{"&":i},(0,yD.genIconStyle)(null!==(n=null==t?void 0:t.prefix.iconPrefixCls)&&void 0!==n?n:vD.defaultIconPrefixCls)]},getCommonStyle:yD.genCommonStyle,getCompUnitless:()=>bD.unitless});lD.genSubStyleComponent=_D,lD.genComponentStyleHook=wD,lD.genStyleHooks=xD;var SD={};Object.defineProperty(SD,"__esModule",{value:!0}),SD.default=function(e,t){return CD.PresetColors.reduce((n,i)=>{const a=e[`${i}1`],o=e[`${i}3`],s=e[`${i}6`],r=e[`${i}7`];return Object.assign(Object.assign({},n),t(i,{lightColor:a,lightBorderColor:o,darkColor:s,textColor:r}))},{})};var CD=OR;var ED={},kD=sP.default;Object.defineProperty(ED,"__esModule",{value:!0}),ED.default=void 0;var ID=mM,TD=cD,jD=kD(DR);ED.default=(e,t)=>{const[n,i]=(0,jD.default)();return(0,ID.useStyleRegister)({theme:n,token:i,hashId:"",path:["ant-design-icons",e],nonce:()=>null==t?void 0:t.nonce,layer:{name:"antd"}},()=>(0,TD.genIconStyle)(e))},function(e){var t=sP.default;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"DesignTokenContext",{enumerable:!0,get:function(){return u.DesignTokenContext}}),Object.defineProperty(e,"PresetColors",{enumerable:!0,get:function(){return a.PresetColors}}),Object.defineProperty(e,"calc",{enumerable:!0,get:function(){return i.genCalc}}),Object.defineProperty(e,"defaultConfig",{enumerable:!0,get:function(){return u.defaultConfig}}),Object.defineProperty(e,"genComponentStyleHook",{enumerable:!0,get:function(){return r.genComponentStyleHook}}),Object.defineProperty(e,"genPresetColor",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"genStyleHooks",{enumerable:!0,get:function(){return r.genStyleHooks}}),Object.defineProperty(e,"genSubStyleComponent",{enumerable:!0,get:function(){return r.genSubStyleComponent}}),Object.defineProperty(e,"getLineHeight",{enumerable:!0,get:function(){return o.getLineHeight}}),Object.defineProperty(e,"mergeToken",{enumerable:!0,get:function(){return i.mergeToken}}),Object.defineProperty(e,"statistic",{enumerable:!0,get:function(){return i.statistic}}),Object.defineProperty(e,"statisticToken",{enumerable:!0,get:function(){return i.statisticToken}}),Object.defineProperty(e,"useResetIconStyle",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"useStyleRegister",{enumerable:!0,get:function(){return n.useStyleRegister}}),Object.defineProperty(e,"useToken",{enumerable:!0,get:function(){return s.default}});var n=mM,i=AR,a=OR,o=mO,s=t(DR),r=lD,l=t(SD),c=t(ED),u=JA}(MR);var ND={},PD=uP.default;Object.defineProperty(ND,"__esModule",{value:!0}),ND.default=void 0;var MD=PD(A);const AD=Object.assign({},MD),{useId:OD}=AD,RD=void 0===OD?()=>"":OD;ND.default=RD;var DD=sP.default;Object.defineProperty(IR,"__esModule",{value:!0}),IR.default=function(e,t,n){var i;(0,zD.devUseWarning)("ConfigProvider");const a=e||{},o=!1!==a.inherit&&t?t:Object.assign(Object.assign({},UD.defaultConfig),{hashed:null!==(i=null==t?void 0:t.hashed)&&void 0!==i?i:UD.defaultConfig.hashed,cssVar:null==t?void 0:t.cssVar}),s=(0,HD.default)();return(0,LD.default)(()=>{var i,r;if(!e)return t;const l=Object.assign({},o.components);Object.keys(e.components||{}).forEach(t=>{l[t]=Object.assign(Object.assign({},l[t]),e.components[t])});const c=`css-var-${s.replace(/:/g,"")}`,u=(null!==(i=a.cssVar)&&void 0!==i?i:o.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:null==n?void 0:n.prefixCls},"object"==typeof o.cssVar?o.cssVar:{}),"object"==typeof a.cssVar?a.cssVar:{}),{key:"object"==typeof a.cssVar&&(null===(r=a.cssVar)||void 0===r?void 0:r.key)||c});return Object.assign(Object.assign(Object.assign({},o),a),{token:Object.assign(Object.assign({},o.token),a.token),components:l,cssVar:u})},[a,o],(e,t)=>e.some((e,n)=>{const i=t[n];return!(0,FD.default)(e,i,!0)}))};var LD=DD(vM),FD=DD(TR),zD=YM,UD=MR,HD=DD(ND);var BD={};const $D=G(he);var qD=uP.default;Object.defineProperty(BD,"__esModule",{value:!0}),BD.default=function(e){const t=GD.useContext(QD),{children:n}=e,[,i]=(0,WD.useToken)(),{motion:a}=i,o=GD.useRef(!1);if(o.current||(o.current=t!==a),o.current)return GD.createElement(QD.Provider,{value:a},GD.createElement(VD.Provider,{motion:a},n));return n};var GD=qD(A),VD=$D,WD=MR;const QD=GD.createContext(!0);var KD={},YD=uP.default;Object.defineProperty(KD,"__esModule",{value:!0}),KD.default=void 0,YD(A),KD.default=()=>null;var XD={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.useResetIconStyle}});var t=MR}(XD),function(e){var t=sP.default,n=uP.default;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"ConfigConsumer",{enumerable:!0,get:function(){return f.ConfigConsumer}}),Object.defineProperty(e,"ConfigContext",{enumerable:!0,get:function(){return f.ConfigContext}}),Object.defineProperty(e,"Variants",{enumerable:!0,get:function(){return f.Variants}}),e.default=e.configConsumerProps=void 0,Object.defineProperty(e,"defaultIconPrefixCls",{enumerable:!0,get:function(){return f.defaultIconPrefixCls}}),Object.defineProperty(e,"defaultPrefixCls",{enumerable:!0,get:function(){return f.defaultPrefixCls}}),e.warnContext=e.globalConfig=void 0;var i=n(A),a=mM,o=t(fM),s=t(vM),r=xM,l=n(YM),c=t(dA),u=n(pA),d=t(qA),h=t(fA),p=JA,m=t(ZA),f=LO,g=GO,v=mR,y=t(yR),b=t(IR),x=t(BD),w=t(KD),_=n(bR),S=t(XD);e.warnContext=null,e.configConsumerProps=["getTargetContainer","getPopupContainer","rootPrefixCls","getPrefixCls","renderEmpty","csp","autoInsertSpaceInButton","locale"];const C=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let E,k,I,T;function j(){return E||f.defaultPrefixCls}function N(){return k||f.defaultIconPrefixCls}e.globalConfig=()=>({getPrefixCls:(e,t)=>t||(e?`${j()}-${e}`:j()),getIconPrefixCls:N,getRootPrefixCls:()=>E||j(),getTheme:()=>I,holderRender:T});const P=e=>{const{children:t,csp:n,autoInsertSpaceInButton:d,alert:g,anchor:y,form:E,locale:k,componentSize:I,direction:T,space:j,splitter:N,virtual:P,dropdownMatchSelectWidth:M,popupMatchSelectWidth:A,popupOverflow:O,legacyLocale:R,parentContext:D,iconPrefixCls:L,theme:F,componentDisabled:z,segmented:U,statistic:H,spin:B,calendar:$,carousel:q,cascader:G,collapse:V,typography:W,checkbox:Q,descriptions:K,divider:Y,drawer:X,skeleton:J,steps:Z,image:ee,layout:te,list:ne,mentions:ie,modal:ae,progress:oe,result:se,slider:re,breadcrumb:le,menu:ce,pagination:ue,input:de,textArea:he,empty:pe,badge:me,radio:fe,rate:ge,switch:ve,transfer:ye,avatar:be,message:xe,tag:we,table:_e,card:Se,tabs:Ce,timeline:Ee,timePicker:ke,upload:Ie,notification:Te,tree:je,colorPicker:Ne,datePicker:Pe,rangePicker:Me,flex:Ae,wave:Oe,dropdown:Re,warning:De,tour:Le,tooltip:Fe,popover:ze,popconfirm:Ue,floatButton:He,floatButtonGroup:Be,variant:$e,inputNumber:qe,treeSelect:Ge}=e,Ve=i.useCallback((t,n)=>{const{prefixCls:i}=e;if(n)return n;const a=i||D.getPrefixCls("");return t?`${a}-${t}`:a},[D.getPrefixCls,e.prefixCls]),We=L||D.iconPrefixCls||f.defaultIconPrefixCls,Qe=n||D.csp;(0,S.default)(We,Qe);const Ke=(0,b.default)(F,D.theme,{prefixCls:Ve("")}),Ye={csp:Qe,autoInsertSpaceInButton:d,alert:g,anchor:y,locale:k||R,direction:T,space:j,splitter:N,virtual:P,popupMatchSelectWidth:null!=A?A:M,popupOverflow:O,getPrefixCls:Ve,iconPrefixCls:We,theme:Ke,segmented:U,statistic:H,spin:B,calendar:$,carousel:q,cascader:G,collapse:V,typography:W,checkbox:Q,descriptions:K,divider:Y,drawer:X,skeleton:J,steps:Z,image:ee,input:de,textArea:he,layout:te,list:ne,mentions:ie,modal:ae,progress:oe,result:se,slider:re,breadcrumb:le,menu:ce,pagination:ue,empty:pe,badge:me,radio:fe,rate:ge,switch:ve,transfer:ye,avatar:be,message:xe,tag:we,table:_e,card:Se,tabs:Ce,timeline:Ee,timePicker:ke,upload:Ie,notification:Te,tree:je,colorPicker:Ne,datePicker:Pe,rangePicker:Me,flex:Ae,wave:Oe,dropdown:Re,warning:De,tour:Le,tooltip:Fe,popover:ze,popconfirm:Ue,floatButton:He,floatButtonGroup:Be,variant:$e,inputNumber:qe,treeSelect:Ge},Xe=Object.assign({},D);Object.keys(Ye).forEach(e=>{void 0!==Ye[e]&&(Xe[e]=Ye[e])}),C.forEach(t=>{const n=e[t];n&&(Xe[t]=n)}),void 0!==d&&(Xe.button=Object.assign({autoInsertSpace:d},Xe.button));const Je=(0,s.default)(()=>Xe,Xe,(e,t)=>{const n=Object.keys(e),i=Object.keys(t);return n.length!==i.length||n.some(n=>e[n]!==t[n])}),{layer:Ze}=i.useContext(a.StyleContext),et=i.useMemo(()=>({prefixCls:We,csp:Qe,layer:Ze?"antd":void 0}),[We,Qe,Ze]);let tt=i.createElement(i.Fragment,null,i.createElement(w.default,{dropdownMatchSelectWidth:M}),t);const nt=i.useMemo(()=>{var e,t,n,i;return(0,r.merge)((null===(e=h.default.Form)||void 0===e?void 0:e.defaultValidateMessages)||{},(null===(n=null===(t=Je.locale)||void 0===t?void 0:t.Form)||void 0===n?void 0:n.defaultValidateMessages)||{},(null===(i=Je.form)||void 0===i?void 0:i.validateMessages)||{},(null==E?void 0:E.validateMessages)||{})},[Je,null==E?void 0:E.validateMessages]);Object.keys(nt).length>0&&(tt=i.createElement(c.default.Provider,{value:nt},tt)),k&&(tt=i.createElement(u.default,{locale:k,_ANT_MARK__:u.ANT_MARK},tt)),(We||Qe)&&(tt=i.createElement(o.default.Provider,{value:et},tt)),I&&(tt=i.createElement(_.SizeContextProvider,{size:I},tt)),tt=i.createElement(x.default,null,tt);const it=i.useMemo(()=>{const e=Ke||{},{algorithm:t,token:n,components:i,cssVar:o}=e,s=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n}(e,["algorithm","token","components","cssVar"]),r=t&&(!Array.isArray(t)||t.length>0)?(0,a.createTheme)(t):p.defaultTheme,l={};Object.entries(i||{}).forEach(([e,t])=>{const n=Object.assign({},t);"algorithm"in n&&(!0===n.algorithm?n.theme=r:(Array.isArray(n.algorithm)||"function"==typeof n.algorithm)&&(n.theme=(0,a.createTheme)(n.algorithm)),delete n.algorithm),l[e]=n});const c=Object.assign(Object.assign({},m.default),n);return Object.assign(Object.assign({},s),{theme:r,token:c,components:l,override:Object.assign({override:c},l),cssVar:o})},[Ke]);return F&&(tt=i.createElement(p.DesignTokenContext.Provider,{value:it},tt)),Je.warning&&(tt=i.createElement(l.WarningContext.Provider,{value:Je.warning},tt)),void 0!==z&&(tt=i.createElement(v.DisabledContextProvider,{disabled:z},tt)),i.createElement(f.ConfigContext.Provider,{value:Je},tt)},M=e=>{const t=i.useContext(f.ConfigContext),n=i.useContext(d.default);return i.createElement(P,Object.assign({parentContext:t,legacyLocale:n},e))};M.ConfigContext=f.ConfigContext,M.SizeContext=_.default,M.config=e=>{const{prefixCls:t,iconPrefixCls:n,theme:i,holderRender:a}=e;void 0!==t&&(E=t),void 0!==n&&(k=n),"holderRender"in e&&(T=a),i&&(!function(e){return Object.keys(e).some(e=>e.endsWith("Color"))}(i)?I=i:(0,g.registerTheme)(j(),i))},M.useConfig=y.default,Object.defineProperty(M,"SizeContext",{get:()=>_.default}),e.default=M}(pM);var JD={},ZD=sP.default;Object.defineProperty(JD,"__esModule",{value:!0}),JD.default=void 0;var eL=ZD(A),tL=ZD(bR);JD.default=e=>{const t=eL.default.useContext(tL.default);return eL.default.useMemo(()=>e?"string"==typeof e?null!=e?e:t:"function"==typeof e?e(t):t:t,[e,t])};var nL={};Object.defineProperty(nL,"__esModule",{value:!0}),nL.default=void 0;var iL=MR;const aL=e=>{const{componentCls:t}=e;return{[t]:{display:"inline-flex","&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"}}}};nL.default=(0,iL.genStyleHooks)(["Space","Compact"],e=>[aL(e)],()=>({}),{resetStyle:!1});var oL=sP.default,sL=uP.default;Object.defineProperty(nM,"__esModule",{value:!0}),nM.useCompactItemContext=nM.default=nM.SpaceCompactItemContext=nM.NoCompactStyle=void 0;var rL=sL(A),lL=oL(pe),cL=oL(iM),uL=pM,dL=oL(JD),hL=oL(nL),pL=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n};const mL=nM.SpaceCompactItemContext=rL.createContext(null);nM.useCompactItemContext=(e,t)=>{const n=rL.useContext(mL),i=rL.useMemo(()=>{if(!n)return"";const{compactDirection:i,isFirstItem:a,isLastItem:o}=n,s="vertical"===i?"-vertical-":"-";return(0,lL.default)(`${e}-compact${s}item`,{[`${e}-compact${s}first-item`]:a,[`${e}-compact${s}last-item`]:o,[`${e}-compact${s}item-rtl`]:"rtl"===t})},[e,t,n]);return{compactSize:null==n?void 0:n.compactSize,compactDirection:null==n?void 0:n.compactDirection,compactItemClassnames:i}};nM.NoCompactStyle=e=>{const{children:t}=e;return rL.createElement(mL.Provider,{value:null},t)};const fL=e=>{const{children:t}=e,n=pL(e,["children"]);return rL.createElement(mL.Provider,{value:rL.useMemo(()=>n,[n])},t)};nM.default=e=>{const{getPrefixCls:t,direction:n}=rL.useContext(uL.ConfigContext),{size:i,direction:a,block:o,prefixCls:s,className:r,rootClassName:l,children:c}=e,u=pL(e,["size","direction","block","prefixCls","className","rootClassName","children"]),d=(0,dL.default)(e=>null!=i?i:e),h=t("space-compact",s),[p,m]=(0,hL.default)(h),f=(0,lL.default)(h,m,{[`${h}-rtl`]:"rtl"===n,[`${h}-block`]:o,[`${h}-vertical`]:"vertical"===a},r,l),g=rL.useContext(mL),v=(0,cL.default)(c),y=rL.useMemo(()=>v.map((e,t)=>{const n=(null==e?void 0:e.key)||`${h}-item-${t}`;return rL.createElement(fL,{key:n,compactSize:d,compactDirection:a,isFirstItem:0===t&&(!g||(null==g?void 0:g.isFirstItem)),isLastItem:t===v.length-1&&(!g||(null==g?void 0:g.isLastItem))},e)}),[v,g,a,d,h]);return 0===v.length?null:p(rL.createElement("div",Object.assign({className:f},u),y))};var gL=sP.default;Object.defineProperty(VP,"__esModule",{value:!0}),VP.default=void 0;var vL=gL(A),yL=WP,bL=nM;VP.default=e=>{const{space:t,form:n,children:i}=e;if(null==i)return null;let a=i;return n&&(a=vL.default.createElement(yL.NoFormStyle,{override:!0,status:!0},a)),t&&(a=vL.default.createElement(bL.NoCompactStyle,null,a)),a};var xL={},wL={},_L={exports:{}},SL={},CL={exports:{}};!function(e){function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(CL);var EL=CL.exports,kL={};Object.defineProperty(kL,"__esModule",{value:!0});kL.default={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M799.86 166.31c.02 0 .04.02.08.06l57.69 57.7c.04.03.05.05.06.08a.12.12 0 010 .06c0 .03-.02.05-.06.09L569.93 512l287.7 287.7c.04.04.05.06.06.09a.12.12 0 010 .07c0 .02-.02.04-.06.08l-57.7 57.69c-.03.04-.05.05-.07.06a.12.12 0 01-.07 0c-.03 0-.05-.02-.09-.06L512 569.93l-287.7 287.7c-.04.04-.06.05-.09.06a.12.12 0 01-.07 0c-.02 0-.04-.02-.08-.06l-57.69-57.7c-.04-.03-.05-.05-.06-.07a.12.12 0 010-.07c0-.03.02-.05.06-.09L454.07 512l-287.7-287.7c-.04-.04-.05-.06-.06-.09a.12.12 0 010-.07c0-.02.02-.04.06-.08l57.7-57.69c.03-.04.05-.05.07-.06a.12.12 0 01.07 0c.03 0 .05.02.09.06L512 454.07l287.7-287.7c.04-.04.06-.05.09-.06a.12.12 0 01.07 0z"}}]},name:"close",theme:"outlined"};var IL={},TL={exports:{}},jL={exports:{}};!function(e){e.exports=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n},e.exports.__esModule=!0,e.exports.default=e.exports}(jL);var NL=jL.exports;!function(e){var t=NL;e.exports=function(e,n){if(null==e)return{};var i,a,o=t(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)i=s[a],-1===n.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o},e.exports.__esModule=!0,e.exports.default=e.exports}(TL);var PL=TL.exports,ML={},AL={},OL={};function RL(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}function DL(e){return RL(e)instanceof ShadowRoot}Object.defineProperty(OL,"__esModule",{value:!0}),OL.getShadowRoot=function(e){return DL(e)?RL(e):null},OL.inShadow=DL;var LL=uP.default,FL=sP.default;Object.defineProperty(AL,"__esModule",{value:!0}),AL.generate=function e(t,n,i){if(!i)return GL.default.createElement(t.tag,(0,zL.default)({key:n},WL(t.attrs)),(t.children||[]).map(function(i,a){return e(i,"".concat(n,"-").concat(t.tag,"-").concat(a))}));return GL.default.createElement(t.tag,(0,zL.default)((0,zL.default)({key:n},WL(t.attrs)),i),(t.children||[]).map(function(i,a){return e(i,"".concat(n,"-").concat(t.tag,"-").concat(a))}))},AL.getSecondaryColor=function(e){return(0,HL.generate)(e)[0]},AL.iconStyles=void 0,AL.isIconDefinition=function(e){return"object"===(0,UL.default)(e)&&"string"==typeof e.name&&"string"==typeof e.theme&&("object"===(0,UL.default)(e.icon)||"function"==typeof e.icon)},AL.normalizeAttrs=WL,AL.normalizeTwoToneColors=function(e){if(!e)return[];return Array.isArray(e)?e:[e]},AL.useInsertStyles=AL.svgBaseProps=void 0,AL.warning=function(e,t){(0,qL.default)(e,"[@ant-design/icons] ".concat(t))};var zL=FL(TM),UL=FL(cP),HL=aO,BL=VO,$L=OL,qL=FL(XM),GL=LL(A),VL=FL(fM);function WL(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce(function(t,n){var i,a=e[n];if("class"===n)t.className=a,delete t.class;else delete t[n],t[(i=n,i.replace(/-(.)/g,function(e,t){return t.toUpperCase()}))]=a;return t},{})}AL.svgBaseProps={width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",focusable:"false"};var QL=AL.iconStyles="\n.anticon {\n  display: inline-flex;\n  align-items: center;\n  color: inherit;\n  font-style: normal;\n  line-height: 0;\n  text-align: center;\n  text-transform: none;\n  vertical-align: -0.125em;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.anticon > * {\n  line-height: 1;\n}\n\n.anticon svg {\n  display: inline-block;\n}\n\n.anticon::before {\n  display: none;\n}\n\n.anticon .anticon-icon {\n  display: block;\n}\n\n.anticon[tabindex] {\n  cursor: pointer;\n}\n\n.anticon-spin::before,\n.anticon-spin {\n  display: inline-block;\n  -webkit-animation: loadingCircle 1s infinite linear;\n  animation: loadingCircle 1s infinite linear;\n}\n\n@-webkit-keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes loadingCircle {\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n";AL.useInsertStyles=function(e){var t=(0,GL.useContext)(VL.default),n=t.csp,i=t.prefixCls,a=t.layer,o=QL;i&&(o=o.replace(/anticon/g,i)),a&&(o="@layer ".concat(a," {\n").concat(o,"\n}")),(0,GL.useEffect)(function(){var t=e.current,i=(0,$L.getShadowRoot)(t);(0,BL.updateCSS)(o,"@ant-design-icons",{prepend:!a,csp:n,attachTo:i})},[])};var KL=sP.default,YL=uP.default;Object.defineProperty(ML,"__esModule",{value:!0}),ML.default=void 0;var XL=KL(PL),JL=KL(TM),ZL=YL(A),eF=AL,tF=["icon","className","onClick","style","primaryColor","secondaryColor"],nF={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};var iF=function(e){var t=e.icon,n=e.className,i=e.onClick,a=e.style,o=e.primaryColor,s=e.secondaryColor,r=(0,XL.default)(e,tF),l=ZL.useRef(),c=nF;if(o&&(c={primaryColor:o,secondaryColor:s||(0,eF.getSecondaryColor)(o)}),(0,eF.useInsertStyles)(l),(0,eF.warning)((0,eF.isIconDefinition)(t),"icon should be icon definiton, but got ".concat(t)),!(0,eF.isIconDefinition)(t))return null;var u=t;return u&&"function"==typeof u.icon&&(u=(0,JL.default)((0,JL.default)({},u),{},{icon:u.icon(c.primaryColor,c.secondaryColor)})),(0,eF.generate)(u.icon,"svg-".concat(u.name),(0,JL.default)((0,JL.default)({className:n,onClick:i,style:a,"data-icon":u.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},r),{},{ref:l}))};iF.displayName="IconReact",iF.getTwoToneColors=function(){return(0,JL.default)({},nF)},iF.setTwoToneColors=function(e){var t=e.primaryColor,n=e.secondaryColor;nF.primaryColor=t,nF.secondaryColor=n||(0,eF.getSecondaryColor)(t),nF.calculated=!!n},ML.default=iF;var aF={},oF=sP.default;Object.defineProperty(aF,"__esModule",{value:!0}),aF.getTwoToneColor=function(){var e=rF.default.getTwoToneColors();if(!e.calculated)return e.primaryColor;return[e.primaryColor,e.secondaryColor]},aF.setTwoToneColor=function(e){var t=(0,lF.normalizeTwoToneColors)(e),n=(0,sF.default)(t,2),i=n[0],a=n[1];return rF.default.setTwoToneColors({primaryColor:i,secondaryColor:a})};var sF=oF(CP),rF=oF(ML),lF=AL;var cF=sP.default,uF=uP.default;Object.defineProperty(IL,"__esModule",{value:!0}),IL.default=void 0;var dF=cF(EL),hF=cF(CP),pF=cF(IM),mF=cF(PL),fF=uF(A),gF=cF(pe),vF=aO,yF=cF(fM),bF=cF(ML),xF=aF,wF=AL,_F=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];(0,xF.setTwoToneColor)(vF.blue.primary);var SF=fF.forwardRef(function(e,t){var n=e.className,i=e.icon,a=e.spin,o=e.rotate,s=e.tabIndex,r=e.onClick,l=e.twoToneColor,c=(0,mF.default)(e,_F),u=fF.useContext(yF.default),d=u.prefixCls,h=void 0===d?"anticon":d,p=u.rootClassName,m=(0,gF.default)(p,h,(0,pF.default)((0,pF.default)({},"".concat(h,"-").concat(i.name),!!i.name),"".concat(h,"-spin"),!!a||"loading"===i.name),n),f=s;void 0===f&&r&&(f=-1);var g=o?{msTransform:"rotate(".concat(o,"deg)"),transform:"rotate(".concat(o,"deg)")}:void 0,v=(0,wF.normalizeTwoToneColors)(l),y=(0,hF.default)(v,2),b=y[0],x=y[1];return fF.createElement("span",(0,dF.default)({role:"img","aria-label":i.name},c,{ref:t,tabIndex:f,onClick:r,className:m}),fF.createElement(bF.default,{icon:i,primaryColor:b,secondaryColor:x,style:g}))});SF.displayName="AntdIcon",SF.getTwoToneColor=xF.getTwoToneColor,SF.setTwoToneColor=xF.setTwoToneColor,IL.default=SF;var CF=uP.default,EF=sP.default;Object.defineProperty(SL,"__esModule",{value:!0}),SL.default=void 0;var kF=EF(EL),IF=CF(A),TF=EF(kL),jF=EF(IL),NF=function(e,t){return IF.createElement(jF.default,(0,kF.default)({},e,{ref:t,icon:TF.default}))},PF=IF.forwardRef(NF);SL.default=PF,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n;const i=(n=SL)&&n.__esModule?n:{default:n};t.default=i,e.exports=i}(_L,_L.exports);var MF=_L.exports,AF={},OF=sP.default;Object.defineProperty(AF,"__esModule",{value:!0}),AF.default=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=!1===n?{aria:!0,data:!0,attr:!0}:!0===n?{aria:!0}:(0,RF.default)({},n);var i={};return Object.keys(e).forEach(function(n){(t.aria&&("role"===n||zF(n,LF))||t.data&&zF(n,FF)||t.attr&&DF.includes(n))&&(i[n]=e[n])}),i};var RF=OF(TM),DF="".concat("accept acceptCharset accessKey action allowFullScreen allowTransparency\n    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge\n    charSet checked classID className colSpan cols content contentEditable contextMenu\n    controls coords crossOrigin data dateTime default defer dir disabled download draggable\n    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder\n    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity\n    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media\n    mediaGroup method min minLength multiple muted name noValidate nonce open\n    optimum pattern placeholder poster preload radioGroup readOnly rel required\n    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected\n    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style\n    summary tabIndex target title type useMap value width wmode wrap"," ").concat("onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown\n    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick\n    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown\n    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel\n    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough\n    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata\n    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError").split(/[\s\n]+/),LF="aria-",FF="data-";function zF(e,t){return 0===e.indexOf(t)}var UF={};Object.defineProperty(UF,"__esModule",{value:!0}),UF.default=void 0,UF.default=function(...e){const t={};return e.forEach(e=>{e&&Object.keys(e).forEach(n=>{void 0!==e[n]&&(t[n]=e[n])})}),t};var HF=sP.default;Object.defineProperty(wL,"__esModule",{value:!0}),wL.pickClosable=function(e){if(!e)return;const{closable:t,closeIcon:n}=e;return{closable:t,closeIcon:n}},wL.useClosable=void 0;var BF=HF(A),$F=HF(MF),qF=HF(AF),GF=pA,VF=HF(fA),WF=HF(UF);function QF(e){const{closable:t,closeIcon:n}=e||{};return BF.default.useMemo(()=>{if(!t&&(!1===t||!1===n||null===n))return!1;if(void 0===t&&void 0===n)return null;let e={closeIcon:"boolean"!=typeof n&&null!==n?n:void 0};return t&&"object"==typeof t&&(e=Object.assign(Object.assign({},e),t)),e},[t,n])}const KF={};wL.useClosable=(e,t,n=KF)=>{const i=QF(e),a=QF(t),[o]=(0,GF.useLocale)("global",VF.default.global),s="boolean"!=typeof i&&!!(null==i?void 0:i.disabled),r=BF.default.useMemo(()=>Object.assign({closeIcon:BF.default.createElement($F.default,null)},n),[n]),l=BF.default.useMemo(()=>!1!==i&&(i?(0,WF.default)(r,a,i):!1!==a&&(a?(0,WF.default)(r,a):!!r.closable&&r)),[i,a,r]);return BF.default.useMemo(()=>{var e,t;if(!1===l)return[!1,null,s,{}];const{closeIconRender:n}=r,{closeIcon:i}=l;let a=i;const c=(0,qF.default)(l,!0);return null!=a&&(n&&(a=n(i)),a=BF.default.isValidElement(a)?BF.default.cloneElement(a,Object.assign(Object.assign(Object.assign({},a.props),{"aria-label":null!==(t=null===(e=a.props)||void 0===e?void 0:e["aria-label"])&&void 0!==t?t:o.close}),c)):BF.default.createElement("span",Object.assign({"aria-label":o.close},c),a)),[!0,a,s,c]},[s,o.close,l,r])};var YF={},XF=sP.default;Object.defineProperty(YF,"__esModule",{value:!0}),YF.useForceUpdate=void 0;var JF=XF(A);YF.useForceUpdate=()=>JF.default.useReducer(e=>e+1,0);var ZF={},ez=uP.default,tz=sP.default;Object.defineProperty(ZF,"__esModule",{value:!0}),ZF.mergeClassNames=oz,ZF.useMergeSemantic=void 0;var nz=tz(DM),iz=ez(A),az=tz(pe);function oz(e,...t){const n=e||{};return t.reduce((e,t)=>(Object.keys(t||{}).forEach(i=>{const a=n[i],o=t[i];if(a&&"object"==typeof a)if(o&&"object"==typeof o)e[i]=oz(a,e[i],o);else{const{_default:t}=a;t&&(e[i]=e[i]||{},e[i][t]=(0,az.default)(e[i][t],o))}else e[i]=(0,az.default)(e[i],o)}),e),{})}function sz(e,...t){return iz.useMemo(()=>oz.apply(void 0,[e].concat(t)),[t,e])}function rz(...e){return iz.useMemo(()=>e.reduce((e,t={})=>(Object.keys(t).forEach(n=>{e[n]=Object.assign(Object.assign({},e[n]),t[n])}),e),{}),[e])}function lz(e,t){const n=Object.assign({},e);return Object.keys(t).forEach(e=>{if("_default"!==e){const i=t[e],a=n[e]||{};n[e]=i?lz(a,i):a}}),n}ZF.useMergeSemantic=(e,t,n)=>{const i=sz.apply(void 0,[n].concat((0,nz.default)(e))),a=rz.apply(void 0,(0,nz.default)(t));return iz.useMemo(()=>[lz(i,n),lz(a,n)],[i,a,n])};var cz={};Object.defineProperty(cz,"__esModule",{value:!0}),cz.useMultipleSelect=void 0;var uz=A;cz.useMultipleSelect=e=>{const[t,n]=(0,uz.useState)(null);return[(0,uz.useCallback)((i,a,o)=>{const s=null!=t?t:i,r=Math.min(s||0,i),l=Math.max(s||0,i),c=a.slice(r,l+1).map(e),u=c.some(e=>!o.has(e)),d=[];return c.forEach(e=>{u?(o.has(e)||d.push(e),o.add(e)):(o.delete(e),d.push(e))}),n(u?l:null),d},[t]),n]};var dz={},hz=uP.default,pz=sP.default;Object.defineProperty(dz,"__esModule",{value:!0}),dz.usePatchElement=void 0;var mz=pz(DM),fz=hz(A);dz.usePatchElement=()=>{const[e,t]=fz.useState([]);return[e,fz.useCallback(e=>(t(t=>[].concat((0,mz.default)(t),[e])),()=>{t(t=>t.filter(t=>t!==e))}),[])]};var gz={};Object.defineProperty(gz,"__esModule",{value:!0}),gz.useProxyImperativeHandle=void 0;var vz=A;gz.useProxyImperativeHandle=(e,t)=>(0,vz.useImperativeHandle)(e,()=>{const e=t(),{nativeElement:n}=e;return"undefined"!=typeof Proxy?new Proxy(n,{get:(t,n)=>e[n]?e[n]:Reflect.get(t,n)}):(a=e,(i=n)._antProxy=i._antProxy||{},Object.keys(a).forEach(e=>{if(!(e in i._antProxy)){const t=i[e];i._antProxy[e]=t,i[e]=a[e]}}),i);var i,a});var yz={},bz=uP.default;Object.defineProperty(yz,"__esModule",{value:!0}),yz.useSyncState=void 0;var xz=bz(A),wz=YF;yz.useSyncState=e=>{const t=xz.useRef(e),[,n]=(0,wz.useForceUpdate)();return[()=>t.current,e=>{t.current=e,n()}]};var _z={},Sz={},Cz=sP.default;Object.defineProperty(Sz,"__esModule",{value:!0}),Sz.default=void 0;const Ez=Cz(A).default.createContext(void 0);Sz.default=Ez;var kz=sP.default;Object.defineProperty(_z,"__esModule",{value:!0}),_z.useZIndex=_z.containerBaseZIndexOffset=_z.consumerBaseZIndexOffset=_z.CONTAINER_MAX_OFFSET=void 0;var Iz=kz(A),Tz=kz(DR),jz=kz(Sz);const Nz=100;_z.CONTAINER_MAX_OFFSET=1e3;const Pz=_z.containerBaseZIndexOffset={Modal:Nz,Drawer:Nz,Popover:Nz,Popconfirm:Nz,Tooltip:Nz,Tour:Nz,FloatButton:Nz},Mz=_z.consumerBaseZIndexOffset={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};_z.useZIndex=(e,t)=>{const[,n]=(0,Tz.default)(),i=Iz.default.useContext(jz.default),a=e in Pz;let o;if(void 0!==t)o=[t,t];else{let s=null!=i?i:0;s+=a?(i?0:n.zIndexPopupBase)+Pz[e]:Mz[e],o=[void 0===i?t:s,s]}return o},function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=wL;Object.keys(t).forEach(function(n){"default"!==n&&"__esModule"!==n&&(n in e&&e[n]===t[n]||Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[n]}}))});var n=YF;Object.keys(n).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===n[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return n[t]}}))});var i=ZF;Object.keys(i).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===i[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return i[t]}}))});var a=cz;Object.keys(a).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===a[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return a[t]}}))});var o=dz;Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===o[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}}))});var s=gz;Object.keys(s).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===s[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return s[t]}}))});var r=yz;Object.keys(r).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===r[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[t]}}))});var l=_z;Object.keys(l).forEach(function(t){"default"!==t&&"__esModule"!==t&&(t in e&&e[t]===l[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return l[t]}}))})}(xL);var Az={};Object.defineProperty(Az,"__esModule",{value:!0}),Az.getTransitionName=Az.default=void 0;var Oz=pM;const Rz=()=>({height:0,opacity:0}),Dz=e=>{const{scrollHeight:t}=e;return{height:t,opacity:1}},Lz=e=>({height:e?e.offsetHeight:0}),Fz=(e,t)=>!0===(null==t?void 0:t.deadline)||"height"===t.propertyName;Az.getTransitionName=(e,t,n)=>void 0!==n?n:`${e}-${t}`,Az.default=(e=Oz.defaultPrefixCls)=>({motionName:`${e}-motion-collapse`,onAppearStart:Rz,onEnterStart:Rz,onAppearActive:Dz,onEnterActive:Dz,onLeaveStart:Lz,onLeaveActive:Rz,onAppearEnd:Fz,onEnterEnd:Fz,onLeaveEnd:Fz,motionDeadline:500});var zz={},Uz={},Hz={};Object.defineProperty(Hz,"__esModule",{value:!0}),Hz.genRoundedArrow=void 0,Hz.getArrowToken=function(e){const{sizePopupArrow:t,borderRadiusXS:n,borderRadiusOuter:i}=e,a=t/2,o=a,s=1*i/Math.sqrt(2),r=a-i*(1-1/Math.sqrt(2)),l=a-n*(1/Math.sqrt(2)),c=i*(Math.sqrt(2)-1)+n*(1/Math.sqrt(2)),u=2*a-l,d=c,h=2*a-s,p=r,m=2*a-0,f=o,g=a*Math.sqrt(2)+i*(Math.sqrt(2)-2),v=i*(Math.sqrt(2)-1);return{arrowShadowWidth:g,arrowPath:`path('M 0 ${o} A ${i} ${i} 0 0 0 ${s} ${r} L ${l} ${c} A ${n} ${n} 0 0 1 ${u} ${d} L ${h} ${p} A ${i} ${i} 0 0 0 ${m} ${f} Z')`,arrowPolygon:`polygon(${v}px 100%, 50% ${v}px, ${2*a-v}px 100%, ${v}px 100%)`}};var Bz=mM;Hz.genRoundedArrow=(e,t,n)=>{const{sizePopupArrow:i,arrowPolygon:a,arrowPath:o,arrowShadowWidth:s,borderRadiusXS:r,calc:l}=e;return{pointerEvents:"none",width:i,height:i,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:i,height:l(i).div(2).equal(),background:t,clipPath:{_multi_value_:!0,value:[a,o]},content:'""'},"&::after":{content:'""',position:"absolute",width:s,height:s,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${(0,Bz.unit)(r)} 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:n,zIndex:0,background:"transparent"}}},Object.defineProperty(Uz,"__esModule",{value:!0}),Uz.MAX_VERTICAL_CONTENT_RADIUS=void 0,Uz.default=function(e,t,n){const{componentCls:i,boxShadowPopoverArrow:a,arrowOffsetVertical:o,arrowOffsetHorizontal:s}=e,{arrowDistance:r=0,arrowPlacement:l={left:!0,right:!0,top:!0,bottom:!0}}=n||{};return{[i]:Object.assign(Object.assign(Object.assign(Object.assign({[`${i}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},(0,qz.genRoundedArrow)(e,t,a)),{"&:before":{background:t}})]},Vz(!!l.top,{[[`&-placement-top > ${i}-arrow`,`&-placement-topLeft > ${i}-arrow`,`&-placement-topRight > ${i}-arrow`].join(",")]:{bottom:r,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top > ${i}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},"&-placement-topLeft":{"--arrow-offset-horizontal":s,[`> ${i}-arrow`]:{left:{_skip_check_:!0,value:s}}},"&-placement-topRight":{"--arrow-offset-horizontal":`calc(100% - ${(0,$z.unit)(s)})`,[`> ${i}-arrow`]:{right:{_skip_check_:!0,value:s}}}})),Vz(!!l.bottom,{[[`&-placement-bottom > ${i}-arrow`,`&-placement-bottomLeft > ${i}-arrow`,`&-placement-bottomRight > ${i}-arrow`].join(",")]:{top:r,transform:"translateY(-100%)"},[`&-placement-bottom > ${i}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},"&-placement-bottomLeft":{"--arrow-offset-horizontal":s,[`> ${i}-arrow`]:{left:{_skip_check_:!0,value:s}}},"&-placement-bottomRight":{"--arrow-offset-horizontal":`calc(100% - ${(0,$z.unit)(s)})`,[`> ${i}-arrow`]:{right:{_skip_check_:!0,value:s}}}})),Vz(!!l.left,{[[`&-placement-left > ${i}-arrow`,`&-placement-leftTop > ${i}-arrow`,`&-placement-leftBottom > ${i}-arrow`].join(",")]:{right:{_skip_check_:!0,value:r},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left > ${i}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop > ${i}-arrow`]:{top:o},[`&-placement-leftBottom > ${i}-arrow`]:{bottom:o}})),Vz(!!l.right,{[[`&-placement-right > ${i}-arrow`,`&-placement-rightTop > ${i}-arrow`,`&-placement-rightBottom > ${i}-arrow`].join(",")]:{left:{_skip_check_:!0,value:r},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right > ${i}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop > ${i}-arrow`]:{top:o},[`&-placement-rightBottom > ${i}-arrow`]:{bottom:o}}))}},Uz.getArrowOffsetToken=function(e){const{contentRadius:t,limitVerticalRadius:n}=e,i=t>12?t+2:12;return{arrowOffsetHorizontal:i,arrowOffsetVertical:n?Gz:i}};var $z=mM,qz=Hz;const Gz=Uz.MAX_VERTICAL_CONTENT_RADIUS=8;function Vz(e,t){return e?t:{}}Object.defineProperty(zz,"__esModule",{value:!0}),zz.default=function(e){const{arrowWidth:t,autoAdjustOverflow:n,arrowPointAtCenter:i,offset:a,borderRadius:o,visibleFirst:s}=e,r=t/2,l={},c=(0,Wz.getArrowOffsetToken)({contentRadius:o,limitVerticalRadius:!0});return Object.keys(Kz).forEach(e=>{const o=i&&Yz[e]||Kz[e],u=Object.assign(Object.assign({},o),{offset:[0,0],dynamicInset:!0});switch(l[e]=u,Xz.has(e)&&(u.autoArrow=!1),e){case"top":case"topLeft":case"topRight":u.offset[1]=-r-a;break;case"bottom":case"bottomLeft":case"bottomRight":u.offset[1]=r+a;break;case"left":case"leftTop":case"leftBottom":u.offset[0]=-r-a;break;case"right":case"rightTop":case"rightBottom":u.offset[0]=r+a}if(i)switch(e){case"topLeft":case"bottomLeft":u.offset[0]=-c.arrowOffsetHorizontal-r;break;case"topRight":case"bottomRight":u.offset[0]=c.arrowOffsetHorizontal+r;break;case"leftTop":case"rightTop":u.offset[1]=2*-c.arrowOffsetHorizontal+r;break;case"leftBottom":case"rightBottom":u.offset[1]=2*c.arrowOffsetHorizontal-r}u.overflow=Qz(e,c,t,n),s&&(u.htmlRegion="visibleFirst")}),l},zz.getOverflowOptions=Qz;var Wz=Uz;function Qz(e,t,n,i){if(!1===i)return{adjustX:!1,adjustY:!1};const a=i&&"object"==typeof i?i:{},o={};switch(e){case"top":case"bottom":o.shiftX=2*t.arrowOffsetHorizontal+n,o.shiftY=!0,o.adjustY=!0;break;case"left":case"right":o.shiftY=2*t.arrowOffsetVertical+n,o.shiftX=!0,o.adjustX=!0}const s=Object.assign(Object.assign({},o),a);return s.shiftX||(s.adjustX=!0),s.shiftY||(s.adjustY=!0),s}const Kz={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},Yz={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},Xz=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);var Jz={},Zz=sP.default;Object.defineProperty(Jz,"__esModule",{value:!0}),Jz.cloneElement=function(e,t){return tU(e,e,t)},Jz.isFragment=function(e){return e&&eU.default.isValidElement(e)&&e.type===eU.default.Fragment},Jz.replaceElement=void 0;var eU=Zz(A);const tU=(e,t,n)=>eU.default.isValidElement(e)?eU.default.cloneElement(e,"function"==typeof n?n(e.props||{}):n):t;Jz.replaceElement=tU;var nU={},iU={},aU={},oU={};Object.defineProperty(oU,"__esModule",{value:!0}),oU.default=void 0;oU.default=e=>({[e.componentCls]:{[`${e.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},\n        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}},[`${e.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},\n        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}}});var sU={},rU={};Object.defineProperty(rU,"__esModule",{value:!0}),rU.initMotion=void 0;const lU=e=>({animationDuration:e,animationFillMode:"both"}),cU=e=>({animationDuration:e,animationFillMode:"both"});rU.initMotion=(e,t,n,i,a=!1)=>{const o=a?"&":"";return{[`\n      ${o}${e}-enter,\n      ${o}${e}-appear\n    `]:Object.assign(Object.assign({},lU(i)),{animationPlayState:"paused"}),[`${o}${e}-leave`]:Object.assign(Object.assign({},cU(i)),{animationPlayState:"paused"}),[`\n      ${o}${e}-enter${e}-enter-active,\n      ${o}${e}-appear${e}-appear-active\n    `]:{animationName:t,animationPlayState:"running"},[`${o}${e}-leave${e}-leave-active`]:{animationName:n,animationPlayState:"running",pointerEvents:"none"}}},Object.defineProperty(sU,"__esModule",{value:!0}),sU.initFadeMotion=sU.fadeOut=sU.fadeIn=void 0;var uU=mM,dU=rU;const hU=sU.fadeIn=new uU.Keyframes("antFadeIn",{"0%":{opacity:0},"100%":{opacity:1}}),pU=sU.fadeOut=new uU.Keyframes("antFadeOut",{"0%":{opacity:1},"100%":{opacity:0}});sU.initFadeMotion=(e,t=!1)=>{const{antCls:n}=e,i=`${n}-fade`,a=t?"&":"";return[(0,dU.initMotion)(i,hU,pU,e.motionDurationMid,t),{[`\n        ${a}${i}-enter,\n        ${a}${i}-appear\n      `]:{opacity:0,animationTimingFunction:"linear"},[`${a}${i}-leave`]:{animationTimingFunction:"linear"}}]};var mU={};Object.defineProperty(mU,"__esModule",{value:!0}),mU.moveUpOut=mU.moveUpIn=mU.moveRightOut=mU.moveRightIn=mU.moveLeftOut=mU.moveLeftIn=mU.moveDownOut=mU.moveDownIn=mU.initMoveMotion=void 0;var fU=mM,gU=rU;const vU=mU.moveDownIn=new fU.Keyframes("antMoveDownIn",{"0%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),yU=mU.moveDownOut=new fU.Keyframes("antMoveDownOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, 100%, 0)",transformOrigin:"0 0",opacity:0}}),bU=mU.moveLeftIn=new fU.Keyframes("antMoveLeftIn",{"0%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),xU=mU.moveLeftOut=new fU.Keyframes("antMoveLeftOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(-100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),wU=mU.moveRightIn=new fU.Keyframes("antMoveRightIn",{"0%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),_U=mU.moveRightOut=new fU.Keyframes("antMoveRightOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(100%, 0, 0)",transformOrigin:"0 0",opacity:0}}),SU={"move-up":{inKeyframes:mU.moveUpIn=new fU.Keyframes("antMoveUpIn",{"0%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0},"100%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1}}),outKeyframes:mU.moveUpOut=new fU.Keyframes("antMoveUpOut",{"0%":{transform:"translate3d(0, 0, 0)",transformOrigin:"0 0",opacity:1},"100%":{transform:"translate3d(0, -100%, 0)",transformOrigin:"0 0",opacity:0}})},"move-down":{inKeyframes:vU,outKeyframes:yU},"move-left":{inKeyframes:bU,outKeyframes:xU},"move-right":{inKeyframes:wU,outKeyframes:_U}};mU.initMoveMotion=(e,t)=>{const{antCls:n}=e,i=`${n}-${t}`,{inKeyframes:a,outKeyframes:o}=SU[t];return[(0,gU.initMotion)(i,a,o,e.motionDurationMid),{[`\n        ${i}-enter,\n        ${i}-appear\n      `]:{opacity:0,animationTimingFunction:e.motionEaseOutCirc},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]};var CU={};Object.defineProperty(CU,"__esModule",{value:!0}),CU.slideUpOut=CU.slideUpIn=CU.slideRightOut=CU.slideRightIn=CU.slideLeftOut=CU.slideLeftIn=CU.slideDownOut=CU.slideDownIn=CU.initSlideMotion=void 0;var EU=mM,kU=rU;const IU={"slide-up":{inKeyframes:CU.slideUpIn=new EU.Keyframes("antSlideUpIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1}}),outKeyframes:CU.slideUpOut=new EU.Keyframes("antSlideUpOut",{"0%":{transform:"scaleY(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"0% 0%",opacity:0}})},"slide-down":{inKeyframes:CU.slideDownIn=new EU.Keyframes("antSlideDownIn",{"0%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0},"100%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1}}),outKeyframes:CU.slideDownOut=new EU.Keyframes("antSlideDownOut",{"0%":{transform:"scaleY(1)",transformOrigin:"100% 100%",opacity:1},"100%":{transform:"scaleY(0.8)",transformOrigin:"100% 100%",opacity:0}})},"slide-left":{inKeyframes:CU.slideLeftIn=new EU.Keyframes("antSlideLeftIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1}}),outKeyframes:CU.slideLeftOut=new EU.Keyframes("antSlideLeftOut",{"0%":{transform:"scaleX(1)",transformOrigin:"0% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"0% 0%",opacity:0}})},"slide-right":{inKeyframes:CU.slideRightIn=new EU.Keyframes("antSlideRightIn",{"0%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0},"100%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1}}),outKeyframes:CU.slideRightOut=new EU.Keyframes("antSlideRightOut",{"0%":{transform:"scaleX(1)",transformOrigin:"100% 0%",opacity:1},"100%":{transform:"scaleX(0.8)",transformOrigin:"100% 0%",opacity:0}})}};CU.initSlideMotion=(e,t)=>{const{antCls:n}=e,i=`${n}-${t}`,{inKeyframes:a,outKeyframes:o}=IU[t];return[(0,kU.initMotion)(i,a,o,e.motionDurationMid),{[`\n      ${i}-enter,\n      ${i}-appear\n    `]:{transform:"scale(0)",transformOrigin:"0% 0%",opacity:0,animationTimingFunction:e.motionEaseOutQuint,"&-prepare":{transform:"scale(1)"}},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInQuint}}]};var TU={};Object.defineProperty(TU,"__esModule",{value:!0}),TU.zoomUpOut=TU.zoomUpIn=TU.zoomRightOut=TU.zoomRightIn=TU.zoomOut=TU.zoomLeftOut=TU.zoomLeftIn=TU.zoomIn=TU.zoomDownOut=TU.zoomDownIn=TU.zoomBigOut=TU.zoomBigIn=TU.initZoomMotion=void 0;var jU=mM,NU=rU;const PU=TU.zoomIn=new jU.Keyframes("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),MU=TU.zoomOut=new jU.Keyframes("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),AU=TU.zoomBigIn=new jU.Keyframes("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),OU=TU.zoomBigOut=new jU.Keyframes("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),RU=TU.zoomUpIn=new jU.Keyframes("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),DU=TU.zoomUpOut=new jU.Keyframes("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),LU={zoom:{inKeyframes:PU,outKeyframes:MU},"zoom-big":{inKeyframes:AU,outKeyframes:OU},"zoom-big-fast":{inKeyframes:AU,outKeyframes:OU},"zoom-left":{inKeyframes:TU.zoomLeftIn=new jU.Keyframes("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),outKeyframes:TU.zoomLeftOut=new jU.Keyframes("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}})},"zoom-right":{inKeyframes:TU.zoomRightIn=new jU.Keyframes("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),outKeyframes:TU.zoomRightOut=new jU.Keyframes("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}})},"zoom-up":{inKeyframes:RU,outKeyframes:DU},"zoom-down":{inKeyframes:TU.zoomDownIn=new jU.Keyframes("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),outKeyframes:TU.zoomDownOut=new jU.Keyframes("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}})}};TU.initZoomMotion=(e,t)=>{const{antCls:n}=e,i=`${n}-${t}`,{inKeyframes:a,outKeyframes:o}=LU[t];return[(0,NU.initMotion)(i,a,o,"zoom-big-fast"===t?e.motionDurationFast:e.motionDurationMid),{[`\n        ${i}-enter,\n        ${i}-appear\n      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:e.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${i}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]},function(e){var t=sP.default;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"fadeIn",{enumerable:!0,get:function(){return i.fadeIn}}),Object.defineProperty(e,"fadeOut",{enumerable:!0,get:function(){return i.fadeOut}}),Object.defineProperty(e,"genCollapseMotion",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"initFadeMotion",{enumerable:!0,get:function(){return i.initFadeMotion}}),Object.defineProperty(e,"initMoveMotion",{enumerable:!0,get:function(){return a.initMoveMotion}}),Object.defineProperty(e,"initSlideMotion",{enumerable:!0,get:function(){return o.initSlideMotion}}),Object.defineProperty(e,"initZoomMotion",{enumerable:!0,get:function(){return s.initZoomMotion}}),Object.defineProperty(e,"moveDownIn",{enumerable:!0,get:function(){return a.moveDownIn}}),Object.defineProperty(e,"moveDownOut",{enumerable:!0,get:function(){return a.moveDownOut}}),Object.defineProperty(e,"moveLeftIn",{enumerable:!0,get:function(){return a.moveLeftIn}}),Object.defineProperty(e,"moveLeftOut",{enumerable:!0,get:function(){return a.moveLeftOut}}),Object.defineProperty(e,"moveRightIn",{enumerable:!0,get:function(){return a.moveRightIn}}),Object.defineProperty(e,"moveRightOut",{enumerable:!0,get:function(){return a.moveRightOut}}),Object.defineProperty(e,"moveUpIn",{enumerable:!0,get:function(){return a.moveUpIn}}),Object.defineProperty(e,"moveUpOut",{enumerable:!0,get:function(){return a.moveUpOut}}),Object.defineProperty(e,"slideDownIn",{enumerable:!0,get:function(){return o.slideDownIn}}),Object.defineProperty(e,"slideDownOut",{enumerable:!0,get:function(){return o.slideDownOut}}),Object.defineProperty(e,"slideLeftIn",{enumerable:!0,get:function(){return o.slideLeftIn}}),Object.defineProperty(e,"slideLeftOut",{enumerable:!0,get:function(){return o.slideLeftOut}}),Object.defineProperty(e,"slideRightIn",{enumerable:!0,get:function(){return o.slideRightIn}}),Object.defineProperty(e,"slideRightOut",{enumerable:!0,get:function(){return o.slideRightOut}}),Object.defineProperty(e,"slideUpIn",{enumerable:!0,get:function(){return o.slideUpIn}}),Object.defineProperty(e,"slideUpOut",{enumerable:!0,get:function(){return o.slideUpOut}}),Object.defineProperty(e,"zoomBigIn",{enumerable:!0,get:function(){return s.zoomBigIn}}),Object.defineProperty(e,"zoomBigOut",{enumerable:!0,get:function(){return s.zoomBigOut}}),Object.defineProperty(e,"zoomDownIn",{enumerable:!0,get:function(){return s.zoomDownIn}}),Object.defineProperty(e,"zoomDownOut",{enumerable:!0,get:function(){return s.zoomDownOut}}),Object.defineProperty(e,"zoomIn",{enumerable:!0,get:function(){return s.zoomIn}}),Object.defineProperty(e,"zoomLeftIn",{enumerable:!0,get:function(){return s.zoomLeftIn}}),Object.defineProperty(e,"zoomLeftOut",{enumerable:!0,get:function(){return s.zoomLeftOut}}),Object.defineProperty(e,"zoomOut",{enumerable:!0,get:function(){return s.zoomOut}}),Object.defineProperty(e,"zoomRightIn",{enumerable:!0,get:function(){return s.zoomRightIn}}),Object.defineProperty(e,"zoomRightOut",{enumerable:!0,get:function(){return s.zoomRightOut}}),Object.defineProperty(e,"zoomUpIn",{enumerable:!0,get:function(){return s.zoomUpIn}}),Object.defineProperty(e,"zoomUpOut",{enumerable:!0,get:function(){return s.zoomUpOut}});var n=t(oU),i=sU,a=mU,o=CU,s=TU}(aU);var FU=uP.default;Object.defineProperty(iU,"__esModule",{value:!0}),iU.prepareComponentToken=iU.default=void 0;var zU=mM,UU=cD,HU=aU,BU=FU(Uz),$U=Hz,qU=MR;const GU=e=>{const{calc:t,componentCls:n,tooltipMaxWidth:i,tooltipColor:a,tooltipBg:o,tooltipBorderRadius:s,zIndexPopup:r,controlHeight:l,boxShadowSecondary:c,paddingSM:u,paddingXS:d,arrowOffsetHorizontal:h,sizePopupArrow:p}=e,m=t(s).add(p).add(h).equal(),f=t(s).mul(2).add(p).equal();return[{[n]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,UU.resetComponent)(e)),{position:"absolute",zIndex:r,display:"block",width:"max-content",maxWidth:i,visibility:"visible","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"&-hidden":{display:"none"},"--antd-arrow-background-color":o,[`${n}-inner`]:{minWidth:f,minHeight:l,padding:`${(0,zU.unit)(e.calc(u).div(2).equal())} ${(0,zU.unit)(d)}`,color:`var(--ant-tooltip-color, ${a})`,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:o,borderRadius:s,boxShadow:c,boxSizing:"border-box"},[["&-placement-topLeft","&-placement-topRight","&-placement-bottomLeft","&-placement-bottomRight"].join(",")]:{minWidth:m},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${n}-inner`]:{borderRadius:e.min(s,BU.MAX_VERTICAL_CONTENT_RADIUS)}},[`${n}-content`]:{position:"relative"}}),(0,qU.genPresetColor)(e,(e,{darkColor:t})=>({[`&${n}-${e}`]:{[`${n}-inner`]:{backgroundColor:t},[`${n}-arrow`]:{"--antd-arrow-background-color":t}}}))),{"&-rtl":{direction:"rtl"}})},(0,BU.default)(e,"var(--antd-arrow-background-color)"),{[`${n}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow}}]},VU=e=>Object.assign(Object.assign({zIndexPopup:e.zIndexPopupBase+70},(0,BU.getArrowOffsetToken)({contentRadius:e.borderRadius,limitVerticalRadius:!0})),(0,$U.getArrowToken)((0,qU.mergeToken)(e,{borderRadiusOuter:Math.min(e.borderRadiusOuter,4)})));iU.prepareComponentToken=VU;iU.default=(e,t=!0)=>(0,qU.genStyleHooks)("Tooltip",e=>{const{borderRadius:t,colorTextLightSolid:n,colorBgSpotlight:i}=e,a=(0,qU.mergeToken)(e,{tooltipMaxWidth:250,tooltipColor:n,tooltipBorderRadius:t,tooltipBg:i});return[GU(a),(0,HU.initZoomMotion)(e,"zoom-big-fast")]},VU,{resetStyle:!1,injectStyle:t})(e);var WU={},QU={},KU=sP.default;Object.defineProperty(QU,"__esModule",{value:!0}),QU.PresetStatusColorTypes=void 0,QU.isPresetColor=function(e,t=!0){if(t)return[].concat((0,YU.default)(JU),(0,YU.default)(XU.PresetColors)).includes(e);return XU.PresetColors.includes(e)},QU.isPresetStatusColor=function(e){return ZU.includes(e)};var YU=KU(DM),XU=OR;const JU=XU.PresetColors.map(e=>`${e}-inverse`),ZU=QU.PresetStatusColorTypes=["success","processing","error","default","warning"];var eH={};const tH=G(me);var nH={},iH={exports:{}};!function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports}(iH);var aH=iH.exports,oH={exports:{}};!function(e){var t=kM;function n(e,n){for(var i=0;i<n.length;i++){var a=n[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,t(a.key),a)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports}(oH);var sH=oH.exports,rH=sP.default;Object.defineProperty(nH,"__esModule",{value:!0}),nH.toHexFormat=nH.getHex=nH.AggregationColor=void 0;var lH=rH(aH),cH=rH(sH),uH=tH;const dH=(e,t)=>(null==e?void 0:e.replace(/[^\w/]/g,"").slice(0,t?8:6))||"";nH.toHexFormat=dH;const hH=(e,t)=>e?dH(e,t):"";nH.getHex=hH,nH.AggregationColor=function(){return(0,cH.default)(function e(t){var n;if((0,lH.default)(this,e),this.cleared=!1,t instanceof e)return this.metaColor=t.metaColor.clone(),this.colors=null===(n=t.colors)||void 0===n?void 0:n.map(t=>({color:new e(t.color),percent:t.percent})),void(this.cleared=t.cleared);const i=Array.isArray(t);i&&t.length?(this.colors=t.map(({color:t,percent:n})=>({color:new e(t),percent:n})),this.metaColor=new uH.Color(this.colors[0].color.metaColor)):this.metaColor=new uH.Color(i?"":t),(!t||i&&!this.colors)&&(this.metaColor=this.metaColor.setA(0),this.cleared=!0)},[{key:"toHsb",value:function(){return this.metaColor.toHsb()}},{key:"toHsbString",value:function(){return this.metaColor.toHsbString()}},{key:"toHex",value:function(){return hH(this.toHexString(),this.metaColor.a<1)}},{key:"toHexString",value:function(){return this.metaColor.toHexString()}},{key:"toRgb",value:function(){return this.metaColor.toRgb()}},{key:"toRgbString",value:function(){return this.metaColor.toRgbString()}},{key:"isGradient",value:function(){return!!this.colors&&!this.cleared}},{key:"getColors",value:function(){return this.colors||[{color:this,percent:0}]}},{key:"toCssString",value:function(){const{colors:e}=this;if(e){return`linear-gradient(90deg, ${e.map(e=>`${e.color.toRgbString()} ${e.percent}%`).join(", ")})`}return this.metaColor.toRgbString()}},{key:"equals",value:function(e){return!(!e||this.isGradient()!==e.isGradient())&&(this.isGradient()?this.colors.length===e.colors.length&&this.colors.every((t,n)=>{const i=e.colors[n];return t.percent===i.percent&&t.color.equals(i.color)}):this.toHexString()===e.toHexString())}}])}();var pH=sP.default;Object.defineProperty(eH,"__esModule",{value:!0}),eH.getRoundNumber=eH.getGradientPercentColor=eH.getColorAlpha=eH.generateColor=eH.genAlphaColor=void 0;var mH=pH(DM),fH=tH,gH=nH;const vH=e=>e instanceof gH.AggregationColor?e:new gH.AggregationColor(e);eH.generateColor=vH;const yH=e=>Math.round(Number(e||0));eH.getRoundNumber=yH;eH.getColorAlpha=e=>yH(100*e.toHsb().a);eH.genAlphaColor=(e,t)=>{const n=e.toRgb();if(!n.r&&!n.g&&!n.b){const n=e.toHsb();return n.a=t||1,vH(n)}return n.a=t||1,vH(n)};eH.getGradientPercentColor=(e,t)=>{const n=[{percent:0,color:e[0].color}].concat((0,mH.default)(e),[{percent:100,color:e[e.length-1].color}]);for(let i=0;i<n.length-1;i+=1){const e=n[i].percent,a=n[i+1].percent,o=n[i].color,s=n[i+1].color;if(e<=t&&t<=a){const n=a-e;if(0===n)return o;const i=(t-e)/n*100,r=new fH.Color(o),l=new fH.Color(s);return r.mix(l,i).toRgbString()}}return""};var bH=sP.default;Object.defineProperty(WU,"__esModule",{value:!0}),WU.parseColor=function(e,t){const n=(0,wH.isPresetColor)(t),i=(0,xH.default)({[`${e}-${t}`]:t&&n}),a={},o={},s=(0,_H.generateColor)(t).toRgb(),r=(.299*s.r+.587*s.g+.114*s.b)/255<.5?"#FFF":"#000";t&&!n&&(a.background=t,a["--ant-tooltip-color"]=r,o["--antd-arrow-background-color"]=t);return{className:i,overlayStyle:a,arrowStyle:o}};var xH=bH(pe),wH=QU,_H=eH;var SH=sP.default,CH=uP.default;Object.defineProperty(nU,"__esModule",{value:!0}),nU.default=void 0;var EH=CH(A),kH=SH(pe),IH=dP,TH=pM,jH=SH(iU),NH=WU;nU.default=e=>{const{prefixCls:t,className:n,placement:i="top",title:a,color:o,overlayInnerStyle:s}=e,{getPrefixCls:r}=EH.useContext(TH.ConfigContext),l=r("tooltip",t),[c,u,d]=(0,jH.default)(l),h=(0,NH.parseColor)(l,o),p=h.arrowStyle,m=Object.assign(Object.assign({},s),h.overlayStyle),f=(0,kH.default)(u,d,l,`${l}-pure`,`${l}-placement-${i}`,n,h.className);return c(EH.createElement("div",{className:f,style:p},EH.createElement("div",{className:`${l}-arrow`}),EH.createElement(IH.Popup,Object.assign({},e,{className:u,prefixCls:l,overlayInnerStyle:m}),a)))};var PH=sP.default,MH=uP.default;Object.defineProperty(aP,"__esModule",{value:!0});var AH=aP.default=void 0,OH=MH(A),RH=PH(pe),DH=PH(dP),LH=PH(hP),FH=PH(VP),zH=xL,UH=Az,HH=PH(zz),BH=Jz,$H=YM,qH=PH(Sz),GH=LO,VH=MR,WH=PH(nU),QH=PH(iU),KH=WU;const YH=OH.forwardRef((e,t)=>{var n,i;const{prefixCls:a,openClassName:o,getTooltipContainer:s,color:r,overlayInnerStyle:l,children:c,afterOpenChange:u,afterVisibleChange:d,destroyTooltipOnHide:h,destroyOnHidden:p,arrow:m=!0,title:f,overlay:g,builtinPlacements:v,arrowPointAtCenter:y=!1,autoAdjustOverflow:b=!0,motion:x,getPopupContainer:w,placement:_="top",mouseEnterDelay:S=.1,mouseLeaveDelay:C=.1,overlayStyle:E,rootClassName:k,overlayClassName:I,styles:T,classNames:j}=e,N=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]])}return n}(e,["prefixCls","openClassName","getTooltipContainer","color","overlayInnerStyle","children","afterOpenChange","afterVisibleChange","destroyTooltipOnHide","destroyOnHidden","arrow","title","overlay","builtinPlacements","arrowPointAtCenter","autoAdjustOverflow","motion","getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName","overlayClassName","styles","classNames"]),P=!!m,[,M]=(0,VH.useToken)(),{getPopupContainer:A,getPrefixCls:O,direction:R,className:D,style:L,classNames:F,styles:z}=(0,GH.useComponentConfig)("tooltip"),U=(0,$H.devUseWarning)("Tooltip"),H=OH.useRef(null),B=()=>{var e;null===(e=H.current)||void 0===e||e.forceAlign()};OH.useImperativeHandle(t,()=>{var e,t;return{forceAlign:B,forcePopupAlign:()=>{U.deprecated(!1,"forcePopupAlign","forceAlign"),B()},nativeElement:null===(e=H.current)||void 0===e?void 0:e.nativeElement,popupElement:null===(t=H.current)||void 0===t?void 0:t.popupElement}});const[$,q]=(0,LH.default)(!1,{value:null!==(n=e.open)&&void 0!==n?n:e.visible,defaultValue:null!==(i=e.defaultOpen)&&void 0!==i?i:e.defaultVisible}),G=!f&&!g&&0!==f,V=OH.useMemo(()=>{var e,t;let n=y;return"object"==typeof m&&(n=null!==(t=null!==(e=m.pointAtCenter)&&void 0!==e?e:m.arrowPointAtCenter)&&void 0!==t?t:y),v||(0,HH.default)({arrowPointAtCenter:n,autoAdjustOverflow:b,arrowWidth:P?M.sizePopupArrow:0,borderRadius:M.borderRadius,offset:M.marginXXS,visibleFirst:!0})},[y,m,v,M]),W=OH.useMemo(()=>0===f?f:g||f||"",[g,f]),Q=OH.createElement(FH.default,{space:!0},"function"==typeof W?W():W),K=O("tooltip",a),Y=O(),X=e["data-popover-inject"];let J=$;"open"in e||"visible"in e||!G||(J=!1);const Z=OH.isValidElement(c)&&!(0,BH.isFragment)(c)?c:OH.createElement("span",null,c),ee=Z.props,te=ee.className&&"string"!=typeof ee.className?ee.className:(0,RH.default)(ee.className,o||`${K}-open`),[ne,ie,ae]=(0,QH.default)(K,!X),oe=(0,KH.parseColor)(K,r),se=oe.arrowStyle,re=(0,RH.default)(I,{[`${K}-rtl`]:"rtl"===R},oe.className,k,ie,ae,D,F.root,null==j?void 0:j.root),le=(0,RH.default)(F.body,null==j?void 0:j.body),[ce,ue]=(0,zH.useZIndex)("Tooltip",N.zIndex),de=OH.createElement(DH.default,Object.assign({},N,{zIndex:ce,showArrow:P,placement:_,mouseEnterDelay:S,mouseLeaveDelay:C,prefixCls:K,classNames:{root:re,body:le},styles:{root:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},se),z.root),L),E),null==T?void 0:T.root),body:Object.assign(Object.assign(Object.assign(Object.assign({},z.body),l),null==T?void 0:T.body),oe.overlayStyle)},getTooltipContainer:w||s||A,ref:H,builtinPlacements:V,overlay:Q,visible:J,onVisibleChange:t=>{var n,i;q(!G&&t),G||(null===(n=e.onOpenChange)||void 0===n||n.call(e,t),null===(i=e.onVisibleChange)||void 0===i||i.call(e,t))},afterVisibleChange:null!=u?u:d,arrowContent:OH.createElement("span",{className:`${K}-arrow-content`}),motion:{motionName:(0,UH.getTransitionName)(Y,"zoom-big-fast",e.transitionName),motionDeadline:1e3},destroyTooltipOnHide:null!=p?p:!!h}),J?(0,BH.cloneElement)(Z,{className:te}):Z);return ne(OH.createElement(qH.default.Provider,{value:ue},de))}),XH=YH;XH._InternalPanelDoNotUseOrYouWillBeFired=WH.default,AH=aP.default=XH;const JH=({text:e="",setMessageInputTextIndent:t,style:n,disabled:i=!1,IsDeepResearchRounds:a=!1,isPlanning:o=!1})=>{const{updateFeatureType:s}=TT(),{i18n:r}=$(),[l,c]=A.useState(!1),u=A.useRef(null),[d,h]=A.useState(!1),p=A.useCallback(e=>{if(u.current&&(u.current.disconnect(),u.current=null),e){const n=new ResizeObserver(e=>{const n=e[0].borderBoxSize[0].inlineSize||0;t(n?n+8:n)});n.observe(e),u.current=n}},[t]),m=A.useMemo(()=>an.jsxs("div",{className:"prompt-input-func-type-popover-content",children:[an.jsxs("div",{className:"prompt-input-func-type-popover-header",children:[an.jsx("p",{className:"prompt-input-func-type-popover-title",children:r.t("Need to adjust?")}),an.jsx("div",{className:"prompt-input-func-type-popover-close-box",onClick:()=>{c(!1)},children:an.jsx(pt,{type:"icon-close-4",className:"prompt-input-func-type-popover-close-icon"})})]}),an.jsx("div",{className:"prompt-input-func-type-popover-body",children:r.t("You can provide more information to steer the research.")})]}),[r]),f=A.useCallback(e=>{o&&(d?c(!1):(h(!0),c(e)))},[d,o]),g=an.jsx("div",{className:Y("prompt-input-input-func-type",{disabled:i,"deep-research-rounds":a}),ref:p,onClick:()=>{a||i||(s({subChatType:ng.Txt2Txt,chatType:ng.Txt2Txt}),t(0),kT.emit(vE.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,{suggestItem:{},active:!1}))},style:n,children:an.jsx(AH,{title:i?r.t("Exit the current mode by creating a new chat"):"",children:an.jsxs("div",{className:"prompt-input-input-func-type-pc-container",children:[an.jsx(pt,{type:"icon-line-chevron-left",className:"icon-line-chevron-left"}),an.jsx("span",{className:"prompt-input-input-func-type-text",children:e})]})})});return an.jsx(ne,{classNames:{root:"propmpt-input-func-type-popover-container"},trigger:"click",placement:"top",autoAdjustOverflow:!0,content:m,open:l,onOpenChange:f,children:g})},ZH=Lx(),eB=e=>{const t=A.useMemo(()=>{const t=e.showSizeSelector&&[ng.ImageGeneration,ng.VideoGeneration].includes(e.messageType),n=!t&&[ng.VideoGeneration].includes(e.messageType)||e.disabled&&e.messageType!==ng.VideoGeneration;return _(w({},e),{showSizeSelector:t,showIcon:!1,showCloseBtn:!e.disabled&&!e.IsDeepResearchRounds,showDividingLine:!e.disabled&&!e.IsDeepResearchRounds,fullBgColor:!e.disabled&&!e.IsDeepResearchRounds,disabled:n})},[e]);return ZH?an.jsx(iP,w({},t)):an.jsx(JH,w({},e))};class tB{constructor(e,t,n){var i;this.length_=e,this.scaleFactor_=(e-1)/t,this.interpolate=this.cubic,"point"===n.method?this.interpolate=this.point:"linear"===n.method?this.interpolate=this.linear:"sinc"===n.method&&(this.interpolate=this.sinc),this.tangentFactor_=1-Math.max(0,Math.min(1,n.tension||0)),this.sincFilterSize_=n.sincFilterSize||1,this.kernel_=(i=n.sincWindow||nB,function(e){return function(e){return 0===e?1:Math.sin(Math.PI*e)/(Math.PI*e)}(e)*i(e)})}point(e,t){return this.getClippedInput_(Math.round(this.scaleFactor_*e),t)}linear(e,t){e=this.scaleFactor_*e;let n=Math.floor(e);return(1-(e-=n))*this.getClippedInput_(n,t)+e*this.getClippedInput_(n+1,t)}cubic(e,t){e=this.scaleFactor_*e;let n=Math.floor(e),i=[this.getTangent_(n,t),this.getTangent_(n+1,t)],a=[this.getClippedInput_(n,t),this.getClippedInput_(n+1,t)],o=(e-=n)*e,s=e*o;return(2*s-3*o+1)*a[0]+(s-2*o+e)*i[0]+(-2*s+3*o)*a[1]+(s-o)*i[1]}sinc(e,t){e=this.scaleFactor_*e;let n=Math.floor(e),i=n-this.sincFilterSize_+1,a=n+this.sincFilterSize_,o=0;for(let s=i;s<=a;s++)o+=this.kernel_(e-s)*this.getClippedInput_(s,t);return o}getTangent_(e,t){return this.tangentFactor_*(this.getClippedInput_(e+1,t)-this.getClippedInput_(e-1,t))/2}getClippedInput_(e,t){return 0<=e&&e<this.length_?t[e]:0}}function nB(e){return Math.exp(-e/2*e/2)}const iB={point:!1,linear:!1,cubic:!0,sinc:!0},aB={IIR:16,FIR:71},oB={IIR:class{constructor(e,t,n){let i=[];for(let a=0;a<e;a++)i.push(this.getCoeffs_({Fs:t,Fc:n,Q:.5/Math.sin(Math.PI/(2*e)*(a+.5))}));this.stages=[];for(let a=0;a<i.length;a++)this.stages[a]={b0:i[a].b[0],b1:i[a].b[1],b2:i[a].b[2],a1:i[a].a[0],a2:i[a].a[1],k:i[a].k,z:[0,0]}}filter(e){let t=e;for(let n=0,i=this.stages.length;n<i;n++)t=this.runStage_(n,t);return t}getCoeffs_(e){let t={z:[0,0],a:[],b:[]},n=this.preCalc_(e,t);return t.k=1,t.b.push((1-n.cw)/(2*n.a0)),t.b.push(2*t.b[0]),t.b.push(t.b[0]),t}preCalc_(e,t){let n={},i=2*Math.PI*e.Fc/e.Fs;return n.alpha=Math.sin(i)/(2*e.Q),n.cw=Math.cos(i),n.a0=1+n.alpha,t.a0=n.a0,t.a.push(-2*n.cw/n.a0),t.k=1,t.a.push((1-n.alpha)/n.a0),n}runStage_(e,t){let n=t*this.stages[e].k-this.stages[e].a1*this.stages[e].z[0]-this.stages[e].a2*this.stages[e].z[1],i=this.stages[e].b0*n+this.stages[e].b1*this.stages[e].z[0]+this.stages[e].b2*this.stages[e].z[1];return this.stages[e].z[1]=this.stages[e].z[0],this.stages[e].z[0]=n,i}reset(){for(let e=0;e<this.stages.length;e++)this.stages[e].z=[0,0]}},FIR:class{constructor(e,t,n){let i=2*Math.PI*n/t,a=0;this.filters=[];for(let o=0;o<=e;o++)o-e/2==0?this.filters[o]=i:(this.filters[o]=Math.sin(i*(o-e/2))/(o-e/2),this.filters[o]*=.54-.46*Math.cos(2*Math.PI*o/e)),a+=this.filters[o];for(let o=0;o<=e;o++)this.filters[o]/=a;this.z=this.initZ_()}filter(e){this.z.buf[this.z.pointer]=e;let t=0;for(let n=0,i=this.z.buf.length;n<i;n++)t+=this.filters[n]*this.z.buf[(this.z.pointer+n)%this.z.buf.length];return this.z.pointer=(this.z.pointer+1)%this.z.buf.length,t}reset(){this.z=this.initZ_()}initZ_(){let e=[];for(let t=0;t<this.filters.length-1;t++)e.push(0);return{buf:e,pointer:0}}}};function sB(e,t,n,i={}){let a=(n-t)/t+1,o=new Float64Array(e.length*a);i.method=i.method||"cubic";let s=new tB(e.length,o.length,{method:i.method,tension:i.tension||0,sincFilterSize:i.sincFilterSize||6,sincWindow:i.sincWindow||void 0});if(void 0===i.LPF&&(i.LPF=iB[i.method]),i.LPF){i.LPFType=i.LPFType||"IIR";const a=oB[i.LPFType];if(n>t){!function(e,t,n,i){for(let a=0,o=t.length;a<o;a++)t[a]=i.filter(n.interpolate(a,e));i.reset();for(let a=t.length-1;a>=0;a--)t[a]=i.filter(t[a])}(e,o,s,new a(i.LPFOrder||aB[i.LPFType],n,t/2))}else{!function(e,t,n,i){for(let a=0,o=e.length;a<o;a++)e[a]=i.filter(e[a]);i.reset();for(let a=e.length-1;a>=0;a--)e[a]=i.filter(e[a]);rB(e,t,n)}(e,o,s,new a(i.LPFOrder||aB[i.LPFType],t,n/2))}}else rB(e,o,s);return o}function rB(e,t,n){for(let i=0,a=t.length;i<a;i++)t[i]=n.interpolate(i,e)}function lB(e,t,n){for(let i=0;i<n.length;i++)e.setUint8(t+i,n.charCodeAt(i))}const cB=class{constructor(){C(this,"audioContext"),C(this,"mediaStream",null),C(this,"mediaSourceNode",null),C(this,"scriptNode",null),C(this,"_state",2),C(this,"isCollectingData",!1),C(this,"frameData",[]),C(this,"frameLength",50),C(this,"audioDataBuffers",[]),C(this,"start",()=>j(this,null,function*(){var e;try{if(0===this.state)return;if(2===this.state&&(this.audioDataBuffers=[],this.frameData=[]),this.mediaStream&&1===this.state)return this.isCollectingData=!0,void this.setRecordState(0);"closed"===this.audioContext.state&&(this.audioContext=new(window.AudioContext||window.webkitAudioContext)),"running"!==this.audioContext.state&&(yield this.audioContext.resume()),this.mediaStream=yield navigator.mediaDevices.getUserMedia({audio:{channelCount:1,noiseSuppression:!1,echoCancellation:!1}}),this.scriptProcessorNodeRecord(),this.isCollectingData=!0,this.setRecordState(0)}catch(t){null==(e=this.onError)||e.call(this,t)}})),C(this,"pause",()=>{0===this.state&&(this.isCollectingData=!1,this.setRecordState(1))}),C(this,"resume",()=>{1===this.state&&(this.isCollectingData=!0,this.setRecordState(0))}),C(this,"stop",()=>{var e,t,n,i,a,o,s,r;this.mediaStream&&(this.isCollectingData=!1,null==(n=null==(t=null==(e=this.mediaStream)?void 0:e.getTracks())?void 0:t.forEach)||n.call(t,e=>{e.stop()}),null==(a=null==(i=this.scriptNode)?void 0:i.disconnect)||a.call(i),null==(s=null==(o=this.mediaSourceNode)?void 0:o.disconnect)||s.call(o),this.mediaStream=null,this.mediaSourceNode=null,this.scriptNode=null,this.setRecordState(2),null==(r=this.onStop)||r.call(this))}),C(this,"destroy",()=>{this.stop(),this.audioContext&&"closed"!==this.audioContext.state&&this.audioContext.close().catch(e=>{})}),C(this,"analyzeAudio",e=>{if(!this.mediaSourceNode)return;const{frameLength:t=50}=e||{};if(this.frameLength=t,!this.mediaStream)return;const n=this.audioContext.createAnalyser();n.fftSize=512,this.mediaSourceNode.connect(n);const i=new Uint8Array(n.frequencyBinCount);this.calculateAudioFrame(n,i)}),C(this,"onRecorderStateChange",null),C(this,"onStop",null),C(this,"onError",null),C(this,"onAudioFrame",null),C(this,"onDataAvailable",null),!window.AudioContext&&window.webkitAudioContext,this.audioContext=new(window.AudioContext||window.webkitAudioContext)}scriptProcessorNodeRecord(){this.mediaStream&&(this.mediaSourceNode=this.audioContext.createMediaStreamSource(this.mediaStream),this.scriptNode=this.audioContext.createScriptProcessor(2048,1,1),this.scriptNode.onaudioprocess=e=>{var t;if(!this.isCollectingData)return;const n=sB(e.inputBuffer.getChannelData(0).slice(0),this.audioContext.sampleRate,16e3),i=new Int16Array(n.length);for(let a=0;a<n.length;++a)i[a]=32767*Math.max(-1,Math.min(1,n[a]));this.audioDataBuffers.push(e.inputBuffer.getChannelData(0).slice()),null==(t=this.onDataAvailable)||t.call(this,i.buffer)},this.mediaSourceNode.connect(this.scriptNode),this.scriptNode.connect(this.audioContext.destination))}calculateAudioFrame(e,t){var n;if(0!==this.state)return;e.getByteFrequencyData(t);const i=[...new Set(t.map(e=>e/2).sort((e,t)=>t-e))],a=i[Math.round(i.length/3)];this.frameData.push(a);const o=this.frameData.length-this.frameLength;o>0?this.frameData.splice(0,o):o<0&&this.frameData.unshift(...Array(-o).fill(0)),null==(n=this.onAudioFrame)||n.call(this,{data:this.frameData}),window.requestAnimationFrame(()=>{this.calculateAudioFrame(e,t)})}setRecordState(e){var t;this._state=e,null==(t=this.onRecorderStateChange)||t.call(this,e)}get state(){return this._state}getAudioFile(){if(this.audioDataBuffers.length){const e=(e=>{if(0===e.length)return;const t=e.reduce((e,t)=>e+t.length,0),n=new Float32Array(t);let i=0;for(let a=0;a<e.length;a++){const t=e[a];n.set(t,i),i+=t.length}return n})(this.audioDataBuffers);if(e){const t=((e,t,n=16,i=1)=>{const{length:a}=e,o=new ArrayBuffer(44+2*a),s=new DataView(o);lB(s,0,"RIFF"),s.setUint32(4,44+2*a,!0),lB(s,8,"WAVE"),lB(s,12,"fmt "),s.setUint32(16,16,!0),s.setUint16(20,1,!0),s.setUint16(22,i,!0),s.setUint32(24,t,!0),s.setUint32(28,t*i*(n/8),!0),s.setUint16(32,i*(n/8),!0),s.setUint16(34,n,!0),lB(s,36,"data"),s.setUint32(40,2*a,!0);let r=44;for(let l=0;l<a;l++)s.setInt16(r,32767*e[l],!0),r+=2;return o})(e,this.audioContext.sampleRate,16,1),n=new Blob([t],{type:"audio/wav"});return new File([n],"audio.wav",{type:"audio/wav"})}}}};C(cB,"isPermissionEnabled",()=>j(cB,null,function*(){var e;let t=!1;try{if(zx()&&window.QwenChat){const n=window.QwenChat,i=Ax()?"RECORD_AUDIO":"MICROPHONE";if(null==n?void 0:n.requestPermissions){const a=yield n.requestPermissions({permissions:[i]});t="allow"===(null==(e=null==a?void 0:a.result)?void 0:e[i])}}else{const e=yield navigator.mediaDevices.getUserMedia({audio:!0});e&&(setTimeout(()=>{e.getTracks().forEach(e=>e.stop())}),t=!0)}}catch(n){}return t}));let uB=cB;const dB=({setRecording:e,visible:t=!0})=>{const n=$(),i=()=>j(void 0,null,function*(){(yield uB.isPermissionEnabled())?e(!0):tE.open({type:"error",content:n.t("Permission denied when accessing microphone")})});return t?an.jsx("div",{className:"record-btn-container",children:an.jsx(AH,{title:n.t("Record voice"),children:an.jsx("button",{id:"voice-input-button",className:"record-btn",type:"button",onTouchStart:Vx()?i:void 0,onClick:Vx()?void 0:i,"aria-label":"Voice Input",children:an.jsx(pt,{type:"icon-line-microphone-02",className:"microphone-icon"})})})}):null},hB=A.memo(({value:e="",onChange:t=()=>{},onSend:n=()=>{},onInputPaste:i=()=>{},placeholder:a="",disabled:o=!1,messageType:s,inDetail:r=!1,sendChatGenerationEvent:l=()=>{},setRecording:c=()=>{},renderProps:u=()=>null,isPlanning:d=!1,IsDeepResearchRounds:h})=>{const p=A.useRef(null),{i18n:m}=$(),f=Ex(e=>e.mobile),g=qx(),[v,y]=A.useState(0),[b,x]=A.useState(0),w=Sx(e=>e.isPdfCardVisible),_=TT(e=>e.files),S=TT(e=>e.setIsFocus),C=TT(e=>e.showDetail),E=TT(e=>e.setShowDetail),k=TT(e=>e.updateFeatureType),I=TT(e=>e.setSelectedSuggest),T=Sx(e=>e.taskRunning),j=Sx(e=>e.visionGenerating),N=vx(e=>e.isChat),P=vx(e=>e.currentInputFeature),M=A.useRef(!1),O=A.useRef(!1),R=A.useRef(0),D=A.useMemo(()=>[ng.DeepResearch,ng.Travel].includes(s)&&w?"":(e=>{Ox();let t="";switch(e){case"artifacts":t=Pv("Artifacts");break;case"t2i":t=Pv("Image Generation");break;case"t2v":case"i2v":t=Pv("Video Generation");break;case"deep_research":t=Pv("Deep Research");break;case"web_dev":t=Pv("Web Dev");break;case"image_edit":t=Pv("Image Edit");break;case"travel":t=Pv("Travel Planner");break;case"learn":t=Pv("Learn")}return t})(s),[s,w]),L=A.useMemo(()=>!(s===ng.VideoGeneration&&(null==_?void 0:_.some(e=>"image"===e.type))),[s,_]);A.useEffect(()=>{""===D&&E(!1)},[D,E]),A.useEffect(()=>{E(!1);kT.firstOn(vE.MESSAGE_INPUT_TRIGGER_FOCUS,(e=!0)=>{(e=>{p.current&&(e?p.current.focus():p.current.blur())})(e)})},[]);const F=A.useMemo(()=>{var e;const t=[ng.ImageGeneration,ng.ImageEdit,ng.VideoGeneration,ng.WebDev,ng.Artifacts,ng.DeepResearch],n=null==(e=kT.getChatOptions())?void 0:e.history;if(t.includes(s)&&r&&n&&!N){let e=!1;for(const i in n.messages)if(t.includes(n.messages[i].chat_type)){e=!0;break}return e}return r},[s,N,r]),z=A.useCallback(e=>{const t=e.target,n=g?"96px":"192px";t.style.maxHeight=n;t.style.height="24px";const i=t.scrollHeight;i!==R.current?(R.current=i,y(e=>e+.001)):y(e=>Math.floor(e));const a=((e,t,n)=>{const i=t?96:192,a=Math.max(1,Math.ceil(e/n));return Math.min(a*n,i)+"px"})(i,g,24);t.style.height=a,t.style.maxHeight=""},[g]);A.useEffect(()=>{const t=p.current;t&&(""===e&&p.current?(p.current.style.height="",R.current=0):z({target:t}))},[e]),A.useEffect(()=>{p.current&&(R.current=p.current.scrollHeight)},[]);return an.jsxs("div",{className:"chat-input-container",children:[D&&an.jsx(eB,{text:D,setMessageInputTextIndent:y,style:{transform:`translateY(-${b}px)`},messageType:s,IsDeepResearchRounds:h,disabled:r&&F&&!h,inDetail:r,showSizeSelector:L,isPlanning:d}),f&&(null==u?void 0:u()),an.jsxs(X,{className:Y({"chat-input-not-input-feature-flex-container":!P||P===ng.Txt2Txt||P===ng.WebSearch}),children:[an.jsx("textarea",{id:Vf.CHAT_INPUT,ref:p,value:e,onChange:e=>{var n;M.current||(n=e.target.value,/^\s*\n/.test(n)&&y(e=>e+.001),t(e.target.value),C&&P===ng.Txt2Txt&&(E(!1),kT.emit(vE.MESSAGE_INPUT_RECOMMEND_WORDS_INIT)))},onBlur:()=>{S(!1),kT.emit(vE.MESSAGE_INPUT_ON_BLUR)},onKeyDown:t=>{const i=h&&(""!==(null==e?void 0:e.trim())||_.length>0);O.current||f||(i||!T&&!j)&&("Enter"!==t.key||t.shiftKey||(t.preventDefault(),N&&!h||(e.trim()||_.length>0)&&!o&&n(e),l("enter")),""!==e||"Backspace"!==t.key||g||F||(I(""),E(!1),k({subChatType:ng.Txt2Txt,chatType:ng.Txt2Txt})))},onFocusCapture:()=>{S(!0)},disabled:o,className:Y("chat-input",{"chat-input-image-edit":P===ng.ImageEdit}),name:"chat-input",placeholder:a||m.t("How can I help you today?"),style:{textIndent:D?v:0},rows:1,onScroll:e=>{const t=e.target;x(t.scrollTop)},onPaste:e=>{M.current=!0,i(e),requestAnimationFrame(()=>{if(M.current=!1,p.current){p.current.style.height="auto";let e=p.current.scrollHeight;if(R.current=e,g)e=Math.min(e,96);else{const t=192;e=Math.min(e,t)}p.current.style.height=e+"px"}})},onFocus:()=>{S(!0)},onCompositionStart:()=>{O.current=!0},onCompositionEnd:()=>{O.current=!1}}),an.jsx(dB,{setRecording:c,visible:f&&!UT()})]})]})}),pB=({iconType:e="",imgUrl:t="",buttonText:n,disabled:i=!1,disabledText:a="",size:o="normal",rounded:s="normal",onClick:r=()=>{}})=>{const l=()=>{r(),dS("clkRecommendGroup",{params:{et:"CLK",c4:n}})};return a?an.jsx(vt,{arrow:!0,show:Boolean(a),title:a?an.jsx("span",{dangerouslySetInnerHTML:{__html:a}}):"",children:an.jsxs("div",{className:"chat-prompt-suggest-button "+(i?"disabled":""),onClick:l,children:[e?an.jsx(pt,{type:e,className:"chat-prompt-suggest-button-icon"}):t?an.jsx("img",{src:t,className:"chat-prompt-suggest-button-img",alt:""}):null,an.jsx("div",{children:n})]})}):an.jsxs("div",{className:`chat-prompt-suggest-button ${o} ${s} ${i?"disabled":""}`,onClick:l,children:[e?an.jsx(pt,{type:e,className:"chat-prompt-suggest-button-icon"}):t?an.jsx("img",{src:t,className:"chat-prompt-suggest-button-img",alt:""}):null,an.jsx("div",{children:n})]})},mB=()=>window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",fB=({data:e,onChange:t})=>{const{i18n:n}=$(),i=ok(e,2);return an.jsx("div",{className:"recommend-web-dev-mobile",children:an.jsx("div",{className:"recommend-web-list",children:i.map((e,i)=>an.jsxs("div",{className:"recommend-web-item-wrap",children:[an.jsx("img",{className:"recommend-web-item",src:"light"===mB()?e.src:e.darkSrc||e.src,alt:""}),an.jsx("button",{className:"recommend-use-prompt-btn",onClick:()=>{return n=e.query||e.title,void t({inputText:n});var n},children:n.t("Use Prompt")})]},i))})})},gB=({data:e,onChange:t})=>{const n=ok(e,2);return an.jsx("div",{className:"recommend-web-container",children:an.jsx("div",{className:"recommend-web-list",children:n.map((e,n)=>an.jsxs("div",{className:"recommend-web-item-wrap",children:[an.jsx("img",{className:"recommend-web-item",src:"light"===mB()?e.src:e.darkSrc||e.src,alt:""}),an.jsxs("div",{className:"recommend-web-item-footer",onClick:()=>{return n=e.query||e.title,j(void 0,null,function*(){t({inputText:n})});var n},children:[an.jsx("div",{className:"recommend-web-item-footer-title",children:e.query||e.title}),an.jsx(pt,{type:"icon-line-arrow-up-right",className:"recommend-web-item-footer-icon"})]})]},n))})})},vB=Lx(),yB=({onChange:e})=>{const{i18n:t}=$(),n=nk(cv,t);return vB?an.jsx(fB,{data:n,onChange:e}):an.jsx(gB,{data:n,onChange:e})},bB=({data:e,onChange:t})=>{const{i18n:n}=$();const i=function(e){if(e.length<=2)return[...e];const t=Math.floor(Math.random()*e.length);let n=Math.floor(Math.random()*e.length);for(;n===t;)n=Math.floor(Math.random()*e.length);return[e[t],e[n]]}(ov);return an.jsx("div",{className:"recommend-dp-container-mobile",children:an.jsx("div",{className:"recommend-dp-list",children:e.map((e,a)=>an.jsxs("div",{className:"recommend-dp-item-wrap",children:[an.jsxs("div",{className:"recommend-pdf-item",children:[an.jsx("div",{className:"recommend-pdf-item-title-wrap",children:an.jsx("div",{className:"recommend-pdf-item-title",children:e.title})}),i.map(e=>an.jsxs("div",{className:"recommend-pdf-item-content",children:[an.jsxs("div",{className:"recommend-pdf-item-content-row",children:[an.jsx("img",{className:"recommend-pdf-item-content-img",src:e,alt:""}),an.jsxs("div",{className:"recommend-pdf-item-content-skeleton-wrap",children:[an.jsx(Ct,{className:"recommend-pdf-item-content-skeleton",style:{width:"100%",height:"8px"}}),an.jsx(Ct,{className:"recommend-pdf-item-content-skeleton",style:{width:"100%",height:"8px"}})]})]}),an.jsx(Ct,{className:"recommend-pdf-item-content-skeleton",style:{width:"100%",height:"8px",marginTop:8}})]},e))]}),an.jsx("button",{className:"recommend-use-prompt-btn",onClick:()=>{return n=e.query||e.title,j(void 0,null,function*(){t({inputText:n})});var n},children:n.t("Use Prompt")})]},a))})})},xB=({data:e,onChange:t})=>{const n=function(e){if(e.length<=2)return[...e];const t=Math.floor(Math.random()*e.length);let n=Math.floor(Math.random()*e.length);for(;n===t;)n=Math.floor(Math.random()*e.length);return[e[t],e[n]]}(ov);return an.jsx("div",{className:"recommend-dp-container",children:an.jsx("div",{className:"recommend-dp-list",children:e.map((e,i)=>an.jsxs("div",{className:"recommend-dp-item-wrap",children:[an.jsxs("div",{className:"recommend-pdf-item",children:[an.jsx("div",{className:"recommend-pdf-item-title-wrap",children:an.jsx("div",{className:"recommend-pdf-item-title",children:e.title})}),n.map(e=>an.jsxs("div",{className:"recommend-pdf-item-content",children:[an.jsxs("div",{className:"recommend-pdf-item-content-row",children:[an.jsx("img",{className:"recommend-pdf-item-content-img",src:e,alt:""}),an.jsxs("div",{className:"recommend-pdf-item-content-skeleton-wrap",children:[an.jsx(Ct,{className:"recommend-pdf-item-content-skeleton",style:{width:"100%",height:"8px"}}),an.jsx(Ct,{className:"recommend-pdf-item-content-skeleton",style:{width:"100%",height:"8px"}})]})]}),an.jsx(Ct,{className:"recommend-pdf-item-content-skeleton",style:{width:"100%",height:"8px",marginTop:8}})]},e))]}),an.jsxs("div",{className:"recommend-dp-item-footer",onClick:()=>{return n=e.query||e.title,j(void 0,null,function*(){t({inputText:n})});var n},children:[an.jsx("div",{className:"recommend-dp-item-footer-title",children:e.query||e.title}),an.jsx(pt,{type:"icon-line-arrow-up-right",className:"recommend-dp-item-footer-icon"})]})]},i))})})},wB=Lx(),_B=({onChange:e,type:t})=>{const{i18n:n}=$(),i=t===ng.DeepResearch?sv:rv,a=ok(nk(i,n),3);return wB?an.jsx(bB,{data:a,onChange:e}):an.jsx(xB,{data:a,onChange:e})},SB=["https://assets.alicdn.com/g/qwenweb/qwen-webui-fe/0.0.245/video/video_man.mp4","https://assets.alicdn.com/g/qwenweb/qwen-webui-fe/0.0.245/video/video_flower.mp4"],CB=({video:e,onChange:t,videoRefs:n,index:i})=>{const{i18n:a}=$();return an.jsxs("div",{className:"chat-recommend-video-list-item-mobile",children:[an.jsx("div",{className:Y("chat-recommend-video-list-item-container",{"aspect-ratio":e.height}),children:an.jsx(Ee,{videoSrc:`${SB[i]}`,errorMessage:a.t("Your browser does not support the video tag.")||"",onLoad:e=>{e&&n.current&&(n.current[i]=e)}})}),an.jsx("button",{className:"recommend-use-prompt-btn",onClick:()=>{return n=e.description,i=e.image,j(void 0,null,function*(){t({inputText:n,image:i})});var n,i},children:a.t("Use Prompt")})]})},EB=({data:e,onChange:t})=>{const n=A.useMemo(()=>ok(e,2),[e]),i=navigator.userAgent.toLowerCase(),a=["VivoBrowser"].some(e=>new RegExp(e,"i").test(i)),o=A.useRef([]),s=Ex(e=>e.mobile);return A.useEffect(()=>{if(a)return;const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?e.target.play():e.target.pause()})},{threshold:.8,rootMargin:"0px"});return o.current.forEach(t=>{t&&(t.setAttribute("playsinline","true"),t.setAttribute("webkit-playsinline","true"),t.muted=!0,e.observe(t))}),()=>{e.disconnect()}},[a]),A.useEffect(()=>{o.current.length===n.length&&setTimeout(()=>{const e=document.getElementById("chat-prompt-recommend-detail-container");e&&s&&(e.scrollLeft=e.scrollWidth)},100)},[o.current.length,n.length,s]),an.jsx("div",{className:"chat-recommend-video-mobile",children:an.jsx("div",{className:"chat-recommend-video-list",children:n.map((e,n)=>an.jsx(CB,{index:n,video:e,onChange:t,videoRefs:o},e.src))})})},kB=({video:e,onChange:t})=>{const n=A.useRef(null),{i18n:i}=$();return an.jsxs("div",{className:"chat-recommend-video-list-item",onMouseEnter:()=>{var e;return null==(e=n.current)?void 0:e.play()},onMouseLeave:()=>{var e;null==(e=n.current)||e.pause(),n.current.currentTime=0},children:[an.jsx("div",{className:"chat-recommend-video-list-item-video-container "+(e.height?"aspect-ratio":""),children:an.jsxs("video",{className:"chat-recommend-video-list-item-video",muted:!0,loop:!0,ref:n,children:[an.jsx("source",{src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static${e.src}`,type:"video/mp4"}),i.t("Your browser does not support the video tag.")]})}),an.jsxs("div",{className:"chat-recommend-video-list-item-text-box",children:[an.jsx("div",{className:"chat-recommend-video-list-item-text-box-text",children:e.description}),an.jsx("button",{className:"chat-recommend-video-list-item-text-box-use-btn",onClick:()=>{return n=e.description,i=e.image,j(void 0,null,function*(){t({inputText:n,image:i})});var n,i},children:i.t("Use Prompt")})]})]})},IB=({data:e,onChange:t})=>{const n=A.useMemo(()=>ok(e,2),[e]);return an.jsx("div",{className:"chat-recommend-video",children:an.jsx("div",{className:"chat-recommend-video-list",children:n.map(e=>an.jsx(kB,{video:e,onChange:t},e.src))})})},TB=({onChange:e})=>{const{i18n:t}=$(),n=A.useMemo(()=>{return e=t,uv.map(t=>_(w({},t),{description:e.t(t.description)}));var e},[t]),i=Ex(e=>e.mobile),a=TT(e=>e.inputValue),o=TT(e=>e.files),s=TT(e=>e.updateFeatureType),r=TT(e=>e.setFiles),l=({inputText:t,image:n})=>{s({chatType:ng.VideoGeneration,subChatType:ng.VideoGeneration}),n&&r([{type:"image",name:"example.png",file_type:"image/png",showType:"image",status:"uploaded",file_class:"vision",url:n}]),e({inputText:t})};return 0!==o.length||a?null:i?an.jsx(EB,{data:n,onChange:l}):an.jsx(IB,{data:n,onChange:l})},jB=({data:e,onChange:t})=>{const{i18n:n}=$(),i=ok(e,3);return an.jsx("div",{className:"recommend-artifacts-mobile",children:an.jsx("div",{className:"recommend-artifacts-list",children:i.map((e,i)=>an.jsxs("div",{className:"recommend-artifacts-item-wrap",children:[an.jsx("img",{className:"recommend-artifacts-item",src:"light"===mB()?e.src:e.darkSrc||e.src,alt:""}),an.jsx("button",{className:"recommend-use-prompt-btn",onClick:()=>{return n=e.query||e.title,void t({inputText:n});var n},children:n.t("Use Prompt")})]},i))})})},NB=({data:e,onChange:t})=>{const n=A.useMemo(()=>ok(e,3),[e]);return an.jsx("div",{className:"recommend-artifacts-container",children:an.jsx("div",{className:"recommend-artifacts-list",children:n.map((e,n)=>an.jsxs("div",{className:"recommend-artifacts-item-wrap",children:[an.jsx("img",{className:"recommend-pdf-item",src:"light"===mB()?e.src:e.darkSrc||e.src,alt:""}),an.jsxs("div",{className:"recommend-artifacts-item-footer",onClick:()=>{return n=e.query||e.title,j(void 0,null,function*(){t({inputText:n})});var n},children:[an.jsx("div",{className:"recommend-artifacts-item-footer-title",children:e.query||e.title}),an.jsx(pt,{type:"icon-line-arrow-up-right",className:"recommend-artifacts-item-footer-icon"})]})]},n))})})},PB=Lx(),MB=({onChange:e})=>{const{i18n:t}=$(),n=nk(lv,t);return PB?an.jsx(jB,{data:n,onChange:e}):an.jsx(NB,{data:n,onChange:e})},AB=({data:e,onChange:t})=>{const{i18n:n}=$();return an.jsx("div",{className:"recommend-image-mobile",children:an.jsx("div",{className:"recommend-image-list",children:e.map((e,i)=>an.jsxs("div",{className:"recommend-image-item-wrap",children:[an.jsx("img",{className:"recommend-image-item",src:"light"===mB()?e.src:e.darkSrc||e.src,alt:""}),an.jsx("button",{className:"recommend-use-prompt-btn",onClick:()=>{var n;n=e.description,t({inputText:n})},children:n.t("Use Prompt")})]},i))})})},OB=({onChange:e,data:t})=>{const n=$(),i=[];for(let a=0;a<t.length;a+=2)i.push(t.slice(a,a+2));return an.jsx("div",{className:"image-grid",children:i.map((t,i)=>{const a=i%2==0;return an.jsx("div",{className:"image-group "+(a?"is-odd":""),children:t.map((t,a)=>an.jsxs("div",{className:"image-container",children:[an.jsx("img",{src:t.src,alt:t.src,className:"image"}),an.jsxs("div",{className:"chat-recommend-image-list-item-text-box",children:[an.jsx("div",{className:"chat-recommend-image-list-item-text-box-text",children:t.description}),an.jsx("button",{className:"chat-recommend-image-list-item-text-box-use-btn",onClick:()=>{e({inputText:t.description})},children:n.t("Use Prompt")})]})]},`${i}-${a}`))},i)})})},RB=({data:e,onChange:t})=>an.jsx("div",{className:"chat-recommend-image",children:an.jsx(OB,{onChange:t,data:e})}),DB=Lx(),LB=({onChange:e})=>{const{i18n:t}=$(),n=ok((i=t,pv.map(e=>_(w({},e),{description:i.t(e.description)}))),10);var i;return A.useEffect(()=>{},[]),DB?an.jsx(AB,{data:n,onChange:e}):an.jsx(RB,{data:n,onChange:e})},FB=()=>null,zB=({data:e,onChange:t,inputValue:n})=>{const{i18n:i}=$();return Pt(e)?null:an.jsx("ul",{className:"chat-prompt-recommend-detail-inner",children:e.map(e=>an.jsx("li",{onClick:()=>{return n=e,j(void 0,null,function*(){t({inputText:n})});var n},children:an.jsx(fe.Text,{ellipsis:!0,children:an.jsx("span",{dangerouslySetInnerHTML:{__html:ak(e,n,i.language)}})})},e))})},UB=Lx(),HB=({onChange:e,selectedSuggest:t,inputValue:n})=>{const{i18n:i}=$(),a=A.useMemo(()=>{var e;var n;return((null==(e=(n=i,dv.map(e=>_(w({},e),{data:e.data.map(e=>n.t(e))}))).find(e=>e.type===t))?void 0:e.data)||[]).slice(0,5)},[i,t]);return UB?an.jsx(FB,{}):an.jsx(zB,{data:a,onChange:e,inputValue:n})},BB=()=>null,$B=({data:e,onChange:t})=>an.jsx("div",{className:"chat-prompt-recommend-search-pc",children:e.map(e=>an.jsx(pB,{iconType:"icon-line-search-01",buttonText:e,onClick:()=>{return n=e,j(void 0,null,function*(){t({inputText:n})});var n},size:"normal"},e))}),qB=Lx(),GB=({onChange:e})=>{const{i18n:t}=$(),n=(i=t,mv.map(e=>i.t(e)));var i;const a=ok(n,6);return qB?an.jsx(BB,{}):an.jsx($B,{data:a,onChange:e})},VB="index-module__pc-recommend-image-edit___VzY1q",WB="index-module__recommend-image-edit-item___9vZgt",QB="index-module__recommend-image-edit-item-image___bqmgi",KB="index-module__display-image___2RJck",YB="index-module__thumbnail___M4Lzv",XB="index-module__recommend-image-edit-item-description___iv3z2",JB=({data:e,onChange:t})=>{const n=z.useRef([]),i=e=>{if(e){const t=new ResizeObserver(()=>{const{bottom:t}=e.getBoundingClientRect();t>window.innerHeight&&(e.style.top="0",e.style.transform="translateY(-100%)")});t.observe(e),n.current.push(t)}};return A.useEffect(()=>{const e=n.current;return()=>{e.forEach(e=>{e.disconnect()})}},[]),an.jsx("div",{className:VB,children:e.map(e=>an.jsxs("div",{className:WB,onClick:()=>(e=>{t({prompt:e.description,images:e.image})})(e),children:[e.thumbnail.map((t,n)=>an.jsxs("div",{className:QB,children:[an.jsx("img",{className:YB,src:t,alt:""}),an.jsx("img",{ref:i,className:KB,src:e.image[n],alt:""})]},t)),an.jsx(vt,{title:e.description,placement:"topLeft",children:an.jsx("div",{className:XB,children:e.description})})]},e.description))})},ZB="index-module__mobile-recommend-image-edit___B-zC2",e$="index-module__recommend-image-edit-item___YuBdK",t$="index-module__image___Jqr9n",n$="index-module__description___vrgjI",i$=({data:e,onChange:t})=>an.jsx("div",{className:ZB,children:e.map(e=>an.jsxs("div",{className:e$,onClick:()=>(e=>{t({prompt:e.description,images:e.image})})(e),children:[e.thumbnail.map(e=>an.jsx("img",{className:t$,src:e,alt:""},e)),an.jsx("div",{className:n$,children:e.description})]},e.description))}),a$=Lx(),o$=({onChange:e})=>{const{i18n:t}=$(),n=ok((i=t,hv.map(e=>_(w({},e),{description:i.t(e.description)}))),5);var i;const a=TT(e=>e.inputValue),o=TT(e=>e.files),s=TT(e=>e.setFiles),r=({prompt:t,images:n})=>{s(n.map(e=>({type:"image",name:"example.png",file_type:"image/png",showType:"image",status:"uploaded",file_class:"vision",url:e}))),e({inputText:t})};return 0!==o.length||a?null:a$?an.jsx(i$,{data:n,onChange:r}):an.jsx(JB,{data:n,onChange:r})},s$=({onClick:e,dataList:t})=>an.jsx("div",{className:"recommend-learn",children:t.map((t,n)=>an.jsxs("div",{className:"recommend-image-edit-item",onClick:()=>{e(t.title)},children:[an.jsx("div",{className:"recommend-image-edit-item-image-container",children:an.jsx(pt,{type:t.images,className:"recommend-learn-item-icon"})}),an.jsx("div",{className:"recommend-image-edit-item-title",children:t.title})]},n))}),r$=({onClick:e,dataList:t})=>an.jsx("div",{className:"recommend-learn-mobile",children:t.map((t,n)=>an.jsxs("div",{className:"qwen-chat-comp-recommend-image-edit-item",onClick:()=>{e(t.title)},children:[an.jsx(pt,{type:t.images,className:"recommend-learn-item-icon"}),an.jsx("div",{className:"qwen-chat-comp-recommend-image-edit-title",children:t.title})]},n))}),l$=({onChange:e})=>{const{i18n:t}=$(),n=Ex(e=>e.mobile),i=TT(e=>e.files),a=TT(e=>e.inputValue),o=dv.filter(e=>"Learn"===e.type).map(({data:e})=>e.map(e=>({title:t.t(e.title),images:e.image})))[0]||[],s=t=>{e({inputText:t})};return 0!==i.length||a?null:an.jsx(an.Fragment,{children:n?an.jsx(r$,{dataList:o,onClick:s}):an.jsx(s$,{dataList:o,onClick:s})})},c$=z.memo(({messageType:e,onChange:t,selectedSuggest:n="",inputValue:i=""})=>{switch(e){case ng.WebSearch:return an.jsx(GB,{onChange:t});case ng.WebDev:return an.jsx(yB,{onChange:t});case ng.DeepResearch:return an.jsx(_B,{onChange:t,type:ng.DeepResearch});case ng.Travel:return an.jsx(_B,{onChange:t,type:ng.Travel});case ng.VideoGeneration:return an.jsx(TB,{onChange:t});case ng.Artifacts:return an.jsx(MB,{onChange:t});case ng.ImageGeneration:return an.jsx(LB,{onChange:t});case ng.ImageEdit:return an.jsx(o$,{onChange:t});case ng.Txt2Txt:return an.jsx(HB,{onChange:t,selectedSuggest:n,inputValue:i});case ng.LEARN:return an.jsx(l$,{onChange:t});default:return null}},(e,t)=>e.messageType===t.messageType),u$=[ng.Thinking,ng.WebSearch,"text"],d$=[ng.ImageEdit,ng.Artifacts,ng.DeepResearch,ng.ImageGeneration,ng.VideoGeneration,ng.WebDev,ng.Travel,ng.LEARN],h$=({onInputCallback:e,onFeatureCallback:t,checkKeyList:n=[]})=>{const{t:i}=$(),a=Ex(e=>e.config),o=TT(e=>e.files),s=EI(e=>e.selectedModels),r=vx(e=>e.history),l=EI(e=>e.selectedModelIds),c=A.useRef(!1),u=A.useCallback(e=>n.includes(e),[n]),d=A.useCallback(e=>({[ng.ImageEdit]:i("Image Edit"),[ng.WebSearch]:i("Web Search"),[ng.Artifacts]:i("Artifacts"),[ng.DeepResearch]:i("Deep Research"),[ng.ImageGeneration]:i("Image Generation"),[ng.VideoGeneration]:i("Video Generation"),[ng.WebDev]:i("Web Dev"),[ng.Travel]:i("Travel Planner"),[ng.LEARN]:i("Learn")}[e]||null),[i]),h=A.useCallback(()=>{const n=new URLSearchParams(window.location.search);"true"===n.get(ng.Thinking)&&u(ng.Thinking)&&1===s.length&&(null==t||t(ng.Thinking));const i=n.get("inputFeature");if(i&&u(i)){const e=d(i);if(e){const{disabled:n,msg:r}=uk(i,e,a,s,o,l);if(n)return void ht.open({type:"warning",content:r});null==t||t(i,e)}}const r=n.get("text");r&&u("text")&&(null==e||e(r))},[a,o,d,t,e,l,s,u]);A.useEffect(()=>{c.current||"/"!==window.location.pathname||r.currentId||!s.length||(c.current=!0,h())},[r.currentId,s.length,h])},p$={thinking:"thinking",search:"search",deep_research:"deep_research_deep_research",t2i:"t2i",t2v:"t2v",artifacts_deploy_artifacts:"artifacts_deploy_artifacts",artifacts_deploy_web_dev:"artifacts_deploy_web_dev",artifacts_deploy_deep_research:"artifacts_deploy_deep_research",audio_chat_audio_only:"audio_chat_AudioOnly",audio_chat_audio_and_video:"audio_chat_AudioAndVideo",deep_research_aipodcast:"deep_research_aipodcast",image_edit:"image_edit",deep_research_advanced:"deep_research_deep_research_advanced"},m$=()=>{const e=Ex(e=>e.mobile),t=GE(e=>e.subscriptionPlus),{updateEquityHandlerByMessage:n}=jj(),[i,a]=A.useState(()=>{const e={},t=KE.getState();for(const[n,i]of Object.entries(p$))e[n]=t.getFeatureEquity(i);return e});A.useEffect(()=>{const e=KE.subscribe(e=>{const t={};for(const[n,i]of Object.entries(p$))t[n]=e.getFeatureEquity(i);a(t)});return()=>{e()}},[]);const o=A.useCallback(i=>{if(null===(null==i?void 0:i.remains)||0===(null==i?void 0:i.remains)){if(e){const e=z.createElement(Tj,{equity:i,onUpdate:n});ht.openOnce({type:"warning",content:e,closable:t})}return!1}return!0},[e,t,n]),s=A.useCallback(e=>{let t=e;if(e===ng.DeepResearch&&(t="deep_research_deep_research"),bv.includes(t)){const e=KE.getState().getFeatureEquity(t);return o(e)}return!0},[o]);return{qThinkingEquity:i.thinking,qSearchEquity:i.search,qDeepResearchEquity:i.deep_research,qT2IEquity:i.t2i,qT2VEquity:i.t2v,qArtifactsDeployArtifacts:i.artifacts_deploy_artifacts,qArtifactsDeployWebDev:i.artifacts_deploy_web_dev,qArtifactsDeployDeepResearch:i.artifacts_deploy_deep_research,qAudioChatAudioOnly:i.audio_chat_audio_only,qAudioChatAudioAndVideo:i.audio_chat_audio_and_video,qDeepResearchAipodcast:i.deep_research_aipodcast,qImageEditEquity:i.image_edit,qDeepResearchAdvanced:i.deep_research_advanced,checkEquityPassByEquity:o,checkEquityPassByInputFeatureType:s}},f$=Lx(),g$=[ng.Travel,ng.DeepResearch],v$=({resetInputHandler:e,inDetail:t=!1,isProject:n=!1})=>{const i=TT(e=>e.messageType),a=TT(e=>e.setMobileRecommendDetailVisible),o=TT(e=>e.mobileRecommendDetailVisible),s=TT(e=>e.updateFeatureType),r=TT(e=>e.isFocus),l=TT(e=>e.selectedSuggest),c=TT(e=>e.setSelectedSuggest),u=EI(e=>e.selectedModels),d=Ex(e=>e.config),h=vx(e=>e.currentInputFeature),{i18n:p}=$(),{qDeepResearchEquity:m,qT2IEquity:f,qT2VEquity:g,qImageEditEquity:v,checkEquityPassByInputFeatureType:y}=m$();jj();const b=Sx(e=>e.setThinkingEnabled),x=Sx(e=>e.setSearchEnabled),S=A.useMemo(()=>t?g$:[],[t]),C=A.useMemo(()=>{return(e=p,ik(e,fv)||[]).map(e=>_(w({},e),{disabledInfo:dk(e.chatType,e.value||"",d||{},u,{qDeepResearchEquity:m,qT2IEquity:f,qT2VEquity:g,qImageEditEquity:v})})).filter(e=>!S.includes(e.chatType));var e},[p.language,d,u,m,f,g,v,S]),E=EI(e=>e.selectedModelIds).length>1;GE(e=>e.subscriptionPlus);const k=A.useMemo(()=>{return(({prompt:e,currentI18n:t,isMultipleModels:n,config:i,equities:{qDeepResearchEquity:a,qT2IEquity:o,qT2VEquity:s,qImageEditEquity:r}})=>{var l;const c=(null==(l=null==i?void 0:i.permissions)?void 0:l.chat)||{};return(e||[]).filter(e=>!zx()||"DeepResearch"!==e.key).map(e=>{let i=null;const l=e.subChatType||e.chatType;if(n&&l!==ng.Txt2Txt&&(i={disabled:!0,msg:t.t("The function {{capability}} is not supported in battle mode.",{capability:t.t(e.value||"")})}),!(null==i?void 0:i.disabled)){let n;["DeepResearch"].includes(e.key)?n=a:["Image Generation"].includes(e.key)?n=o:["Video Generation"].includes(e.key)?n=s:["Image Edit"].includes(e.key)&&(n=r),n&&-1!==n.remains&&(i={disabled:0===n.remains,msg:LE({remains:n.remains,unit:n.unit,capability:t.t(e.value||""),allowHtml:!0,currentI18n:t})})}return 5===(null==c?void 0:c[l])&&UT()&&(i={disabled:!0,msg:t.t("{{capability}} is not supported in guest mode.",{capability:t.t(e.value||"")})}),e.disabledInfo=i||{disabled:!1,msg:""},e})})({prompt:(e=p,ik(e,vv)),currentI18n:p,isMultipleModels:E,config:d,equities:{qDeepResearchEquity:m,qT2IEquity:f,qT2VEquity:g,qImageEditEquity:v}});var e},[d,p.language,E,m,v,f,g]),I=A.useCallback((e,t=!1)=>{var i;const{chatType:o,subChatType:r}=e;if(!(null==(i=e.disabledInfo)?void 0:i.disabled)){if(s({subChatType:r,chatType:o}),c(e.key),t&&(n||a(!0),kT.emit(vE.MESSAGE_INPUT_TRIGGER_FOCUS)),[ng.ImageGeneration,ng.VideoGeneration].includes(o)){const e=o===ng.ImageGeneration;TT.getState().setVisionSize(e?"9:16":"16:9")}[ng.ImageGeneration,ng.VideoGeneration,ng.ImageEdit,ng.DeepResearch,ng.Travel].includes(o)&&(b(!1),x(!1))}},[s,c,n,a,b,x]),T=A.useCallback((e,t)=>{const n=[...f$?C:k].find(e=>e.value===t);n&&I(n,!0)},[I,C,k]),j=A.useMemo(()=>[ng.Travel,ng.Artifacts,ng.WebDev,ng.ImageGeneration,ng.VideoGeneration,ng.DeepResearch,ng.ImageEdit].includes(h),[C,h]);if(h$({onFeatureCallback:T,checkKeyList:d$}),A.useEffect(()=>{f$&&kT.firstOn(vE.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,({suggestItem:e,active:t})=>{if(t){const{chatType:t,subChatType:n}=e;let i;i="t2t"===t?e:C.find(e=>e.chatType===t&&e.subChatType===n)||e,I(i)}else a(!1)})},[I,C,a]),f$){const t=t=>{e(t.inputText,"send"),a(!1)};return o?an.jsx("div",{className:"chat-prompt-recommend-detail-container",id:"chat-prompt-recommend-detail-container",children:an.jsx(c$,{messageType:i,selectedSuggest:l,onChange:t})}):r||j?an.jsx("div",{className:"chat-prompt-recommend-detail-container-hidden"}):an.jsx("div",{className:"chat-prompt-suggest-button-group",children:C.map(e=>{var t,n;return an.jsx(pB,{buttonText:e.value||"",size:"small",disabled:null==(t=e.disabledInfo)?void 0:t.disabled,disabledText:null==(n=e.disabledInfo)?void 0:n.msg,imgUrl:`${e.icon||e.url}`,onClick:()=>{var t;y(e.subChatType||e.chatType)&&!(null==(t=e.disabledInfo)?void 0:t.disabled)&&I(e,!0)}},e.key)})})}return an.jsx("div",{className:"chat-prompt-suggest-button-group",children:k.map(e=>{var t,n;return an.jsx(pB,{buttonText:e.value||"",size:"small",rounded:"circle",disabled:null==(t=e.disabledInfo)?void 0:t.disabled,disabledText:null==(n=e.disabledInfo)?void 0:n.msg,imgUrl:`${e.icon||e.url}`,onClick:()=>{var t;y(e.subChatType||e.chatType)&&!(null==(t=e.disabledInfo)?void 0:t.disabled)&&I(e,!0)}},e.key)})})},y$=z.memo(({resetInputHandler:e,recommendDetailHide:t=!1})=>{const{i18n:n}=$(),[i,a]=A.useState(""),[o,s]=A.useState(""),r=TT(e=>e.updateFeatureType),l=TT(e=>e.messageType),c=TT(e=>e.files),u=TT(e=>e.setWordsShowMore),d=TT(e=>e.wordsShowMore),h=TT(e=>e.isFocus),p=Ex(e=>e.config),m=EI(e=>e.selectedModels)[0],f=EI(e=>e.selectedModelIds).length>1,g=TT(e=>e.showDetail),v=TT(e=>e.setShowDetail),y=Sx(e=>e.setThinkingEnabled),b=Sx(e=>e.setMcpEnabled),{qDeepResearchEquity:x,qT2IEquity:S,qT2VEquity:C,qImageEditEquity:E,checkEquityPassByInputFeatureType:k}=m$(),I=A.useMemo(()=>{const e=ik(n,gv);return lk(n,e,f,p,m,c,{qDeepResearchEquity:x,qT2IEquity:S,qT2VEquity:C,qImageEditEquity:E})},[p,m,c,n.language,f,x,E,S,C]),T=A.useMemo(()=>{const e=ik(n,yv);return lk(n,e,f,p,m,c,{qDeepResearchEquity:x,qT2IEquity:S,qT2VEquity:C,qImageEditEquity:E})},[p,m,c,n.language,f,x,E,S,C]),j=A.useRef(!1),N=A.useRef(""),P=A.useCallback(e=>{dS("clkGenerateMode",{params:{et:"OTHER"},paramsExtend:{msg_type:e},aesParams:{c5:e}})},[]),M=A.useCallback(t=>{j.current=!0;const{chatType:n,subChatType:i,value:o,key:l}=t;if(o&&s(o),v(!0),a(l),N.current=n,"t2t"===n)e(o||"");else if([ng.ImageGeneration,ng.VideoGeneration].includes(n)){const e=n===ng.ImageGeneration;TT.getState().setVisionSize(e?"9:16":"16:9")}switch(n){case ng.ImageGeneration:case ng.ImageEdit:case ng.VideoGeneration:case ng.DeepResearch:case ng.Travel:y(!1)}[ng.Thinking,ng.WebSearch].includes(n)||b(!1),r({subChatType:i,chatType:n}),P(i||n),kT.emit(vE.MESSAGE_INPUT_TRIGGER_FOCUS),setTimeout(()=>{"t2t"===n&&(j.current=!1)},200)},[v,r,P,e,y,b]),O=A.useCallback(t=>{e(t.inputText,"send"),v(!1)},[e,v]),R=A.useCallback((e,t)=>{const n=[...I,...T].find(e=>e.value===t);n&&M(n)},[M,I,T]);return A.useEffect(()=>(kT.on(vE.MESSAGE_INPUT_ON_BLUR,()=>{setTimeout(()=>{j.current?j.current=!1:"t2t"===N.current&&v(!1)},200)}),kT.firstOn(vE.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,({suggestItem:e,active:t})=>{if(t){const{chatType:t,subChatType:n,value:i}=e,a=[...I,...T].find(e=>t===ng.Txt2Txt?e.chatType===t:e.chatType===t&&e.subChatType===n)||e;M(_(w({},a),{value:i||a.value}))}else v(!1)}),kT.firstOn(vE.MESSAGE_INPUT_RECOMMEND_WORDS_INIT,()=>{s(""),a("")}),()=>{kT.off(vE.MESSAGE_INPUT_ON_BLUR)}),[v,M,I,T]),A.useEffect(()=>{h&&o&&i&&N.current===ng.Txt2Txt&&v(!0)},[o,h,i,v]),h$({onFeatureCallback:R,checkKeyList:d$}),an.jsxs("div",{className:Y("chat-prompt-recommend-container",{"chat-prompt-recommend-container-large":g&&l===ng.ImageEdit}),children:[an.jsxs("div",{className:"chat-prompt-recommend-words",children:[I.map(e=>{var t,n;return an.jsx(pB,{buttonText:e.value||"",size:"normal",disabled:null==(t=e.disabledInfo)?void 0:t.disabled,disabledText:null==(n=e.disabledInfo)?void 0:n.msg,imgUrl:`${e.icon||e.url}`,onClick:()=>{var t;k(e.subChatType||e.chatType)&&!(null==(t=e.disabledInfo)?void 0:t.disabled)&&M(e)}},e.key)}),d?T.map(e=>{var t,n;return an.jsx(pB,{buttonText:e.value||"",size:"normal",disabled:null==(t=e.disabledInfo)?void 0:t.disabled,disabledText:null==(n=e.disabledInfo)?void 0:n.msg,imgUrl:`${e.icon||e.url}`,onClick:()=>{var t;k(e.subChatType||e.chatType)&&!(null==(t=e.disabledInfo)?void 0:t.disabled)&&M(e)}},e.key)}):an.jsx(pB,{size:"normal",buttonText:n.t("More"),onClick:()=>u(!0)})]}),g&&!t&&an.jsx("div",{className:Y("chat-prompt-recommend-detail-container",{"chat-prompt-recommend-detail-container-txt":l===ng.Txt2Txt}),children:an.jsx(c$,{messageType:l,onChange:O,selectedSuggest:i,inputValue:o})})]})}),b$=({buttonDisabled:e,status:t,onClick:n,disabledStatusCallbackEnabled:i,sendChatGenerationEvent:a})=>{const{i18n:o}=$();return an.jsx("div",{className:"chat-prompt-send-button",children:"stop"===t?an.jsx(AH,{title:e?null:o.t("Stop"),children:an.jsx("button",{className:"stop-button "+(e?"disabled":""),disabled:e,onClick:e=>{e.preventDefault(),e.stopPropagation(),n("stop")},children:an.jsx(pt,{type:"icon-fill-stop-011",className:"icon-stop"})})}):"recording"===t?an.jsx("button",{className:"send-button "+(e?"disabled":""),disabled:e,onClick:e=>{e.preventDefault(),e.stopPropagation(),n("recording")},children:"om"}):an.jsx("button",{className:`send-button ${e?"disabled":""} ${(null==i?void 0:i.includes("send"))?"disabled-pointer":""}`,disabled:e&&!(null==i?void 0:i.includes("send")),onClick:e=>{e.preventDefault(),e.stopPropagation(),n("send"),a("click")},children:an.jsx(pt,{type:"icon-line-arrow-up",className:"icon-send"})})})},x$=()=>{const{i18n:e}=$(),t=Ex(e=>e.mobile),n=Sx(e=>e.setWelcomeModalShow),i=Sx(e=>e.setOmniType),a=HE(e=>e.user),o=zE(e=>e.omniButtonBackgroundImg),{qAudioChatAudioAndVideo:s,qAudioChatAudioOnly:r,checkEquityPassByEquity:l}=m$(),c=A.useMemo(()=>null===(null==r?void 0:r.remains)||0===(null==r?void 0:r.remains),[r]),u=A.useMemo(()=>null===(null==s?void 0:s.remains)||0===(null==s?void 0:s.remains),[s]),d=A.useCallback(e=>{l("voice"===e?r:s)},[l,s,r]),h=A.useCallback(e=>{c&&"voice"===e||u&&"video"===e?t&&d(e):UT()?n(!0):(dS("speechVoiceChatStart",{params:{et:"CLK",c1:null==a?void 0:a.id}}),i(e))},[c,u,null==a?void 0:a.id,i,t,d,n]),p=A.useMemo(()=>t?null:UT()?e.t("{{capability}} is not supported in guest mode.",{capability:e.t("Use voice and video chat")}):e.t("Use voice and video chat"),[e,null==a?void 0:a.id]),m=A.useMemo(()=>t||UT()?"":-1!==(null==r?void 0:r.remains)?LE({remains:(null==r?void 0:r.remains)||0,unit:null==r?void 0:r.unit,currentI18n:e,capability:e.t("Voice Chat"),allowHtml:!0}):"",[e,t,null==r?void 0:r.remains,null==r?void 0:r.unit]),f=A.useMemo(()=>t||UT()?"":-1!==(null==s?void 0:s.remains)?LE({remains:(null==s?void 0:s.remains)||0,unit:null==s?void 0:s.unit,currentI18n:e,capability:e.t("Video Chat"),allowHtml:!0}):"",[e,t,null==s?void 0:s.remains,null==s?void 0:s.unit]),g=A.useMemo(()=>[{key:"voice",label:an.jsx(vt,{title:m?an.jsx("span",{dangerouslySetInnerHTML:{__html:m}}):"",placement:"bottom",children:an.jsxs("div",{className:"omni-button-drop-item "+(c?"omni-button-drop-item-disabled":""),onClick:()=>h("voice"),children:[an.jsx(pt,{type:"icon-line-voiceChat",className:"omni-button-drop-item-icon"}),an.jsx("div",{className:"omni-button-drop-item-label",children:e.t("Voice Chat")})]})})},{key:"video",label:an.jsx(vt,{title:f?an.jsx("span",{dangerouslySetInnerHTML:{__html:f}}):"",placement:"bottom",children:an.jsxs("div",{className:"omni-button-drop-item "+(u?"omni-button-drop-item-disabled":""),onClick:()=>h("video"),children:[an.jsx(pt,{type:"icon-line-video-on",className:"omni-button-drop-item-icon"}),an.jsxs("div",{className:"omni-button-drop-item-label",children:[e.t("Video Chat"),an.jsx("div",{className:"omni-button-drop-item-label-beta",children:"Beta"})]})]})})}],[e,h,f,m,u,c]);return an.jsx("div",{className:"omni-button-content",children:an.jsx(vt,{title:p,arrow:!1,children:an.jsx(ee,{menu:{items:g},trigger:["click"],overlayClassName:"omni-button-drop",children:an.jsx(ge,{className:Y("omni-button-content-btn",{"omni-button-content-btn-no-bg-color":t&&o}),type:"primary",shape:"circle",style:t&&o?{background:`url(${o}) no-repeat center/cover`}:{},icon:an.jsx(pt,{type:"icon-line-waveform"})})})})})},w$=({type:e="image",fileType:t="",item:n,status:i,src:a="",alt:o,name:s="",size:r,handleClose:l,handlePreview:c,onReUpload:u})=>{const{mobile:d}=Ex(),{i18n:h}=$();let p="",m="";if(s){const e=s.lastIndexOf(".");-1===e?(p=s,m=""):(p=s.slice(0,e),m=s.slice(e+1))}const f=Ug[t]||Ug.others,g=Hx()||zx()&&Mx(),v=d&&(Hx()||zx()&&Mx()),y=A.useRef(null),b=A.useMemo(()=>"uploaded"===i||!!a,[a,i]),x=A.useMemo(()=>"green_error"===n.greenNet,[n,n.greenNet]);return A.useEffect(()=>{const t=y.current,n=e=>()=>{e.currentTime=.1,(e=>{if(!Ax())return;const t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight;const n=t.getContext("2d");n&&(n.drawImage(e,0,0,t.width,t.height),e.setAttribute("poster",t.toDataURL("image/png")))})(e)};if("video"===e&&t){const e=()=>t.pause(),i=n(t);return t.addEventListener("play",e),t.addEventListener("loadedmetadata",i),()=>{t.removeEventListener("play",e),t.removeEventListener("loadedmetadata",i)}}},[e,a]),an.jsx(an.Fragment,{children:b?an.jsxs("div",{className:"vision-item-container",children:[an.jsx("div",{className:"media",children:an.jsxs("div",{className:"vision-item-content",children:["image"===e&&an.jsx("img",{src:a,alt:o,className:"vision-item-image"}),"video"===e&&an.jsxs(an.Fragment,{children:[an.jsx("video",{ref:y,className:"vision-item-video",preload:"auto",controls:!1,autoPlay:v,muted:!0,playsInline:!0,children:g?an.jsx("source",{src:a,type:t}):an.jsx("source",{src:a})}),an.jsx("div",{className:"vision-item-video-play-button",children:an.jsx("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),c&&c("video",a)},children:an.jsx(pt,{type:"iconbigPauseMore",className:"iconbig-pause-more"})})})]})]})}),an.jsx("button",{className:"close-button",type:"button",onClick:l,children:an.jsx(pt,{type:"icon-close",className:"icon-close"})})]}):an.jsxs("div",{className:Y("fileitem-btn",{"fileitem-btn-greening":x}),children:[an.jsxs("div",{className:"file-content-icon",style:x?{}:{backgroundColor:null==f?void 0:f.bg},children:["uploading"===i&&an.jsx(Sj,{className:"vision-spinner"}),"upload_error"===i&&!x&&an.jsx("button",{className:"fileitem-error-icon-wrapper",onClick:e=>{e.preventDefault(),e.stopPropagation(),u&&u()},children:an.jsx(pt,{type:"icon-fill",className:"fileitem-error-icon"})}),x&&an.jsx("div",{className:"fileitem-icon-wrapper",children:an.jsx(pt,{type:"icon-line-file-none",className:"fileitem-icon"})})]}),an.jsxs("div",{className:"file-content-info",children:[an.jsxs("div",{className:"fileitem-file-name",children:[an.jsx("div",{className:"fileitem-file-name-text",children:p}),an.jsx("div",{className:"fileitem-file-name-ext",children:m?`.${m}`:""})]}),an.jsxs("div",{className:"fileitem-file-size",children:[r&&!x&&an.jsx("span",{style:{margin:0},children:nC(r)}),x&&an.jsx("span",{className:"fileitem-file-error",children:h.t("Invalid File")})]})]}),an.jsx("div",{className:"close-button",onClick:l,children:an.jsx(pt,{type:"icon-close",className:"icon-close"})})]})})},_$=({className:e="",url:t=null,dismissible:n=!1,item:i=null,fileType:a="others",name:o="",size:s,role:r="user",onClick:l,handleClose:c,onReUpload:u,showClose:d=!0})=>{var h,p,m,f,g,v,y,b,x;const{i18n:w}=$(),[_,S]=A.useState(!1),{fileName:C,fileExt:E}=A.useMemo(()=>{let e="",t="";const n=(null==o?void 0:o.lastIndexOf("."))||-1;return-1===n?(e=o,t=""):(e=o.slice(0,n),t=o.slice(n+1)),{fileName:e,fileExt:t}},[o]),k=A.useMemo(()=>Mg.includes(E)||kg.includes(a)?{icon:"icon-playground",bg:"#3F3F47"}:Ug[a]||Ug.others,[a,i,E]),I=A.useMemo(()=>{var e,t,n,a,o,s;if(null==(n=null==(t=null==(e=null==i?void 0:i.file)?void 0:e.meta)?void 0:t.parse_meta)?void 0:n.parse_status)switch(null==(s=null==(o=null==(a=null==i?void 0:i.file)?void 0:a.meta)?void 0:o.parse_meta)?void 0:s.parse_status){case"success":return"parsed";case"failed":return"parsed_error";case"running":return"parsing";default:return""}return(null==i?void 0:i.status)||""},[null==i?void 0:i.status,null==(m=null==(p=null==(h=null==i?void 0:i.file)?void 0:h.meta)?void 0:p.parse_meta)?void 0:m.parse_status]),T=A.useMemo(()=>"green_error"===i.greenNet,[i.greenNet]);return an.jsx(an.Fragment,{children:an.jsxs("button",{className:Y(`fileitem-btn ${e}`,{"fileitem-btn-greening":T}),type:"button",onClick:e=>j(void 0,null,function*(){var e,n;(null==(n=null==(e=null==i?void 0:i.file)?void 0:e.data)?void 0:n.content)?S(!_):t&&yC({role:r,url:t,isFile:!0}),l&&l()}),children:[an.jsxs("div",{className:"file-content-icon",style:T?{}:{backgroundColor:null==k?void 0:k.bg},children:[(["parsed","uploaded","success"].includes(I)||!I||"parsed_error"===I&&!(null==(v=null==(g=null==(f=null==i?void 0:i.file)?void 0:f.meta)?void 0:g.parse_meta)?void 0:v.retry))&&an.jsx("div",{className:"fileitem-icon-wrapper",children:an.jsx(pt,{type:null==k?void 0:k.icon,className:"fileitem-icon"})}),T&&an.jsx("div",{className:"fileitem-icon-wrapper",children:an.jsx(pt,{type:"icon-line-file-none",className:"fileitem-icon"})}),["parsing","uploading"].includes(I)&&an.jsx(Sj,{className:"vision-spinner"}),("upload_error"===I||"parsed_error"===I&&(null==(x=null==(b=null==(y=null==i?void 0:i.file)?void 0:y.meta)?void 0:b.parse_meta)?void 0:x.retry))&&!T&&an.jsx("button",{className:"fileitem-error-icon-wrapper",style:{backgroundColor:null==k?void 0:k.bg},onClick:e=>{e.preventDefault(),e.stopPropagation(),u&&u()},children:an.jsx(pt,{type:"icon-fill",className:"fileitem-error-icon"})})]}),an.jsxs("div",{className:"file-content-info",children:[an.jsxs("div",{className:"fileitem-file-name",children:[an.jsx("div",{className:"fileitem-file-name-text",children:C}),an.jsx("div",{className:"fileitem-file-name-ext",children:E?`.${E}`:""})]}),an.jsxs("div",{className:"fileitem-file-size",children:[!["parsed_error","upload_error"].includes(I)&&s&&an.jsx("span",{style:{margin:0},children:nC(s)}),"parsing"===I&&an.jsx("span",{children:w.t("Parsing...")}),"parsed_error"===I&&!T&&an.jsx("span",{className:"fileitem-file-error",children:w.t("Parsing failed")}),"upload_error"===I&&!T&&an.jsx("span",{className:"fileitem-file-error",children:w.t("Upload failed")}),T&&an.jsx("span",{className:"fileitem-file-error",children:w.t("Invalid File")})]})]}),d&&an.jsx("div",{className:"close-button",type:"button",onClick:c,children:an.jsx(pt,{type:"icon-close",className:"icon-close"})})]})})},S$=({files:e,onClose:t,onReUpload:n,role:i})=>{const[a,o]=A.useState(),[s,r]=A.useState(""),l=A.useRef(null),[c,u]=A.useState(!1),d=(e,t)=>j(void 0,null,function*(){o(e),r(t),"video"===e&&u(!0)});return e&&0!==e.length?an.jsxs(an.Fragment,{children:[an.jsx("div",{className:"file-card-list",children:e.map((e,i)=>{const a=`${e.itemId||i}-${e.status}`;return["video","image"].includes(e.showType)||["video","image"].includes(e.type||"")?an.jsx(w$,{src:e.url,item:e,type:e.showType,fileType:e.file_type,alt:`${e.name}`,status:e.status,handleClose:()=>{null==t||t(i)},onReUpload:()=>{null==n||n(i)},name:e.name,size:e.size,handlePreview:d},a):an.jsx(_$,{className:"w-[17rem]",item:e,name:e.name,fileType:e.file_type,size:(null==e?void 0:e.size)||0,dismissible:!0,handleClose:()=>{null==t||t(i)},onReUpload:()=>{null==n||n(i)}},a)})}),"video"===a&&s&&an.jsx(ke,{videoPlayerRef:l,url:s,open:c,setOpen:u})]}):null},C$=({uploadInfo:e,uploadHandler:t=()=>{},disabled:n=!1})=>{const i=Ex(e=>e.mobile),a=vx(e=>e.currentInputFeature),[o,s]=A.useState(!1),r=$(),l=A.useRef(null),c=A.useRef(null),u=A.useMemo(()=>{const t=[{key:Lg.DOC,label:r.t("Upload document"),icon:"icon-line-paperclip-01",disabled:e.document.disable,eventID:"clkUploadFileBtn",type:wg.ITEM},{key:Lg.IMAGE,label:r.t("Upload image"),description:i||a!==ng.VideoGeneration?"":r.t("Select an image to use as the videos first frame."),icon:"icon-line-image-up-01",disabled:e.vision.disable,eventID:"clkUploadImgBtn",type:wg.ITEM,separator:i&&a===ng.VideoGeneration},{key:Lg.VIDEO,label:r.t("Upload video"),icon:"icon-line-video-up-01",disabled:e.video.disable,eventID:"clkUploadVideoBtn",type:wg.ITEM},{key:Lg.AUDIO,label:r.t("Upload audio"),icon:"icon-line-audio-up-01",disabled:e.audio.disable,eventID:"clkUploadAudioBtn",type:wg.ITEM}].filter(({key:t})=>e[t].show);return a===ng.VideoGeneration?i?t.concat([{type:wg.GROUP,label:r.t("Upload first frame"),key:"upload-first-frame"}]).reverse():t.reverse():t},[a,r,i,e]),d=A.useCallback(e=>{dS((e=>({[Lg.DOC]:"clkUploadFileBtn",[Lg.IMAGE]:"clkUploadImgBtn",[Lg.VIDEO]:"clkUploadVideoBtn",[Lg.AUDIO]:"clkUploadAudioBtn"}[e]))(e),{params:{et:"CLK"}})},[]),h=e=>{var n,i;null==(n=c.current)||n.updateOptions({acceptedTypes:lC(e),type:e,callBack:n=>{t({type:e,files:n})}}),null==(i=c.current)||i.triggerUpload(),d(e)};return A.useEffect(()=>{l.current&&(c.current=new HN(l.current))},[]),an.jsxs("div",{className:"upload-group",children:[an.jsx("input",{type:"file",id:"filesUpload",ref:l,multiple:!i,style:{display:"none"}}),an.jsx(ee,{open:o,placement:i?"topLeft":"bottomLeft",trigger:["click"],onOpenChange:e=>{n||(a!==ng.ImageEdit?s(e):h(Lg.IMAGE))},align:{offset:i?[0,-4]:[-12,8]},overlayClassName:"qwen-upload-group-dropdown",popupRender:()=>an.jsx("div",{className:"qwen-upload-group-menu",children:u.map(e=>an.jsxs("div",{className:Y({"qwen-upload-group-menu-item":e.type===wg.ITEM,"qwen-upload-group-menu-item-disabled":e.disabled,"qwen-upload-group-menu-item-group":e.type===wg.GROUP,"qwen-upload-group-menu-item-separator":e.separator}),onClick:()=>{e.type===wg.GROUP||e.disabled||(s(!1),h(e.key))},children:[!!e.icon&&an.jsx(pt,{type:e.icon,className:"qwen-upload-group-menu-item-icon"}),an.jsxs("div",{className:"qwen-upload-group-menu-item-content",children:[an.jsx("div",{className:"qwen-upload-group-menu-item-content-label",children:e.label}),!!e.description&&an.jsx("div",{className:"qwen-upload-group-menu-item-content-description",children:e.description})]})]},e.key))}),children:an.jsx("button",{className:i?"":"chat-prompt-upload-group-btn",type:"button",children:an.jsx(pt,{type:a===ng.ImageEdit?"icon-line-image-up-01":i?"icon-line-plus-01":"icon-line-plus-02",className:Y("chat-prompt-upload-group-btn-icon",{disabled:n,"text-18":a===ng.ImageEdit})})})})]})},E$=({tooltipText:e="",className:t="",iconType:n="",btnText:i="",active:a=!1,disabled:o=!1,isLastEle:s=!0,onClick:r=()=>{},commonClassName:l="",children:c})=>{const u=Lx();let d="chat-input-feature-btn";return s&&(d+=" is-last-element"),a&&!o&&(d+=" active"),o&&(d+=" disabled"),t&&(d+=` ${t}`),l&&(d+=` ${l}`),an.jsx(vt,{show:Boolean(e),title:e?an.jsx("span",{dangerouslySetInnerHTML:{__html:e}}):"",placement:"bottom",className:"chat-input-feature-tooltip",children:an.jsxs("div",{className:d,onClick:()=>{r()},children:[n&&an.jsx(pt,{type:n,className:"chat-input-feature-btn-icon "+(a?"chat-input-feature-btn-icon-active":"")}),(!u||a)&&an.jsxs(an.Fragment,{children:[an.jsx("span",{className:"chat-input-feature-btn-text",children:i}),c]})]})})},k$=e=>{const t=e,{min:n=1e3,max:i=25e3,step:a=100,currentValue:o=1e3,tooltip:s={open:!1},onChange:r}=t,l=S(t,["min","max","step","currentValue","tooltip","onChange"]);return an.jsx("div",{className:"messaage-input-slider",children:an.jsx(ve,w({min:n,max:i,step:a,value:o,onChange:r,tooltip:s},l))})},I$=1024,T$=({active:e,triggerActive:t})=>{const{i18n:n}=$(),[i,a]=A.useState(38912),[o,s]=A.useState(i),r=NT(e=>e.updateModelConfig),l=EI(e=>e.selectedModelIds),c=EI(e=>e.selectedModels),u=EI(e=>e.models),d=NT(e=>e.settings),h=TT(e=>e.messageInputPermissions),{qThinkingEquity:p,checkEquityPassByEquity:m}=m$(),f=A.useMemo(()=>h.enableThinking.disabled||null===(null==p?void 0:p.remains)||0===(null==p?void 0:p.remains),[h.enableThinking.disabled,null==p?void 0:p.remains]),g=A.useMemo(()=>h.enableThinking.disabled&&h.enableThinking.msg?h.enableThinking.msg:-1!==(null==p?void 0:p.remains)?LE({remains:(null==p?void 0:p.remains)||0,unit:null==p?void 0:p.unit,capability:n.t("Thinking Btn"),allowHtml:!0,currentI18n:n}):n.t("Thinking Btn"),[n,h.enableThinking.disabled,h.enableThinking.msg,null==p?void 0:p.remains,null==p?void 0:p.unit]),v=A.useCallback(e=>{s(e),r({[l[0]]:{thinking_budget:e}})},[l,r]),y=A.useCallback(()=>{var e,t,n;if(l.length>1||f)return!1;const i=u.find(e=>e.id===l[0]);return 1===(null==(n=null==(t=null==(e=null==i?void 0:i.info)?void 0:e.meta)?void 0:t.abilities)?void 0:n.thinking_budget)},[f,u,l]),b=A.useCallback(()=>{var e,t,n,o;if(1!==l.length)return;try{a((null==(n=null==(t=null==(e=c[0])?void 0:e.info)?void 0:t.meta)?void 0:n.max_thinking_generation_length)||38912);const r=c[0];r&&s(d.model_config&&(null==r?void 0:r.id)&&(null==(o=d.model_config[r.id])?void 0:o.thinking_budget)||i)}catch(r){}},[i,l.length,c,d.model_config]),x=A.useCallback(e=>{e?b():UT()||CS(_(w({},d),{model_config:_(w({},d.model_config),{[l[0]]:{thinking_budget:o}})}))},[o,b,l,d]);A.useEffect(()=>{0!==(null==p?void 0:p.remains)&&null!==(null==p?void 0:p.remains)||!e||t()},[e,b,null==p?void 0:p.remains,t]),A.useEffect(()=>{1===l.length&&b()},[l]);const S=A.useMemo(()=>y()?an.jsxs("div",{className:"chat-message-input-budget",onClick:e=>e.stopPropagation(),children:[an.jsx("div",{className:"button-line"}),an.jsx(ye,{placement:"bottom",title:"",icon:null,okText:null,showCancel:!1,arrow:!1,rootClassName:"chat-message-input-thinking-budget-popconfirm",description:an.jsxs("div",{className:"chat-message-input-thinking-budget-container",onClick:e=>e.stopPropagation(),children:[an.jsx("div",{className:"chat-message-input-thinking-budget-header",children:an.jsx("div",{className:"chat-message-input-thinking-budget-title",children:n.t("Thinking budget")})}),an.jsx("div",{className:"chat-message-input-thinking-budget-des",children:n.t("Control the maximum length of thinking")}),an.jsx("div",{className:"chat-message-input-thinking-budget-content",children:an.jsx(k$,{min:1024,max:i,step:I$,currentValue:o,onChange:v,tooltip:{open:!1}})}),an.jsx("div",{className:"chat-message-input-thinking-budget-info",children:an.jsxs("div",{className:"chat-message-input-thinking-budget-info-value",children:[o.toLocaleString("en-US")," ",n.t("tokens")]})})]}),onOpenChange:x,children:an.jsx(pt,{type:"icon-line-chevron-down",className:"chat-message-input-thinking-budget-icon"})})]}):an.jsx(an.Fragment,{}),[o,y,n,i,v,x]);return an.jsx("div",{className:"chat-message-input-thinking-budget-btn",children:an.jsx(E$,{tooltipText:g||n.t("Thinking Btn"),iconType:"icon-line-deepthink-01",isLastEle:!1,active:e&&!f,disabled:f,btnText:n.t("Thinking Btn"),onClick:()=>{m(p)&&!f&&t()},commonClassName:"",children:S})})};var j$=function(e,t){return(j$=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function N$(e,t){function n(){this.constructor=e}j$(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var P$=function(){return function(e,t){this.target=t,this.type=e}}(),M$=function(e){function t(t,n){var i=e.call(this,"error",n)||this;return i.message=t.message,i.error=t,i}return N$(t,e),t}(P$),A$=function(e){function t(t,n,i){void 0===t&&(t=1e3),void 0===n&&(n="");var a=e.call(this,"close",i)||this;return a.wasClean=!0,a.code=t,a.reason=n,a}return N$(t,e),t}(P$),O$={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0},R$=function(){function e(e,t,n){var i=this;void 0===n&&(n={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(e){i._debug("open event");var t=i._options.minUptime,n=void 0===t?O$.minUptime:t;clearTimeout(i._connectTimeout),i._uptimeTimeout=setTimeout(function(){return i._acceptOpen()},n),i._ws.binaryType=i._binaryType,i._messageQueue.forEach(function(e){return i._ws.send(e)}),i._messageQueue=[],i.onopen&&i.onopen(e),i._listeners.open.forEach(function(t){return i._callEventListener(e,t)})},this._handleMessage=function(e){i._debug("message event"),i.onmessage&&i.onmessage(e),i._listeners.message.forEach(function(t){return i._callEventListener(e,t)})},this._handleError=function(e){i._debug("error event",e.message),i._disconnect(void 0,"TIMEOUT"===e.message?"timeout":void 0),i.onerror&&i.onerror(e),i._debug("exec error listeners"),i._listeners.error.forEach(function(t){return i._callEventListener(e,t)}),i._connect()},this._handleClose=function(e){i._debug("close event"),i._clearTimeouts(),i._shouldReconnect&&i._connect(),i.onclose&&i.onclose(e),i._listeners.close.forEach(function(t){return i._callEventListener(e,t)})},this._url=e,this._protocols=t,this._options=n,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(e,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CONNECTING",{get:function(){return e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OPEN",{get:function(){return e.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSING",{get:function(){return e.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSED",{get:function(){return e.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){return this._messageQueue.reduce(function(e,t){return"string"==typeof t?e+=t.length:t instanceof Blob?e+=t.size:e+=t.byteLength,e},0)+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?e.CLOSED:e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),e.prototype.close=function(e,t){void 0===e&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState!==this.CLOSED?this._ws.close(e,t):this._debug("close: already closed"):this._debug("close enqueued: no ws instance")},e.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED?(this._disconnect(e,t),this._connect()):this._connect()},e.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var t=this._options.maxEnqueuedMessages,n=void 0===t?O$.maxEnqueuedMessages:t;this._messageQueue.length<n&&(this._debug("enqueue",e),this._messageQueue.push(e))}},e.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},e.prototype.dispatchEvent=function(e){var t,n,i=this._listeners[e.type];if(i)try{for(var a=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(i),o=a.next();!o.done;o=a.next()){var s=o.value;this._callEventListener(e,s)}}catch(r){t={error:r}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return!0},e.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter(function(e){return e!==t}))},e.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug},e.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,n=void 0===t?O$.reconnectionDelayGrowFactor:t,i=e.minReconnectionDelay,a=void 0===i?O$.minReconnectionDelay:i,o=e.maxReconnectionDelay,s=void 0===o?O$.maxReconnectionDelay:o,r=0;return this._retryCount>0&&(r=a*Math.pow(n,this._retryCount-1))>s&&(r=s),this._debug("next delay",r),r},e.prototype._wait=function(){var e=this;return new Promise(function(t){setTimeout(t,e._getNextDelay())})},e.prototype._getNextUrl=function(e){if("string"==typeof e)return Promise.resolve(e);if("function"==typeof e){var t=e();if("string"==typeof t)return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},e.prototype._connect=function(){var e=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var t=this._options,n=t.maxRetries,i=void 0===n?O$.maxRetries:n,a=t.connectionTimeout,o=void 0===a?O$.connectionTimeout:a,s=t.WebSocket,r=void 0===s?function(){if("undefined"!=typeof WebSocket)return WebSocket}():s;if(this._retryCount>=i)this._debug("max retries reached",this._retryCount,">=",i);else{if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),void 0===(l=r)||!l||2!==l.CLOSING)throw Error("No valid WebSocket class provided");var l;this._wait().then(function(){return e._getNextUrl(e._url)}).then(function(t){e._closeCalled||(e._debug("connect",{url:t,protocols:e._protocols}),e._ws=e._protocols?new r(t,e._protocols):new r(t),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout(function(){return e._handleTimeout()},o))})}}},e.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new M$(Error("TIMEOUT"),this))},e.prototype._disconnect=function(e,t){if(void 0===e&&(e=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new A$(e,t,this))}catch(n){}}},e.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},e.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},e.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},e.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},e.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},e}();const D$={1003:[{reason:"request too fast",message:"Voice input has been used too frequently. Please try again later."}]};class L${constructor(){C(this,"state","Stop"),C(this,"audioData",[]),C(this,"rws",null),C(this,"taskId",""),C(this,"asrResults",[]),C(this,"sentenceIndex",-1),C(this,"start",e=>{this.rws=new R$(e,"",{connectionTimeout:6e4,maxReconnectionDelay:3e3,minReconnectionDelay:1e3,maxRetries:10}),this.rws.onopen=()=>{if(!this.rws)return;this.taskId=rt().replaceAll("-",""),this.sentenceIndex=-1;const e=(e=>{const t={header:{message_id:rt().replaceAll("-",""),task_id:e,namespace:"SpeechTranscriber",name:"StartTranscription"},context:{},payload:{sample_rate:16e3,format:"pcm",enable_intermediate_result:!0,enable_inverse_text_normalization:!0,enable_punctuation_prediction:!0,language:V.language}};return JSON.stringify(t)})(this.taskId);this.rws.send(e)},this.rws.onclose=e=>{var t,n,i,a;this.state="Stop";const{code:o,reason:s}=e,r=null==(t=D$[o])?void 0:t.find(e=>e.reason===s),l=!!r||!1;if([1e3].includes(o)&&(null==e?void 0:e.isTrusted)||l)return null==(n=this.rws)||n.close(),this.rws=null,null==(i=this.onClose)||i.call(this),void(l&&(null==(a=this.onError)||a.call(this,new Error((null==r?void 0:r.message)||"")),this.state="Error"));this.state="Reconnecting"},this.rws.onerror=e=>{var t,n;"Started"===this.state&&(null==(t=this.rws)||t.close(),this.rws=null,null==(n=this.onError)||n.call(this,new Error(e.message)),this.state="Error")},this.rws.onmessage=e=>{var t,n;this.handleAsrData(JSON.parse(e.data))&&(null==(t=this.onEnd)||t.call(this),null==(n=this.rws)||n.close())}}),C(this,"stop",()=>{this.rws&&"Started"===this.state&&(this.rws.send((e=>{const t={header:{message_id:rt().replaceAll("-",""),task_id:e,namespace:"SpeechTranscriber",name:"StopTranscription"}};return JSON.stringify(t)})(this.taskId)),this.state="Stopping")}),C(this,"sendAudioData",e=>{"Started"===this.state&&this.rws?(this.audioData.forEach(e=>{var t;null==(t=this.rws)||t.send(e)}),this.audioData=[],this.rws.send(e)):this.audioData.push(e)}),C(this,"handleAsrData",e=>{var t,n,i,a,o;const{name:s=""}=(null==e?void 0:e.header)||{},{result:r=""}=(null==e?void 0:e.payload)||{};switch(s){case"TranscriptionStarted":this.state="Started";break;case"SentenceBegin":this.asrResults.push("");break;case"TranscriptionResultChanged":case"SentenceEnd":this.asrResults[this.asrResults.length-1]=r,null==(t=this.onMessage)||t.call(this,{result:this.asrResults.join("")});break;case"TranscriptionCompleted":this.state="Stop";break;case"TaskFailed":null==(n=this.onError)||n.call(this,new Error(s)),this.state="Error";break;case"TranscriptionResult":(null==(i=null==e?void 0:e.payload)?void 0:i.index)!==this.sentenceIndex&&(this.sentenceIndex=null==(a=null==e?void 0:e.payload)?void 0:a.index,this.asrResults.push("")),this.asrResults[this.asrResults.length-1]=r,null==(o=this.onMessage)||o.call(this,{result:this.asrResults.join("")})}return["TranscriptionCompleted","TaskFailed"].includes(s)}),C(this,"onError",null),C(this,"onEnd",null),C(this,"onClose",null),C(this,"onMessage",null)}}const F$=class e{constructor(){C(this,"speechRecognition",null),C(this,"start",()=>{if(!e.isSupport)return;this.speechRecognition.continuous=!0,this.speechRecognition.interimResults=!0;let t=!0;this.speechRecognition.onresult=e=>j(this,null,function*(){var n;const{results:i}=e,a=i[i.length-1],{transcript:o}=a[0],{isFinal:s}=a;null==(n=this.onMessage)||n.call(this,{result:o,begin:t}),t=s}),this.speechRecognition.onend=()=>{var e;null==(e=this.onEnd)||e.call(this)},this.speechRecognition.onerror=e=>{var t;null==(t=this.onError)||t.call(this,new Error(null==e?void 0:e.error))},this.speechRecognition.start()}),C(this,"stop",()=>{e.isSupport&&this.speechRecognition.stop()}),C(this,"onMessage",null),C(this,"onEnd",null),C(this,"onError",null),e.isSupport&&(this.speechRecognition=new(window.SpeechRecognition||window.webkitSpeechRecognition))}};C(F$,"isSupport","SpeechRecognition"in window||"webkitSpeechRecognition"in window);let z$=F$;class U${constructor(){C(this,"currentTime",0),C(this,"intervalTimeout",null),C(this,"pausedElapsedTime",0),C(this,"isPaused",!1),C(this,"start",e=>{this.stop(),this.isPaused=!1,this.pausedElapsedTime=0;const t=e||0;this.currentTime=Date.now()-1e3*t,this.intervalTimeout=setInterval(()=>{var e;const t=Math.round((Date.now()-this.currentTime)/1e3);null==(e=this.onTimeChange)||e.call(this,{time:t,formatTime:this.format(t)})},1e3)}),C(this,"stop",()=>{this.intervalTimeout&&(clearInterval(this.intervalTimeout),this.intervalTimeout=null),this.isPaused=!1,this.pausedElapsedTime=0,this.currentTime=0}),C(this,"pause",()=>{!this.isPaused&&this.intervalTimeout&&(this.pausedElapsedTime=Math.round((Date.now()-this.currentTime)/1e3),this.intervalTimeout&&(clearInterval(this.intervalTimeout),this.intervalTimeout=null),this.isPaused=!0)}),C(this,"resume",()=>{this.isPaused&&this.start(this.pausedElapsedTime)}),C(this,"format",e=>(""+e%60).padStart(2,"0")),C(this,"onTimeChange",null)}}const H$=jx()?43:150,B$=new uB,$$=({className:e="",onConfirm:t,onCancel:n})=>{const i=$(),a=Ex(e=>e.mobile),o=TT(e=>e.setInputValue),s=A.useRef(null),[r,l]=A.useState(""),[c,u]=A.useState(Array(H$).fill(0)),d=A.useRef(!1),h=A.useRef(new L$),p=A.useRef(new z$),m=A.useRef(B$),f=A.useRef(new U$),g=A.useRef(""),v=A.useCallback(e=>{g.current=e,l(e),a||d.current||o(e)},[a,o]),y=A.useCallback(()=>{f.current.stop(),h.current.stop(),p.current.stop(),m.current.stop()},[]),b=A.useCallback(()=>{v(""),y(),null==n||n()},[n,v,y]),x=A.useCallback(()=>{d.current=!0,y(),null==t||t(g.current)},[t,y]),w=A.useCallback(()=>{m.current.onAudioFrame=({data:e})=>{u([...e])},m.current.start().then(()=>{f.current.onTimeChange=({time:e})=>{e>=60&&x()},f.current.start(),m.current.analyzeAudio({frameLength:H$})});const e=e=>{const{result:t}=e;v(t),s.current&&s.current.scrollTo({top:s.current.scrollHeight})},t=()=>{b()},n=e=>{const t=e.message?i.t(e.message):i.t("Network error");tE.open({type:"error",content:t}),b()};try{m.current.onDataAvailable=e=>{h.current.sendAudioData(e)},h.current.onMessage=e,h.current.onClose=t,h.current.onError=n;let i="wss://chat.qwen.ai";if("prod"!==Qg){let e=location.hostname;"localhost"===e&&(e="pre-chat.qwen.ai"),i=`wss://${e}`}h.current.start(`${i}/api/v1/asr/wsgu_asr?token=${localStorage.token}`)}catch(a){tE.open({type:"error",content:(null==a?void 0:a.message)||i.t("Network error")}),b()}},[b,x,i,v]);return A.useEffect(()=>(w(),()=>{b()}),[]),a?an.jsxs("div",{className:`voice-recording-root ${e}`,children:[an.jsx("div",{ref:s,className:"asr-result "+(r?"asr-result-active":"asr-result-inactive"),children:r||(null==i?void 0:i.t("I'm listening"))}),an.jsxs("div",{className:"controls-row",children:[an.jsx("button",{type:"button",className:"button",onClick:b,children:an.jsx(pt,{type:"icon-line-x-02"})}),an.jsx("div",{className:"audio-bar",children:c.map(e=>an.jsx("div",{className:"audio-bar-item",style:{height:`${Math.min(100,Math.max(12,e))}%`}},rt()))}),an.jsx("button",{type:"button",className:"button button-confirm",onClick:x,children:an.jsx(pt,{type:"icon-line-check-01"})})]})]}):an.jsx("div",{className:`pc-voice-recording ${e}`,children:an.jsxs("div",{className:"pc-voice-recording-controls",children:[an.jsx("button",{type:"button",className:"button-cancel",onClick:b,children:an.jsx(pt,{type:"icon-line-x-02"})}),an.jsx("div",{className:"audio-bar",children:c.map(e=>an.jsx("div",{className:"audio-bar-item",style:{height:`${Math.min(100,Math.max(12,e))}%`}},rt()))}),an.jsx("button",{type:"button",className:"button-confirm",onClick:x,children:an.jsx(pt,{type:"icon-line-check-02"})})]})})},q$=()=>{var e;const t=vx(e=>e.history),n=TT(e=>e.visionSize),i=TT(e=>e.setVisionSize),a=Ex(e=>e.mobile),o=A.useMemo(()=>{if(!(null==t?void 0:t.messages))return null;const e=Object.keys(t.messages);return e.length>0?e[e.length-1]:null},[t.messages]),s=A.useMemo(()=>null!==o&&(null==t?void 0:t.messages)?t.messages[o]:null,[o,t]),r=null!=(e=null==s?void 0:s.chat_type)?e:"",l=A.useMemo(()=>!!(null==t?void 0:t.currentId)&&r===ng.ImageGeneration,[r,null==t?void 0:t.currentId]);return an.jsx(E$,{isLastEle:!1,active:!1,disabled:l,commonClassName:"size-selector-btn",children:an.jsx(nP,{value:[n],onChange:i,offset:a?[-25,10]:[-35,20],disabled:l})})},G$=e=>{const{open:t,onOk:n,onCancel:i}=e,{i18n:a}=$();return an.jsx(mt,{className:"mcp-first-time-guide-modal",visible:t,width:700,header:!1,footer:!1,children:an.jsxs("div",{className:"mcp-first-time-guide-modal-content",children:[an.jsx("div",{className:"mcp-first-time-guide-modal-content-close",onClick:i,children:an.jsx(pt,{type:"icon-close-4"})}),an.jsxs("div",{className:"mcp-first-time-guide-modal-content-inner",children:[an.jsxs("div",{className:"mcp-first-time-guide-modal-content-inner-left",children:[an.jsxs("div",{className:"mcp-first-time-guide-modal-content-inner-left-header",children:[an.jsx("div",{className:"mcp-first-time-guide-modal-content-inner-left-header-title",children:a.t("MCP: Limitless AI")}),an.jsx("div",{className:"mcp-first-time-guide-modal-content-inner-left-header-desc",children:a.t('The Model Context Protocol (MCP), introduced by Anthropic, is an open-source standard designed to facilitate the integration of large language models (LLMs) with external data sources and tools. MCP provides a unified interface, allowing AI models to connect with external data (e.g., files, databases, APIs) and integrate various functionalities more effectively. Described as a "universal plug," MCP enables consistent context sharing between AI systems and external environments, enhancing the flexibility and utility of AI applications. In essence, MCP acts like a "super network cable" for AI, enabling seamless external connectivity.')})]}),an.jsx("div",{className:"mcp-first-time-guide-modal-content-inner-left-button",children:an.jsx(ft,{type:"brandprimary",iconFontType:"icon-line-arrow-down-right-sm",onClick:n,children:a.t("Set up MCP to start")})})]}),an.jsx("div",{className:"mcp-first-time-guide-modal-content-inner-right",children:an.jsx("img",{src:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/images/mcp-intro.png",alt:""})})]})]})})},V$=e=>{const{open:t,onOk:n,onCancel:i}=e,{i18n:a}=$();return an.jsx(mt,{className:"no-mcp-available-modal",visible:t,width:480,header:!1,footer:!1,children:an.jsxs("div",{className:"no-mcp-available-modal-content",children:[an.jsx("div",{className:"no-mcp-available-modal-content-close",onClick:i,children:an.jsx(pt,{type:"icon-close-4"})}),an.jsxs("div",{className:"no-mcp-available-modal-content-inner",children:[an.jsx("div",{className:"no-mcp-available-modal-content-inner-header",children:a.t("No MCP available")}),an.jsx("div",{className:"no-mcp-available-modal-content-inner-desc",children:a.t("No MCP is available, please go to Settings to enable it.")}),an.jsxs("div",{className:"no-mcp-available-modal-content-inner-button",children:[an.jsx(ft,{type:"brandprimary",shape:"circle",onClick:n,children:a.t("MCP Settings")}),an.jsx(ft,{type:"textonly",shape:"circle",onClick:i,children:a.t("Not use for now")})]})]})]})})},W$=()=>{const{i18n:e}=$(),t=Ty(),n=Sx(e=>e.mcpEnabled),i=TT(e=>e.messageInputPermissions.enableMCP),a=NT(e=>e.mcpSettingList),o=NT(e=>e.settings.mcp_remind),s=NT(e=>e.settings.mcp),r=HE(e=>e.user),l=Sx(e=>e.setMcpEnabled),[c,u]=A.useState(!1),[d,h]=A.useState(!1),p=A.useMemo(()=>a.filter(e=>e.enabled).length,[a]),m=A.useMemo(()=>({items:[{key:"mcpEnabledList",label:an.jsxs(an.Fragment,{children:[an.jsx("div",{className:"mcp-button-menu-title",onClick:e=>e.stopPropagation(),onMouseEnter:e=>e.stopPropagation(),children:e.t("Enabled MCP  {{number}}",{number:p})}),an.jsx("div",{className:"mcp-button-menu-list",onClick:e=>e.stopPropagation(),children:a.filter(e=>e.enabled).map(t=>{let n="";switch(t.connectionStatus){case"available":n=e.t("MCP available");break;case"connecting":n=e.t("Connecting to the MCP server: Once connected, it can be used in chat.");break;case"failed":n=e.t("Connection to the MCP server failed: It is not available for use in chat.");break;default:n=""}return an.jsxs("div",{className:"mcp-button-menu-item",children:[an.jsxs("div",{className:"mcp-button-menu-item-header",children:[an.jsx(vt,{title:n,children:an.jsx("div",{className:Y("mcp-button-menu-item-header-status",{[t.connectionStatus]:!0})})}),an.jsx("div",{className:"mcp-button-menu-item--header-name",children:t.name})]}),an.jsx("div",{className:"mcp-button-menu-item-content",children:e.t(t.description)})]},t.id)})}),an.jsx("div",{className:"mcp-button-menu-setting-button",onClick:e=>e.stopPropagation(),children:an.jsx(ft,{type:"ghost",iconFontType:"icon-line-arrow-down-right-sm",onClick:()=>{t("/settings/mcp")},children:e.t("MCP Settings")})})]})}]}),[p,e,a,t]),f=()=>{u(!1)},g=()=>{h(!1)};return A.useEffect(()=>{r&&s&&TC()},[r,s]),an.jsxs("div",{id:"mcp-button",className:"mcp-button",children:[an.jsx(E$,{tooltipText:e.t(i.msg||"MCP"),iconType:"icon-line-star-01",btnText:e.t("MCP"),active:n,disabled:i.disabled,isLastEle:!1,onClick:()=>{i.disabled||(0===p?o?u(!0):h(!0):l(!n))},children:an.jsx(an.Fragment,{children:p>0&&!i.disabled&&an.jsx("div",{onClick:e=>{e.stopPropagation()},children:an.jsx(xt,{rootClassName:"mcp-button-dropdown",menu:m,trigger:["click"],placement:"bottom",children:an.jsxs("div",{className:"mcp-button-num",children:[an.jsx("div",{children:p}),an.jsx(pt,{type:"icon-line-triangle-down"})]})})})})}),an.jsx(G$,{open:c,onOk:()=>{t("/settings/mcp"),f()},onCancel:f}),an.jsx(V$,{open:d,onOk:()=>{t("/settings/mcp"),g()},onCancel:g})]})},Q$=A.forwardRef((e,t)=>{const n=$(),i=Sx(e=>e.webSearchEnabled),a=Sx(e=>e.setWebSearchEnabled),o=TT(e=>e.messageInputPermissions),s=TT(e=>e.updateFeatureType),r=vx(e=>e.currentInputFeature),{qSearchEquity:l,checkEquityPassByEquity:c}=m$(),u=A.useMemo(()=>o.enableSearch.disabled||null===(null==l?void 0:l.remains)||0===(null==l?void 0:l.remains),[o.enableSearch.disabled,null==l?void 0:l.remains]),d=A.useMemo(()=>o.enableSearch.disabled&&o.enableSearch.msg?o.enableSearch.msg:-1!==(null==l?void 0:l.remains)?LE({remains:(null==l?void 0:l.remains)||-1,unit:null==l?void 0:l.unit,capability:"Search",allowHtml:!0,currentI18n:n.i18n}):n.t("Search"),[n,o.enableSearch.disabled,o.enableSearch.msg,null==l?void 0:l.remains,null==l?void 0:l.unit]),h=A.useCallback(()=>{a(!i),kT.emit(vE.MESSAGE_INPUT_RECOMMEND_WORDS_CLICK,{suggestItem:{key:ng.WebSearch,value:ng.WebSearch,chatType:ng.WebSearch,subChatType:ng.WebSearch},active:!i});const e=i?ng.Txt2Txt:ng.WebSearch;let t={subChatType:e};r!==ng.DeepResearch&&(t={subChatType:e,chatType:e}),s(t)},[a,i,r,s]);return A.useImperativeHandle(t,()=>({onClickHandler:h})),A.useEffect(()=>{i&&!e.enabled&&h()},[e.enabled,h,i]),e.enabled?an.jsx(E$,{tooltipText:d,iconType:"icon-line-globe-01",isLastEle:!1,active:i,disabled:u,btnText:n.t("Search"),onClick:()=>{c(l)&&!u&&h()},commonClassName:""}):null}),K$=({children:e})=>{const t=$();return an.jsxs("div",{className:"add-files-placeholder",children:[an.jsx("div",{className:"emoji",children:""}),an.jsx("div",{className:"title",children:t.t("Add Files")}),e||an.jsx("div",{className:"description",children:t.t("Drop any files here to add to the conversation")})]})},Y$=({show:e=!1,showSidebar:t=!1})=>{const n=A.useRef(null),i=A.useMemo(()=>(n.current||(n.current=document.createElement("div")),n.current),[]);if(A.useEffect(()=>{const t=i;if(e){document.body.appendChild(t);const e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{try{document.body.removeChild(t)}catch(n){}document.body.style.overflow=e||"unset"}}try{t.parentElement&&document.body.removeChild(t)}catch(n){}},[e,i]),!e)return null;const a=an.jsx("div",{className:"dropzone-overlay",id:"dropzone",role:"region","aria-label":"Drag and Drop Container",children:an.jsx("div",{className:"dropzone-overlay-content",children:an.jsx("div",{className:"dropzone-overlay-inner",children:an.jsx("div",{className:"max-w-md",children:an.jsx(K$,{})})})})});return be.createPortal(a,i)},X$=({textLength:e})=>{const{i18n:t}=$(),n=Ex(e=>e.mobile);return e<=cg?null:an.jsx("div",{className:"pasted-limit-info",children:an.jsxs("span",{children:[!n&&t.t("If you need to input more than {{value}} characters, please convert it into a txt document and upload the file, or enable the function in `Settings-Interface-Paste large text as file` and then paste the text.",{value:cg}),n&&t.t("If you need to input more than {{value}} characters, please convert it into a txt document and upload the file, or just copy the text to the clipboard, and then paste it into the input box.",{value:cg})]})})},J$=()=>{const e=$(),t=Sx(e=>e.researchMode),n=Sx(e=>e.setResearchMode),i=TT(e=>e.messageInputPermissions),{qDeepResearchAdvanced:a,checkEquityPassByEquity:o}=m$(),s=A.useMemo(()=>null===(null==a?void 0:a.remains)||0===(null==a?void 0:a.remains),[a]),r=A.useMemo(()=>a&&-1!==(null==a?void 0:a.remains)?LE({remains:null==a?void 0:a.remains,unit:null==a?void 0:a.unit,capability:"Advanced",allowHtml:!0,currentI18n:e.i18n}):e.t(i.enableAdvanced.msg||"Devoting extra time to a deeper analysis"),[e,i.enableAdvanced.msg,a]),l=A.useCallback(()=>{n(!t)},[t,n]);return an.jsx(E$,{tooltipText:r,iconType:"icon-line-advanced-02",isLastEle:!1,active:t,disabled:s,btnText:e.t("Advanced"),onClick:()=>{o(a)&&!s&&l()},commonClassName:""})},Z$=(e,t,n,i,a)=>{const[o,s]=A.useState(!1);return A.useEffect(()=>{if("/"!==window.location.pathname||1!==(null==i?void 0:i.length))return;const o=((e,t,n,i,a)=>mk(e,t,n,i,a,3))(e,t,n,i,a);s(o)},[n,a,i,t,e]),o},eq=({functionButtonsVisible:e=!1,recommendWordsVisible:t=!1,recommendDetailHide:n=!1,inDetail:i=!1,uploadInfo:a,projectId:o=""})=>{var s,r,l;const{id:c}=Ny(),u=Ex(e=>e.config),d=Ex(e=>{var t,n;return null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.limits}),h=Sx(e=>e.thinkingEnabled),p=Sx(e=>e.setThinkingEnabled),m=Sx(e=>e.disableOtherFeature),f=Sx(e=>e.isPdfCardVisible),g=EI(e=>e.selectedModels),[v,y]=A.useState(!1),b=Sx(e=>e.PdfViewInfo),x=Ex(e=>e.mobile),S=vx(e=>e.currentInputFeature),C=Ex(e=>e.isDisableGuestAccess),E=Sx(e=>e.setWelcomeModalShow),k=vx(e=>e.currentInputSubType),I=A.useRef(!1),T=A.useRef(null);Sx(e=>e.setWebSearchEnabled),Sx(e=>e.webSearchEnabled);const N=vx(e=>e.history.messages),P=vx(e=>e.history.currentId)||"",{messageInputPermissions:M,inputValue:O,messageType:R,files:D,setInputValue:L,setFiles:F,onPromptSend:z}=TT(),{i18n:U}=$(),H=HE(e=>e.user),B=Sx(e=>e.taskRunning),q=Sx(e=>e.visionGenerating),G=vx(e=>e.setEmitSendPromptType),[V,W]=A.useState(!1),Q=vx(e=>e.isStopDisabled),K=DT(e=>e.setChatProjectId),Y=DT(e=>e.chatProjectId),X=TT(e=>e.setMobileRecommendDetailVisible),J=TT(e=>e.setShowDetail);TT(e=>e.updateFeatureType),(()=>{const e=EI(e=>e.models),t=EI(e=>e.setVisibleModels),n=TT(e=>e.files),i=vx(e=>e.currentInputFeature),a=Sx(e=>e.thinkingEnabled);A.useEffect(()=>{const a=e.filter(e=>{var t,a;if("qwen3-max-2025-09-23"===e.id||"Qwen3-Max"===e.name)return!0;const o=null==(a=null==(t=e.info)?void 0:t.meta.chat_type)?void 0:a.includes(i),s=n.every(t=>{var n,i;return 1===(null==(i=null==(n=e.info)?void 0:n.meta.abilities)?void 0:i["default"===t.file_class?"document":t.file_class])});return o&&s});t(a)},[a,i,n,e,t])})();const Z=A.useCallback(e=>j(void 0,null,function*(){if(G(Yf.CHAT),UT()&&C)E(!0);else{if((null==e?void 0:e.projectId)&&K(e.projectId),S===ng.ImageEdit){let t="";if(""===((null==e?void 0:e.inputText)||TT.getState().inputValue||"").trim()?t=U.t("Please enter a prompt describing how you'd like to edit your image."):TT.getState().files.length||(t=U.t("Please upload the image you would like to edit.")),t)return void ht.openOnce({type:"caution",content:t})}z(e)}}),[S,U,C,z,K,G,E]),ee=A.useCallback(e=>{dS("chatGeneration",{params:{et:"CLK"},aesParams:{c4:c,c5:R,c6:e},paramsExtend:{chat_id:c,msg_type:R,send_type:e}})},[c,R]),te=A.useCallback((e,t)=>{switch(e){case"stop":kT.stopResponse();break;case"send":if(J(!1),P){const e=jt(N),t=N[P];if((null==t?void 0:t.isMultiResponse)&&t.parentId){N[t.parentId].childrenIds.forEach(t=>{e[t].isMultiResponse=!1}),kT.updateChatHistory({messages:e,currentId:P})}}kT.closeShowControls(),kT.emit(vE.MESSAGE_INPUT_TRIGGER_FOCUS,!1),Z({inputText:null!=t?t:O,projectId:o||Y}),S===ng.Travel&&x&&X(!1)}},[Z,Y,S,O,x,o,X,N,P]),ne=A.useMemo(()=>{const e=S===ng.DeepResearch&&k===ng.DeepResearch,t=S===ng.DeepResearch&&k===ng.INTERRUPT;return(e||t)&&B},[S,k,B]),ie=A.useMemo(()=>v?U.t("I'm listening"):ne?U.t("Provide additional details..."):((e,t)=>{const n=Hf();switch(e){case ng.Artifacts:return t===ng.WebDev?n.t("Describe the web page you want to generate."):n.t("Describe the artifacts you want to generate.");case ng.DeepResearch:return n.t("Describe the themes you want to research.");case ng.ImageGeneration:return n.t("Describe the image you want to generate.");case ng.ImageEdit:return n.t("Upload up to three images and describe how you'd like them edited");case ng.VideoGeneration:return n.t("Describe the video you want to generate.");default:return""}})(S,k),[S,k,U,ne,v]),ae=A.useMemo(()=>ET.createFilesManager({onAddProcess:(e,t)=>{const n=TT.getState().files;if(t&&Array.isArray(n)){const e=[...n.filter(e=>e.itemId!==t.itemId),jt(t)];F(e)}},onAddSuccess:(e,t)=>{var n,i,a;const o=TT.getState().files;if(!o.length||!o.some(e=>e.itemId===t.itemId))return;const s=[...o.filter(e=>e.itemId!==t.itemId),jt(t)];F(s),dS("uploadedFileData",{params:{et:"OTHER",c1:null==(n=null==t?void 0:t.file)?void 0:n.user_id,c4:null==t?void 0:t.id,c5:null==t?void 0:t.name,c6:t.file_type,c7:(null==(i=null==t?void 0:t.file)?void 0:i.meta)?JSON.stringify(null==(a=null==t?void 0:t.file)?void 0:a.meta):"",c8:t.status}})},onAddFail:(e,t)=>{t&&F([...e.filter(e=>e.itemId!==t.itemId),jt(t)]),dS("uploadedFileErr",{params:{et:"OTHER"}})},onPaseSuccess:(e,t)=>{var n,i,a;const o=TT.getState().files;if(o.length&&o.some(e=>e.itemId===t.itemId)&&t){const e=_(w({},t),{file:jt(t.file)});F([...o.filter(e=>e.id!==t.id),jt(e)]),dS("filePaseSuccess",{params:{et:"OTHER",c1:(null==H?void 0:H.id)||(null==(n=null==t?void 0:t.file)?void 0:n.user_id)||"",c4:null==t?void 0:t.id,c5:null==t?void 0:t.name,c6:t.file_type,c7:(null==(i=null==t?void 0:t.file)?void 0:i.meta)?JSON.stringify(null==(a=null==t?void 0:t.file)?void 0:a.meta):""}})}},onPaseFail:(e,t)=>{var n,i,a,o,s,r,l;if(e.length&&e.some(e=>e.itemId===t.itemId)&&t){const c=_(w({},t),{file:jt(t.file)});F([...e.filter(e=>e.id!==t.id),jt(c)]),dS("filePaseFail",{params:{et:"OTHER",c1:(null==H?void 0:H.id)||(null==(n=null==t?void 0:t.file)?void 0:n.user_id)||"",c4:null==t?void 0:t.id,c5:null==t?void 0:t.name,c6:t.file_type,c7:(null==(i=null==t?void 0:t.file)?void 0:i.meta)?JSON.stringify(null==(a=null==t?void 0:t.file)?void 0:a.meta):"",c8:(null==(s=null==(o=t.file)?void 0:o.meta)?void 0:s.parse_meta)?JSON.stringify(null==(l=null==(r=t.file)?void 0:r.meta)?void 0:l.parse_meta):""}})}},userId:null==H?void 0:H.id,parsedFileTypes:[Fg.FILE]}),[null==H?void 0:H.id]),oe=A.useMemo(()=>{var e,t;if(fk(N,S,P)&&P){const n=(null==(t=null==(e=N[P])?void 0:e.content_list)?void 0:t[0])||"";return!n||!(!n||"answer"===n.phase)}return!1},[N,P,S]),se=A.useMemo(()=>!!o,[o]),re=A.useMemo(()=>{let e=!1;return e=se?""===O&&!D.length:""===O&&!D.length&&!c,e},[se,O,D.length,c]),le=A.useMemo(()=>{var e;return!!(null==(e=N[P])?void 0:e.done)},[N,P]),ce=A.useMemo(()=>{var e,t;return!!(null==(t=null==(e=N[P])?void 0:e.content_list)?void 0:t.some(e=>"answer"===e.phase))},[P,N]),ue=A.useMemo(()=>{const e=vk(N,P);return(null==e?void 0:e.done)||!1},[P,N]),de=A.useMemo(()=>{const e=""!==(null==O?void 0:O.trim())||!!D.length;switch(k){case ng.INTERRUPT:return!e&&(B||q)||ce&&!ue?"stop":"send";case ng.DeepResearch:return!e&&(B||q)||ce&&!le?"stop":"send";default:return B||q?"stop":"send"}},[k,B,q,ce,ue,O,D.length,le]),he=A.useMemo(()=>k===ng.INTERRUPT&&!le,[k,le]),pe=A.useMemo(()=>{if(re&&!B&&!q)return an.jsx(x$,{});const e=S===ng.ImageEdit?""===O||""===(null==O?void 0:O.trim())||!D.length:(""===O||""===(null==O?void 0:O.trim()))&&!D.length,t=[ng.ImageEdit,ng.ImageGeneration,ng.VideoGeneration].includes(S)||Q||q,n=B||q?t:e;return an.jsx(b$,{buttonDisabled:n||he,status:de,onClick:te,sendChatGenerationEvent:ee,disabledStatusCallbackEnabled:S===ng.ImageEdit?["send"]:[]})},[S,D.length,te,O,Q,B,q,ee,re,de,he]),me=A.useMemo(()=>an.jsxs("div",{className:"action-bar-right",children:[O?null:an.jsx(dB,{setRecording:y,visible:!x&&!UT()}),pe]}),[O,x,pe]),fe=A.useCallback(e=>{let t=e;return t=((e,{currentInputFeature:t,config:n,files:i})=>{var a,o;if(t===ng.ImageEdit){const t=e.filter(e=>(e=>{const{type:t="",file_type:n="",name:i=""}=e||{};return["image/png","image/jpeg","image/bmp","image/tiff","image/webp"].includes(n||t)&&(i.toLowerCase().endsWith(".png")||i.toLowerCase().endsWith(".jpg")||i.toLowerCase().endsWith(".jpeg")||i.toLowerCase().endsWith(".bmp")||i.toLowerCase().endsWith(".tif")||i.toLowerCase().endsWith(".tiff")||i.toLowerCase().endsWith(".webp"))})(e)),s=(null==(o=null==(a=null==n?void 0:n.features.limits)?void 0:a.image_edit)?void 0:o.image_max_count)||1;return t.length<e.length?ht.openOnce({type:"warning",content:Hf().t("Only JPG, JPEG, PNG, BMP, TIFF and WEBP files are supported.")}):i.length+t.length>s&&ht.openOnce({type:"warning",content:Hf().t("In a single-turn conversation, up to {{number}} images can be uploaded.",{number:s})}),i.length+t.length>s&&t.splice(s-i.length,i.length+t.length-s),t}return e})(t,{currentInputFeature:S,config:u,files:D}),t=((e,{currentInputFeature:t,config:n,files:i})=>{var a,o,s;if(t===ng.VideoGeneration&&e){const t=rk[ng.VideoGeneration];if(t){const r=e.filter(e=>e.type.startsWith("image")),l=e.filter(e=>!e.type.startsWith("image")),c=r.filter(e=>{const{type:n="",name:i=""}=e||{};return t.mineType.includes(n)&&t.extensions.find(e=>i.toLowerCase().endsWith(e))}),u=(null==(s=null==(o=null==(a=null==n?void 0:n.features)?void 0:a.limits)?void 0:o.video_generation)?void 0:s.image_max_count)||1;c.length<r.length?ht.openOnce({type:"warning",content:Hf().t(`Only ${t.fileType.join(", ")} files are supported.`)}):i.filter(e=>"image"===e.type).length+c.length>u&&ht.openOnce({type:"warning",content:Hf().t("In a single-turn conversation, up to {{number}} images can be uploaded.",{number:u})});const d=i.filter(e=>"image"===e.type);return d.length+c.length>u&&c.splice(u-d.length,d.length+c.length-u),[...l,...c]}}return e||[]})(t,{currentInputFeature:S,config:u,files:D}),t},[u,S,D]),ge=A.useCallback(e=>{const t=fe(e.files);t.length>0&&ae.addFiles(t,e.type)},[ae,fe]),ve=e=>j(void 0,null,function*(){const t=D[e];t&&"uploading"===t.status&&t.uploadTaskId&&(yield ME.stopAndRemoveTask(t.uploadTaskId)),ae.removeFile(t),F(null==D?void 0:D.filter(e=>t.itemId!==e.itemId))}),ye=A.useCallback((e,t)=>{L(e),"send"===t&&(Z({inputText:e}),ee("suggest"))},[Z,ee,L]),{renderTipsModels:be}=gj({filesManager:ae,promptCallBack:ye}),xe=A.useCallback(e=>{L(e),te("send",e)},[te,L]),we=A.useCallback((e,t)=>{var n;e===ng.Thinking&&p(!0),e===ng.WebSearch&&(null==(n=T.current)||n.onClickHandler())},[p]),_e=A.useCallback(e=>{L(e),y(!1)},[L]),Se=A.useCallback(()=>{y(!1)},[]);A.useEffect(()=>{const e=[];!a.audio.disable&&a.audio.show&&e.push(Lg.AUDIO),!a.document.disable&&a.document.show&&e.push(Lg.DEFAULT,Lg.DOC),!a.video.disable&&a.video.show&&e.push(Lg.VIDEO),!a.vision.disable&&a.vision.show&&e.push(Lg.IMAGE),ae.updateLimitTypes(e)},[ae,a]),A.useEffect(()=>{I.current=((e,t,n,i,a)=>mk(e,t,n,i,a,4))(ng.Thinking,U.t("Thinking Btn"),u,g,D),I.current&&p(!0)},[u,D,U,g,p]);const Ce=Z$(ng.Thinking,U.t("Thinking Btn"),u,g,D);A.useEffect(()=>{Ce&&p(!0)},[Ce]),h$({onInputCallback:xe,onFeatureCallback:we,checkKeyList:u$});const Ee=A.useCallback(e=>{var t,n;e.preventDefault(),S!==ng.ImageGeneration&&((null==(n=null==(t=e.dataTransfer)?void 0:t.types)?void 0:n.includes("Files"))?W(!0):W(!1))},[S]),ke=A.useCallback(e=>j(void 0,null,function*(){var t,n;if(e.preventDefault(),S!==ng.ImageGeneration){if(null==(t=e.dataTransfer)?void 0:t.files){const t=Array.from(null==(n=e.dataTransfer)?void 0:n.files),i=fe(t);i.length>0&&ae.addFiles(i)}W(!1)}}),[S,ae,fe]),je=()=>{W(!1)},Ne=()=>an.jsx("div",{className:"prompt-input-file-list",children:an.jsx(S$,{role:"user",files:D,onClose:ve,onReUpload:e=>j(void 0,null,function*(){var t,n,i;const a=D[e];a&&"failed"===(null==(i=null==(n=null==(t=a.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)?ae.startParse(a,!0):a&&(a.uploadTaskId?yield ME.resumeUpload(a.uploadTaskId):ae.retryFile(a))})})});return A.useEffect(()=>{const e=document.getElementById("dropzone-container");return null==e||e.addEventListener("dragover",Ee),null==e||e.addEventListener("drop",ke),null==e||e.addEventListener("dragleave",je),()=>{null==e||e.removeEventListener("dragover",Ee),null==e||e.removeEventListener("drop",ke),null==e||e.removeEventListener("dragleave",je)}},[Ee,ke]),A.useEffect(()=>{d&&ae.updateLimitRules(OE(d))},[ae,d]),A.useEffect(()=>{var e,t;if(g.length){let n;if(n=g.map(e=>e.id).includes(Rg)?g.find(e=>e.id===Rg):g[0],n){const i=null==(t=null==(e=n.info)?void 0:e.meta)?void 0:t.file_limits;ae.updateLimitRules(OE(i))}}},[ae,g]),an.jsxs("div",{className:"chat-prompt-input-container",children:[v&&x?an.jsx($$,{onConfirm:_e,onCancel:Se}):an.jsxs("div",{className:"chat-prompt-input",children:[e&&an.jsx(v$,{resetInputHandler:ye,inDetail:i,isProject:""!==o}),x&&an.jsx(X$,{textLength:(null==O?void 0:O.length)||0}),an.jsxs("div",{className:"prompt-input-container",children:[!x&&Ne(),f&&an.jsx("div",{className:"prompt-input-deep-research-tag",children:an.jsx(Ie,{info:b,type:Te.simple,onDownload:Ek})}),an.jsx("div",{className:"prompt-input-input-area",children:an.jsx(hB,{value:O,onChange:e=>L(e),onSend:()=>{he||"stop"===de||te("send")},messageType:R,inDetail:i,onInputPaste:e=>j(void 0,null,function*(){((e,t)=>{var n,i,a;const o=e.clipboardData||window.clipboardData;let s=!1;if(o&&o.items){vx.getState().currentInputFeature;const l=NT.getState().settings;for(const c of o.items)if("text/html"!==c.type&&"text/rtf"!==c.type){if(-1!==c.type.indexOf("image")){const e=c.getAsFile();e&&t.addFile(e,Lg.IMAGE),s=!0}else if("text/plain"===c.type){const r=o.getData("text/plain");if((null==(i=null==(n=null==l?void 0:l.ui)?void 0:n.largeTextAsFile)||i)&&r.length>cg){const n=new Blob([r],{type:"text/plain"}),i=new File([n],`Pasted_Text_${Date.now()}.txt`,{type:"text/plain"});t.addFile(i,Lg.DEFAULT),e.preventDefault(),s=!0}else{const t=ZE(r);if(t.length>1||(null==(a=null==t?void 0:t[0])?void 0:a.type)===rg.url){const n=e.target;let i=TT.getState().inputValue;const a=ek(t),o=null==n?void 0:n.selectionStart,r=null==n?void 0:n.selectionEnd;i=i.slice(0,o)+a+i.slice(r),TT.getState().setInputValue(i),setTimeout(()=>{n.selectionStart=n.selectionEnd=o+a.length},0),n.style.height="auto",n.style.height=n.scrollHeight+"px",s=!0}}}if(!s)try{const t=o.getData(c.type);if(t){const n=e.target,i=null==n?void 0:n.selectionStart,a=null==n?void 0:n.selectionEnd;let o=TT.getState().inputValue;o=o.slice(0,i)+t+o.slice(a),TT.getState().setInputValue(o),setTimeout(()=>{n.selectionStart=n.selectionEnd=i+t.length},0),n.style.height="auto",n.style.height=n.scrollHeight+"px",s=!0}}catch(r){}}}})(e,ae)}),placeholder:ie,setRecording:y,renderProps:Ne,sendChatGenerationEvent:ee,isPlanning:ne,IsDeepResearchRounds:oe})}),v?an.jsx($$,{onConfirm:_e,onCancel:Se}):an.jsxs("div",{className:"prompt-input-action-bar",children:[an.jsxs("div",{className:"action-bar-left",children:[M.enableUpload.enable&&an.jsx(C$,{uploadHandler:ge,uploadInfo:a,disabled:S===ng.ImageEdit&&(null==D?void 0:D.length)>=((null==(l=null==(r=null==(s=null==u?void 0:u.features)?void 0:s.limits)?void 0:r.image_edit)?void 0:l.image_max_count)||1)}),an.jsxs("div",{className:"action-bar-left-btns",children:[M.enableThinking.enable&&an.jsx(T$,{active:h,triggerActive:()=>{var e;dS("clkGenerateMode",{params:{et:"CLK"},aesParams:{c4:"thinking"},paramsExtend:{msg_type:"thinking"}}),(null==(e=M.enableThinking)?void 0:e.disabled)||I.current||m||p(!h)}}),an.jsx(Q$,{enabled:M.enableSearch.enable,ref:T}),!x&&M.enableSizeSelector.enable&&an.jsx(q$,{}),M.enableMCP.enable&&an.jsx(W$,{}),M.enableAdvanced.enable&&an.jsx(J$,{})]})]}),me]})]}),!x&&an.jsx(X$,{textLength:(null==O?void 0:O.length)||0}),t&&an.jsx(y$,{recommendDetailHide:n,resetInputHandler:ye},"RecommendWords"),be]}),an.jsx(Y$,{show:V})]})},tq=()=>{const e=$(),t="footer-link "+("dark"===zE(e=>e.realTheme)?"footer-link-dark":"footer-link-light");return UT()?an.jsx("div",{className:"chat-footer",children:an.jsx(q,{i18nKey:"By using Qwen Chat, you agree to our {{Terms}} and {{Privacy}}.",values:{Terms:"<a/>",Privacy:"<b/>"},components:{a:an.jsx("a",{className:t,onClick:e=>{var t;(null==(t=window.electronAPI)?void 0:t.open_external_link)?(e.preventDefault(),window.electronAPI.open_external_link(`${window.location.origin}/legal-agreement/terms-of-service`)):window.open(`${window.location.origin}/legal-agreement/terms-of-service`)},children:e.t("Terms of Service")},"terms-of-service"),b:an.jsx("a",{className:t,onClick:e=>{var t;(null==(t=window.electronAPI)?void 0:t.open_external_link)?(e.preventDefault(),window.electronAPI.open_external_link(`${window.location.origin}/legal-agreement/privacy-policy`)):window.open(`${window.location.origin}/legal-agreement/privacy-policy`)},children:e.t("Privacy Policy")},"privacy-policy")}})}):null},nq="mobile"===Ox(),iq=({permissions:e,scrollDownBtnVisible:t=!1,onScrollDown:n,onScrollTop:i,inDetail:a=!1,chatId:o,projectId:s})=>{var r,l;const{i18n:c}=$(),u=Ex(e=>e.config),d=vx(e=>e.history),h=Sx(e=>e.thinkingEnabled),p=vx(e=>e.currentInputFeature),m=vx(e=>e.currentInputSubType),f=EI(e=>e.models),g=EI(e=>e.selectedModels),v=EI(e=>e.selectedModelIds),y=TT(e=>e.files),b=HE(e=>e.user),x=TT(e=>e.setMessageInputPermissions),w=TT(e=>e.setMessageType),_=Sx(e=>e.setThinkingEnabled),S=Sx(e=>e.setMcpEnabled),C=A.useMemo(()=>{var t,n,i;return(!d.currentId||!(null==(t=null==kT?void 0:kT.shareHistory)?void 0:t.shareId))&&(nq?null!=(n=null==e?void 0:e.functionButtonsVisible)&&n:null!=(i=p!==ng.DeepResearch&&p!==ng.Travel&&(null==e?void 0:e.functionButtonsVisible))&&i)},[p,e,d.currentId]),E=null!=(r=null==e?void 0:e.recommendWordsVisible)&&r,k=null!=(l=null==e?void 0:e.recommendDetailHide)&&l,I=A.useMemo(()=>[h?"thinking":""].filter(e=>""!==e),[h]),T=(e=>{const{config:t,history:n,currentInputFeature:i,currentInputSubType:a,models:o,selectedModelsStore:s=[],featureSwitchList:r,files:l}=e,c=A.useMemo(()=>i!==ng.DeepResearch||fk(n.messages,i,n.currentId),[i,n.messages,n.currentId]),u=A.useMemo(()=>i!==ng.Travel||gk(n.messages,i,n.currentId),[i,n.messages,n.currentId]),d=A.useMemo(()=>Object.keys(n.messages).some(e=>{var t;return(null==(t=n.messages[e])?void 0:t.chat_type)===ng.DeepResearch}),[n]),h=A.useMemo(()=>d&&a===ng.WebSearch?ng.WebSearch:i,[i,a,d]),p=A.useMemo(()=>{var e,n,i;const a=jt(t);return c&&(null==(i=null==(n=null==(e=null==a?void 0:a.features)?void 0:e.feature_file)?void 0:n.deep_research)?void 0:i.length)&&(a.features.feature_file.deep_research=[Fg.AUDIO,Fg.IMAGE,Fg.VIDEO,Fg.FILE]),a},[t,c]),m=A.useMemo(()=>o.filter(e=>s.find(t=>(null==t?void 0:t.id)===e.id)),[o,s]),f=A.useMemo(()=>{var e,t,i,a;const{id:o}=(null==(e=Object.values(n.messages))?void 0:e.find(e=>(null==e?void 0:e.sub_chat_type)===ng.DeepResearch&&"assistant"===e.role))||{};return!!o&&!(null==(i=null==(t=null==n?void 0:n.messages[o||""])?void 0:t.content_list)?void 0:i.some(e=>"answer"===e.phase))&&!(null==(a=null==n?void 0:n.messages[o||""])?void 0:a.done)},[n.messages]),g=A.useMemo(()=>ck(Fg.IMAGE,h,r,p,m,l),[p,h,r,m,l]),v=A.useMemo(()=>ck(Fg.FILE,h,r,p,m),[p,h,r,m]),y=A.useMemo(()=>!!f||ck(Fg.AUDIO,h,r,p,m),[p,h,r,f,m]),b=A.useMemo(()=>!!f||ck(Fg.VIDEO,h,r,p,m),[p,h,r,f,m]),x=A.useMemo(()=>i===ng.Travel&&!u,[i,u]);return{[Lg.IMAGE]:{disable:g||x,show:!0},[Lg.DOC]:{disable:v||x,show:!0},[Lg.DEFAULT]:{disable:v||x,show:!0},[Lg.AUDIO]:{disable:y||x,show:i!==ng.VideoGeneration&&c},[Lg.VIDEO]:{disable:b||x,show:i!==ng.VideoGeneration&&c}}})({history:d,config:u,currentInputFeature:p,currentInputSubType:null!=m?m:p,models:f,selectedModelsStore:g,featureSwitchList:I,files:y}),j=A.useMemo(()=>p!==ng.Travel||gk(d.messages,p,d.currentId),[p,d.messages,d.currentId]),N=A.useMemo(()=>p!==ng.DeepResearch||fk(d.messages,p,d.currentId),[p,d.messages,d.currentId]),P=A.useMemo(()=>{const e=[ng.Podcast,ng.DeepResearchWebDev].includes(m)&&kT.shareHistory;return{enable:!(T.vision.disable&&T.document.disable&&T.video.disable&&T.audio.disable||e),disabled:!1}},[m,T.vision.disable,T.document.disable,T.video.disable,T.audio.disable]),M=A.useMemo(()=>{const e=pk("thinking",p,I,u,g)&&N&&j,{disabled:t,msg:n}=uk(ng.Thinking,c.t("Thinking Btn"),u,g,y,v);return t&&_(!1),{enable:e,disabled:t,msg:n}},[u,p,N,I,y,c,v,g,_,j]),O=A.useMemo(()=>{const e=pk("web_search",p,I,u,g)&&N&&j,{disabled:t,msg:n}=uk(ng.WebSearch,c.t("Web Search"),u,g,y,v);return{enable:e,disabled:t,msg:n}},[p,I,u,N,j,g,h,c,y,v]),R=A.useMemo(()=>{const e=pk("mcp",p,I,u)&&Gx(),{disabled:t,msg:n}=UT()&&!b?{disabled:!0,msg:c.t("Login required to use")}:uk(ng.Mcp,c.t("MCP"),u,g,y,v);return e&&!t||S(!1),{enable:e,disabled:t,msg:n}},[p,I,u,b,c,g,y,v,S]),D=A.useMemo(()=>{const e=[ng.ImageGeneration,ng.VideoGeneration].includes(p);if(p===ng.VideoGeneration&&(null==y?void 0:y.find(e=>"image"===e.type)))return{enable:!1,disabled:!1,msg:""};return{enable:e&&(!nq||a),disabled:!1,msg:""}},[a,p,y]),L=A.useMemo(()=>({enable:p===ng.DeepResearch,disabled:!1,msg:""}),[p]),F=A.useMemo(()=>({enableThinking:M,enableSearch:O,enableMCP:R,enableSizeSelector:D,enableUpload:P,enableAdvanced:L}),[M,P,O,R,D,L]);return A.useEffect(()=>{w({subChatType:m,chatType:p})},[p,m]),A.useEffect(()=>{x(F)},[F,x]),an.jsxs(an.Fragment,{children:[an.jsxs("div",{className:"chat-message-input "+(a?"":"in-placeholder"),id:"chat-message-input",children:[an.jsx("div",{className:"chat-message-input-fixed",style:o?void 0:{opacity:0,pointerEvents:"none"},children:an.jsx("div",{className:"chat-message-input-fixed-container",id:"message-input-container",children:an.jsx("div",{className:"scroll-down-button",onClick:t?n:i,children:an.jsx(pt,{type:"icon-line-arrow-down",className:"scroll-down-button-icon "+(t?"":"up-button-icon")})})})}),an.jsx("div",{className:"chat-message-input-container-inner",children:an.jsx(eq,{functionButtonsVisible:C,recommendWordsVisible:E,recommendDetailHide:k,inDetail:a,uploadInfo:T,projectId:s})})]}),nq?an.jsx(tq,{}):null]})},aq=()=>{const e=Fx(),t=$x(),n=qx(),i="mobile"===Ox(),a=Sx(e=>e.temporaryChatEnabled),o=Ex(e=>e.mobile),s=Sx(e=>e.setTaskRunning),r=Sx(e=>e.setVisionGenerating),l=TT(e=>e.setShowDetail),c=HE(e=>e.user),{i18n:u}=$(),d=A.useCallback(()=>{s(!1),r(!1),l(!1),kT.createChat(),kT.initSelectedModels()},[l,s,r]);A.useEffect(()=>{d()},[d]),A.useEffect(()=>{const e=new URLSearchParams(window.location.search).get("shareId");vx.getState().history.currentId&&!e&&(kT.resetChatState(),kT.closeShowControls())},[]);const h=A.useMemo(()=>((e,t=!1)=>{const n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][(new Date).getDay()],i=B(),a=[()=>i.t("Whats on your mind today?"),()=>i.t("What can I do for you?"),()=>i.t("Whats on the agenda today?"),()=>i.t("Ready when you are."),()=>i.t("What are you working on?"),()=>i.t("Where should we begin?"),e=>e&&!t?i.t("How can I help, {{name}}?",{name:e}):i.t("How can I help?"),()=>i.t("Ready to get started?"),()=>i.t("How can I help you right now?"),()=>i.t("What can I help you with today?"),e=>e&&!t?i.t("Let's get started, {{name}}.",{name:e}):i.t("Let's get started."),()=>i.t("What's the plan for today?"),()=>i.t("What brings you here today?"),()=>i.t("Where do you want to start?"),()=>i.t("Ready to create something?"),()=>i.t("Ready when you are."),e=>e&&!t?i.t("Where to begin, {{name}}?",{name:e}):i.t("Where to begin?"),()=>i.t("What would you like to explore?"),e=>e&&!t?i.t("What's your focus today, {{name}}?",{name:e}):i.t("What's your focus today."),e=>e&&!t?i.t("What do you want to know, {{name}}?",{name:e}):i.t("What do you want to know.")];return(0,a[Math.floor(Math.random()*a.length)])(e,n)})(null==c?void 0:c.name,o),[null==c?void 0:c.name,o]),p=n?{functionButtonsVisible:!0}:{recommendWordsVisible:!0};return t?an.jsx("div",{className:"main-layout native-layout",children:an.jsx("div",{className:"placeholder-container",id:"dropzone-container",children:an.jsx("div",{className:"placeholder-text-container",children:an.jsx(eP,{greetingText:h})})})}):an.jsxs("div",{className:"home-page-layout-main "+(a&&!o?"home-page-layout-main-temporary":""),children:[e?an.jsx(WN,{}):null,an.jsx("main",{className:"main-content",children:an.jsxs("div",{className:"placeholder-container",id:"dropzone-container",children:[an.jsx("div",{className:"placeholder-text-container",children:an.jsx(eP,{greetingText:h})}),an.jsx(iq,{permissions:p})]})}),i?null:an.jsx(tq,{})]})},oq=A.createContext(null);oq.displayName="PanelGroupContext";const sq="data-panel-group",rq="data-panel-group-direction",lq="data-panel-group-id",cq="data-panel",uq="data-panel-collapsible",dq="data-panel-id",hq="data-panel-size",pq="data-panel-resize-handle-id",mq=A.useLayoutEffect,fq=F["useId".toString()],gq="function"==typeof fq?fq:()=>null;let vq=0;function yq(e=null){const t=gq(),n=A.useRef(e||t||null);return null===n.current&&(n.current=""+vq++),null!=e?e:n.current}function bq(e){var t=e,{children:n,className:i="",collapsedSize:a,collapsible:o,defaultSize:s,forwardedRef:r,id:l,maxSize:c,minSize:u,onCollapse:d,onExpand:h,onResize:p,order:m,style:f,tagName:g="div"}=t,v=S(t,["children","className","collapsedSize","collapsible","defaultSize","forwardedRef","id","maxSize","minSize","onCollapse","onExpand","onResize","order","style","tagName"]);const y=A.useContext(oq);if(null===y)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:b,expandPanel:x,getPanelSize:C,getPanelStyle:E,groupId:k,isPanelCollapsed:I,reevaluatePanelConstraints:T,registerPanel:j,resizePanel:N,unregisterPanel:P}=y,M=yq(l),O=A.useRef({callbacks:{onCollapse:d,onExpand:h,onResize:p},constraints:{collapsedSize:a,collapsible:o,defaultSize:s,maxSize:c,minSize:u},id:M,idIsFromProps:void 0!==l,order:m});A.useRef({didLogMissingDefaultSizeWarning:!1}),mq(()=>{const{callbacks:e,constraints:t}=O.current,n=w({},t);O.current.id=M,O.current.idIsFromProps=void 0!==l,O.current.order=m,e.onCollapse=d,e.onExpand=h,e.onResize=p,t.collapsedSize=a,t.collapsible=o,t.defaultSize=s,t.maxSize=c,t.minSize=u,n.collapsedSize===t.collapsedSize&&n.collapsible===t.collapsible&&n.maxSize===t.maxSize&&n.minSize===t.minSize||T(O.current,n)}),mq(()=>{const e=O.current;return j(e),()=>{P(e)}},[m,M,j,P]),A.useImperativeHandle(r,()=>({collapse:()=>{b(O.current)},expand:e=>{x(O.current,e)},getId:()=>M,getSize:()=>C(O.current),isCollapsed:()=>I(O.current),isExpanded:()=>!I(O.current),resize:e=>{N(O.current,e)}}),[b,x,C,I,M,N]);const R=E(O.current,s);return A.createElement(g,_(w({},v),{children:n,className:i,id:M,style:w(w({},R),f),[lq]:k,[cq]:"",[uq]:o||void 0,[dq]:M,[hq]:parseFloat(""+R.flexGrow).toFixed(1)}))}const xq=A.forwardRef((e,t)=>A.createElement(bq,_(w({},e),{forwardedRef:t})));function wq(e){return"keydown"===e.type}function _q(e){return e.type.startsWith("pointer")}function Sq(e){return e.type.startsWith("mouse")}bq.displayName="Panel",xq.displayName="forwardRef(Panel)";!function(){if("function"==typeof matchMedia)matchMedia("(pointer:coarse)").matches}();let Cq=new Map;function Eq(e,t){Cq.set(e,t)}function kq(e,t){if(!e)throw Error(t)}function Iq(e,t,n=10){return e.toFixed(n)===t.toFixed(n)?0:e>t?1:-1}function Tq(e,t,n=10){return 0===Iq(e,t,n)}function jq(e,t,n){return 0===Iq(e,t,n)}function Nq({panelConstraints:e,panelIndex:t,size:n}){const i=e[t];kq(null!=i,`Panel constraints not found for index ${t}`);let{collapsedSize:a=0,collapsible:o,maxSize:s=100,minSize:r=0}=i;if(Iq(n,r)<0)if(o){n=Iq(n,(a+r)/2)<0?a:r}else n=r;return n=Math.min(s,n),n=parseFloat(n.toFixed(10))}function Pq({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:i,prevLayout:a,trigger:o}){if(jq(e,0))return t;const s=[...t],[r,l]=i;kq(null!=r,"Invalid first pivot index"),kq(null!=l,"Invalid second pivot index");let c=0;if("keyboard"===o){{const i=e<0?l:r,a=n[i];kq(a,`Panel constraints not found for index ${i}`);const{collapsedSize:o=0,collapsible:s,minSize:c=0}=a;if(s){const n=t[i];if(kq(null!=n,`Previous layout not found for panel index ${i}`),jq(n,o)){const t=c-n;Iq(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}{const i=e<0?r:l,a=n[i];kq(a,`No panel constraints found for index ${i}`);const{collapsedSize:o=0,collapsible:s,minSize:c=0}=a;if(s){const n=t[i];if(kq(null!=n,`Previous layout not found for panel index ${i}`),jq(n,c)){const t=n-o;Iq(t,Math.abs(e))>0&&(e=e<0?0-t:t)}}}}{const i=e<0?1:-1;let a=e<0?l:r,o=0;for(;;){const e=t[a];kq(null!=e,`Previous layout not found for panel index ${a}`);if(o+=Nq({panelConstraints:n,panelIndex:a,size:100})-e,a+=i,a<0||a>=n.length)break}const s=Math.min(Math.abs(e),Math.abs(o));e=e<0?0-s:s}{let i=e<0?r:l;for(;i>=0&&i<n.length;){const a=Math.abs(e)-Math.abs(c),o=t[i];kq(null!=o,`Previous layout not found for panel index ${i}`);const r=Nq({panelConstraints:n,panelIndex:i,size:o-a});if(!jq(o,r)&&(c+=o-r,s[i]=r,c.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?i--:i++}}if(function(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!jq(e[i],t[i],n))return!1;return!0}(a,s))return a;{const i=e<0?l:r,a=t[i];kq(null!=a,`Previous layout not found for panel index ${i}`);const o=a+c,u=Nq({panelConstraints:n,panelIndex:i,size:o});if(s[i]=u,!jq(u,o)){let t=o-u;let i=e<0?l:r;for(;i>=0&&i<n.length;){const a=s[i];kq(null!=a,`Previous layout not found for panel index ${i}`);const o=Nq({panelConstraints:n,panelIndex:i,size:a+t});if(jq(a,o)||(t-=o-a,s[i]=o),jq(t,0))break;e>0?i--:i++}}}return jq(s.reduce((e,t)=>t+e,0),100)?s:a}function Mq({layout:e,panelsArray:t,pivotIndices:n}){let i=0,a=100,o=0,s=0;const r=n[0];kq(null!=r,"No pivot index found"),t.forEach((e,t)=>{const{constraints:n}=e,{maxSize:l=100,minSize:c=0}=n;t===r?(i=c,a=l):(o+=c,s+=l)});return{valueMax:Math.min(a,100-o),valueMin:Math.max(i,100-s),valueNow:e[r]}}function Aq(e,t=document){return Array.from(t.querySelectorAll(`[${pq}][data-panel-group-id="${e}"]`))}function Oq(e,t,n){const i=function(e,t,n=document){const i=Aq(e,n).findIndex(e=>e.getAttribute(pq)===t);return null!=i?i:null}(e,t,n);return null!=i?[i,i+1]:[-1,-1]}function Rq(e,t=document){if(((n=t)instanceof HTMLElement||"object"==typeof n&&null!==n&&"tagName"in n&&"getAttribute"in n)&&t.dataset.panelGroupId==e)return t;var n;const i=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return i||null}function Dq(e,t=document){const n=t.querySelector(`[${pq}="${e}"]`);return n||null}function Lq({committedValuesRef:e,eagerValuesRef:t,groupId:n,layout:i,panelDataArray:a,panelGroupElement:o,setLayout:s}){A.useRef({didWarnAboutMissingResizeHandle:!1}),mq(()=>{if(!o)return;const e=Aq(n,o);for(let t=0;t<a.length-1;t++){const{valueMax:n,valueMin:o,valueNow:s}=Mq({layout:i,panelsArray:a,pivotIndices:[t,t+1]}),r=e[t];if(null==r);else{const e=a[t];kq(e,`No panel data found for index "${t}"`),r.setAttribute("aria-controls",e.id),r.setAttribute("aria-valuemax",""+Math.round(n)),r.setAttribute("aria-valuemin",""+Math.round(o)),r.setAttribute("aria-valuenow",null!=s?""+Math.round(s):"")}}return()=>{e.forEach((e,t)=>{e.removeAttribute("aria-controls"),e.removeAttribute("aria-valuemax"),e.removeAttribute("aria-valuemin"),e.removeAttribute("aria-valuenow")})}},[n,i,a,o]),A.useEffect(()=>{if(!o)return;const e=t.current;kq(e,"Eager values not found");const{panelDataArray:a}=e;kq(null!=Rq(n,o),`No group found for id "${n}"`);const r=Aq(n,o);kq(r,`No resize handles found for group id "${n}"`);const l=r.map(e=>{const t=e.getAttribute(pq);kq(t,"Resize handle element has no handle id attribute");const[r,l]=function(e,t,n,i=document){var a,o,s,r;const l=Dq(t,i),c=Aq(e,i),u=l?c.indexOf(l):-1;return[null!==(a=null===(o=n[u])||void 0===o?void 0:o.id)&&void 0!==a?a:null,null!==(s=null===(r=n[u+1])||void 0===r?void 0:r.id)&&void 0!==s?s:null]}(n,t,a,o);if(null==r||null==l)return()=>{};const c=e=>{if(!e.defaultPrevented)switch(e.key){case"Enter":{e.preventDefault();const l=a.findIndex(e=>e.id===r);if(l>=0){const e=a[l];kq(e,`No panel data found for index ${l}`);const r=i[l],{collapsedSize:c=0,collapsible:u,minSize:d=0}=e.constraints;if(null!=r&&u){const e=Pq({delta:jq(r,c)?d-c:c-r,initialLayout:i,panelConstraints:a.map(e=>e.constraints),pivotIndices:Oq(n,t,o),prevLayout:i,trigger:"keyboard"});i!==e&&s(e)}}break}}};return e.addEventListener("keydown",c),()=>{e.removeEventListener("keydown",c)}});return()=>{l.forEach(e=>e())}},[o,e,t,n,i,a,s])}function Fq(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function zq(e,t){const n="horizontal"===e,{x:i,y:a}=function(e){if(_q(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(Sq(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}(t);return n?i:a}function Uq(e,t,n,i,a,o){if(wq(e)){const t="horizontal"===n;let i=0;i=e.shiftKey?100:null!=a?a:10;let o=0;switch(e.key){case"ArrowDown":o=t?0:i;break;case"ArrowLeft":o=t?-i:0;break;case"ArrowRight":o=t?i:0;break;case"ArrowUp":o=t?0:-i;break;case"End":o=100;break;case"Home":o=-100}return o}return null==i?0:function(e,t,n,i,a){const o="horizontal"===n,s=Dq(t,a);kq(s,`No resize handle element found for id "${t}"`);const r=s.getAttribute(lq);kq(r,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=i;const c=zq(n,e),u=Rq(r,a);kq(u,`No group element found for id "${r}"`);const d=u.getBoundingClientRect();return(c-l)/(o?d.width:d.height)*100}(e,t,n,i,o)}function Hq(e,t,n){t.forEach((t,i)=>{const a=e[i];kq(a,`Panel data not found for index ${i}`);const{callbacks:o,constraints:s,id:r}=a,{collapsedSize:l=0,collapsible:c}=s,u=n[r];if(null==u||t!==u){n[r]=t;const{onCollapse:e,onExpand:i,onResize:a}=o;a&&a(t,u),c&&(e||i)&&(!i||null!=u&&!Tq(u,l)||Tq(t,l)||i(),!e||null!=u&&Tq(u,l)||!Tq(t,l)||e())}})}function Bq(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function $q(e){try{if("undefined"==typeof localStorage)throw new Error("localStorage not supported in this environment");e.getItem=e=>localStorage.getItem(e),e.setItem=(e,t)=>{localStorage.setItem(e,t)}}catch(t){e.getItem=()=>null,e.setItem=()=>{}}}function qq(e){return`react-resizable-panels:${e}`}function Gq(e){return e.map(e=>{const{constraints:t,id:n,idIsFromProps:i,order:a}=e;return i?n:a?`${a}:${JSON.stringify(t)}`:JSON.stringify(t)}).sort((e,t)=>e.localeCompare(t)).join(",")}function Vq(e,t){try{const n=qq(e),i=t.getItem(n);if(i){const e=JSON.parse(i);if("object"==typeof e&&null!=e)return e}}catch(n){}return null}function Wq(e,t,n,i,a){var o;const s=qq(e),r=Gq(t),l=null!==(o=Vq(e,a))&&void 0!==o?o:{};l[r]={expandToSizes:Object.fromEntries(n.entries()),layout:i};try{a.setItem(s,JSON.stringify(l))}catch(c){}}function Qq({layout:e,panelConstraints:t}){const n=[...e],i=n.reduce((e,t)=>e+t,0);if(n.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${n.map(e=>`${e}%`).join(", ")}`);if(!jq(i,100)&&n.length>0)for(let o=0;o<t.length;o++){const e=n[o];kq(null!=e,`No layout data found for index ${o}`);const t=100/i*e;n[o]=t}let a=0;for(let o=0;o<t.length;o++){const e=n[o];kq(null!=e,`No layout data found for index ${o}`);const i=Nq({panelConstraints:t,panelIndex:o,size:e});e!=i&&(a+=e-i,n[o]=i)}if(!jq(a,0))for(let o=0;o<t.length;o++){const e=n[o];kq(null!=e,`No layout data found for index ${o}`);const i=Nq({panelConstraints:t,panelIndex:o,size:e+a});if(e!==i&&(a-=i-e,n[o]=i,jq(a,0)))break}return n}const Kq={getItem:e=>($q(Kq),Kq.getItem(e)),setItem:(e,t)=>{$q(Kq),Kq.setItem(e,t)}},Yq={};function Xq(e){var t=e,{autoSaveId:n=null,children:i,className:a="",direction:o,forwardedRef:s,id:r=null,onLayout:l=null,keyboardResizeBy:c=null,storage:u=Kq,style:d,tagName:h="div"}=t,p=S(t,["autoSaveId","children","className","direction","forwardedRef","id","onLayout","keyboardResizeBy","storage","style","tagName"]);const m=yq(r),f=A.useRef(null),[g,v]=A.useState(null),[y,b]=A.useState([]),x=function(){const[e,t]=A.useState(0);return A.useCallback(()=>t(e=>e+1),[])}(),C=A.useRef({}),E=A.useRef(new Map),k=A.useRef(0),I=A.useRef({autoSaveId:n,direction:o,dragState:g,id:m,keyboardResizeBy:c,onLayout:l,storage:u}),T=A.useRef({layout:y,panelDataArray:[],panelDataArrayChanged:!1});A.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),A.useImperativeHandle(s,()=>({getId:()=>I.current.id,getLayout:()=>{const{layout:e}=T.current;return e},setLayout:e=>{const{onLayout:t}=I.current,{layout:n,panelDataArray:i}=T.current,a=Qq({layout:e,panelConstraints:i.map(e=>e.constraints)});Fq(n,a)||(b(a),T.current.layout=a,t&&t(a),Hq(i,a,C.current))}}),[]),mq(()=>{I.current.autoSaveId=n,I.current.direction=o,I.current.dragState=g,I.current.id=m,I.current.onLayout=l,I.current.storage=u}),Lq({committedValuesRef:I,eagerValuesRef:T,groupId:m,layout:y,panelDataArray:T.current.panelDataArray,setLayout:b,panelGroupElement:f.current}),A.useEffect(()=>{const{panelDataArray:e}=T.current;if(n){if(0===y.length||y.length!==e.length)return;let t=Yq[n];null==t&&(t=function(e,t=10){let n=null;return(...i)=>{null!==n&&clearTimeout(n),n=setTimeout(()=>{e(...i)},t)}}(Wq,100),Yq[n]=t);const i=[...e],a=new Map(E.current);t(n,i,a,y,u)}},[n,y,u]),A.useEffect(()=>{});const j=A.useCallback(e=>{const{onLayout:t}=I.current,{layout:n,panelDataArray:i}=T.current;if(e.constraints.collapsible){const a=i.map(e=>e.constraints),{collapsedSize:o=0,panelSize:s,pivotIndices:r}=eG(i,e,n);if(kq(null!=s,`Panel size not found for panel "${e.id}"`),!Tq(s,o)){E.current.set(e.id,s);const l=Pq({delta:Zq(i,e)===i.length-1?s-o:o-s,initialLayout:n,panelConstraints:a,pivotIndices:r,prevLayout:n,trigger:"imperative-api"});Bq(n,l)||(b(l),T.current.layout=l,t&&t(l),Hq(i,l,C.current))}}},[]),N=A.useCallback((e,t)=>{const{onLayout:n}=I.current,{layout:i,panelDataArray:a}=T.current;if(e.constraints.collapsible){const o=a.map(e=>e.constraints),{collapsedSize:s=0,panelSize:r=0,minSize:l=0,pivotIndices:c}=eG(a,e,i),u=null!=t?t:l;if(Tq(r,s)){const t=E.current.get(e.id),s=null!=t&&t>=u?t:u,l=Pq({delta:Zq(a,e)===a.length-1?r-s:s-r,initialLayout:i,panelConstraints:o,pivotIndices:c,prevLayout:i,trigger:"imperative-api"});Bq(i,l)||(b(l),T.current.layout=l,n&&n(l),Hq(a,l,C.current))}}},[]),P=A.useCallback(e=>{const{layout:t,panelDataArray:n}=T.current,{panelSize:i}=eG(n,e,t);return kq(null!=i,`Panel size not found for panel "${e.id}"`),i},[]),M=A.useCallback((e,t)=>{const{panelDataArray:n}=T.current,i=Zq(n,e);return function({defaultSize:e,dragState:t,layout:n,panelData:i,panelIndex:a,precision:o=3}){const s=n[a];let r;return r=null==s?null!=e?e.toFixed(o):"1":1===i.length?"1":s.toFixed(o),{flexBasis:0,flexGrow:r,flexShrink:1,overflow:"hidden",pointerEvents:null!==t?"none":void 0}}({defaultSize:t,dragState:g,layout:y,panelData:n,panelIndex:i})},[g,y]),O=A.useCallback(e=>{const{layout:t,panelDataArray:n}=T.current,{collapsedSize:i=0,collapsible:a,panelSize:o}=eG(n,e,t);return kq(null!=o,`Panel size not found for panel "${e.id}"`),!0===a&&Tq(o,i)},[]),R=A.useCallback(e=>{const{layout:t,panelDataArray:n}=T.current,{collapsedSize:i=0,collapsible:a,panelSize:o}=eG(n,e,t);return kq(null!=o,`Panel size not found for panel "${e.id}"`),!a||Iq(o,i)>0},[]),D=A.useCallback(e=>{const{panelDataArray:t}=T.current;t.push(e),t.sort((e,t)=>{const n=e.order,i=t.order;return null==n&&null==i?0:null==n?-1:null==i?1:n-i}),T.current.panelDataArrayChanged=!0,x()},[x]);mq(()=>{if(T.current.panelDataArrayChanged){T.current.panelDataArrayChanged=!1;const{autoSaveId:e,onLayout:t,storage:n}=I.current,{layout:i,panelDataArray:a}=T.current;let o=null;if(e){const t=function(e,t,n){var i,a;return null!==(a=(null!==(i=Vq(e,n))&&void 0!==i?i:{})[Gq(t)])&&void 0!==a?a:null}(e,a,n);t&&(E.current=new Map(Object.entries(t.expandToSizes)),o=t.layout)}null==o&&(o=function({panelDataArray:e}){const t=Array(e.length),n=e.map(e=>e.constraints);let i=0,a=100;for(let o=0;o<e.length;o++){const e=n[o];kq(e,`Panel constraints not found for index ${o}`);const{defaultSize:s}=e;null!=s&&(i++,t[o]=s,a-=s)}for(let o=0;o<e.length;o++){const s=n[o];kq(s,`Panel constraints not found for index ${o}`);const{defaultSize:r}=s;if(null!=r)continue;const l=a/(e.length-i);i++,t[o]=l,a-=l}return t}({panelDataArray:a}));const s=Qq({layout:o,panelConstraints:a.map(e=>e.constraints)});Fq(i,s)||(b(s),T.current.layout=s,t&&t(s),Hq(a,s,C.current))}}),mq(()=>{const e=T.current;return()=>{e.layout=[]}},[]);const L=A.useCallback(e=>{let t=!1;const n=f.current;if(n){"rtl"===window.getComputedStyle(n,null).getPropertyValue("direction")&&(t=!0)}return function(n){n.preventDefault();const i=f.current;if(!i)return()=>null;const{direction:a,dragState:o,id:s,keyboardResizeBy:r,onLayout:l}=I.current,{layout:c,panelDataArray:u}=T.current,{initialLayout:d}=null!=o?o:{},h=Oq(s,e,i);let p=Uq(n,e,a,o,r,i);const m="horizontal"===a;m&&t&&(p=-p);const g=Pq({delta:p,initialLayout:null!=d?d:c,panelConstraints:u.map(e=>e.constraints),pivotIndices:h,prevLayout:c,trigger:wq(n)?"keyboard":"mouse-or-touch"}),v=!Bq(c,g);(_q(n)||Sq(n))&&k.current!=p&&(k.current=p,Eq(e,v||0===p?0:m?p<0?1:2:p<0?4:8)),v&&(b(g),T.current.layout=g,l&&l(g),Hq(u,g,C.current))}},[]),F=A.useCallback((e,t)=>{const{onLayout:n}=I.current,{layout:i,panelDataArray:a}=T.current,o=a.map(e=>e.constraints),{panelSize:s,pivotIndices:r}=eG(a,e,i);kq(null!=s,`Panel size not found for panel "${e.id}"`);const l=Pq({delta:Zq(a,e)===a.length-1?s-t:t-s,initialLayout:i,panelConstraints:o,pivotIndices:r,prevLayout:i,trigger:"imperative-api"});Bq(i,l)||(b(l),T.current.layout=l,n&&n(l),Hq(a,l,C.current))},[]),z=A.useCallback((e,t)=>{const{layout:n,panelDataArray:i}=T.current,{collapsedSize:a=0,collapsible:o}=t,{collapsedSize:s=0,collapsible:r,maxSize:l=100,minSize:c=0}=e.constraints,{panelSize:u}=eG(i,e,n);null!=u&&(o&&r&&Tq(u,a)?Tq(a,s)||F(e,s):u<c?F(e,c):u>l&&F(e,l))},[F]),U=A.useCallback((e,t)=>{const{direction:n}=I.current,{layout:i}=T.current;if(!f.current)return;const a=Dq(e,f.current);kq(a,`Drag handle element not found for id "${e}"`);const o=zq(n,t);v({dragHandleId:e,dragHandleRect:a.getBoundingClientRect(),initialCursorPosition:o,initialLayout:i})},[]),H=A.useCallback(()=>{v(null)},[]),B=A.useCallback(e=>{const{panelDataArray:t}=T.current,n=Zq(t,e);n>=0&&(t.splice(n,1),delete C.current[e.id],T.current.panelDataArrayChanged=!0,x())},[x]),$=A.useMemo(()=>({collapsePanel:j,direction:o,dragState:g,expandPanel:N,getPanelSize:P,getPanelStyle:M,groupId:m,isPanelCollapsed:O,isPanelExpanded:R,reevaluatePanelConstraints:z,registerPanel:D,registerResizeHandle:L,resizePanel:F,startDragging:U,stopDragging:H,unregisterPanel:B,panelGroupElement:f.current}),[j,g,o,N,P,M,m,O,R,z,D,L,F,U,H,B]),q={display:"flex",flexDirection:"horizontal"===o?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return A.createElement(oq.Provider,{value:$},A.createElement(h,_(w({},p),{children:i,className:a,id:r,ref:f,style:w(w({},q),d),[sq]:"",[rq]:o,[lq]:m})))}const Jq=A.forwardRef((e,t)=>A.createElement(Xq,_(w({},e),{forwardedRef:t})));function Zq(e,t){return e.findIndex(e=>e===t||e.id===t.id)}function eG(e,t,n){const i=Zq(e,t),a=i===e.length-1?[i-1,i]:[i,i+1],o=n[i];return _(w({},t.constraints),{panelSize:o,pivotIndices:a})}Xq.displayName="PanelGroup",Jq.displayName="forwardRef(PanelGroup)";const tG=()=>{const e=Ex(e=>e.mobile),t=zE(e=>e.theme);return e?an.jsx("img",{crossOrigin:"anonymous",src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/share/${"dark"===t?"app-dark":"app"}.png`,style:{width:"100%"},alt:"logo"}):an.jsx("img",{crossOrigin:"anonymous",src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/share/${"dark"===t?"web-dark":"web"}.png`,style:{width:320,height:460},alt:"logo"})},nG=({type:e="",className:t=""})=>{const n=zE(e=>e.theme);return an.jsx("div",{className:`share-qr-code ${t}`,children:"ios"===e?an.jsx("img",{crossOrigin:"anonymous",src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/share/${"dark"===n?"ios-dark":"ios"}.png`,alt:"logo"}):an.jsx("img",{crossOrigin:"anonymous",src:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/share/${"dark"===n?"android-dark":"android"}.png`,alt:"logo"})})},iG=({show:e,onClose:t})=>{const n=$();return an.jsx(mt,{visible:e,className:"get-app-modal",header:!1,footer:!1,children:an.jsxs("div",{className:"get-app-modal-main",children:[an.jsx("div",{className:"get-app-modal-close",style:{backgroundColor:TE("rgba(0, 0, 0, 0.5)","rgba(255, 255, 255, 0.2)")},onClick:t,children:an.jsx(pt,{type:"icon-line-x-01",className:"get-app-modal-close-icon"})}),an.jsxs("div",{className:"get-app-modal-main-content",children:[an.jsxs("div",{className:"get-app-modal-main-content-box",style:{color:TE("#2C2C36","#FAFAFC")},children:[an.jsxs("div",{className:"get-app-modal-header",children:[an.jsx("div",{className:"header-title",children:n.t("Download App")}),an.jsx("div",{className:"header-content",children:n.t("Designed for mobile devices, offering better experience and more features")})]}),an.jsxs("div",{className:"get-app-modal-footer",children:[an.jsxs("div",{className:"footer-top",children:[an.jsx(nG,{type:"ios",className:"footer-top-code"}),an.jsxs("div",{className:"footer-top-content",onClick:()=>{window.open("https://apps.apple.com/app/id6743778442")},children:[n.t("Download for iOS"),an.jsx(pt,{type:"icon-line-arrow-down-right-sm",className:"footer-top-content-icon"})]})]}),an.jsxs("div",{className:"footer-top",children:[an.jsx(nG,{type:"android",className:"footer-top-code"}),an.jsxs("div",{className:"footer-top-content",onClick:()=>{window.open("https://play.google.com/store/apps/details?id=ai.qwenlm.chat.android")},children:[n.t("Download for Android"),an.jsx(pt,{type:"icon-line-arrow-down-right-sm",className:"footer-top-content-icon"})]})]})]})]}),an.jsx("div",{className:"get-app-modal-main-content-view",children:an.jsx(tG,{})})]})]})})},aG="setting",oG="email",sG="subscription",rG="archive",lG="download",cG="logout",uG=({icon:e,text:t,warningType:n,type:i})=>an.jsxs(X,{className:"user-menu-dropdown-item",gap:8,children:[e&&an.jsx(pt,{className:"user-menu-dropdown-item-icon "+("email"===i?"setting-panel-email-icon":""),type:e}),an.jsx("div",{className:"user-menu-dropdown-item-text",children:t}),n&&an.jsx(pt,{className:`user-menu-dropdown-item-icon-${n}`,type:"icon-line-alert-circle"})]}),dG=({children:e,placement:t})=>{const{i18n:n}=$(),i=zE(e=>e.setUserMenuDropdownOpen),a=Ty(),o=HE(e=>e.setUser),s=HE(e=>e.user),r=zE(e=>e.setShowSidebar),l=GE(e=>e.subscriptionPlus),c=GE(e=>e.setShowSubscriptionDetail),{isShowGetTheApp:u,setShowArchivedChats:d,setTaskRunning:h}=Sx(_j(e=>({isShowGetTheApp:e.isShowGetTheApp,setShowArchivedChats:e.setShowArchivedChats,setTaskRunning:e.setTaskRunning}))),p=Ex(e=>{var t,n;return null==(n=null==(t=e.config)?void 0:t.features)?void 0:n.enable_app_download}),m=Ex(e=>e.mobile),f=Ex(e=>{var t,n,i,a;return(null==(n=null==(t=null==e?void 0:e.config)?void 0:t.features)?void 0:n.enable_payment)&&(null==(a=null==(i=null==e?void 0:e.config)?void 0:i.features)?void 0:a.enable_payment_and_quota)}),[g,v]=A.useState(!1),y=GE(e=>e.paymentExpiredNotification),b=GE(e=>e.paymentIssueNotification),x=MT(e=>e.setEntrySettingsRouter),w=A.useMemo(()=>{const e=p&&!m&&u;return[{label:an.jsx(uG,{icon:"icon-line-user-profile-circle",type:"email",text:an.jsx("span",{className:"setting-panel-email",children:null==s?void 0:s.email}),warningType:y?"warning":b?"caution":void 0}),key:oG,disabled:!0,className:"setting-panel-email-menu"},{label:an.jsx(uG,{icon:"icon-line-settings",text:n.t("Settings"),warningType:y?"warning":b?"caution":void 0}),key:aG},f&&!l?{label:an.jsx(uG,{icon:"icon-line-star-02",text:n.t("Upgrade Plan")}),key:sG}:null,m?null:{label:an.jsx(uG,{icon:"icon-line-archive-02",text:n.t("Archived Chats")}),key:rG},e?{type:"divider"}:null,e?{label:an.jsx(uG,{icon:"icon-line-app-download-01",text:n.t("Download the App")}),key:lG}:null,{type:"divider"},{label:an.jsx(uG,{icon:"icon-line-logout-03",text:n.t("Log out")}),key:cG}]},[f,p,n.language,m,u,y,b,l]);return an.jsxs(an.Fragment,{children:[an.jsx(xt,{placement:t,overlayClassName:"user-menu-dropdown",menu:{items:w,onClick:e=>j(void 0,[e],function*({key:e}){switch(e){case aG:location.pathname.includes("/p/")&&x(location.pathname),a("/settings/general"),m&&r(!1);break;case sG:return void c(!0);case rG:d(!0),m&&r(!1);break;case lG:v(!0);break;case cG:h(!1),yield k_(),LT("token"),LT("settings"),zx()&&kT.adapter.clearCookie(Xf.SETAPP),o(),a("/",{replace:!0})}})},onOpenChange:e=>{null==i||i(e)},children:e}),an.jsx(iG,{show:g,onClose:()=>{v(!1)}})]})},hG=A.memo(({user:e,menu:t=!0})=>{const n=()=>{var t;return(null==e?void 0:e.profile_image_url)?an.jsx("img",{src:e.profile_image_url,alt:e.name||"User"}):an.jsx("span",{className:"user-avatar-placeholder",children:(null==(t=null==e?void 0:e.name)?void 0:t.charAt(0))||"U"})};return e?t?an.jsx(dG,{placement:"bottomRight",children:an.jsx("div",{className:"user-avatar",children:n()})}):an.jsx("div",{className:"user-avatar",children:n()}):null}),pG="index-module__audio-card___lUXFC",mG="index-module__audio-card-content___IEXg-",fG="index-module__audio-card-content-left___ictRc",gG="index-module__qwen-left-icon___LKDGi",vG="index-module__qwen-left-info___8Q9fA",yG="index-module__qwen-left-info-name___gbVSI",bG="index-module__qwen-left-info-name-text___eX1Ys",xG="index-module__qwen-left-info-name-ext___H5xGW",wG="index-module__qwen-left-info-time___eotBv",_G="index-module__audio-card-content-right___gmh3w",SG="index-module__audio-card-content-right-disabled___MlkD8",CG=({url:e,id:t,name:n})=>{const[i,a]=A.useState(""),[o,s]=A.useState(""),[r,l]=A.useState(!1),[c,u]=A.useState(!0),[d,h]=A.useState({currTime:"00:00",duration:"00:00"}),p=A.useRef(null),m=A.useCallback(e=>{h(e)},[]);return A.useEffect(()=>{const e=(null==n?void 0:n.lastIndexOf("."))||-1;a(-1===e?n:n.slice(0,n.lastIndexOf("."))),s(-1===e?"":n.slice(e+1))},[n]),e?an.jsxs("div",{className:pG,children:[an.jsxs("div",{className:mG,children:[an.jsxs("div",{className:fG,children:[an.jsx(X,{className:gG,justify:"center",align:"center",children:an.jsx(pt,{type:"iconaudio"})}),an.jsxs(X,{className:vG,vertical:!0,justify:"space-between",flex:1,children:[an.jsxs(X,{className:yG,align:"center",children:[an.jsx("div",{className:bG,children:i}),an.jsx("div",{className:xG,children:o?`.${o}`:""})]}),an.jsxs(X,{className:wG,align:"center",gap:4,children:[an.jsx("span",{children:d.currTime}),an.jsx("span",{children:"/"}),an.jsx("span",{children:d.duration})]})]})]}),an.jsx("div",{className:Y(_G,{[SG]:!r}),onClick:()=>j(void 0,null,function*(){var e;null==(e=p.current)||e.toggle()}),children:an.jsx(pt,{type:c?"icon-pause":"icon-play"})})]}),an.jsx(Et,{ref:p,url:e,id:t,showHandler:!1,onLoaded:l,onPause:u,onPlay:u,getPlayingDuration:m,getFileNewUrlWhenLoadError:e=>j(void 0,null,function*(){var t;const n=yield fS({fileUrl:e});if(n.success)return null==(t=n.data)?void 0:t.fileUrl})})]}):null},EG={publishToCommunityModal:"index-h5-module__publish-to-community-modal___i-q--",content:"index-h5-module__content___ahaeV",messageContent:"index-h5-module__message-content___Amkbp",messageContentGoCheck:"index-h5-module__message-content-go-check___KO8rp",messageContentGoCheckText:"index-h5-module__message-content-go-check-text___Bx9NM",messageContentGoCheckIcon:"index-h5-module__message-content-go-check-icon___K7EoM"},kG={publishToCommunityModal:"index-module__publish-to-community-modal___KVynA",content:"index-module__content___rD7ew",publishModalFooter:"index-module__publish-modal-footer___bBfJ7",publishModalButton:"index-module__publish-modal-button___zScqE",qwenModalFooter:"index-module__qwen-modal-footer___07Xz1",messageContentGoCheck:"index-module__message-content-go-check___S94Vu",messageContentGoCheckText:"index-module__message-content-go-check-text___bX-F0",messageContentGoCheckIcon:"index-module__message-content-go-check-icon___YaQNP"},IG=({open:e,onCancel:t,messageId:n})=>{const i=$(),a=Ex(e=>e.mobile),[o,s]=A.useState(!1),r=A.useMemo(()=>a?EG:kG,[a]),l=()=>{window.open(`${location.origin}/community/collections`,"_self")},c=()=>an.jsxs(X,{align:"center",gap:a?20:158,className:r.messageContent,children:[an.jsx("div",{children:i.t("Published successfully")}),an.jsxs(X,{align:"center",onClick:l,className:r.messageContentGoCheck,children:[an.jsx("div",{className:r.messageContentGoCheckText,children:i.t("Go check")}),an.jsx(pt,{className:r.messageContentGoCheckIcon,type:"icon-line-chevron-right"})]})]});return an.jsx(mt,{title:i.t("Publish Work"),headerBorderNone:!0,visible:e,className:r.publishToCommunityModal,closable:!a,zIndex:1e7,onCancel:t,size:"small",type:"confirm",actions:[{text:i.t("Cancel"),type:"tertiary",disabled:o,onClick:e=>{e.stopPropagation(),t()},rounded:"circle"},{text:i.t("Confirm"),disabled:o,type:"brandprimary",onClick:e=>{e.stopPropagation(),j(void 0,null,function*(){try{s(!0),(yield YC(n,c)).success&&t()}finally{t(),s(!1)}})},rounded:"circle"}],children:an.jsx("span",{className:r.content,children:i.t("Are you sure you want to publish your work?")})})},TG=({mediaType:e,messageId:t,preview:n})=>{const{i18n:i}=$(),a=Ex(e=>e.mobile),o=vx(e=>e.chatId),s=vx(e=>e.currentInputFeature),r=vx(e=>{var t;return null==(t=e.branchInfo)?void 0:t.isTemp}),l=Sx(e=>e.setWelcomeModalShow),c=TT(e=>e.setFiles),[u,d]=A.useState(!1),[h,p]=A.useState(!1),m=A.useCallback((u,m)=>{const{image:f,video:g}=m,v=("image"===e?null==f?void 0:f.url:null==g?void 0:g.url)||"";let y=(null==n?void 0:n.actions)||["download","share"];return r&&(y=[]),an.jsx("div",{className:"qwen-image-preview-operations-wrapper "+(!a&&(null==n?void 0:n.tip)?"qwen-image-preview-operations-wrapper-tip":""),children:an.jsxs("div",{className:"qwen-media-preview-toolbar",children:[!a&&(null==n?void 0:n.tip)&&an.jsxs("div",{className:"qwen-media-preview-toolbar-info",children:[an.jsx(pt,{type:"icon-line-alert-circle"}),null==n?void 0:n.tip]}),an.jsx("div",{className:"qwen-media-preview-toolbar-btn",children:y.map(e=>{switch(e){case"download":return an.jsxs("div",{className:"qwen-media-preview-toolbar-item",onClick:e=>j(void 0,null,function*(){e.stopPropagation(),dS("clkdownloadBtn",{params:{et:"CLK",c5:"preview",c6:v},paramsExtend:{chat_id:o,msg_id:t||""}}),v.includes("img.alicdn.com")?yield gC(v):yield yC({role:"assistant",url:v})}),children:[an.jsx(pt,{type:"icon-line-download-02"}),a?null:an.jsx("div",{children:i.t("Download")})]},e);case"share":return an.jsxs("div",{className:"qwen-media-preview-toolbar-item",onClick:e=>j(void 0,null,function*(){e.stopPropagation(),dS("clkShareBtn",{params:{et:"CLK",c5:"preview",c6:v},paramsExtend:{chat_id:o,msg_id:t||""}});const n=yield mC("assistant",v);(yield WS(n))&&ht.open({type:"success",content:i.t("Copying to clipboard was successful!")})}),children:[an.jsx(pt,{type:"icon-line-share-01"}),a?null:an.jsx("div",{children:i.t("Share")})]},e);case"publish":return an.jsxs(an.Fragment,{children:[an.jsxs("div",{className:"qwen-media-preview-toolbar-item",onClick:e=>{e.stopPropagation(),$x()?kT.adapter.invoke({method:"openPublishingRightsWindow",params:{from:"chat",chatId:o,msgId:t||""}}):p(!0)},children:[an.jsx(pt,{type:"icon-line-Publish"}),a?null:an.jsx("div",{children:i.t("Publish")})]},e),an.jsx(IG,{open:h,onCancel:()=>{p(!1)},messageId:t})]});case"edit":return an.jsxs("div",{className:"qwen-media-preview-toolbar-item qwen-media-preview-toolbar-item-pd-8-12",onClick:()=>j(void 0,null,function*(){const e=[{type:"image",name:"example.png",file_type:"image/png",showType:"image",file_class:"vision",status:"uploaded",url:v}];s===ng.ImageEdit?c(e):s===ng.ImageGeneration&&(yield kT.makeVideoOrImageByImageGen({chatType:ng.ImageEdit,subChatType:ng.ImageEdit,files:e})),d(!1)}),children:[an.jsx(pt,{type:"icon-line-edit-contained"}),an.jsx("div",{className:"qwen-media-preview-toolbar-item-text",children:i.t("Edit")})]},e);case"video":return an.jsxs("div",{className:"qwen-media-preview-toolbar-item qwen-media-preview-toolbar-item-pd-8-12",onClick:()=>j(void 0,null,function*(){UT()?$x()?yield kT.adapter.invoke({method:"showAlert",params:{type:"login"}}):l(!0):yield kT.makeVideoOrImageByImageGen({chatType:ng.VideoGeneration,files:[{type:"image",name:"example.png",file_type:"image/png",showType:"image",file_class:"vision",status:"uploaded",url:v}]})}),children:[an.jsx(pt,{type:"icon-line-video-generation-01"}),an.jsx("div",{className:"qwen-media-preview-toolbar-item-text",children:i.t("Create video")})]},e)}})})]})})},[e,null==n?void 0:n.actions,null==n?void 0:n.tip,r,a,i,h,t,o,s,c,l]),f=A.useCallback(t=>{a&&(null==n?void 0:n.tip)&&t&&"image"===e&&ht.openOnce({type:"caution",content:null==n?void 0:n.tip,closable:!1}),$x()||d(t)},[e,a,null==n?void 0:n.tip]),g=A.useCallback(i=>{if($x()){const{chatId:a,currentInputFeature:o}=vx.getState();kT.adapter.invoke({method:"openMediaPreview",params:{type:e,urls:[null==i?void 0:i.url],chatId:a,msgId:t,msgType:o,tips:(null==n?void 0:n.tip)?[n.tip]:[]}})}},[e,t,null==n?void 0:n.tip]);return{preview:A.useMemo(()=>$x()?void 0:{maskClosable:!0,toolbarRender:m,onVisibleChange:f,visible:u,onStateChange:e=>{}},[m,u,f]),onClick:g}},jG=e=>{const t="x-oss-process=image/resize,m_mfit,w_320,h_320";return e.includes("qwen-webui")||"ico"===eC(e)?e:e.includes("?")?`${e}&${t}`:`${e}?${t}`},NG=({url:e,generation:t,error:n,mediaProps:i,ratio:a,containerWidth:o,onError:s,customScope:r,messageType:l})=>{const{i18n:c}=$(),u=Ex(e=>e.mobile),d=vx(e=>e.chatId),h=A.useRef(0),p=A.useRef(0),m=A.useMemo(()=>r||(u?{width:[114,300],height:[126,380]}:[133,400]),[u,r]);A.useEffect(()=>{h.current=GS()});const f=A.useMemo(()=>{if(a){const[e,t]=a.split(":");return{width:Number(e),height:Number(t)}}return{width:0,height:0}},[a]),g=A.useMemo(()=>{const{width:e,height:t}=u?((e,t=0)=>{const n=[375,667],i=[307,380],a=window.screen.width,o=window.screen.height,s=Math.min(a/n[0],o/n[1]);let r=s*i[0],l=s*i[1];a-t<r&&(r=a-t);const[c,u]=e.split(":"),[d,h]=[parseInt(c),parseInt(u)];return d>h?l=Math.round(r/d*h):d<h?r=Math.round(l/h*d):d===h&&(l=r),{width:r,height:l}})(a,68):((e,t,n=448)=>{const i=.825*(window.innerWidth||document.documentElement.clientWidth),a=.4*(window.innerHeight||document.documentElement.clientHeight);let o=Math.min(n,i),s=Math.min(n,a);if(o=s=Math.min(o,s),o<t&&(o=s=t),e){const[t,n]=e.split(":"),[i,a]=[parseInt(t),parseInt(n)];i>a&&(s=Math.round(o/i*a)),i<a&&(o=Math.round(s/a*i))}return{width:o,height:s}})(a,133,400);let n=e,i=t;if(e>=t&&u&&o){const a=.9*o;n=a,i=a/e*t}return{width:n,height:i}},[u,a,o]);return an.jsx(je,_(w({url:e,poster:(v=e,v.includes("cdn.qwenlm.ai")?`${v}${v.includes("?")?"&":"?"}x-oss-process=video/snapshot,t_0,w_0,h_500,f_jpg`:""),defaultWidth:f.width||16,defaultHeight:f.height||9,controls:!1,width:null==g?void 0:g.width,height:null==g?void 0:g.height,sizeScope:m,generation:t,firstFramePoster:!0,unSupportMessage:c.t("Your browser does not support the video tag."),error:n,onError:s},i),{autoPlay:!0,onLoad:()=>{p.current=GS(),dS("messageVideoOnLoadTime",{params:{et:"OTHER",c4:d||"",c5:l,c6:e,c7:Math.round(h.current),c8:Math.round(p.current),c9:Math.round(p.current-h.current)}})},style:u?{maxWidth:"11.25rem",maxHeight:"12rem"}:{}}));var v},PG={greenNetError:"index-module__green-net-error___xxZRT",qwenVideoViewerContentOperations:"index-module__qwen-video-viewer-content-operations___47tr9"},MG={greenNetError:"index-h5-module__green-net-error___AKDlS",greenNetErrorIcon:"index-h5-module__green-net-error-icon___9s-Sn",qwenVideoViewerContentOperations:"index-h5-module__qwen-video-viewer-content-operations___sdzKj",qwenImagePreviewOperationsWrapper:"index-h5-module__qwen-image-preview-operations-wrapper___Tdm5X"},AG={actions:["download"]},OG=A.memo(({url:e,isImage:t,isVideo:n,isMobile:i,greenNet:a,messageId:o})=>{const s="green_error"===a,[r,l]=A.useState(0),c=vx(e=>e.chatId),u=A.useRef(0),d=A.useRef(0),[h,p]=A.useState(e),m=A.useMemo(()=>i?MG:PG,[i]),f=TG({mediaType:t?"image":"video",messageId:o,preview:AG}),g=A.useMemo(()=>i?[96,180]:[112,112],[i]),v=A.useMemo(()=>i?{height:[96,192],width:[96,192]}:[320,320],[i]),y=A.useCallback(()=>j(void 0,null,function*(){if(pC(h)){const{success:e,data:t}=yield fS({fileUrl:h});e&&(null==t?void 0:t.fileUrl)&&p(t.fileUrl)}}),[h]);A.useEffect(()=>{const e=document.getElementById("chat-message-container");e&&l(null==e?void 0:e.getBoundingClientRect().width),u.current=GS()},[]);const b=A.useCallback((e,t,n)=>{dS("messageImgOnLoadTime",{params:{et:"OTHER",c4:c||"",c5:"query",c6:n,c7:Math.round(e),c8:Math.round(t),c9:Math.round(t-e)}})},[c]);return s?an.jsx(X,{className:m.greenNetError,justify:"center",align:"center",children:an.jsx(pt,{className:m.greenNetErrorIcon,type:"icon-line-image-x-2"})}):t?an.jsx(Ne,_(w({url:h,defaultWidth:1,defaultHeight:1,thumbnailUrl:jG(h),sizeScope:g,onError:()=>{y()},id:o},f),{onLoad:()=>{d.current=GS(),b(u.current,d.current,h)}})):n?an.jsx(NG,{url:h,generation:void 0,error:!1,onError:()=>{y()},ratio:"1:1",containerWidth:r>192?192:r,customScope:v,mediaProps:f,messageType:"query"}):null}),RG={fileMessage:"index-module__file-message___SeOoR",fileMessageImage:"index-module__file-message-image___eDmks",fileMessageAudio:"index-module__file-message-audio___clhPw",fileMessageDocument:"index-module__file-message-document___OjWnc"},DG={fileMessage:"index-h5-module__file-message___gacd4",fileMessageImage:"index-h5-module__file-message-image___1smH3",fileMessageVideo:"index-h5-module__file-message-video___PZ8v0",fileMessageDocument:"index-h5-module__file-message-document___etdmB"},LG=({fileList:e,isMobile:t,messageId:n})=>{const i=e.length<4?[e]:[e.slice(0,Math.ceil(e.length/2)),e.slice(Math.ceil(e.length/2),e.length)];return an.jsx("div",{className:"user-image-list",children:i.map((e,i)=>0===e.length?null:an.jsx("div",{className:Y("user-image-list-row",{"user-image-item-margin-top":i>0}),children:e.map((e,i)=>{var a;return an.jsx("div",{className:Y("user-image-item",{"user-image-item-margin-left":i>0}),children:an.jsx(OG,{isImage:!0,isMobile:t,greenNet:e.greenNet,url:(null==(a=null==e?void 0:e.url)?void 0:a.startsWith("/api"))?`${e.url}/content`:(null==e?void 0:e.url)||"",messageId:n})},e.id)})},i))})},FG=({messageId:e,files:t,isBubbleMode:n})=>{const i=Ex(e=>e.mobile),a=A.useMemo(()=>i?DG:RG,[i]),o=A.useMemo(()=>(null==t?void 0:t.length)?i?t:(e=>{const t=[];let n=[];for(const i of e)"image"===i.type&&"image"===i.showType?n.push(i):(n.length>0&&(t.push(n),n=[]),t.push(i));return n.length>0&&t.push(n),t})(t):[],[t,i]);if(!Array.isArray(t)||0===t.length)return null;const s=()=>{bI.getInstance().stopAllPlayer()};return an.jsx(X,{className:a.fileMessage,vertical:!0,wrap:!0,gap:i?16:8,align:n?"flex-end":"flex-start",children:o.map(t=>{var n;return Array.isArray(t)?an.jsx("div",{className:a.fileMessageImage,onClick:()=>{s()},children:an.jsx(LG,{fileList:t,isMobile:i,messageId:e})},t[0].id):"image"!==t.type||"image"!==t.showType&&t.showType?"video"===t.type&&"video"===t.showType?an.jsx("div",{className:a.fileMessageVideo,onClick:()=>{s()},children:an.jsx(OG,{isVideo:!0,isMobile:i,greenNet:t.greenNet,url:t.url,messageId:e})},t.id):"audio"===t.type&&"audio"===t.showType?an.jsx("div",{className:a.fileMessageAudio,onClick:()=>{s()},children:an.jsx(CG,{url:t.url,id:t.id,name:t.name},t.id)},t.id):"url"!==t.file_class?an.jsx(_$,{className:a.fileMessageDocument,item:t,url:t.url,name:t.name,fileType:t.file_type,size:null==t?void 0:t.size,role:"user",showClose:!1},t.id):null:an.jsx("div",{className:a.fileMessageImage,onClick:()=>{s()},children:an.jsx(OG,{isImage:!0,isMobile:i,greenNet:t.greenNet,url:(null==(n=null==t?void 0:t.url)?void 0:n.startsWith("/api"))?`${t.url}/content`:(null==t?void 0:t.url)||"",messageId:e})},t.id)})})},zG={userMessageHeader:"index-module__user-message-header___s556a",userMessageHeaderUsername:"index-module__user-message-header-username___0ZP-x",userMessageHeaderTimestamp:"index-module__user-message-header-timestamp___Ii7Bs",userMessageHeaderTimecost:"index-module__user-message-header-timecost___gEDh7",userMessageHeaderTimecostIcon:"index-module__user-message-header-timecost-icon___wkz3L"},UG={userMessageHeaderTimecost:"index-h5-module__user-message-header-timecost___dbbwK",userMessageHeaderTimecostIcon:"index-h5-module__user-message-header-timecost-icon___ktBGX"},HG=A.memo(({username:e,timestamp:t,timeClassName:n,isBubbleMode:i,timecost:a})=>{const o=$();NT(e=>{var t,n;return null==(n=null==(t=e.settings)?void 0:t.ui)?void 0:n.showUsername});const s=Ex(e=>e.mobile),r=w(w({},zG),s?UG:{});return i?"string"==typeof a?an.jsxs("div",{className:r.userMessageHeaderTimecost,children:[an.jsx(pt,{type:"icon-line-microphone-02",className:r.userMessageHeaderTimecostIcon}),a]}):null:an.jsxs("div",{className:r.userMessageHeader,children:[an.jsx("span",{className:r.userMessageHeaderUsername,children:e}),an.jsx("span",{className:Y(r.userMessageHeaderTimestamp,n),children:Q(1e3*t).format(o.t("h:mm a"))})]})}),BG={disable:[],disable_GREEN_ERROR:[],error_ALL_N:["regenerate"],error_ALL_G:["regenerate"],error_ALL_S:[],normal_TW_N:["copy","voice","edit","branch_new","good","bad","share","regenerate"],normal_TW_G:["copy","voice","regenerate"],normal_TW_S:["copy"],normal_A_N:["artifacts","copy","edit","branch_new","publish","good","bad","share","regenerate"],normal_A_G:["artifacts","copy","regenerate"],normal_A_S:["artifacts","copy"],normal_D_N:["copy","branch_new","publish","good","bad","share","regenerate"],normal_D_G:["copy","regenerate"],normal_D_S:["copy"],normal_DP_N:["download","good","bad","share","regenerate","publish"],normal_DP_G:["download","regenerate"],normal_DP_S:["download"],normal_RUPT_N:["copy","good","bad","share","branch_new"],normal_RUPT_G:["copy"],normal_RUPT_S:["copy"],normal_T2I_N:["create_video","image_edit","branch_new","publish","download","good","bad","share","regenerate"],normal_T2I_G:["create_video","image_edit","download","regenerate"],normal_T2I_S:["download"],normal_IE_N:["image_edit","create_video","branch_new","publish","download","good","bad","share","regenerate"],normal_IE_G:["image_edit","create_video","download","regenerate"],normal_IE_S:["download"],normal_VLO_N:["create_video","image_edit","branch_new","publish","download","good","bad","share","regenerate"],normal_VLO_G:["create_video","image_edit","download","regenerate"],normal_VLO_S:["download"],normal_VLO_N_STOP:["regenerate"],normal_VLO_G_STOP:["regenerate"],normal_T2V_N:["branch_new","publish","download","good","bad","share","regenerate"],normal_T2V_G:["download","regenerate"],normal_T2V_S:["download"],normal_OMNI_N:["copy","good","bad","share","branch_new","replay"],normal_OMNI_S:["copy"]},$G={normal_TW:["select","translation"],normal_A:["select","translation"],normal_D:["select"]},qG={normal:"N",guest:"G",local:"G",share:"S"},GG={t2t:"TW",search:"TW",artifacts:"A",web_dev:"A",deep_research:"D",podcast:"DP",t2i:"T2I",image_edit:"IE",t2v:"T2V",travel:"D"},VG=e=>{const t=/```html[\s\S]*?```/g,n=/```jsx[\s\S]*?```/g;try{const i=e.match(t),a=e.match(n);return null!==i&&i.length>0||null!==a&&a.length>0}catch(i){return!1}},WG=new RegExp("^<think>(.*?)<\\/think>","is"),QG=new RegExp("^<think>(?!.*<\\/think>)","is"),KG=e=>{var t;if(QG.test(e)){let t=e.replace(/^<think>/i,"");return t=t.replace(/^\n/,""),{status:"THINKING",content:"",thinkingQuoteText:t}}if(WG.test(e)){let n=e.replace(WG,"");n=n.replace(/^\n{0,2}/,"");let i=(null==(t=e.match(WG)||[])?void 0:t[1])||"";return i=i.replace(/^\n+|\n+$/g,""),{status:"THOUGHT_COMPLETED",content:n,thinkingQuoteText:i}}return{status:"NONE_THINKING",content:e,thinkingQuoteText:""}},YG=e=>{var t,n,i;return(null==e?void 0:e.content_list)&&(null==(t=null==e?void 0:e.content_list)?void 0:t.length)&&(null==(i=null==(n=null==e?void 0:e.content_list)?void 0:n.findLast(e=>(null==e?void 0:e.phase)===og.ANSWER))?void 0:i.content)||""},XG=e=>{var t,n;if((null==e?void 0:e.content_list)&&(null==(t=null==e?void 0:e.content_list)?void 0:t.length))return null==(n=null==e?void 0:e.content_list)?void 0:n.filter(e=>(null==e?void 0:e.phase)===og.ANSWER||(null==e?void 0:e.phase)===og.DEEPTHINKING).map(e=>e.content||"").join("\n");const{content:i}=KG((null==e?void 0:e.content)||"");return i},JG=e=>e.every(e=>{var t,n,i,a;return e.phase===og.THINKING_SUMMARY?0===(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.summary_title)?void 0:n.length)&&0===(null==(a=null==(i=null==e?void 0:e.extra)?void 0:i.summary_content)?void 0:a.length):""===e.content});function ZG(e){return A.forwardRef((t,n)=>{const i=t,{mode:a}=i,o=S(i,["mode"]),s=zE(e=>e.isSharePage);return an.jsx("div",{className:"message-hoc-container",children:an.jsx(e,_(w({ref:n},o),{mode:s?"read":null!=a?a:"edit"}))})})}const eV=z.memo(e=>{const t=e,{src:n}=t,i=S(t,["src"]),[a,o]=A.useState(!!n);return A.useEffect(()=>{o(!!n)},[n]),an.jsx(X,_(w({justify:"center",align:"center",className:"qwen-chat-search-card-logo"},i),{children:a?an.jsx("img",{src:n,alt:"",className:"qwen-chat-search-card-logo-image",onError:()=>{o(!1)}}):an.jsx(pt,{className:"qwen-chat-search-card-logo-icon",type:"icon-line-globe-01"})}))}),tV=z.memo(e=>{const{sources:t=[],maxShowNum:n=4,onClick:i=()=>{}}=e;return Array.isArray(t)&&0!==t.length?an.jsxs(X,{justify:"center",align:"center",gap:8,onClick:i,className:"qwen-chat-search-card",children:[an.jsx(X,{justify:"center",align:"center",children:t.slice(0,n).map(({hostlogo:e},t)=>{const n=t+"-"+e+"-sources-icon";return an.jsx("div",{style:{width:12},children:an.jsx(eV,{src:e||""})},n)})}),an.jsxs("div",{className:"qwen-chat-fold-source-count",children:["+",t.length]})]}):null}),nV=({sourceListLogos:e,sourceListMaxShowNumber:t=4,sourceListCallback:n,sourceListName:i,className:a})=>{const o=Ex(e=>e.mobile);return an.jsx("div",{className:`qwen-chat-package-comp-source-list ${a||""}`,onClick:n,children:o?an.jsxs(an.Fragment,{children:[an.jsx(Pe,{sources:(null==e?void 0:e.map(e=>e.hostlogo||""))||[],showNum:t}),an.jsxs("div",{className:"qwen-chat-package-comp-source-list-text",children:[an.jsx("span",{children:null==e?void 0:e.length}),an.jsx("span",{children:i})]})]}):an.jsx(tV,{maxShowNum:t,sources:e||[]})})},iV="icon-line-copy-right",aV="icon-line-edit-contained",oV="icon-line-edit-contained",sV="icon-line-thumb-up-02",rV="icon-line-thumb-down-02",lV="icon-line-arrow-rotate-right-02",cV="icon-line-text-selection",uV="icon-line-share-01",dV="icon-line-download-02",hV="icon-line-trash-01",pV="icon-pause",mV="icon-line-Volume",fV="icon-line-Publish",gV="icon-line-video-generation-01",vV="icon-line-Branch",yV="icon-line-Volume";var bV=(e=>(e.LOADING_DARK="https://img.alicdn.com/imgextra/i2/O1CN01J8AmJN1cZGSJ5xFjV_!!6000000003614-54-tps-60-60.apng",e.LOADING_LIGHT="https://img.alicdn.com/imgextra/i4/O1CN01Jwyf191eaIa5xowFe_!!6000000003887-54-tps-60-60.apng",e.VOICE_ACTIVE_DARK="https://img.alicdn.com/imgextra/i1/O1CN01lSOiPA1VfwvV2cZw6_!!6000000002681-54-tps-60-60.apng",e.VOICE_ACTIVE_LIGHT="https://img.alicdn.com/imgextra/i1/O1CN01pNHavt1CykU9z9sPI_!!6000000000150-54-tps-60-60.apng",e))(bV||{});const xV=[{key:"copy",controlType:"only-icon",icon:iV},{key:"edit",controlType:"only-icon",icon:aV},{key:"publish",controlType:"only-icon",icon:fV},{key:"regenerate",controlType:"only-icon",icon:lV},{key:"select",controlType:"only-icon",icon:cV},{key:"share",controlType:"only-icon",icon:uV},{key:"download",controlType:"only-icon",icon:dV},{key:"image_edit",controlType:"label-icon-primary",icon:oV},{key:"delete",controlType:"only-icon",icon:hV},{key:"good",controlType:"only-icon",icon:sV},{key:"bad",controlType:"only-icon",icon:rV},{key:"artifacts",controlType:"label-icon-secondary",icon:pV},{key:"create_video",controlType:"label-icon-primary",icon:gV},{key:"voice",icon:mV,activeImgs:["https://img.alicdn.com/imgextra/i1/O1CN01pNHavt1CykU9z9sPI_!!6000000000150-54-tps-60-60.apng","https://img.alicdn.com/imgextra/i1/O1CN01lSOiPA1VfwvV2cZw6_!!6000000002681-54-tps-60-60.apng"],loadingImgs:["https://img.alicdn.com/imgextra/i4/O1CN01Jwyf191eaIa5xowFe_!!6000000003887-54-tps-60-60.apng","https://img.alicdn.com/imgextra/i2/O1CN01J8AmJN1cZGSJ5xFjV_!!6000000003614-54-tps-60-60.apng"]},{key:"branch_new",controlType:"only-icon",icon:vV},{key:"replay",controlType:"only-icon",icon:yV}],wV=({className:e,editedData:t,siblingsData:n,controlData:i,sourceListData:a,maxShowButtonCount:o=6,moreText:s="More actions"})=>{const r=zE(e=>e.realTheme),l=Ex(e=>e.mobile),[c,u]=A.useState(null),[d,h]=A.useState(!1),[p,m]=A.useState(!1),f=A.useRef(null),g=A.useMemo(()=>(null==t?void 0:t.visible)||(null==n?void 0:n.visible),[null==t?void 0:t.visible,null==n?void 0:n.visible]),{displayButtons:v,moreButtons:y}=A.useMemo(()=>{const e=(null==i?void 0:i.controls)||[],t=e.filter(e=>["image_edit","artifacts","create_video"].includes(e)).slice(0,1),n=e.filter(e=>["good","bad","share","regenerate"].includes(e)),a=e.filter(e=>![...t,...n].includes(e));let s=a.length+n.length>o?a.slice(-(a.length+n.length-o+1)):[],r=[...t,...a.slice(0,a.length-s.length),...n];if(l&&p){const e=["good","bad"].filter(e=>r.includes(e));e.length>0&&(s=[...s,"divider",...e],s.length<3&&(s=s.filter(e=>"divider"!==e)),r=r.filter(e=>!["good","bad"].includes(e)))}return{displayButtons:r||[],moreButtons:s}},[null==i?void 0:i.controls,o,l,p]);A.useLayoutEffect(()=>{if(l&&f.current){const e=f.current,t=e.querySelector(".qwen-chat-package-comp-new-action-control-container");if(t){const n=t.offsetHeight;e.offsetHeight>2*n?m(!0):m(!1)}}},[l,f]);const b=A.useMemo(()=>((null==i?void 0:i.list)||[]).map(e=>{const t=xV.find(t=>t.key===e.key)||{};return w(w({},t),e)}),[null==i?void 0:i.list]),x=A.useMemo(()=>y.map(e=>{const t=b.find(t=>t.key===e);return!1===(null==t?void 0:t.visible)?null:t}).filter(e=>null!==e),[y,b]),S=A.useMemo(()=>{var e;let t=v.map(e=>{const t=b.find(t=>t.key===e);return!1===(null==t?void 0:t.visible)?null:t}).filter(e=>null!==e);const n=null==(e=null==t?void 0:t[0])?void 0:e.controlType;return n&&["label-icon-primary","label-icon-secondary"].includes(n)&&(t=t.map((e,t)=>0===t?e:_(w({},e),{controlType:["label-icon-primary","label-icon-secondary"].includes(e.controlType)?"only-icon":e.controlType}))),t},[v,b]),C=A.useCallback(e=>an.jsxs(ft,{type:"brandsecondary",size:"small",rounded:"circle",className:Y("qwen-chat-package-comp-new-action-control-btn",{"qwen-chat-package-comp-action-base-control-btn-visible":e.visible}),onClick:e.callback,children:[an.jsx("div",{className:"qwen-chat-package-comp-new-action-control-icon-container",children:an.jsx(pt,{className:"qwen-chat-package-comp-new-action-control-icon",type:e.icon||""})}),an.jsx("div",{className:"qwen-chat-package-comp-new-action-control-text",children:e.label})]},`renderLabelIconSecondary_${e.key}`),[]),E=A.useCallback(e=>an.jsx(ft,{buttonClass:Y("qwen-chat-package-comp-action-base-control-btn","qwen-chat-package-comp-action-base-control-btn-primary",{"qwen-chat-package-comp-action-base-control-btn-visible":e.visible}),type:l?"brandprimary":"brandsecondary",size:"small",rounded:"circle",iconFontType:e.icon||"",onClick:e.callback,children:e.label},`renderLabelIconPrimary_${e.key}`),[l]),k=A.useCallback(e=>an.jsxs("div",{className:"qwen-chat-package-comp-new-action-control-guide-content",onClick:e=>e.stopPropagation(),children:[an.jsxs("div",{className:"qwen-chat-package-comp-new-action-control-guide-top",children:[an.jsx("div",{className:"qwen-chat-package-comp-new-action-control-guide-title",children:e.title}),an.jsx("div",{className:"qwen-chat-package-comp-new-action-control-guide-close-btn",onClick:()=>{e.onCloseClick&&e.onCloseClick()},children:an.jsx(pt,{type:"icon-close-4",className:"qwen-chat-package-comp-new-action-control-guide-close"})})]}),an.jsx("div",{className:"qwen-chat-package-comp-new-action-control-guide-content-text",children:e.content}),e.buttonVisible&&an.jsx(ft,{type:"brandtertiary",rounded:"circle",size:"small",onClick:e.onButtonClick,children:e.buttonText})]}),[]),I=A.useCallback((e,t)=>{var n,a,o,s,d,h,p,m,f,g,v;const y=null==(n=null==i?void 0:i.disableControls)?void 0:n.some(t=>t===e.key),b=null==(a=null==i?void 0:i.activeControls)?void 0:a.some(t=>t===e.key),x="light"===r?null==(o=e.activeImgs)?void 0:o[0]:(null==(s=e.activeImgs)?void 0:s[1])||(null==(d=e.activeImgs)?void 0:d[0]),w=null==(h=null==i?void 0:i.loadingControls)?void 0:h.some(t=>t===e.key),_="light"===r?null==(p=e.loadingImgs)?void 0:p[0]:(null==(m=e.loadingImgs)?void 0:m[1])||(null==(f=e.loadingImgs)?void 0:f[0]);let S=e.defaultToolTip||null;y?S=e.disabledTooltip||null:b&&(S=e.activeTooltip||null);const C=!t&&(null==(g=e.guideInfo)?void 0:g.visible)||!1;return S||c!==e.key||u(null),["good","bad"].includes(e.key)&&b&&(e.icon="good"===e.key?"icon-fill-thumb-up-01":"icon-fill-thumb-down-01"),an.jsx(vt,{open:c===e.key,title:l||t?null:S,placement:"bottom",onOpenChange:t=>{u(t?e.key:null)},children:an.jsx(ne,{arrow:!1,classNames:{root:"qwen-chat-package-comp-new-action-control-guide "+(C?"":"qwen-chat-package-comp-new-action-control-guide-none")},content:k(e.guideInfo||{}),trigger:C?"click":[],getPopupContainer:()=>document.body,placement:l?"top":"right",onOpenChange:null==(v=e.guideInfo)?void 0:v.onOpenChange,children:an.jsx("div",{className:`qwen-chat-package-comp-new-action-control-container qwen-chat-package-comp-new-action-control-container-${e.key} ${y?"qwen-chat-package-comp-new-action-control-container-disabled":""} ${l||t?"":"qwen-chat-package-comp-new-action-control-container-enable-hover"}`,onClick:n=>{y||!e.callback||t||e.callback()},children:w||b&&x?an.jsx("img",{alt:"",className:"qwen-chat-package-comp-new-action-control-icon-img",src:w?_:x}):an.jsx(pt,{type:e.icon||"",className:"qwen-chat-package-comp-new-action-control-icon\n            "+(b&&!t?"qwen-chat-package-comp-new-action-control-icon-active":"")})})})},`renderOnlyIcon_${e.key}`)},[null==i?void 0:i.activeControls,null==i?void 0:i.disableControls,null==i?void 0:i.loadingControls,l,k,r,c]),T=A.useCallback(e=>{switch(null==e?void 0:e.controlType){case"only-icon":return I(e);case"label-icon-primary":return E(e);case"label-icon-secondary":return C(e);default:return(null==e?void 0:e.iconRender)?e.iconRender:e?I(e):null}},[E,C,I]),j=A.useMemo(()=>(null==t?void 0:t.visible)||(null==n?void 0:n.visible)?an.jsxs("div",{className:"qwen-chat-package-comp-new-action-control-edited-container",children:[(null==t?void 0:t.visible)&&an.jsx("div",{className:"qwen-chat-package-comp-new-action-control-is-edited",children:t.text}),(null==n?void 0:n.visible)&&an.jsx(Me,{onPreviousClick:n.onPreviousClick,onNextClick:n.onNextClick,curSiblingsIndex:n.curSiblingsIndex,maxSiblings:n.maxSiblings})]}):null,[null==t?void 0:t.text,null==t?void 0:t.visible,null==n?void 0:n.curSiblingsIndex,null==n?void 0:n.maxSiblings,null==n?void 0:n.onNextClick,null==n?void 0:n.onPreviousClick,null==n?void 0:n.visible]),N=A.useCallback(e=>e?an.jsx("div",{className:"qwen-chat-package-comp-new-action-more-operation-text",children:e.label||e.defaultToolTip||""}):null,[]),P=A.useCallback(e=>{var t,n,a;const o=null==(t=null==i?void 0:i.disableControls)?void 0:t.some(t=>t===e),s=b.find(t=>t.key===e);if(!s||!1===s.visible)return null;const r=(null==(n=s.guideInfo)?void 0:n.visible)||!1;return an.jsx(ne,{classNames:{root:"qwen-chat-package-comp-new-action-control-guide "+(r?"":"qwen-chat-package-comp-new-action-control-guide-none")},getPopupContainer:e=>document.body,content:k(s.guideInfo||{}),trigger:r?"click":[],placement:l?"top":"right",arrow:!l,autoAdjustOverflow:!0,onOpenChange:null==(a=s.guideInfo)?void 0:a.onOpenChange,children:an.jsxs("div",{className:"qwen-chat-package-comp-new-action-more-operation-items",onClick:()=>{!o&&s.callback&&(s.callback(),r||h(!1))},children:[I(s,!0),N(s)]},e)})},[b,null==i?void 0:i.disableControls,I,N,k,l]),M=A.useMemo(()=>an.jsx("div",{className:"qwen-chat-package-comp-new-action-more-operation-content",children:y.map(e=>"divider"===e?an.jsx("div",{className:"qwen-chat-package-comp-new-action-more-operation-divider"},e):P(e))}),[y,P]),O=A.useMemo(()=>an.jsxs("div",{ref:f,className:"qwen-chat-package-comp-new-action-control-icons",children:[(null==S?void 0:S.length)?null==S?void 0:S.map(e=>T(e)):null,(null==x?void 0:x.length)>0&&an.jsx(ne,{arrow:!1,open:d,onOpenChange:h,classNames:{root:"qwen-chat-package-comp-new-action-more-popover"},trigger:"click",placement:"bottomLeft",autoAdjustOverflow:!0,destroyTooltipOnHide:!0,content:M,children:an.jsx(vt,{title:s,placement:"top",children:an.jsx("div",{className:"qwen-chat-package-comp-new-action-control-container",children:an.jsx(pt,{type:"icon-line-more-01",className:"qwen-chat-package-comp-new-action-control-icon"})})},"more-button-tooltip")})]}),[T,s,M,x,S,d,h]);return l?an.jsxs("div",{className:`qwen-chat-package-comp-new-action-control ${e}`,children:[(null==a?void 0:a.visible)&&an.jsx(nV,w({},{sourceListLogos:a.sourceListLogos,sourceListName:a.sourceListName,sourceListCallback:a.sourceListCallback})),an.jsxs("div",{className:"qwen-chat-package-comp-new-action-control-mobile-container",children:[O,j]})]}):an.jsxs("div",{className:`qwen-chat-package-comp-new-action-control ${e}`,children:[g&&("left"===(null==n?void 0:n.position)||!(null==n?void 0:n.position))&&j,O,g&&"right"===(null==n?void 0:n.position)&&j,(null==a?void 0:a.visible)&&an.jsx(nV,w({},{sourceListLogos:a.sourceListLogos,sourceListName:a.sourceListName,sourceListCallback:a.sourceListCallback}))]})},_V=[{key:"copy",controlType:"icon-label",icon:iV},{key:"edit",controlType:"icon-label",icon:aV},{key:"publish",controlType:"icon-label",icon:fV},{key:"regenerate",controlType:"icon-label",icon:lV},{key:"select",controlType:"icon-label",icon:cV},{key:"share",controlType:"icon-label",icon:uV},{key:"download",controlType:"icon-label",icon:dV},{key:"image_edit",controlType:"icon-label",icon:oV},{key:"delete",controlType:"icon-label-error",icon:hV},{key:"good",controlType:"icon-label",icon:sV},{key:"bad",controlType:"icon-label",icon:rV},{key:"artifacts",controlType:"icon-label",icon:pV},{key:"translation",controlType:"icon-label-select",icon:cV},{key:"branch_new",controlType:"icon-label",icon:vV},{key:"voice",controlType:"icon-label",icon:mV,activeImgs:[bV.VOICE_ACTIVE_LIGHT,bV.VOICE_ACTIVE_DARK],loadingImgs:[bV.LOADING_LIGHT,bV.LOADING_DARK]}],SV=({className:e,controlData:t})=>{const n=zE(e=>e.realTheme),i=A.useMemo(()=>((null==t?void 0:t.list)||[]).map(e=>{const t=_V.find(t=>t.key===e.key)||{};return w(w({},t),e)}),[null==t?void 0:t.list]),a=A.useCallback(e=>{var t,n,i;return an.jsx(Ae,{languageCode:(null==(t=e.dropdown)?void 0:t.value)||"",popover:{getPopupContainer:()=>{var e;return(null==(e=document.getElementsByClassName("chat-messages"))?void 0:e[0])||document.body}},languages:((null==(n=e.dropdown)?void 0:n.options)||[]).map(e=>({code:e.key,title:e.label,translate:e.value})),onTranslate:null==(i=e.dropdown)?void 0:i.onChange})},[]),o=A.useCallback(e=>e.loading||e.active&&e.activeImg?an.jsx("img",{className:"qwen-chat-package-comp-action-control-vertical-group-base-item-img",src:e.loading?e.loadingImg:e.activeImg,alt:""}):an.jsx(pt,{type:e.icon||"",className:`qwen-chat-package-comp-action-control-vertical-group-base-item-icon\n          ${e.active?"qwen-chat-package-comp-action-control-vertical-group-base-item-icon-active":""}\n          ${e.disabled?"qwen-chat-package-comp-action-control-vertical-group-base-item-icon-disable":""}\n          `}),[]),s=A.useCallback((e,i="normal",s=!1)=>{var r,l,c,u,d,h,p,m,f;const g=null==(r=null==t?void 0:t.disableControls)?void 0:r.some(t=>t===e.key),v=null==(l=null==t?void 0:t.activeControls)?void 0:l.some(t=>t===e.key),y="light"===n?null==(c=e.activeImgs)?void 0:c[0]:(null==(u=e.activeImgs)?void 0:u[1])||(null==(d=e.activeImgs)?void 0:d[0]),b=null==(h=null==t?void 0:t.loadingControls)?void 0:h.some(t=>t===e.key),x="light"===n?null==(p=e.loadingImgs)?void 0:p[0]:(null==(m=e.loadingImgs)?void 0:m[1])||(null==(f=e.loadingImgs)?void 0:f[0]);return an.jsxs("div",{className:`qwen-chat-package-comp-action-control-vertical-group-base-item qwen-chat-package-comp-action-control-vertical-group-base-item-${i} qwen-chat-package-comp-action-control-vertical-group-base-item-${e.key}`,onClick:()=>!b&&e.callback&&e.callback(),children:[an.jsx("div",{className:"qwen-chat-package-comp-action-control-vertical-group-base-item-icon-label",children:e.label}),s?a(e):o({loading:b,active:v,disabled:g,activeImg:y,loadingImg:x,icon:e.icon})]})},[null==t?void 0:t.activeControls,null==t?void 0:t.disableControls,null==t?void 0:t.loadingControls,o,a,n]),r=A.useCallback(e=>{const t=i.find(t=>t.key===e);switch(null==t?void 0:t.controlType){case"icon-label":return s(t);case"icon-label-error":return s(t,"error");case"icon-label-select":return s(t,"normal",!0);default:return null}},[i,s]),l=A.useMemo(()=>{var e;return(null==(e=null==t?void 0:t.controls)?void 0:e.length)?t.controls:[]},[null==t?void 0:t.controls]);return an.jsx("div",{className:`qwen-chat-package-comp-action-control-vertical ${e||""}`,children:l.map((e,t)=>an.jsx("div",{className:"qwen-chat-package-comp-action-control-vertical-group",children:r(e)},`action-control-vertical-${t}`))})},CV=ZG(e=>{const{i18n:t}=$(),n=HE(e=>e.user),i=vx(e=>e.isChat),a=Sx(e=>e.temporaryChatEnabled),[o,s]=A.useState(!1),r=vx(e=>e.currentInputFeature),l=Sx(e=>e.visionGenerating),c=Sx(e=>e.taskRunning),u=Ex(e=>e.mobile),d="read"===e.mode;zE(e=>e.isSharePage);const{message:h,isChatIntercept:p,isFirstMessage:m,isOmni:f,handleEditMessage:g,handleDeleteMessage:v,showActionControl:y=!0,isOldMessageInNewBranch:b}=e,x=A.useMemo(()=>h.siblings||WC(h.id||h.fid),[h]),w=A.useMemo(()=>!!f&&!(null==h?void 0:h.content),[f,null==h?void 0:h.content]),_=A.useMemo(()=>!p&&!d&&!f&&h.id&&!b&&h.sub_chat_type!==ng.INTERRUPT,[p,d,f,h.id,h.sub_chat_type,b]),S=A.useMemo(()=>!m&&!d&&!p&&!a&&!i&&!l&&!c&&!UT()&&!b&&h.id,[m,d,p,a,i,l,c,b,h.id]),C=A.useMemo(()=>{if(h.isShare)return[];let e=["copy"];return _&&e.push("edit"),S&&e.push("delete"),w&&(e=e.filter(e=>!["copy","edit"].includes(e))),e},[S,_,w,h.isShare]),E=A.useMemo(()=>{let e=["copy"];return _&&e.push("edit"),e.push("select"),S&&e.push("delete"),w&&(e=e.filter(e=>!["copy","edit","select"].includes(e))),e},[S,_,w]),k=A.useMemo(()=>(null==x?void 0:x.indexOf(h.id||h.fid))+1,[h.fid,h.id,x]),I=A.useCallback(e=>{const t=e||h.content;QS(t)},[h.content]),T=A.useCallback(()=>{v()},[v]),j=A.useCallback(()=>{$x()?kT.adapter.invoke({method:"openHalfWindow",params:{type:"selectText",content:r===ng.WebSearch?Ev(XG(h)):XG(h),ext:`{"disable_translate": ${(null==h?void 0:h.chat_type)===ng.DeepResearch||h.chat_type===ng.Travel}}`,windowSize:100}}):s(!0)},[r,h]),N=A.useMemo(()=>({visible:x.length>1,curSiblingsIndex:k,maxSiblings:x.length,position:n&&"left",onPreviousClick:()=>{kT.navigateToSiblingMessage(h,x,"previous")},onNextClick:()=>{kT.navigateToSiblingMessage(h,x,"next")}}),[k,h,x,n]),P=A.useMemo(()=>({controls:C,list:[{key:"edit",defaultToolTip:t.t("Edit"),callback:g,visible:!b&&!!h.id},{key:"copy",defaultToolTip:t.t("Copy"),callback:I},{key:"delete",defaultToolTip:t.t("Delete"),callback:T,visible:!b&&!!h.id}]}),[C,I,T,g,t,b,h.id]),M=A.useMemo(()=>({controls:E,list:[{key:"edit",label:t.t("Edit"),callback:g},{key:"copy",label:t.t("Copy"),callback:I},{key:"delete",label:t.t("Delete"),callback:T},{key:"select",label:t.t("Select text"),callback:j}]}),[I,T,g,t,j,E]);return an.jsxs(X,{className:"user-message-footer "+(u&&!N.visible?"user-message-footer-none":""),vertical:!0,justify:"center",align:"flex-end",children:[y?!(u&&!N.visible)&&an.jsx(wV,{className:"user-message-footer-horizontal",siblingsData:N,controlData:P,moreText:t.t("More actions")}):an.jsx("div",{}),u&&an.jsx(SV,{className:"user-message-footer-vertical",controlData:M}),o&&an.jsx(Oe,{contentText:r===ng.WebSearch?Ev(XG(h)):XG(h),useSystemSelect:!0,title:t.t("Select text"),show:o,onClose:()=>s(!1)})]})}),EV=({children:e,onLongPress:t})=>{const[n,i]=A.useState(!1),a=A.useRef(null),o=A.useRef(null),[s,r]=A.useState(null),l=A.useRef(null),c=A.useRef(!1),u=Lx();let d=null;const h=A.useCallback(()=>{i(!1),c.current=!1,document.querySelectorAll(".user-message-footer-vertical").forEach(e=>{e.style.left="0",e.style.top="0",e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex=-1}),document.querySelectorAll(".qwen-chat-package-comp-action-control-vertical").forEach(e=>{e.style.left="0",e.style.top="0",e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex=-1})},[]),p=(e,t,n,i,o)=>{try{const s=document.querySelector(`#${bg}`);d&&clearTimeout(d),d=setTimeout(()=>{n||p(e,s,a,i,o);const r=null==s?void 0:s.getBoundingClientRect(),l=null==t?void 0:t.getBoundingClientRect(),c=null==n?void 0:n.getBoundingClientRect();if(c&&r&&l){const{height:t,width:n}=c,{x:a,width:s,y:u,height:d}=r,{x:h,y:p}=l;let m=i+h;m+n>a+s&&(m=a+s-n-10,i=m-h);o+t>u+d&&(o=o-t);const f=e.target.closest(".chat-user-message-container").querySelector(".user-message-footer").querySelector(".user-message-footer-vertical");f&&(f.style.left=i+"px",f.style.top=o+"px",f.style.display="block",f.style.visibility="visible",f.style.position="fixed",f.style.zIndex=9)}},100)}catch(s){}},m=A.useCallback((e,n,a)=>{i(!0),c.current=!0;const o=document.querySelector(`#${bg}`),s=e.target.closest(".qwen-chat-message"),r=e.target.closest(".chat-user-message-container").querySelector(".user-message-footer").querySelector(".user-message-footer-vertical");r.style.display="block";const l=a;let d=n;d=(null==r?void 0:r.offsetWidth)+d+50>(null==o?void 0:o.offsetWidth)?Math.max(0,n-(null==r?void 0:r.offsetWidth)-50):n+50,u&&r&&p(e,s,r,d,l),u&&(setTimeout(()=>{window.addEventListener("click",h)},500),null==t||t())},[h,u,t]);return A.useEffect(()=>{if(!u||!n)return;const e=e=>{a.current&&!a.current.contains(e.target)&&h()},t=setTimeout(()=>{document.addEventListener("click",e)},300);window.addEventListener("click",h),window.addEventListener("touchStart",h),window.addEventListener("touchmove",h);return document.querySelectorAll(".chat-response-message-right").forEach(e=>{e.addEventListener("click",h)}),()=>{clearTimeout(t),document.removeEventListener("click",e),window.removeEventListener("click",h),window.removeEventListener("touchStart",h),window.removeEventListener("touchmove",h);document.querySelectorAll(".chat-response-message-right").forEach(e=>{e.removeEventListener("click",h)})}},[n,h,u]),an.jsx("div",{ref:o,className:u?"chat-user-message-right":"",onTouchStart:e=>{h(),document.querySelectorAll(".ant-popover").forEach(e=>{e.style.left="0",e.style.top="0",e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex=-1}),c.current&&(e.preventDefault(),e.stopPropagation());const t=e.touches[0],n=t.clientX,i=t.clientY;r({x:n,y:i}),l.current&&clearTimeout(l.current),l.current=setTimeout(()=>{e.target&&m(e,n,i)},500)},onTouchMove:e=>{if(!s)return;const t=e.touches[0],n=t.clientX,i=t.clientY,a=n-s.x,o=i-s.y;Math.sqrt(b(a,2)+b(o,2))>5&&(h(),l.current&&(clearTimeout(l.current),l.current=null),r(null))},onTouchEnd:()=>{l.current&&(window.clearTimeout(l.current),l.current=null),r(null)},style:{position:"relative",width:"100%"},children:e})},kV=({content:e,isMobile:t=!1,isIos:n=!1,className:i="",style:a={}})=>{const o=A.useRef(null),[s,r]=A.useState(!1),l=A.useRef(""),c=e=>{if(!o.current)return;r(!0);let t=0;const i=n?1e3:2e3,a=n?3:5,s=document.createDocumentFragment(),l=()=>{for(let n=0;n<a&&t<e.length;n++){const n=Math.min(e.length,t+i),a=e.slice(t,n);s.appendChild(document.createTextNode(a)),t=n}var c;t<e.length?(c=l,"requestIdleCallback"in window?window.requestIdleCallback(c):requestAnimationFrame(c)):(performance.now(),setTimeout(()=>{o.current&&(n&&(o.current.style.transform="translateZ(0)",o.current.style.willChange="transform"),o.current.textContent="",o.current.appendChild(s),u()),performance.now(),r(!1)},0))};"fonts"in document?document.fonts.ready.then(l):l()},u=()=>j(void 0,null,function*(){const e=document.getElementById("messages-container");e&&(e.scrollTop=e.scrollHeight)});A.useEffect(()=>{o.current&&e!==l.current&&(t?c(e):(e=>{if(!o.current)return;r(!0);const t=document.createElement("p");let n=0;const i=()=>{const a=n,s=Math.min(e.length,n+5e3),l=e.slice(a,s),c=document.createElement("span");c.textContent=l,t.appendChild(c),n=s,n<e.length?requestAnimationFrame(i):requestAnimationFrame(()=>{o.current&&(o.current.textContent="",o.current.append(...t.childNodes),u()),r(!1)})};i()})(e),l.current=e)},[e,t,n]);const d=w({lineHeight:t?"24px":"28px"},a),h="whitespace-pre-wrap user-message-content "+(t?"":"fade-in");return an.jsx("p",{ref:o,className:`${h} ${i}`,style:d})},IV=({message:e,handleDeleteMessage:t,isOldMessageInNewBranch:n})=>{var i,a;const o=$(),{content:s,files:r}=e,l=HE(e=>e.user),c=vx(e=>e.chatId),u=vx(e=>e.isChat),d=vx(e=>e.history),h=vx(e=>e.setEmitSendPromptType),p=MT(e=>e.voicePlayingMessageId),[m,f]=A.useState(""),[g,v]=A.useState(!1),[y,b]=A.useState(!1),x=A.useRef(!1),[S,C]=A.useState(!1),E=Ex(e=>e.mobile),k=Px(),I=zE(e=>e.isSharePage),T=EI(e=>e.models),N=A.useMemo(()=>!0,[E,I]),P=t=>{var n,i;const a=KS(JSON.stringify(t),{}),o=T.find(e=>"Qwen3-Max"===e.name);if(e.models.includes((null==o?void 0:o.id)||"")&&(null==(n=e.feature_config)?void 0:n.thinking_enabled)||(s=a.content,!(tk(s).length>0)))return C(!1),a;{C(!0);const e=ZE(a.content,null==(i=a.extra)?void 0:i.url_parse_result);return _(w({},a),{parseResult:e})}var s},M=e=>e===lg.SUCCESS||e===lg.PARSING,O=A.useMemo(()=>P(e),[e.id]),R=A.useMemo(()=>!(!e.sub_chat_type||![ig.OmniAudio,ig.OmniVideo].includes(e.sub_chat_type)),[e.sub_chat_type]),D=A.useMemo(()=>Array.isArray(s)?"":R?s?`${s}`:o.t("Transcript not available"):s,[s,o,R]),L=A.useMemo(()=>{var t;let n=d.messages[d.currentId||""];for(;n&&(null==n?void 0:n.parentId)!==(e.id||e.fid);)n=d.messages[n.parentId||""];return["RateLimited","ParallelLimited","data_inspection_failed"].includes((null==(t=null==n?void 0:n.error)?void 0:t.errorCode)||"")},[d.currentId,d.messages,e.fid,e.id]),F=A.useMemo(()=>{var t;return R&&(e=>{const t=Math.floor(e/1e3),n=Math.floor(t/60),i=t%60;return`${String(n).padStart(2,"0")}:${String(i).padStart(2,"0")}`})(null==(t=null==e?void 0:e.extra)?void 0:t.timecost)},[R,null==(i=null==e?void 0:e.extra)?void 0:i.timecost]),z=(t,n=!0)=>j(void 0,null,function*(){if($x()&&!x.current)return;b(!1),h(Yf.EDIT);const i=t.replace(/\s+/g,"");if((null==t?void 0:t.trim())&&0!==i.length)if(t.length>cg)ht.open({type:"error",content:o.t("Prompt cannot exceed {{value}} characters.",{value:cg})});else{if(!n){const n=XG(e),{success:i,data:a}=yield K_({origin_content:n,new_content:t});if(!i&&"data_inspection_passed"!==a.code)return}((e,t,n=!0)=>{j(void 0,null,function*(){const i=vx.getState().history;kT.editMessage({messageId:e,content:t,history:i,submit:n})})})(e.id,t,n),v(!1),f(""),e.childrenIds.includes(p)&&bI.getInstance().stopAllPlayer()}else ht.open({type:"error",content:o.t("The content cannot be empty!")})});return A.useEffect(()=>{x.current=y},[y]),an.jsxs(X,{gap:10,className:"chat-user-message-container-wrapper",children:[!N&&an.jsx(hG,{user:l,menu:!1}),an.jsxs("div",{className:Y("chat-user-message-container",{"chat-user-message-container-nobubble":!N}),children:[an.jsx(HG,{timeClassName:"chat-user-message-header-timestamp",username:null==l?void 0:l.name,timestamp:e.timestamp,isBubbleMode:N,timecost:F}),an.jsx(FG,{messageId:e.id,files:r,isBubbleMode:N}),g?an.jsx(Re,{value:m,open:!0,onOk:e=>{z(e||"",!0)},onCancel:()=>{f(""),v(!1)},okText:o.t("Send"),cancelText:o.t("Cancel"),showExtra:!1}):an.jsxs(an.Fragment,{children:[!!D&&an.jsx(EV,{children:an.jsx(X,{className:"chat-user-message-wrapper",justify:N?"flex-end":"flex-start",children:(null==(a=null==O?void 0:O.parseResult)?void 0:a.length)?an.jsx("p",{className:"chat-user-message",children:O.parseResult.map(e=>"url"===e.type?an.jsx(vt,{style:{display:"inline-block"},className:"tooltip-box",title:e.title,children:an.jsx("a",{className:`url-analyze url-analyze-${e.status}`,href:M(e.status)?e.content:void 0,target:"_blank",onClick:()=>{var t;if(E&&!M(e.status)&&ht.open({type:"warning",content:null!=(t=e.title)?t:""}),$x()&&M(e.status)){const t=`qwen://web?url=${encodeURIComponent(e.content)}`;kT.adapter.invoke({method:"openWindow",params:{uri:t}})}},children:an.jsx("span",{style:{whiteSpace:"pre"},children:e.content.trim()})})},e.content):an.jsx("span",{children:e.content},e.content))}):an.jsx("div",{className:"chat-user-message",children:an.jsx(kV,{content:D,isMobile:E,isIos:k,className:Y({"chat-user-message-text-renderer-omni":R,"chat-user-message-text-renderer-omni-available":R&&!s})})})})}),an.jsx(CV,{showActionControl:!!D,message:e,isFirstMessage:null===e.parentId,isChatIntercept:L,isOmni:R,handleEditMessage:()=>{if(dS("clkReviseMsg",{params:{et:"CLK",c4:"query"},aesParams:{c5:c,c6:`${null==e?void 0:e.id}`},paramsExtend:{chat_id:c,msg_id:`${null==e?void 0:e.id}`}}),u||Sx.getState().visionGenerating)return void ht.open({type:"warning",content:o.t("In the conversation, please wait a moment.")});kT.closeShowControls();const t=e.content;$x()?(b(!0),kT.firstOn(dE.MESSAGE_EDIT_SAVE,e=>z(e)),kT.adapter.invoke({method:"openHalfWindow",params:{type:"edit",content:t,ext:""}})):(f(t),v(!0))},isOldMessageInNewBranch:n,handleDeleteMessage:()=>{t(e.id)}})]})]})]})};ZG(IV);const TV=e=>{var t,n,i;const{message:a,children:o,phase:s,boxId:r}=e,l=Ex(e=>e.config),c=vx(e=>e.isChat),u=vx(e=>e.setEmitSendPromptType),d=zE(e=>e.isSharePage),h=EI(e=>e.selectedModelIds),p=vx(e=>e.branchInfo),{i18n:m}=$(),[f,g]=A.useState(""),v=A.useCallback(e=>{kT.setSelectLocalLanguageCode(e),g(e)},[]),y=A.useCallback(()=>j(void 0,null,function*(){if(null==l?void 0:l.language){const e=yield kT.getSelectLocalLanguageCode(l,m.language);v(e)}}),[l,m,v]),b=A.useMemo(()=>{var e,t,n,i,o;return a.chat_type===ng.DeepResearch&&(null==(t=null==(e=a.extra)?void 0:e.meta)?void 0:t.subChatType)===ng.DeepThinking||a.chat_type===ng.Travel&&(null==(i=null==(n=a.extra)?void 0:n.meta)?void 0:i.subChatType)===ng.TRAVEL_FEEDBACK||a.isMultiResponse?[{key:De.copy,text:m.t("Copy")}]:(null==(o=null==l?void 0:l.language)?void 0:o.length)&&"deep_research"!==a.chat_type&&"travel"!==a.chat_type?[{key:De.copy,text:m.t("Copy")},{key:De.ask,text:m.t("Ask")},{key:De.explain,text:m.t("Explain")},{key:De.translate,text:m.t("Translate")}]:[{key:De.copy,text:m.t("Copy")},{key:De.ask,text:m.t("Ask")},{key:De.explain,text:m.t("Explain")}]},[a.chat_type,null==(n=null==(t=a.extra)?void 0:t.meta)?void 0:n.subChatType,a.isMultiResponse,null==(i=null==l?void 0:l.language)?void 0:i.length,m]),x=A.useMemo(()=>c||d||(null==p?void 0:p.isTemp),[c,p,d]);A.useEffect(()=>{(null==l?void 0:l.language)&&y()},[l,y]);const w=A.useCallback(e=>{QS((e=>(vx.getState().currentInputFeature===ng.WebSearch?Ev(e,"numberAndEntry"):e)||"")(e))},[]),_=A.useCallback((e,t)=>{const n={type:"ask",messageId:a.id||void 0,inputText:t,content:{text:e}};u(Yf.ASK),kT.seleteOperation(n)},[a.id]),S=A.useCallback(e=>{const t={type:"explain",messageId:a.id||void 0,content:{text:e}};u(Yf.EXPLAIN),kT.seleteOperation(t)},[a.id]),C=A.useCallback((e,t)=>{var n,i;if(v(e),!l)return;const o=l.language,s={type:"translate",messageId:a.id,extra:Sk(e),content:{text:Ck(m.t("Translate the following text into {{lang}}.",{lang:null!=(i=null==(n=o.find(t=>t.code===e))?void 0:n.title)?i:""}),`${m.t("TextTranslate")}${t}`,o.find(t=>t.code===e))}};u(Yf.TRANSLATE),kT.seleteOperation(s)},[v,l,a.id,m,u]);return an.jsx(Le,{className:`response-message-content ${a.sub_chat_type} phase-${s}`,id:`chat-response-message-${a.id||""}`,menuId:a.id||"",disabledContainer:x,offset:h.length>1?28:10,boxId:r,menuList:b,languageCode:f,languages:(null==l?void 0:l.language)||[],onAskHandler:_,onCopyHandler:w,onExplainHandler:S,onTranslateHandler:C,askInputPlaceholder:m.t("Ask a question"),children:o})},jV=e=>{const t=null==e?void 0:e.parentElement;if(t){if("chat-message-container"!==t.id)return jV(t);{const t=e.previousElementSibling;if(t){const e=t.querySelectorAll("img"),n=e[e.length-1];if(n)return n}}}return null},NV=e=>{var t,n,i,a,o,s;let r=0,l=0;const c=null==(t=e.content_list)?void 0:t.find(e=>{var t,n;return e.phase===og.IMAGE_GEN&&(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.output_image_hw)?void 0:n[0])});if(c&&(null==(i=null==(n=null==c?void 0:c.extra)?void 0:n.output_image_hw)?void 0:i[0])){r=Number((null==(a=c.extra.output_image_hw[0])?void 0:a[1])||0),l=Number((null==(o=c.extra.output_image_hw[0])?void 0:o[0])||0)}if(null==(s=null==e?void 0:e.info)?void 0:s.size){const[t,n]=e.info.size.split(":");r=Number(t),l=Number(n)}return{width:r,height:l}};function PV(e){const t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}function MV(e,t=!1){const n=new Date(1e3*e),i=e=>e.toString().padStart(2,"0"),a=n.getFullYear(),o=i(n.getMonth()+1),s=i(n.getDate()),r=i(n.getHours()),l=i(n.getMinutes()),c=i(n.getSeconds());return t?`${a}-${o}-${s} ${r}:${l}:${c}`:`${a}-${o}-${s}`}const AV=({currentTime:e,duration:t,onProgressChange:n,disabled:i,loading:a})=>{const[o,s]=A.useState(!1),[r,l]=A.useState(!1),c=A.useRef(null),u=A.useMemo(()=>{return n=e,0===(i=t)?0:Math.min(Math.max(n/i*100,0),100);var n,i},[e,t]),d=A.useCallback(e=>{const t=Math.max(0,Math.min(100,Math.round(e)));n(t)},[n]),h=A.useCallback(e=>{if(!c.current)return;const t=c.current.getBoundingClientRect();let n;n="touches"in e?e.touches[0].clientX:e.clientX;const i=(n-t.left)/t.width*100;d(i)},[d]),p=A.useCallback(e=>{e.preventDefault(),r&&h(e)},[r,h]),m=A.useCallback(()=>{l(!1)},[l]);A.useEffect(()=>{if(!r)return;const e=e=>p(e),t=()=>m(),n=e=>p(e),i=()=>m(),a=()=>m();return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),document.addEventListener("touchmove",n,{passive:!1}),document.addEventListener("touchend",i),document.addEventListener("touchcancel",a),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),document.removeEventListener("touchmove",n),document.removeEventListener("touchend",i),document.removeEventListener("touchcancel",a)}},[r,p,m]);const f=e=>{i||(e.preventDefault(),l(!0),h(e.nativeEvent))};if(a)return an.jsx("div",{className:"audio-progress-bar-container loading",children:an.jsx("div",{className:"audio-progress-bar"})});const g=["audio-progress-bar-container",i?"disabled":""].filter(Boolean).join(" "),v=["audio-progress-container",o||r?"expand":""].filter(Boolean).join(" ");return an.jsx("div",{className:g,onClick:e=>{e.stopPropagation()},onMouseUp:m,onTouchCancel:m,onTouchEnd:m,onMouseEnter:()=>!i&&s(!0),onTouchStart:f,children:an.jsx("div",{className:v,ref:c,onMouseDown:f,style:{touchAction:"none"},children:an.jsx("div",{className:"audio-progress-bar",style:{width:`${u}%`}})})})},OV=({menuData:e,playbackRate:t,onChange:n,children:i,disabled:a})=>{const o=A.useMemo(()=>({items:e.map(e=>({key:e.value,label:an.jsx("div",{className:Y("dialog-body-item",{active:t===e.value}),children:an.jsx("span",{className:"dialog-body-item-label",children:e.label})}),onClick:()=>{n(e.value)}}))}),[e,n,t]);return an.jsx(xt,{overlayClassName:"rate-selector",menu:o,trigger:["click"],placement:"topCenter",disabled:a,children:i})},RV=[{label:"2.0x",value:2,icon:"icon-a-2x"},{label:"1.5x",value:1.5,icon:"icon-a-15x"},{label:"1.0x",value:1,icon:"icon-a-1x"},{label:"0.5x",value:.5,icon:"icon-a-05x"}],DV=({playbackRate:e,onPlaybackRateChange:t,onTimeChange:n,onDownload:i,disabled:a,ready:o,messageId:s})=>{const{t:r}=$(),l=A.useMemo(()=>{var t;return(null==(t=RV.find(t=>t.value===e))?void 0:t.value)||"1.0"},[e]),c=e=>{t(e)};return an.jsxs("div",{className:Y("action-buttons",{disabled:a}),children:[an.jsx("div",{className:"action-button",onClick:()=>{!a&&o&&n(-15)},children:an.jsx(pt,{type:"icon-speed1"})}),an.jsx("div",{className:"action-button",onClick:()=>{!a&&o&&n(15)},children:an.jsx(pt,{type:"icon-speed"})}),(()=>{const t=an.jsxs("div",{className:"action-button dropdown-button",children:[an.jsx("span",{style:{letterSpacing:Fx()?"-1px":0},children:l}),an.jsx("span",{style:{marginLeft:2},children:"x"})]});return $x()?z.cloneElement(t,{onClick:()=>{a||kT.adapter.invoke({method:"openMediaRateWindow",params:{items:[.5,1,1.5,2],rate:e,id:s}})}}):an.jsx(OV,{disabled:a,playbackRate:e,menuData:RV,onChange:c,children:t})})(),an.jsx(vt,{title:r("Download the audio"),children:an.jsx("div",{className:"action-button",onClick:()=>{a||i()},children:an.jsx(pt,{type:"icon-line-download-02"})})})]})},LV=({track:e,autoplay:t=!1,messageStatus:n="normal",messageIdProp:i})=>{const{t:a}=$(),o=Ex(e=>e.mobile),[s,r]=A.useState({isPlaying:!1,currentTime:0,duration:0,volume:1,isMuted:!1,playbackRate:1}),[l,c]=A.useState(!1),[u,d]=A.useState(""),[h,p]=A.useState(!1),[m,f]=A.useState(""),g=zE(e=>e.theme),v=A.useRef(null),y=A.useRef(i||rt()),b=A.useRef("");A.useEffect(()=>{e.duration&&$x()&&r(t=>_(w({},t),{duration:Math.floor(e.duration/1e3)}))},[e.duration]);const x=A.useMemo(()=>u?"error":h?"loading":n,[u,h,n]),S=A.useMemo(()=>["error","generating"].includes(x),[x]),C=A.useMemo(()=>"dark"===g?"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/images/media-generating-dark.png":"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/images/media-generating-light.png",[g]),E=A.useMemo(()=>"dark"===g?"https://img.alicdn.com/imgextra/i3/O1CN01GYWLuG1uWfKs6epLG_!!6000000006045-55-tps-276-276.svg":"https://img.alicdn.com/imgextra/i4/O1CN01UDhh9L1lxqIMhagLd_!!6000000004886-55-tps-276-276.svg",[g]),k=A.useCallback((e,t={})=>{y.current&&kT.adapter.invoke({method:"controlAudioPlayer",params:{id:y.current,action:e,content:t}})},[]),I=A.useCallback(()=>r(e=>_(w({},e),{isPlaying:!0})),[]),T=A.useCallback(()=>r(e=>_(w({},e),{isPlaying:!1})),[]),j=A.useCallback(()=>r(e=>_(w({},e),{isPlaying:!1,currentTime:0})),[]),N=A.useCallback(()=>{v.current&&r(e=>_(w({},e),{currentTime:v.current.currentTime,duration:v.current.duration}))},[]),P=A.useCallback(()=>{v.current&&r(e=>_(w({},e),{volume:v.current.volume,isMuted:v.current.muted}))},[]),M=A.useCallback(()=>{var e;(null==(e=v.current)?void 0:e.duration)&&(r(e=>_(w({},e),{duration:Math.floor(v.current.duration)})),c(!0))},[]),O=e=>{S||($x()?k("seekTo",{position:e}):v.current&&l&&(v.current.currentTime=e,r(t=>_(w({},t),{currentTime:e}))))},R=t=>{var n;switch(t){case"resume":k("resume");break;case"play":k("play",{url:e.audioUrl,position:0,rate:null!=(n=s.playbackRate)?n:1,title:e.title})}};A.useEffect(()=>{const e=e=>{const{status:t,id:n,content:i}=e||{};if(n===y.current)switch(b.current=t,t){case"ready":c(!0),p(!1),r(e=>_(w({},e),{duration:Math.floor((null==i?void 0:i.duration)||0),isPlaying:!0}));break;case"position":r(e=>_(w({},e),{currentTime:(null==i?void 0:i.position)||0}));break;case"resumed":c(!0),p(!1),r(e=>_(w({},e),{isPlaying:!0}));break;case"paused":T();break;case"ended":case"stopped":r(e=>_(w({},e),{isPlaying:!1,currentTime:0}));break;case"error":f(a("Playback failed. Please try again")),d("error")}},n=({rate:e,id:t})=>{t===y.current&&r(t=>_(w({},t),{playbackRate:e||1}))},i=({id:e})=>{e!==y.current&&(T(),v.current&&v.current.pause())};if($x())return kT.on(fE.MESSAGE_AUDIO_PLAYBACK_CHANGED,e),kT.on(fE.MESSAGE_AUDIO_PLAYBACK_RATE_CHANGED,n),()=>{k("stop"),kT.off(fE.MESSAGE_AUDIO_PLAYBACK_CHANGED,e),kT.off(fE.MESSAGE_AUDIO_PLAYBACK_RATE_CHANGED,n)};if(v.current){const e=v.current;return e.addEventListener("loadedmetadata",M),e.addEventListener("loadeddata",M),e.addEventListener("timeupdate",N),e.addEventListener("play",I),e.addEventListener("pause",T),e.addEventListener("ended",j),e.addEventListener("volumechange",P),kT.on(dE.MESSAGE_PODCAST_AUDIO_PLAY_START,i),t&&e.play().catch(console.error),()=>{e.removeEventListener("loadedmetadata",M),e.removeEventListener("loadeddata",M),e.removeEventListener("timeupdate",N),e.removeEventListener("play",I),e.removeEventListener("pause",T),e.removeEventListener("ended",j),e.removeEventListener("volumechange",P),kT.off(dE.MESSAGE_PODCAST_AUDIO_PLAY_START,i)}}},[t,M,j,T,I,N,P,k,a]);return an.jsxs("div",{className:Y("audio-tool-player",x,{disabled:S}),children:[an.jsxs("div",{className:"audio-info",children:[an.jsx("div",{className:"cover-container",children:"error"===x?an.jsx(pt,{type:o?"icon-line-code-failed":"icon-line-Podcast-failed",className:"!text-24 podcast-icon podcast-icon-failed"}):"paused"===x?an.jsx(pt,{type:o?"icon-line-code":"icon-line-Podcast-loading",className:"!text-24 podcast-icon podcast-icon-paused"}):"generating"===x?an.jsxs(an.Fragment,{children:[an.jsx("img",{src:"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/images/line-podcast.png",alt:"cover",className:"cover-img-icon"}),an.jsx("img",{src:C,alt:"cover",className:"cover-img"})]}):an.jsx("img",{src:E,alt:"cover",className:"cover-img"})}),an.jsxs("div",{className:"audio-tool-details",children:[S?an.jsxs("div",{className:"skeleton-container",children:[an.jsx(Ct,{className:"timestamp-skeleton",style:{height:20,width:"100%",marginBottom:"0.5rem"}}),an.jsx(Ct,{className:"timestamp-skeleton",style:{height:20,width:"100%"}})]}):an.jsx("h3",{className:"audio-tool-details-text",children:e.title}),an.jsx("div",{className:"time-info",children:S?an.jsx(Ct,{className:"timestamp-skeleton",style:{width:88,height:18}}):`${PV(s.currentTime)} / ${PV(s.duration)}`})]}),an.jsx("div",{className:Y("play-button-container",{disabled:!l&&!$x()}),children:an.jsx("button",{className:"play-button",onClick:()=>{if(!S)if($x()){if(s.isPlaying)return void k("pause",{position:s.currentTime});if("position"===b.current)return void R(l?"resume":"play");if("paused"===b.current)R("resume");else R("play"),p(!0)}else l&&v.current&&(s.isPlaying?v.current.pause():(v.current.play(),kT.emit(dE.MESSAGE_PODCAST_AUDIO_PLAY_START,{id:y.current})))},children:an.jsx(pt,{type:s.isPlaying?"icon-play":"icon-pause",className:"play-button-icon"})})})]}),"generating"===x&&an.jsx("div",{className:"generate-text info",children:a("Youll be informed immediately upon completion.")}),"error"===x&&an.jsx("div",{className:"generate-text error",children:m||a("Generation failed. Please try again.")}),an.jsx(AV,{currentTime:s.currentTime,duration:s.duration,onProgressChange:e=>{const t=Math.floor(e/100*s.duration);O(t)},disabled:S||!l,loading:"loading"===x}),an.jsxs("div",{className:"bottom-section",children:[S?an.jsx(Ct,{className:"timestamp-skeleton",style:{width:88,height:18}}):an.jsx("div",{className:"timestamp",children:e.timestamp}),an.jsx("div",{className:"actions-container",children:an.jsx(DV,{playbackRate:s.playbackRate,onPlaybackRateChange:e=>{$x()?k("setRate",{rate:e}):v.current&&(v.current.playbackRate=e),r(t=>_(w({},t),{playbackRate:e}))},disabled:S,ready:l,messageId:y.current,onTimeChange:e=>O(s.currentTime+e),onDownload:()=>{yC({url:e.audioUrl,role:"assistant"})}})})]}),!$x()&&an.jsx("audio",{ref:v,src:e.audioUrl,preload:"metadata"})]})},FV=({message:e,messageLoading:t})=>{var n,i,a;const o=A.useMemo(()=>!t&&(null==e?void 0:e.id)||(null==e?void 0:e.error)?(null==e?void 0:e.error)||!(null==e?void 0:e.content)?"error":(null==e?void 0:e.done)&&!(null==e?void 0:e.is_stop)?"normal":(null==e?void 0:e.is_stop)?"paused":"generating":"generating",[e,t]);return an.jsx(LV,{messageStatus:o,messageIdProp:(null==e?void 0:e.id)||"",track:{title:null==(i=null==(n=null==e?void 0:e.extra)?void 0:n.aipodcast)?void 0:i.topic,audioUrl:null==e?void 0:e.content,timestamp:(s=null==e?void 0:e.timestamp,s?Q(1e3*s).format("DD/MM/YYYY HH:mm"):""),duration:null==(a=null==e?void 0:e.extra)?void 0:a.duration}});var s},zV=e=>{var t,n,i,a,o,s,r;const{message:l,podcastAsyncLoading:c,setPodcastAsyncLoading:u,onMediaError:d}=e,h=vx(e=>e.chatId),p=vx(e=>e.currentInputFeature),{i18n:m}=$(),f=Ex(e=>e.mobile),g=Ex(e=>e.config),v=zE(e=>e.realTheme),y=zE(e=>e.isSharePage),b=vx(e=>e.setIsChat),x=Sx(e=>e.setVisionGenerating),S=Sx(e=>e.setTaskRunning),C=Sx(e=>e.temporaryChatEnabled),[E,k]=A.useState(!1),[I,T]=A.useState(!1),[N,P]=A.useState(NV(l).width||0),[M,O]=A.useState(NV(l).height||0),[R,D]=A.useState(""),[L,F]=A.useState(0),z=A.useRef(null),U=A.useRef(!1),H=A.useRef(!1),B=A.useRef(void 0),q=A.useRef(void 0),G=A.useRef(0),V=A.useRef(0),W=A.useRef(0),Q=A.useMemo(()=>{var e;const t=!!(null==(e=l.content_list)?void 0:e.find(e=>[og.IMAGE_GEN].includes(e.phase)));return[ng.ImageGeneration,ng.ImageEdit].includes(l.chat_type)||t},[l.chat_type,l.content_list]),K=A.useMemo(()=>l.chat_type===ng.VideoGeneration,[l.chat_type]),Y=A.useMemo(()=>K?5:10,[K]),X=A.useMemo(()=>{var e,t;return l.sub_chat_type===ng.Podcast||(null==(t=null==(e=null==l?void 0:l.extra)?void 0:e.meta)?void 0:t.subChatType)===ng.Podcast},[l.sub_chat_type,null==l?void 0:l.extra]),J=A.useMemo(()=>{var e,t,n;return(null==(n=null==(t=null==(e=l.content_list)?void 0:e.findLast)?void 0:t.call(e,e=>e.phase===og.IMAGE_GEN&&!!e.content))?void 0:n.content)||l.content},[l.content,l.content_list]),Z=A.useMemo(()=>{const e=Fx()?450:320,t=`x-oss-process=image/resize,m_mfit,w_${e},h_${e}`;return J?J.includes("qwen-webui")?J:`${J}${J.includes("?")?"&":"?"}${t}`:""},[J]),ee=A.useMemo(()=>K?f?{width:[114,300],height:[126,380]}:[400,448]:f?{width:[114,300],height:[126,380]}:[133,400],[K,f]),te=A.useMemo(()=>{var e;if(y)return["download"];if(UT()||C)return Q?["video","edit","download"]:["download"];if(Q||K){const t=Q?["video","edit","download","share"]:["download","share"];return(null==(e=null==g?void 0:g.function_entry)?void 0:e.community)&&t.push("publish"),t}return["download","share"]},[null==(t=null==g?void 0:g.function_entry)?void 0:t.community,p,Q,K,y,C]),ne=TG({mediaType:Q?"image":"video",messageId:l.id||"",preview:{actions:te,tip:R}}),ie=A.useMemo(()=>{if(!J)return{iconUrl:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/images/${Q?"image":"video"}-generating-icon.png`,skeletonUrl:`//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/static/images/media-generating-${v}.png`,percent:L}},[Q,v,J,L]),ae=A.useCallback(()=>{null==d||d();let e=(Q?"Image":"Video")+" Load Error";return E?e="Generate Error":I&&(e="The current content is empty, please regenerate."),{errorMessage:m.t(e)}},[m,I,E,Q,d]),oe=A.useCallback(e=>{if(e.currentTarget){const{naturalWidth:t,naturalHeight:n}=e.currentTarget;P(t),O(n),e.currentTarget.removeEventListener("load",oe)}},[]),se=A.useCallback((e,t)=>{kT.updateMessage(e,t)},[]),re=A.useCallback(({status:e,content:t})=>{var n,i,a,o;const s={};"error"===e&&(s.error=t.error),s.content=(null==t?void 0:t.content)||"",s.chat_type=(null==t?void 0:t.chat_type)||p,s.done=!0;const r=(null==t?void 0:t.duration)||0;let c=w(w({},l),s);const u=(null==(i=null==(n=null==c?void 0:c.extra)?void 0:n.meta)?void 0:i.subChatType)?{meta:{subChatType:c.extra.meta.subChatType},duration:r}:{duration:r};c=_(w({},c),{extra:At({},(null==c?void 0:c.extra)||{},u)}),kT.updateChatInfo({id:h,status:"finished",subChatType:(null==(o=null==(a=null==l?void 0:l.extra)?void 0:a.meta)?void 0:o.subChatType)||l.sub_chat_type}),kT.updateMessage(l.id,c)},[l,h,p]),le=A.useCallback((e,t)=>{var n;u(!1),k(!0),S(!1);const i=e||{},a=null==i?void 0:i.detail,o=null!=(n=null==l?void 0:l.selectedModelId)?n:l.model,s=(null==a?void 0:a.info)||(null==a?void 0:a.content),r=_(w({},i),{error:!0,content:m.t("Oops! There was an issue connecting to {{provider}}.",{provider:o})+(s?"\n"+m.t(s):"")});"error"===(null==a?void 0:a.type)&&(r.error={content:(null==r?void 0:r.content)||(null==a?void 0:a.info),errorMessage:null==a?void 0:a.info,errorCode:null==a?void 0:a.content}),re({status:"error",content:r}),se(t,{done:!0})},[m,null==l?void 0:l.selectedModelId,l.model,S,k,re,se]),ce=A.useCallback((e,t)=>{if(!U.current&&!H.current){const i=xE.getChatByChatId(h||"");U.current=!0,(n={task_id:t},j(void 0,null,function*(){const{task_id:e}=n;return yield ow(`/tasks/status/${e}`,{baseURL:"/api/v1",method:"GET"})})).then(n=>{var a,o;if(clearTimeout(B.current),H.current)return void(U.current=!1);const s=null==(a=n.data)?void 0:a.task_status;"running"===s?B.current=setTimeout(()=>{ce(e,t)},Q?3e3:1e4):"success"===s?(u(!1),x(!1),S(!1),re({status:"done",content:null==n?void 0:n.data}),se(e,{done:!0,content:(null==(o=n.data)?void 0:o.content)||""})):le(null==n?void 0:n.data,e),x("running"===s),i&&(i.isChat="running"===s),U.current=!1}).catch(n=>{clearTimeout(B.current),G.current+=1,G.current>=Y?(le(null==n?void 0:n.data,e),x(!1),i&&(i.isChat=!1),U.current=!1):B.current=setTimeout(()=>{ce(e,t)},Q?3e3:1e4)}).finally(()=>{kT.shareHistory=null})}var n},[x,h,Q,S,re,se,le,Y,b]),ue=A.useCallback(()=>{q.current&&clearInterval(q.current),q.current=setInterval(()=>{let e=0;const t=+"360s".slice(0,-1),n=l.timestamp?Math.round(((new Date).getTime()-1e3*l.timestamp)/1e3):0;n&&(e=n<t?n:t-1);let i=e||n?(Math.round(e/t*1e4)/100).toFixed(0):0;+i>90?(clearInterval(q.current),i=99):e++,F(+i)})},[l.timestamp]),de=A.useMemo(()=>{const e=z.current;return e?{width:e.getBoundingClientRect().width,height:e.getBoundingClientRect().height}:{width:0,height:0}},[z.current]);A.useEffect(()=>{const e=jV(z.current);return()=>{null==e||e.removeEventListener("load",oe)}},[oe]),A.useEffect(()=>{var e,t,n,i,a,o,s,r;const c=(null==(t=null==(e=null==l?void 0:l.extra)?void 0:e.wanx)?void 0:t.task_id)||(null==(i=null==(n=null==l?void 0:l.extra)?void 0:n.aipodcast)?void 0:i.task_id),d=l.id||l.fid||"";y||!c||J||((null==(o=null==(a=null==l?void 0:l.extra)?void 0:a.aipodcast)?void 0:o.task_id)&&u(!0),x(!0),kT.updateChatInfo({id:h,status:"running",subChatType:(null==(r=null==(s=null==l?void 0:l.extra)?void 0:s.meta)?void 0:r.subChatType)||l.sub_chat_type}),ce(d,c),ue());const p=B.current,m=q.current;return()=>{clearTimeout(p),clearInterval(m)}},[y,null==(i=null==(n=null==l?void 0:l.extra)?void 0:n.wanx)?void 0:i.task_id,null==l?void 0:l.fid,null==l?void 0:l.id,ce,J,null==(o=null==(a=null==l?void 0:l.extra)?void 0:a.aipodcast)?void 0:o.task_id,x,null==l?void 0:l.extra,l.sub_chat_type,h,ue]),A.useEffect(()=>{var e;const{width:t,height:n}=NV(l);if(t&&n){const a=null==(e=l.content_list)?void 0:e.find(e=>{var t,n;return e.phase===og.IMAGE_GEN&&(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.output_image_hw)?void 0:n[0])});z.current&&a&&(i=z.current,j(void 0,null,function*(){const e=jV(i);if(e){const t=e.src,n="x-oss-process=image/resize";if(t.includes(n)){const e=t.indexOf(n)-1;return yield new Promise(n=>{const i=new Image;i.onload=()=>{n({naturalWidth:i.naturalWidth,naturalHeight:i.naturalHeight})},i.onerror=()=>{n({naturalWidth:0,naturalHeight:0})},i.src=t.slice(0,e)})}{const{naturalWidth:t,naturalHeight:n}=e;return{naturalWidth:t,naturalHeight:n}}}})).then(e=>{e&&(e.naturalWidth>t||e.naturalHeight>n)&&D(m.t("The input image was too high in resolution, so the edited image has been downscaled."))}),P(t),O(n)}else if(l.chat_type===ng.ImageEdit&&z.current){const e=jV(z.current);if(e){const{naturalWidth:t,naturalHeight:n}=e;t&&n?(P(t),O(n)):(e.removeEventListener("load",oe),e.addEventListener("load",oe))}}var i},[m,l,l.chat_type,l.content_list,null==(s=null==l?void 0:l.info)?void 0:s.size,oe]),A.useEffect(()=>{if(l.done&&!J&&Q)k(!0);else if(y&&!J){const e=l.id||l.fid||"";T(!0),se(e,{done:!0})}},[Q,y,null==l?void 0:l.done,null==l?void 0:l.fid,null==l?void 0:l.id,se,J]),A.useEffect(()=>{k(!1),T(!1),D(""),F(0)},[l.fid]),A.useEffect(()=>(V.current=GS(),()=>{H.current=!0}),[]);const he=A.useCallback((e,t,n)=>{dS("messageImgOnLoadTime",{params:{et:"OTHER",c4:h||"",c5:"answer",c6:n,c7:Math.round(e),c8:Math.round(t),c9:Math.round(t-e)}})},[h]);return an.jsxs("div",{ref:z,className:"chat-response-media-render",children:[Q&&an.jsx(Ne,_(w({url:J,thumbnailUrl:Z,defaultWidth:1,defaultHeight:1,width:N,height:M,sizeScope:ee,generation:ie,error:E||I,onError:ae},l.isShare?{}:ne),{onLoad:()=>{W.current=GS(),he(V.current,W.current,J)}})),K&&an.jsx(NG,{url:J,generation:ie,error:E||I,mediaProps:ne,onError:ae,ratio:(null==(r=null==l?void 0:l.info)?void 0:r.size)||"",containerWidth:de.width,messageType:"answer"}),X&&an.jsx(FV,{message:l,messageLoading:c})]})},UV=e=>{const{message:t}=e,n=Sx(e=>e.taskRunning),i=A.useRef(null),a=A.useRef(t),o=A.useCallback(()=>{var e,t;return(null==(e=a.current)?void 0:e.error)?"error":(null==(t=a.current)?void 0:t.done)?"done":n?"loading":"pause"},[n]),s=A.useCallback(e=>j(void 0,null,function*(){var t,n,r,l,c;if(!a.current)return;const{type:u,contentIndex:d}=e,h=o(),p=!!(null==(n=null==(t=a.current)?void 0:t.feature_config)?void 0:n.thinking_enabled);let m=[];if(void 0!==d&&u===ag.WebSearch)m=(null==(c=null==(l=null==(r=a.current.content_list)?void 0:r[d])?void 0:l.extra)?void 0:c.web_search_info)||[];else{const e=kT.collectAllSearchAndThinList([a.current],!1);m=u===ag.WebSearch?e[a.current.id||""].webSearchInfo||[]:e[a.current.id||""].contentList||[]}TI(ag.Artifacts),kT.adapter.invoke({method:"storeInfo",params:{key:TI([ag.ThinkingAndSearch,ag.Thinking].includes(u)?ag.Thinking:ag.WebSearch),value:JSON.stringify({originsList:m,type:u,currentId:a.current.id,status:h})}}),clearTimeout(i.current),"loading"===h&&p&&(i.current=setTimeout(()=>{s(e)},1e3))}),[o]),r=A.useCallback(e=>{const{type:t,currentTab:n,citationIndex:i}=e;s(e),kT.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",content:`${jI(t)}?tab=${n}&citation_index=${i}`}})},[s]);return A.useEffect(()=>()=>{clearTimeout(i.current)},[]),A.useEffect(()=>{a.current=t},[t]),{openNativePopup:r}},HV=e=>{switch(e.toLowerCase()){case"javascript":return".js";case"typescript":return".ts";case"java":return".java";case"python":return".py";case"c":return".c";case"c++":case"cpp":return".cpp";case"c#":case"csharp":return".cs";case"go":return".go";case"rust":return".rs";case"php":return".php";case"ruby":return".rb";case"swift":return".swift";case"kotlin":return".kt";case"scala":return".scala";case"html":return".html";case"css":return".css";case"less":return".less";case"scss":return".scss";case"json":return".json";case"markdown":case"md":return".md";case"xml":return".xml";case"yaml":return".yaml";case"sql":return".sql";case"bash":case"sh":return".sh";case"perl":return".pl";case"r":return".r";case"matlab":case"objective-c":case"objc":return".m";case"dart":return".dart";case"lua":return".lua";case"groovy":return".groovy";case"typescript-definition":case"d.ts":return".d.ts";case"vue":return".vue";case"svelte":return".svelte";case"jsx":return".jsx";case"tsx":return".tsx";case"dockerfile":return"Dockerfile";case"makefile":return"Makefile";case"gitignore":return".gitignore";case"editorconfig":return".editorconfig";case"eslintconfig":case"eslintrc":return".eslintrc";case"prettierconfig":case"prettierrc":return".prettierrc";case"babelconfig":case"babelrc":return".babelrc";case"webpackconfig":return"webpack.config.js";case"jestconfig":return"jest.config.js";case"viteconfig":return"vite.config.js";case"nextconfig":return"next.config.js";case"angularconfig":case"angularconfigts":return"angular.json";case"reactconfig":return"react.config.js";case"vueconfig":return"vue.config.js";case"svelteconfig":return"svelte.config.js";case"gulpfile":return"gulpfile.js";case"gruntfile":return"Gruntfile.js";case"npmconfig":case"package.json":return"package.json";case"yarnconfig":case"yarn.lock":return"yarn.lock";case"bowerconfig":case"bower.json":return"bower.json";case"webpackconfigts":return"webpack.config.ts";case"jestconfigts":return"jest.config.ts";case"viteconfigts":return"vite.config.ts";case"nextconfigts":return"next.config.ts";case"reactconfigts":return"react.config.ts";case"vueconfigts":return"vue.config.ts";case"svelteconfigts":return"svelte.config.ts";case"gulpfilets":return"gulpfile.ts";case"gruntfilets":return"Gruntfile.ts";default:return".txt"}},BV=(e,t,n)=>{const i=Q().format("YYYYMMDD"),a=Math.random().toString(36).substr(2,9),o=HV(n)||".txt",s=`${t}_${n}_${i}_${a}${o}`,r=new Blob([e],{type:`text/${o.replace(/^\./,"")}`}),l=window.URL.createObjectURL(r),c=document.createElement("a");c.href=l,c.download=s,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(l)},$V={markdownTokens:"index-module__markdown-tokens___CveLB",markdownTokensHostname:"index-module__markdown-tokens-hostname___u1uxj",markdownTokensHostnameMore:"index-module__markdown-tokens-hostname-more___2vfOB",markdownTokensContainer:"index-module__markdown-tokens-container___e9KzF",markdownTokensContainerHostname:"index-module__markdown-tokens-container-hostname___eG8Zu",markdownTokensContainerIcon:"index-module__markdown-tokens-container-icon___ngxko",markdownTokensContainerTitle:"index-module__markdown-tokens-container-title___RBM-t",markdownTokensContainerDetail:"index-module__markdown-tokens-container-detail___kKNDk"},qV=z.memo(e=>{var t;const{className:n="",hostList:i=[],onClick:a=()=>{},onHostNameClick:o=()=>{}}=e,s=Ex(e=>e.mobile),[r,l]=A.useState(!1),c=A.useRef(null),u=A.useMemo(()=>(null==i?void 0:i.length)>1,[i]),[d,h]=A.useState(0),p=A.useCallback(e=>new URL((e||"").trim()).hostname||"",[]),m=A.useMemo(()=>{const e=i[d];return _(w({},e),{hostOriginName:p((null==e?void 0:e.url)||"")})},[d,p,i]),f=A.useCallback(e=>{let t="prev"===e?d-1:d+1;t<0&&(t=0),t>=i.length&&(t=i.length-1),h(t)},[d,i.length]),g=A.useMemo(()=>[{icon:"icon-line-chevron-left",disabled:0===d,onClick:()=>{f("prev")}},{icon:"icon-line-chevron-right",disabled:d===i.length-1,onClick:()=>{f("next")}}],[d,i.length,f]),v=A.useMemo(()=>{var e,t;return an.jsxs("div",{className:Y($V.markdownTokens,n),onClick:o,children:[an.jsx("div",{className:$V.markdownTokensHostname,children:(null==(e=i[0])?void 0:e.hostname)||p(null==(t=i[0])?void 0:t.url)}),u&&an.jsxs("div",{className:$V.markdownTokensHostnameMore,children:["+",i.length-1]})]})},[n,p,i,o,u]),y=A.useCallback(e=>{try{return decodeURIComponent(e)}catch(kX){return e}},[]);return A.useEffect(()=>{if(!r)return;const e=requestAnimationFrame(()=>{setTimeout(()=>{const e=c.current.popupElement;if(e){const t=20,n=((e,t=1)=>{if(!(e instanceof HTMLElement))return"none";const n=e.getBoundingClientRect(),i=n.left<=t,a=window.innerWidth-n.right<=t;return i?"left":a?"right":"none"})(e,t);if("none"===n)return;e.style.inset=e.style.inset.replace(/(\d+)px$/,(e,i)=>`${parseInt(i,10)+t*("right"===n?-1:1)}px`)}},0)});return()=>cancelAnimationFrame(e)},[r]),s?v:an.jsx(ne,{trigger:"hover",open:r,ref:c,onOpenChange:l,rootClassName:"qwen-chat-comp-markdown-tokens-container",content:an.jsxs("div",{className:$V.markdownTokensPopoverContent,children:[an.jsxs(X,{vertical:!0,gap:8,children:[an.jsxs(X,{align:"center",justify:"space-between",children:[an.jsxs(X,{align:"center",justify:"center",gap:4,children:[an.jsx(eV,{src:(null==(t=i[d])?void 0:t.icon)||""}),an.jsx("div",{className:$V.markdownTokensContainerHostname,children:m.hostname?m.hostname:y(m.url)})]}),an.jsx(pt,{className:$V.markdownTokensContainerIcon,type:"icon-line-arrow-up-right",onClick:()=>a(m.url)})]}),an.jsx("div",{className:$V.markdownTokensContainerTitle,children:m.title}),an.jsx("div",{className:$V.markdownTokensContainerDetail,children:m.description})]}),u&&an.jsxs("div",{className:"markdown-tokens-container-switch",children:[an.jsx("div",{className:"markdown-tokens-container-switch-left",children:g.map(e=>an.jsx("div",{className:Y("markdown-tokens-container-switch-container",{"markdown-tokens-container-switch-container-disabled":e.disabled}),onClick:e.onClick,children:an.jsx(pt,{className:"markdown-tokens-container-switch-icon",type:e.icon})},e.icon))}),an.jsxs("div",{className:"markdown-tokens-container-switch-right",children:[d+1,"/",i.length]})]})]}),arrow:!1,classNames:{root:$V.markdownTokensContainer},placement:"bottom",children:v})}),GV=e=>{var t,n;const{message:i,phaseContentIndex:a}=e,o=null==(t=i.content_list)?void 0:t[a],{i18n:s}=$(),{openNativePopup:r}=UV({message:i}),l=zE(e=>e.realTheme),c=Ex(e=>e.mobile),u=Sx(e=>e.setCurrentShowControl),d=vx(e=>e.setCurrentCitationInfo),h=zE(e=>e.setShowControls),p=zE(e=>e.setShowSharePanel),m=vx(e=>e.allSearchAndThinkLists),f=A.useMemo(()=>!i.done,[i.done]),g=A.useMemo(()=>{var e,t;if(Array.isArray(null==o?void 0:o.content))return"";let n=(null==o?void 0:o.content)||"";return Array.isArray(null==(e=null==o?void 0:o.extra)?void 0:e.prev_round_image_list)&&(n=(null==(t=null==o?void 0:o.extra)?void 0:t.prev_round_image_list.map(e=>`![](${e})`).join("\n"))+"\n"+n),n},[o]),v=TG({mediaType:"image",messageId:i.id}),y=A.useCallback(e=>j(void 0,null,function*(){(yield WS(e))&&ht.openOnce({type:"success",content:s.t("Copying to clipboard was successful!")})}),[s]),b=A.useCallback((e,t="")=>{const n=new Date,i=`Qwen_${t}_${`${n.getFullYear()}${String(n.getMonth()+1).padStart(2,"0")}${String(n.getDate()).padStart(2,"0")}`}_${Math.random().toString(36).slice(-9)}${HV(t)}`;Tx.saveAs(new Blob([e],{type:"text/plain;charset=utf-8"}),i)},[]),x=A.useMemo(()=>{var e;return!!(null==(e=null==i?void 0:i.feature_config)?void 0:e.thinking_enabled)},[null==(n=null==i?void 0:i.feature_config)?void 0:n.thinking_enabled]),S=A.useCallback(e=>{var t,n,a,o,s,l;if(i.chat_type===ng.DeepResearch){const r=null==(n=null==(t=null==kT?void 0:kT.getChatOptions())?void 0:t.history)?void 0:n.messages[(null==i?void 0:i.id)||""],c=null==(l=null==(s=null==(o=null==(a=null==r?void 0:r.content_list)?void 0:a.find(e=>e.phase===og.ANSWER))?void 0:o.extra)?void 0:s.deep_research)?void 0:l.references;p(!0),kT.emit(hE.SOURCE_CILCK,{Tab:Fe.sources,citationIndex:Number(e)||0,list:c})}else{if($x())return void r({type:x?ag.ThinkingAndSearch:ag.WebSearch,currentTab:Fe.sources,citationIndex:Number(e)});p(!0),h(!0),u(x?ag.ThinkingAndSearch:ag.WebSearch),d({messageId:i.id||"",citationIndex:Number(e),tab:Fe.sources})}},[i.chat_type,i.id,r,d,u,h,p,x]),C=A.useCallback((e=0)=>{$x()?r({type:ag.WebSearch,currentTab:Fe.sources,citationIndex:e}):(h(!0),u(ag.WebSearch),d({messageId:i.id||"",citationIndex:e,tab:Fe.sources}))},[i.id,r,d,u,h]),E=A.useMemo(()=>{var e;return(null==(e=null==m?void 0:m[(null==i?void 0:i.id)||""])?void 0:e.webSearchInfo)||[]},[m,null==i?void 0:i.id]),k=A.useMemo(()=>({code:{headerActionsRender:e=>an.jsxs(an.Fragment,{children:[an.jsx(vt,{title:s.t("Copy"),children:an.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>y(e.text),children:an.jsx(pt,{type:"icon-line-copy-right"})})}),!c&&an.jsx(vt,{title:s.t("Download"),children:an.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>b(e.text,e.lang),children:an.jsx(pt,{type:"icon-line-download-02"})})})]}),theme:l},codespan:{onClick:e=>j(void 0,[e],function*({text:e}){(yield WS(e))&&ht.openOnce({type:"success",content:s.t("Copying to clipboard was successful!")})})},image:w({sizeScope:c?{width:[114,300],height:[126,380]}:[400,448],onError:()=>({errorMessage:s.t("Image Load Error")})},v),table:{headerActionsRender:zx()?void 0:e=>an.jsx(an.Fragment,{children:an.jsx(xt,{placement:"bottomRight",menu:{items:[{key:"csv",label:an.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${i.id||""}.csv`;XS(e,t)},children:s.t("Export to CSV")})},{key:"excel",label:an.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${i.id||""}.xlsx`;JS(e,t)},children:s.t("Export to Excel")})}]},getPopupContainer:e=>e||document.body,children:an.jsx("div",{className:"qwen-markdown-table-header-action-item",children:an.jsx(pt,{type:"icon-line-download-02"})})})})},citation:{visible:!Pt(E),onClick:e=>S(e),contentRender:e=>{const t=e.map(e=>{if(!Array.isArray(E)||!E.length)return null;const t=E[Number(e)-1];if(!t)return null;const{snippet:n}=t;return _(w({},t),{description:n,hostIndex:e})}).filter(e=>e);return c?t.map(e=>an.jsx("div",{className:"qwen-markdown-citation-item",children:an.jsx(qV,{hostList:[e],onHostNameClick:()=>{C(Number(null==e?void 0:e.hostIndex)||0)}})},null==e?void 0:e.url)):t.length?an.jsx(qV,{hostList:t,onClick:e=>window.open(e)}):null}}}),[l,c,v,s,y,b,i.id,S,E,C]);return an.jsx("div",{className:"custom-qwen-markdown",children:an.jsx(ze,{content:g,loose:!["ja-JP","ko-KR","zh-CN","zh-TW"].includes(s.language),tokenProps:k,styleProps:{showAnimation:f}})})};var VV=(e=>(e.THINKING="THINKING",e.THINKING_AND_ANALYSING="THINKING_AND_ANALYSING",e.ANALYZING_IMAGE="ANALYZING_IMAGE",e.SEARCHING_WEB_PAGES="SEARCHING_WEB_PAGES",e.CALLING_CODE_INTERPRETER="CALLING_CODE_INTERPRETER",e.SEARCHING_MEMORIES="SEARCHING_MEMORIES",e.UPDATING_MEMORIES="UPDATING_MEMORIES",e.READING_SOURCES="READING_SOURCES",e.THINKING_COMPLETED="THINKING_COMPLETED",e))(VV||{}),WV=(e=>(e.PROCESS_STATE="PROCESS_STATE",e.RESULT_STATE="RESULT_STATE",e))(WV||{});const QV=z.memo(e=>{const{endTime:t,timestamp:n,loading:i}=e,[a,o]=A.useState(""),[s,r]=A.useState(Date.now()/1e3),l=A.useRef(null),c=A.useCallback(()=>{const e=Date.now()/1e3;r(e),window._currentTime=e,l.current=setInterval(()=>{const e=Date.now()/1e3;window._currentTime=e,r(e)},1e3)},[]),u=A.useCallback(()=>{l.current&&(clearInterval(l.current),l.current=null)},[]);A.useEffect(()=>(i?l.current||c():u(),()=>{u()}),[i,c,u]);const d=A.useCallback(e=>{let t=e;const n=Math.floor(t/36e5);t-=36e5*n;const i=Math.floor(t/6e4);t-=6e4*i;const a=Math.floor(t/1e3);return`${n?JSON.stringify(n)+"h":""}${i?JSON.stringify(i)+"m":""}${a?JSON.stringify(a)+"s":""}`},[]);return A.useEffect(()=>{if(i){if(void 0!==n){const e=d(1e3*Math.abs(s-n));o(e)}}else if(void 0!==t&&void 0!==n){const e=d(1e3*Math.abs(t-n));o(e)}},[t,n,i,s,d]),a&&(t||s)?an.jsx("span",{children:a}):null});var KV=(e=>(e.LOADING="LOADING",e.PAUSE="PAUSE",e.FINISHED="FINISHED",e.ERROR="ERROR",e))(KV||{});const YV=[{label:{process:"Thinking...",completed:"Thinking completed"},key:og.THINK,icon:"icon-fill-check-contained"},{label:{process:"Analyzing",completed:"Analyzed"},key:og.THINKING_SUMMARY,icon:"icon-fill-check-contained"},{label:{process:"Searching the web",completed:"Searched the web"},key:og.WEB_SEARCH,icon:"icon-line-globe-01"},{label:{process:"Running code interpreter",completed:"Code interpreter finished"},key:og.CODE_INTERPRETER,icon:"icon-line-code-01"},{label:{process:"Searching memory",completed:"Searched memory"},key:og.HISTORY_RETRIEVER,icon:"icon-line-brain-02"},{label:{process:"Updating memory",completed:"Updated memory"},key:og.BIO,icon:"icon-line-brain-02"},{label:{process:"Reading sources",completed:"Sources read"},key:og.WEB_EXTRACTOR,icon:"icon-fill-check-contained"}],XV=e=>{var t,n;const{i18n:i}=$(),[a,o]=A.useState(!0),s=A.useMemo(()=>{var t;return!(!Array.isArray(null==e?void 0:e.content_list)||!(null==e?void 0:e.content_list.length))&&(null==(t=e.content_list)?void 0:t.some(e=>[og.WEB_SEARCH].includes(e.phase)))},[e]),r=A.useMemo(()=>{if(!e)return[];const{content_list:t}=e;return Array.isArray(t)&&(null==t?void 0:t.length)?t:[]},[e]),l=A.useMemo(()=>{if(!e)return!1;const{feature_config:t}=e;return!!(null==t?void 0:t.thinking_enabled)},[e]),c=A.useMemo(()=>{if(!e)return"LOADING";const{error:t,is_stop:n}=e,i=null==r?void 0:r.some(({phase:e})=>e===og.ANSWER);return t?"ERROR":n?"PAUSE":i&&r&&(null==r?void 0:r.length)>1||e.done?"FINISHED":"LOADING"},[r,e]),u=A.useMemo(()=>{if(!(null==r?void 0:r.length))return null;const e=r.length-1;return r[e]},[r]),d=A.useMemo(()=>(null==u?void 0:u.phase)||"",[null==u?void 0:u.phase]),h=A.useMemo(()=>{var e;if(!(null==r?void 0:r.length))return"";const t=r.length-1;return(null==(e=r[t])?void 0:e.status)||"finished"},[r]),p=A.useMemo(()=>{var e,t,n,i,a,s;const r=YV.find(({key:e})=>e===d);if(!r)return"";const l="finished"===h;o(l);if(((null==(t=null==(e=null==u?void 0:u.extra)?void 0:e.summary_title)?void 0:t.content)||[]).length>0){const e=(null==(i=null==(n=null==u?void 0:u.extra)?void 0:n.summary_title)?void 0:i.content)||[],t=e[e.length-1]||r.label.process;return l?r.label.completed:t}if(d===og.ANSWER){const e=(null==(s=null==(a=null==u?void 0:u.extra)?void 0:a.summary_title)?void 0:s.content)||[],t=e[e.length-1]||"";return l?t:r.label.process}return l?r.label.completed:r.label.process},[d,h,null==(n=null==(t=null==u?void 0:u.extra)?void 0:t.summary_title)?void 0:n.content]),m=A.useMemo(()=>{var t;let n="",a=c;switch((null==(t=null==e?void 0:e.content_list)?void 0:t.some(e=>e.phase===og.ANSWER))&&"PAUSE"===c&&(a="FINISHED"),a){case"LOADING":n=p,n||(n=l?"Thinking...":"Searching...");break;case"PAUSE":l&&s?n="Thinking and Searching Stopped":l?n="Thinking stopped":s&&(n="Search web stopped");break;case"FINISHED":l&&s?n="Thinking and Searching Completed":l?n="Thinking completed":s&&(n="Search web Completed");break;case"ERROR":l&&s?n="Thinking and Search Failed":l?n="Thinking Failed":s&&(n="Search web pages failed");break;default:n=""}return i.t(n)},[p,i,e,c,s,l]);return A.useEffect(()=>{o("LOADING"!==c)},[c]),{chatStatusTitle:m,isFinished:a}};var JV=(e=>(e.LOADING="LOADING",e.THINKING="THINKING",e.CHAT_STOPED="CHAT_STOPED",e.THINKING_STOPED="THINKING_STOPED",e.FINISHED="FINISHED",e.ERROR="ERROR",e))(JV||{});const ZV=z.memo(e=>{var t;const{message:n}=e,i=$(),a=Ex(e=>e.mobile),o=zE(e=>e.setShowControls),s=Sx(e=>e.currentShowControl),r=Sx(e=>e.setCurrentShowControl),l=Sx(e=>e.setCurrentActionMessageId),c=Sx(e=>e.setLocateTheSearchSource),u=Sx(e=>e.currentActionMessageId),{openNativePopup:d}=UV({message:n}),h=vx(e=>e.setCurrentCitationInfo),{chatStatusTitle:p,isFinished:m}=XV(n),{timestamp:f,content_list:g=[]}=n,v=A.useMemo(()=>{if(!Array.isArray(g)||!g.length)return[];let e=[];return g.forEach(({phase:t,extra:n})=>{t===og.WEB_SEARCH&&(e=[...e,...(null==n?void 0:n.web_search_info)||[]])}),e},[g]),y=A.useMemo(()=>{if(!Array.isArray(null==n?void 0:n.content_list)||!(null==n?void 0:n.content_list.length))return KV.LOADING;const{error:e,is_stop:t,content_list:i}=n,a=null==i?void 0:i.some(({phase:e})=>e===og.ANSWER);return e?KV.ERROR:t?KV.PAUSE:a&&i&&(null==i?void 0:i.length)>1||n.done?KV.FINISHED:KV.LOADING},[n]),b=A.useMemo(()=>{var e;return!!(null==(e=null==n?void 0:n.feature_config)?void 0:e.thinking_enabled)},[null==(t=null==n?void 0:n.feature_config)?void 0:t.thinking_enabled]),x=A.useMemo(()=>!(!Array.isArray(g)||!g.length)&&!(!b&&!v.length),[g,v.length,b]),w=A.useMemo(()=>{var e,t;return!(!Array.isArray(null==n?void 0:n.content_list)||!(null==(e=null==n?void 0:n.content_list)?void 0:e.length))&&(null==(t=n.content_list)?void 0:t.every(e=>e.phase===og.ANSWER))},[n.content_list]),_=A.useMemo(()=>s===ag.ThinkingAndSources&&u&&u===n.id,[u,s,n.id]),S=A.useMemo(()=>{var e;return null==(e=n.content_list)?void 0:e.some(e=>[og.WEB_SEARCH].includes(e.phase))},[n.content_list]),C=A.useMemo(()=>y!==KV.LOADING&&!b&&S,[y,S,b]),E=A.useMemo(()=>{var e,t;const i=EI.getState().models,a=vx.getState().history,o=i.find(e=>e.id===n.model),s=null==a?void 0:a.messages[(null==n?void 0:n.parentId)||""];if(!o||!s)return!1;const{enable:r=!1,support_files:l=[]}=(null==(t=null==(e=null==o?void 0:o.info)?void 0:e.meta)?void 0:t.think_skip)||{},c=((null==s?void 0:s.files)||[]).map(e=>e.type);return r&&c.every(e=>l.includes(e))},[n.model,null==n?void 0:n.parentId]),k=A.useCallback(e=>{if(x||C){if(e){if($x()){let e=b?ag.Thinking:ag.WebSearch;return b&&S&&(e=ag.ThinkingAndSearch),void d({type:e,currentTab:Fe.step})}return o(!0),!b&&a?(r(ag.WebSearch),void h({messageId:n.id||"",citationIndex:0,tab:Fe.sources})):(r(ag.ThinkingAndSources),void l(null==n?void 0:n.id))}o(!1),r(ag.None),c(!1),l("")}},[x,n.id,a,d,S,C,l,h,r,c,o,b]);A.useMemo(()=>C||v.length?`${v.length} ${i.t("Sources")}`:null,[i,C,v.length]);const I=A.useRef(void 0);A.useMemo(()=>{var e,t,i;if(!b)return null;if(!f)return null;const a=(null==n?void 0:n.error)||(null==n?void 0:n.done)||(null==n?void 0:n.is_stop);let o;const s=(null==(e=null==n?void 0:n.content_list)?void 0:e.findIndex(({phase:e})=>e===og.ANSWER))||-1,r=s>0;r&&!I.current&&(o=(null==(i=null==(t=null==n?void 0:n.content_list)?void 0:t[s-1])?void 0:i.timestamp)||Date.now()/1e3,I.current=o),I.current&&(o=I.current);const l=!r&&!a;return l||f&&o?an.jsx(QV,{timestamp:f,endTime:o,loading:l}):null},[null==n?void 0:n.content_list,null==n?void 0:n.done,null==n?void 0:n.error,null==n?void 0:n.is_stop,b,f]);const T=(e=>A.useMemo(()=>{var t;if(!e)return"LOADING";const{error:n,is_stop:i}=e,a=Array.isArray(null==e?void 0:e.content_list)?null==e?void 0:e.content_list:[],o=null==a?void 0:a.some(({phase:e})=>e===og.ANSWER);return n?"ERROR":i?"CHAT_STOPED":o&&a&&(null==a?void 0:a.length)>1||e.done?"FINISHED":e&&(null==e?void 0:e.content_list)&&0!==(null==(t=null==e?void 0:e.content_list)?void 0:t.length)&&!o&&(null==a?void 0:a.length)>0?"THINKING":"LOADING"},[e]))(n),j=e=>{k(!1),kT.stopThinkingPhase(n.id)};return a?an.jsx("div",{className:"qwen-chat-mobile-chat-status-card",children:an.jsxs(X,{align:"center",justify:"space-between",gap:16,className:"qwen-chat-mobile-chat-status-card-top",children:[an.jsxs(X,{gap:4,align:"center",className:"qwen-chat-mobile-chat-status-title",onClick:()=>{k(!_)},children:[an.jsx(pt,{className:"qwen-chat-mobile-chat-status-before-icon",type:b?"icon-line-lightbulb-031":"icon-line-globe-01"}),an.jsx("div",{className:Y("qwen-chat-mobile-chat-status-label",{"qwen-chat-mobile-chat-status-label-animate":!m}),children:p}),x&&!w?an.jsx(pt,{className:"qwen-chat-mobile-chat-status-after-icon",type:"icon-line-chevron-right"}):null]}),T===JV.THINKING&&E&&b&&an.jsx("div",{className:"qwen-chat-mobile-chat-status-answer-now",onClick:j,children:i.t("Skip")})]})}):an.jsxs(X,{className:"qwen-chat-status-card",align:"center",justify:"space-between",gap:16,children:[an.jsxs(X,{align:"center",gap:8,onClick:()=>{k(!_)},children:[an.jsx(pt,{className:"qwen-chat-status-card-before",type:b?"icon-line-lightbulb-031":"icon-line-globe-01"}),an.jsx("div",{className:Y("qwen-chat-status-card-title",{"qwen-chat-status-card-title-animate":!m}),children:p}),x&&!w||C?an.jsx(pt,{className:"qwen-chat-status-card-after",type:"icon-line-chevron-right"}):null]}),T===JV.THINKING&&E&&b&&an.jsx("div",{className:"qwen-chat-status-card-answer-now",onClick:j,children:i.t("Skip")})]})}),eW=ZG(e=>{var t,n,i,a,o;const{message:s,phaseContentIndex:r=-1}=e,l=function(e){const t=A.useRef(e);return A.useEffect(()=>{t.current=e},[e]),t}(s),c=A.useMemo(()=>{var e;return!!(null==(e=null==s?void 0:s.feature_config)?void 0:e.thinking_enabled)},[null==(t=null==s?void 0:s.feature_config)?void 0:t.thinking_enabled]),u=A.useMemo(()=>{var e;return null==(e=s.content_list)?void 0:e.some(e=>[og.THINK,og.WEB_SEARCH].includes(e.phase))},[s.content_list]),d=null==s?void 0:s.id,h=null!=(i=null==(n=null==s?void 0:s.content_list)?void 0:n.length)?i:0;A.useEffect(()=>{if(!l.current)return;kT.collectAllSearchAndThinList([l.current]);const e=()=>{kT.collectAllSearchAndThinList(l.current?[l.current]:[])};return yE.on(uE.CHAT_SSE_PROCESS,e),()=>{yE.off(uE.CHAT_SSE_PROCESS,e)}},[d,h]);const p=A.useMemo(()=>{var e,t;return!(!Array.isArray(null==s?void 0:s.content_list)||!(null==(e=null==s?void 0:s.content_list)?void 0:e.length))&&(null==(t=s.content_list)?void 0:t.every(e=>e.phase===og.ANSWER))},[s.content_list]),m=A.useMemo(()=>null==s?void 0:s.is_stop_in_thinking,[null==s?void 0:s.is_stop_in_thinking]),f=A.useMemo(()=>{var e,t,n;return(null==(t=null==(e=null==s?void 0:s.feature_config)?void 0:e.mcp)?void 0:t.length)||(null==(n=null==s?void 0:s.feature_config)?void 0:n.local_mcp)},[null==(a=null==s?void 0:s.feature_config)?void 0:a.local_mcp,null==(o=null==s?void 0:s.feature_config)?void 0:o.mcp]);return!u&&!c||-1!==r||p||m||f?null:an.jsx(ZV,{message:s})}),tW={"zh-cht":"",zh:"",en:"Research Planning",fr:"Planification de la recherche",de:"Forschungsplanung",it:"Pianificazione della ricerca",ja:"",ko:" ",pt:"Planeamento da Pesquisa",ar:"Planning for research",ru:" ",es:"Planificacin de la investigacin"},nW={"zh-cht":"",zh:"",en:"Summary",fr:"Rsum",de:"Zusammenfassung",it:"Riepilogo",ja:"",ko:"",pt:"Resumo",ar:"",ru:"     ().",es:"Resumen"},iW=(e,t,n)=>n?`${n} \n`:"";function aW(e,t){const n=[];return t.forEach(t=>{Object.prototype.hasOwnProperty.call(e,t)&&n.push(e[t])}),n}function oW(e,t){var n;return(null==(n=null==e?void 0:e.scrape)?void 0:n.map(e=>t[e]))||[]}const sW=["researchGoal","pageContent","codeContent","searchContent","webSites","learnings","learningMap"],rW=(e,t)=>{const n=[...e],i="v4"===t?"researchGoal":"searchContent",a=n.indexOf(i);return-1!==a&&n.splice(a+1,0,"webSites"),n},lW=e=>{var t,n,i,a,o,s;const r=[],l=null!=(n=null==(t=null==e?void 0:e[0])?void 0:t.lang_code)?n:"en",c=null!=(s=null==(o=null==(a=null==(i=null==e?void 0:e[0])?void 0:i.extra)?void 0:a.deep_research)?void 0:o.version)?s:"v1";for(let d=0;d<e.length;d++){const t=e[d],{phase:n,status:i,content:a,extra:o}=t,{deep_research:s,travel_research:u}=o||{},h=s||u;switch(n){case pg.ResearchPlanning:r.push({stage:n,title:(null==h?void 0:h.title)||(null==tW?void 0:tW[l])||n,content:iW(0,null==h||h.id,a),status:"finished"===i?"finish":"process",id:(null==h?void 0:h.id)||n,phase:n});break;case og.INTERRUPTRECEIVED:r.push({stage:n,title:"Additional context added",content:"",status:"finished"===i?"finish":"process",id:(null==h?void 0:h.id)||n,phase:n});break;case og.ANSWER:r.push({stage:n,title:(null==nW?void 0:nW[l])||n,content:"",status:"finished"===i?"finish":"process",id:(null==h?void 0:h.id)||n,phase:n});break;default:Array.isArray(h)&&h.forEach(e=>{const{id:t=rt(),query:i,learnings:a="",researchGoal:o="",pageContent:s="",codeContent:l="",searchContent:u="",runningIds:d,learningMap:h,webSites:p,status:m,sortKeys:f}=e;let g=a;if(h&&d){g=oW(d||{scrape:[]},h||{}).join("\n")}const v=aW({researchGoal:iW(0,0,o),pageContent:iW(0,0,s),codeContent:iW(0,0,l),searchContent:iW(0,0,u),webSites:p,learnings:iW(0,0,g),learningMap:iW(0,0,g)},f?rW(f,c):sW);r.push({stage:n,title:i,researchGoal:o,pageContent:s,codeContent:l,learnings:a,webSites:p,status:"finished"===m||"WebResultFinished"===m?"finish":"process",id:t,phase:n,content:v})})}}const u=[];for(const d of r){if("finish"!==d.status){u.push(d);break}u.push(d)}return u},cW={"zh-cht":"",zh:"",en:"Visited URLs",fr:"URL visits",de:"Besuchte URLs",it:"URL visitate",ja:"",ko:" URL",pt:"URLs visitados",ar:"  visited     ()",ru:" URL-",es:"URLs visitados"},uW=A.memo(({contentList:e,timestamp:t,endTime:n,messageId:i,isRenderError:a,subChatType:o,taskRunning:s,isMessageStopped:r})=>{const l="pc-research-panel-content",[c,u]=A.useState([]),[d,h]=A.useState(!1),[p,m]=A.useState(!1),[f,g]=A.useState([]),[v,y]=A.useState([]),b=Ex(e=>e.mobile),x=Sx(e=>e.setCurrentShowControl),w=Sx(e=>e.currentShowControl),_=Sx(e=>e.isPdfCardVisible),S=Sx(e=>e.setPDFViewInfo),C=Sx(e=>e.setIsSourcesVisible),E=zE(e=>e.setShowControls),k=zE(e=>e.setDeepDetailTitle),I=vx(e=>e.setCurrentSearchSource),T=vx(e=>e.setCurrentCitationInfo),j=vx(e=>e.setCurrentSearchLists),N=Sx(e=>e.setCurrentDPLanguageCode),{i18n:P}=$(),M=vx(e=>e.chatId),O=zE(e=>e.showControls),R=A.useRef(null),D=A.useRef([]),L=A.useRef([]),F=A.useRef(!1),z=A.useRef(null),U=A.useCallback(e=>lW(e).map(t=>{var n,i;return t.title&&(t.title=P.t(t.title),t.lang_code=(null==(n=null==e?void 0:e[0])?void 0:n.lang_code)||"en",t.linkCardTitle=cW[null==(i=null==e?void 0:e[0])?void 0:i.lang_code]||"Visited URLs"),t.phase===og.INTERRUPTRECEIVED&&(t.icon=an.jsx(pt,{type:"icon-line-message-circle-02"}),t.content=an.jsx("div",{style:{height:20}})),t}),[P]),H=A.useCallback(e=>{var t,n,a;j({[i]:U(e)});const o=null==(a=null==(n=null==(t=e.find(e=>e.phase===og.ANSWER))?void 0:t.extra)?void 0:n.deep_research)?void 0:a.references;y(o);const s=!!e.find(e=>e.phase===og.ANSWER&&e.content);h(s);const r=U(e);g(r);const l=!r.filter(e=>"process"===e.status);m(l)},[U]);A.useEffect(()=>{Array.isArray(c)&&H(c)},[c,H]);const B=A.useMemo(()=>{const e=kT.getCurrentChatsubChatType(),t=vg(e)||e===ng.INTERRUPT;return!(!s||!t||a)},[s,a]),q=A.useCallback(({tab:e=Fe.step,action:t="open",citationIndex:n=0})=>{var s,r;if(!Array.isArray(c))return;u(L.current);const l=(null==(r=null==(s=L.current)?void 0:s[0])?void 0:r.lang_code)||"en";N(xx[l]||xx.en);let d=B?"running":"finished";if(B||_?(!B&&_&&p||a)&&(d="error"):d="stop",!$x())return;const h={key:TI(ag.DeepResearch),value:JSON.stringify({contentList:L.current,status:d,currentId:i,messageType:o})};kT.adapter.invoke({method:"storeInfo",params:h}),"open"===t&&kT.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",content:`${jI(ag.DeepResearch)}?id=${M}&tab=${e}&messageId=${i}&citation_index=${n}`}})},[c,B,_,p,a,i,M,kT,o]),G=A.useCallback(e=>{const{list:t,tab:n,citationIndex:a=0}=e||{};if($x())q({tab:n||Fe.sources,citationIndex:a});else if(b){kT.closeShowControls(),T({messageId:i,citationIndex:a,tab:Fe.sources});const e=Array.isArray(t)?t:v;I({[i]:e,type:ag.DeepResearchLinkSource}),E(!0),x(ag.DeepResearchLinkSource)}else{kT.closeShowControls(),T({messageId:i,citationIndex:a,tab:Fe.sources});const e=Array.isArray(t)?t:v;I({[i]:e,type:ag.DeepResearch}),E(!0),x(ag.DeepResearch)}},[v,i,b,q,T,I,E,x]);A.useEffect(()=>(kT.on(hE.SOURCE_CILCK,G),()=>{kT.off(hE.SOURCE_CILCK,G)}),[kT,G]),A.useEffect(()=>()=>{E(!1),x(ag.None)},[]);const V=e=>{e.deltaY<0&&(z.current&&clearTimeout(z.current),F.current=!0,z.current=setTimeout(()=>{F.current=!1},5e3))},W=A.useCallback(()=>{var e;const t=document.getElementById(l),n="finished"===(null==(e=(L.current||[]).find(e=>e.phase===og.PdfMdGen))?void 0:e.status);t&&t.addEventListener("wheel",V),n?R.current&&clearInterval(R.current):R.current=setInterval(()=>{const e=JSON.stringify(L.current);e!==D.current&&(D.current=e,q({tab:Fe.step,action:"update"}),setTimeout(()=>{var e;s&&(e=t,F.current||null==e||e.scrollTo({top:e.scrollHeight,behavior:"smooth"}))},100))},100)},[l,s,q]);A.useEffect(()=>{L.current=e},[e]);const Q=A.useRef(void 0);A.useEffect(()=>{Q.current!==B&&(Q.current=B,B?(R.current&&clearInterval(R.current),W()):(R.current&&clearInterval(R.current),q({tab:Fe.step,action:"update"})))},[B,q,W]),A.useEffect(()=>()=>{R.current&&clearInterval(R.current),C(!1),S(null)},[]);const K=A.useMemo(()=>!B&&r,[B,r]),Y=A.useMemo(()=>{let e="";return e=B?o===ng.DeepResearch?`${P.t("Deep Research")}...`:`${P.t("Travel Research")}...`:K?o===ng.DeepResearch?P.t("Deep Research Stopped"):P.t("Travel Research Stopped"):a?o===ng.DeepResearch?P.t("Deep Research Failed"):P.t("Travel Research Failed"):o===ng.DeepResearch?P.t("Deep Research Completed"):P.t("Travel Research Completed"),k(e),e},[B,K,a,P,o]),X=A.useMemo(()=>B?"running":!B&&_?"finished":"stop",[B,_]),[J,Z]=A.useState(!B),ee=(e=!0)=>{e&&kT.closeShowControls(),Z(!0)},te=e=>{(void 0!==e?e:!(O&&w===ag.DeepResearchDetail))?(T({messageId:i,citationIndex:0,tab:Fe.step}),E(!0),Z(!1),x(ag.DeepResearchDetail),j({[i]:U(c)})):ee()};A.useEffect(()=>{B&&!b&&te(!0)},[B,b]),A.useEffect(()=>{if(kT)return kT.on(dE.MESSAGE_DEEP_RESEARCH_CLOSE_DETAIL,ee),()=>{null==kT||kT.off(dE.MESSAGE_DEEP_RESEARCH_CLOSE_DETAIL,ee)}},[kT]);return an.jsx(Ue,{texts:{detail:P.t("Details")},loading:B,onStepsChange:(e,t,n)=>{kT.emit(dE.MESSAGE_STOP_SCROLL_TO_BOTTOM);const i=document.getElementById("research-panel-detail-content"),a=document.getElementById(`${He.markdown}_deepDetail_${t.id}`);i&&a&&function(e,t,n=0){if(!e||!t)return;const i=t.getBoundingClientRect(),a=e.getBoundingClientRect(),o=i.top-a.top+e.scrollTop-n;null==e||e.scrollTo({top:o,behavior:"smooth"})}(i,a,0)},cardType:"list",sourceList:v,timestamp:t,endTime:n,searchTitle:Y,deepResearchList:f,showAll:J,disableAlls:!d,contentId:l,displayDrawer:!0,cardStatus:X,onSourcesCilck:G,onAllChange:e=>{Z(e)},onLinkCard:e=>{Array.isArray(e)?G({list:e}):window.open(e.url)},onCardClick:()=>{G({tab:Fe.step}),T({messageId:i,citationIndex:0,tab:Fe.step})},onDetailClick:()=>{te()},webSourceOption:{noSourceText:P.t("no sources"),headerTitle:P.t("Search Source  {{Number}}",{Number:null==v?void 0:v.length}),onClickItem:()=>{}},className:"research-panel"})}),dW=A.memo(({message:e})=>{var t,n,i,a,o;const s=(null==e?void 0:e.sub_chat_type)||(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.meta)?void 0:n.subChatType),r=zE(e=>e.realTheme);if(vg(s)){const t=!!(null==e?void 0:e.error),n=!(null==e?void 0:e.done)&&!t,l=(null==(a=null==(i=e.content_list)?void 0:i.find(e=>e.phase===og.RESEARCHNOTICE))?void 0:a.content)||"";return an.jsxs("div",{className:"deep-research-panel",children:[an.jsx(ze,{content:l,tokenProps:{image:{preview:{mask:null}},code:{theme:r}}}),an.jsx(uW,{messageId:e.id,contentList:e.content_list,timestamp:e.timestamp,subChatType:s,endTime:(null==(o=null==e?void 0:e.extra)?void 0:o.endTime)||window._currentTime_,isRenderError:t,taskRunning:n,isMessageStopped:!!e.is_stop})]})}return null}),hW=({src:e,id:t="",audioInitHandle:n=()=>{},audioLoadHandle:i=()=>{},audioPlayHandle:a=()=>{},audioPauseHandle:o=()=>{},audioEndHandle:s=()=>{},audioTimeupdateHandle:r=()=>{},audioErrorHandle:l=()=>{},audioWaitingHandle:c=()=>{},audioCanplayHandle:u=()=>{},audioCanplayThroughHandle:d=()=>{}})=>{const h=A.useRef(null),[p,m]=A.useState(e),[f,g]=A.useState(!1),[v,y]=A.useState(1),b=MT(e=>e.ossUrls),x=MT(e=>e.setOssUrls),S=A.useCallback(()=>{h.current&&i(h.current)},[i]),C=A.useCallback(()=>{if(!h.current)return;document.querySelectorAll("audio").forEach(e=>{e.id!==`qwen-chat-audio-core-${t}`&&e.pause()}),a(h.current)},[a,t]),E=A.useCallback(()=>{h.current&&o(h.current)},[o]),k=A.useCallback(()=>{h.current&&s(h.current)},[s]),I=A.useCallback(()=>{h.current&&r(h.current)},[r]),T=A.useCallback(()=>j(void 0,null,function*(){if(h.current){if(!f){g(!0);try{const{data:{fileUrl:t}}=yield fS({fileUrl:e});return m(t),void x(_(w({},b),{[e]:t}))}catch(IX){}}if(v>0)return y(e=>e-1),void setTimeout(()=>{h.current&&(h.current.src=`${p}&timestamp=${Date.now()}`)},200);l(h.current)}}),[f,v,l,e,x,b,p]),N=A.useCallback(()=>{h.current&&c(h.current)},[c]),P=A.useCallback(()=>{h.current&&u(h.current)},[u]),M=A.useCallback(()=>{h.current&&d(h.current)},[d]);return A.useEffect(()=>{const e=h.current;if(!e)return;return e.addEventListener("loadedmetadata",S),e.addEventListener("loadeddata",S),e.addEventListener("play",C),e.addEventListener("pause",E),e.addEventListener("ended",k),e.addEventListener("timeupdate",I),e.addEventListener("error",T),e.addEventListener("waiting",N),e.addEventListener("canplay",P),e.addEventListener("canplaythrough",M),n(e),()=>{e.removeEventListener("loadedmetadata",S),e.removeEventListener("loadeddata",S),e.removeEventListener("play",C),e.removeEventListener("pause",E),e.removeEventListener("ended",k),e.removeEventListener("timeupdate",I),e.removeEventListener("error",T),e.removeEventListener("waiting",N),e.removeEventListener("canplay",P),e.removeEventListener("canplaythrough",M)}},[S,C,E,k,I,T,N,P,M,n]),A.useEffect(()=>{g(!1),y(1);const t=b[e]||e;m(t)},[e,b]),an.jsx("audio",{id:"qwen-chat-audio-core"+(t?`-${t}`:""),style:{display:"none"},className:"qwen-chat-comp-audio-core",ref:h,src:p})},pW=({id:e})=>{var t,n;const{i18n:i}=$(),a=NT(e=>e.settings),o=MT(e=>e.ttsAudioTTSSpeakers),s=NT(e=>e.updateQwenChatSettings),r=A.useMemo(()=>o||[],[o]),[l,c]=A.useState({label:fg,value:"",gender:"",description:"",url:""}),[u,d]=A.useState({label:fg,value:"",gender:"",description:"",url:""}),[h,p]=A.useState(!1),[m,f]=A.useState(!1),[g,v]=A.useState(""),y=A.useRef(null);NT(e=>e.setSettings);const b=Sx(e=>e.currentDPLanguageCode),x=A.useMemo(()=>b||i.language||xx.en,[b,i]),w=A.useRef(null),_=A.useRef(null),S=A.useRef(r),C=e=>{var t,n,a;return{label:"zh-CN"===i.language?e.spk_name:e.speaker,value:e.speaker,gender:e.gender,description:e.description,url:(null==(n=null==(t=e.urls)?void 0:t.find(e=>e.language===x||"en"===e.language))?void 0:n.url)||(null==(a=e.urls)?void 0:a[0].url)||""}};A.useEffect(()=>{var e,t;if(S.current=r,!(null==r?void 0:r.length))return;if((!(null==a?void 0:a.aipodcast)||!(null==(e=a.aipodcast)?void 0:e.host))&&(null==r?void 0:r.length)){const e={hostItem:(t=r).find(e=>e.speaker===fg),guestItem:t.find(e=>"male"===e.gender)};return c(C(e.hostItem)),void d(C(e.guestItem))}const n=r.find(e=>{var t;return e.speaker===(null==(t=null==a?void 0:a.aipodcast)?void 0:t.host)});n&&c(C(n));const i=r.find(e=>{var t;return e.speaker===(null==(t=null==a?void 0:a.aipodcast)?void 0:t.guest)});if((null==i?void 0:i.speaker)===(null==n?void 0:n.speaker)){const e=r.find(e=>"male"===e.gender);if(e)return void d(C(e))}i&&d(C(i))},[a,r]);const E=A.useRef(""),k=A.useMemo(()=>{var e,t;return(null==(t=null==(e=S.current)?void 0:e.find(e=>e.speaker===(null==l?void 0:l.value)))?void 0:t.gender)||"female"},[l]),{hostMenu:I,guestMenu:T}=A.useMemo(()=>{E.current=k;const e=[],t=[];return Pt(r)||r.forEach(n=>{e.push(C(n)),n.gender!==k&&t.push(C(n))}),{hostMenu:e,guestMenu:t}},[r,k,x,i.language]),N=A.useCallback(e=>j(void 0,null,function*(){y.current=e}),[]),P=A.useCallback(()=>j(void 0,null,function*(){v(""),p(!1)}),[]),M=A.useCallback(()=>j(void 0,null,function*(){p(!0)}),[]),O=A.useCallback(()=>j(void 0,null,function*(){v(""),p(!1)}),[]),R=A.useCallback(()=>j(void 0,null,function*(){f(!0)}),[]),D=A.useCallback(()=>j(void 0,null,function*(){m&&f(!1)}),[m]),L=A.useMemo(()=>{var e;return(null==(e=null==a?void 0:a.aipodcast)?void 0:e.host)||l.value||fg},[null==(t=null==a?void 0:a.aipodcast)?void 0:t.host,l]),F=A.useMemo(()=>{var e;return(null==(e=null==a?void 0:a.aipodcast)?void 0:e.guest)||u.value||fg},[null==(n=null==a?void 0:a.aipodcast)?void 0:n.guest,u]),z=A.useMemo(()=>an.jsx(hW,{src:null,id:e||"pdf-tts-audio",audioInitHandle:N,audioPlayHandle:M,audioEndHandle:P,audioPauseHandle:O,audioWaitingHandle:R,audioCanplayHandle:D,audioCanplayThroughHandle:D}),[N,M,P,O,R,D]);return{hostMenu:I,guestMenu:T,hostItem:l,guestValue:F,hostValue:L,setHostItem:e=>{if(c(e),E.current!==e.gender){const t=I.find(e=>e.gender===k);t&&(E.current=e.gender,d(t))}},guestItem:u,setGuestItem:d,languageCode:x,activeItemValue:g,audioWaiting:m,audioPlaying:h,Audio:z,guestSelectRef:w,hostSelectRef:_,updateSetting:()=>j(void 0,null,function*(){const e={host:(null==l?void 0:l.value)||"",guest:(null==u?void 0:u.value)||""};e.host&&e.guest&&(yield s({aipodcast:e}))}),closeSelect:()=>{var e,t;try{(null==(e=w.current)?void 0:e.blur)&&w.current.blur(),(null==(t=_.current)?void 0:t.blur)&&_.current.blur()}catch(n){}},stopCurrentAudio:()=>j(void 0,null,function*(){try{y.current&&h&&(v(""),y.current.pause())}catch(e){}}),setActiveItemValue:e=>{if(y.current&&e.value===g&&h)return v(""),void y.current.pause();v(e.value),f(!0),y.current&&(y.current.src=e.url),setTimeout(()=>{y.current&&(y.current.currentTime=0,y.current.play())},0)},audioEleRef:y}},mW=({list:e,activeItemValue:t,audioWaiting:n,audioPlaying:i,soundPreview:a,type:o,closeSelect:s,onVoiceClickHandle:r,onClickHandle:l})=>{const{i18n:c}=$();return an.jsx("div",{className:"pdf-speaker-select",children:e.map(e=>an.jsxs("div",{className:"pdf-speaker-select-item",onClick:()=>{s(),null==l||l(e,o)},children:[e.label,a&&an.jsx("span",{onClick:t=>{t.stopPropagation(),null==r||r(e)},children:an.jsx(xe,{title:c.t("Preview voice"),placement:"top",children:t===e.value?an.jsx("img",{src:wx(n,mB()),alt:"speaking",className:"podcast-selector-dropdown-menu-item-waveform "+(t===e.value&&i?"podcast-selector-dropdown-menu-item-waveform-active":"")}):an.jsx(pt,{type:"icon-waveform",className:"podcast-selector-dropdown-menu-item-waveform"})})})]},e.value))})},fW=({placement:e="bottom",className:t="",customContent:n=null})=>{const{i18n:i}=$(),a=zE(e=>e.isSharePage),o=Sx(e=>e.taskRunning),s=Sx(e=>e.visionGenerating),r=Ex(e=>e.mobile),l=zE(e=>e.setShowH5PodcastDetail),c=Sx(e=>e.deepResearchVersion),u=Sx(e=>e.podcastCount),{hostMenu:d,guestMenu:h,guestItem:p,hostItem:m,Audio:f,activeItemValue:g,audioPlaying:v,audioWaiting:y,hostSelectRef:b,guestSelectRef:x,guestValue:w,hostValue:_,languageCode:S,closeSelect:C,setHostItem:E,updateSetting:k,setGuestItem:I,stopCurrentAudio:T,setActiveItemValue:N}=pW({id:"button-pdf-tts-audio"}),[P,M]=A.useState(!1),{qDeepResearchAipodcast:O,checkEquityPassByEquity:R}=m$(),[D,L]=A.useState(!1),F=A.useRef(null),z=A.useMemo(()=>s||o,[o,s]),U=A.useMemo(()=>"icon-line-chevron-"+(D?"up":"down"),[D]),H=A.useCallback(()=>j(void 0,null,function*(){o||(kT.closeShowControls(),UT()||(yield k()),M(!1),l(!1),vx.getState().setEmitSendPromptType(Yf.CHAT),kT.beforeSendMessage({inputText:i.t("Create a podcast"),subChatType:ng.Podcast}),yield KE.getState().updateEquity())}),[o,k,i,l]),B=A.useMemo(()=>{const e=[];"v4"===c&&(e.push({label:i.t("Web Dev"),key:"web dev",icon:an.jsx(pt,{type:"icon-Cube"}),onClick:()=>{kT.closeShowControls(),vx.getState().setEmitSendPromptType(Yf.CHAT),kT.beforeSendMessage({inputText:i.t("Generate a web page preview"),subChatType:ng.DeepResearchWebDev})}}),r&&e.push({type:"divider"}));const t=null===(null==O?void 0:O.remains)||-1!==(null==O?void 0:O.remains)?LE({remains:(null==O?void 0:O.remains)||0,unit:null==O?void 0:O.unit,currentI18n:i,capability:"Podcast"}):"",n=null===(null==O?void 0:O.remains)||0===(null==O?void 0:O.remains);return e.push({label:an.jsx(vt,{title:t?an.jsx("span",{dangerouslySetInnerHTML:{__html:t}}):"",children:i.t("Podcast")}),className:n?"ant-dropdown-menu-item-disabled":"",disabled:!r&&n,key:"podcast",icon:an.jsx(pt,{type:"icon-line-Podcast"}),onClick:()=>{if(r){if(!R(O)||n)return;$x()?kT.adapter.invoke({method:"openPodcastWindow",params:{content:{host:_,guest:w},languageCode:S}}):l(!0)}else M(!0)}}),{items:e}},[R,c,w,_,i,S,r,O,l]);A.useEffect(()=>{const e=e=>{const t=e.target;r||!F.current||F.current.contains(t)||t.closest(".ant-select-dropdown")||(M(!1),l(!1))};return P&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[P,r,l]);const q=A.useCallback((e,t)=>{"host"===t?E(e):I(e)},[E,I]),G=A.useMemo(()=>[{list:d,value:null==m?void 0:m.label,type:"host",ref:b,titleKey:"Host"},{list:h,value:null==p?void 0:p.label,type:"guest",ref:x,titleKey:"Guest"}],[d,h,m,p,b,x]);A.useEffect(()=>{P||T()},[P,T]);const V=A.useCallback(()=>P?an.jsx("div",{className:"podcast-detail-container",ref:F,children:an.jsxs("div",{className:"podcast-detail",children:[an.jsx("div",{className:"podcast-detail-title",children:i.t("Select the voice")}),an.jsx("div",{className:"podcast-detail-content",children:G.map(e=>an.jsxs("div",{className:"podcast-detail-content-item",children:[an.jsx("div",{className:"podcast-detail-content-item-title",children:i.t(e.titleKey||"Host")}),an.jsx(kt,{selectAntdRef:e.ref,rounded:"circle",value:e.value,placeholder:"",onOpenChange:e=>{e||T()},popupRender:()=>an.jsx(mW,{list:e.list,type:e.type,soundPreview:!0,closeSelect:C,activeItemValue:g,audioWaiting:y,audioPlaying:v,onClickHandle:q,onVoiceClickHandle:N})})]},e.type))}),an.jsx(ft,{rounded:"circle",type:"brandprimary",buttonClass:"podcast-detail-button",buttonStyle:{marginLeft:"0px",height:"40px"},onClick:H,children:i.t("Create a podcast")})]})}):null,[P,i,G,H,T,C,g,y,v,q,N]);return a||0===B.items.length?null:an.jsxs(an.Fragment,{children:[V(),f,an.jsx(xt,{menu:B,overlayClassName:"pdf-create-button-outer",disabled:z||u>=5,trigger:["click"],placement:e,className:"pdf-create-button",onOpenChange:e=>{L(e)},children:n?an.jsx("div",{className:Y("pdf-create-custom",{"pdf-create-custom-disabled":z||u>=5}),children:n}):an.jsx(ft,{isLeft:!1,iconFontType:U,type:"brandsecondary",rounded:"circle",disabled:z||u>=5,className:t,size:"small",children:i.t("Create")})})]})},gW=A.memo(({info:e,subChatType:t,timestamp:n})=>{var i,a,o,s,r;zE(e=>e.setShowSidebar);const l=Ex(e=>e.mobile),c=Sx(e=>e.setCurrentShowControl),u=Sx(e=>e.currentShowControl),d=zE(e=>e.setShowControls),h=zE(e=>e.showControls),p=vx(e=>e.chatId),m=Sx(e=>e.setIsPdfCardVisible),f=Sx(e=>e.setPDFViewInfo),g=Sx(e=>e.setPdfCardType),v=zE(e=>e.isSharePage),y=vx(e=>e.branchInfo),b=Sx(e=>e.taskRunning),x=Sx(e=>e.deepResearchVersion),w=Sx(e=>e.pdfCardType),_=GE(e=>e.subscriptionPlus),S=Sx(e=>e.podcastCount),C=Sx(e=>e.visionGenerating),E=Sx(e=>e.temporaryChatEnabled),k=vx(e=>e.history),I=Ex(e=>e.config),{i18n:T}=$(),j=!!(null==e?void 0:e.messageId)&&!!(null==(a=null==(i=k.messages)?void 0:i[null==e?void 0:e.messageId])?void 0:a.isShare),[N,P]=A.useState(!1),M=t&&(vg(t)||t===ng.INTERRUPT);A.useEffect(()=>{if(!$x())return;const t={key:TI(ag.PdfViewer),value:JSON.stringify({PDFViewInfo:e,isSharePage:v,branchInfo:y,taskRunning:b,deepResearchVersion:x,pdfCardType:w,subscriptionPlus:_,podcastCount:S,visionGenerating:C,temporaryChatEnabled:E})};kT.adapter.invoke({method:"storeInfo",params:t})},[e,v,y,b,x,w,_,S,C,E]);const O=()=>{if(h&&u===ag.PdfViewer)kT.closeShowControls();else if($x())try{kT.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",content:`${jI(ag.PdfViewer)}?id=${p}`}})}catch(e){}else c(ag.PdfViewer),d(!0)};A.useEffect(()=>(M&&e?(m(!0),f(e)):m(!1),g(t||""),()=>{m(!1)}),[M,t,e]),A.useEffect(()=>{kT.emit(dE.MESSAGE_DEEP_RESEARCH_CLOSE_DETAIL),[ng.DeepResearch,ng.TRAVEL_RESEARCH].includes(kT.getCurrentChatsubChatType())&&!l&&(kT.closeShowControls(),v||c(ag.PdfViewer),d(!0))},[v]);const R=A.useMemo(()=>v||j||t===ng.TRAVEL_RESEARCH?null:an.jsx("div",{className:"pdf-card-after-extras",children:an.jsx(fW,{customContent:an.jsx("div",{children:an.jsx(pt,{type:"icon-a-lianji8"})}),placement:l?"topLeft":"top"})}),[v,j,t,l]),D=A.useMemo(()=>{var e;return!v&&!UT()&&(null==(e=null==I?void 0:I.function_entry)?void 0:e.community)&&!(null==y?void 0:y.isTemp)&&!E},[v,null==(o=null==I?void 0:I.function_entry)?void 0:o.community,null==y?void 0:y.isTemp,E]),L=A.useMemo(()=>D?an.jsx(ne,{arrow:!1,trigger:"click",classNames:{root:"pc-pdf-viewer-more-popover"},content:an.jsx("div",{className:"pc-pdf-viewer-more-content",children:D?an.jsxs("div",{onClick:()=>{j||P(!0)},className:Y("pc-pdf-viewer-more-content-item",{"pc-pdf-viewer-more-content-item-disabled":j}),children:[an.jsx(pt,{className:"pc-pdf-viewer-more-content-item-icon",type:"icon-line-Publish"}),T.t("Publish to community")]}):null}),placement:"bottomLeft",children:an.jsx("div",{className:"after-extras-icon",children:an.jsx(pt,{type:"icon-line-more-01"})})}):an.jsx(an.Fragment,{}),[T,j,D]);return M&&e?an.jsxs(an.Fragment,{children:[an.jsx(IG,{open:N,onCancel:()=>P(!1),messageId:e.messageId}),an.jsx(Be,{className:"pdf-card",onCardClick:O,info:{time:ZS(n),name:(null==(s=e.pdf)?void 0:s.name)||"",size:(null==(r=e.pdf)?void 0:r.size)||0,extra:e},type:$e.PDF,toolsOption:{afterExtras:L,download:{onDownload:Ek},beforeExtras:R}})]}):null}),vW=e=>{var t,n,i,a,o;const{message:s,phaseContentIndex:r=-1}=e,l=null==(t=s.content_list)?void 0:t[r],c=null==(n=s.content_list)?void 0:n.some(e=>e.status===sg.FINISHED),u=(null==(a=null==(i=null==s?void 0:s.feature_config)?void 0:i.mcp)?void 0:a.length)||(null==(o=null==s?void 0:s.feature_config)?void 0:o.local_mcp)||!1,d=A.useMemo(()=>(null==l?void 0:l.status)===sg.FINISHED?Jf.THOUGHT_COMPLETED:s.is_stop?Jf.THOUGHT_STOP:Jf.THINKING,[s.is_stop,null==l?void 0:l.status]);return u?an.jsx(qe,{content:null==l?void 0:l.content,loading:d===Jf.THINKING&&!c}):null},yW=e=>{var t,n,i;const{message:a,phaseContentIndex:o=-1}=e,{i18n:s}=$(),r=EI(e=>e.models),l=vx(e=>e.chatPermission);vx(e=>e.setChatPermission);const c=A.useMemo(()=>a.content_list||[],[a.content_list]),u=A.useMemo(()=>{var e;return null==(e=a.content_list)?void 0:e[o]},[a.content_list,o]),d=A.useMemo(()=>{const e=c.find((e,t)=>e.phase===og.ANSWER&&t>o);return!a.done&&(null==u?void 0:u.phase)===og.TOOL&&!e},[a.done,null==u?void 0:u.phase,o,c]),h=A.useMemo(()=>{const e=c.findIndex((e,t)=>e.phase===og.LOCAL_TOOL&&e.mcp_results&&t>o),t=c.find((t,n)=>t.phase===og.ANSWER&&n>(e>-1?e:o+2));return!a.done&&(null==u?void 0:u.phase)===og.LOCAL_TOOL&&!t},[a.done,null==u?void 0:u.phase,o,c]),{mcpName:p,toolName:m,params:f,result:g}=A.useMemo(()=>{var e,t,n,i,a,s,r;const l=c.findIndex((e,t)=>e.phase===og.LOCAL_TOOL&&e.mcp_results&&t>o),d=l>-1?c[l]:void 0,h=(null==u?void 0:u.mcp_name)||"",p=(null==u?void 0:u.tool_name)||"",m=null==(i=null==(n=null==(t=null==(e=null==u?void 0:u.extra)?void 0:e.local_mcp)?void 0:t[h])?void 0:n.find(({tool_name:e})=>e===p))?void 0:i.params,f=m?JSON.stringify(m):"",g=(null==(r=null==(s=null==(a=null==d?void 0:d.mcp_results)?void 0:a[h])?void 0:s.find(e=>!!(null==e?void 0:e[p])))?void 0:r[p])||"";return{mcpName:h,toolName:p,params:f,result:g}},[null==(t=null==u?void 0:u.extra)?void 0:t.local_mcp,null==u?void 0:u.mcp_name,null==u?void 0:u.tool_name,o,c]),v=A.useMemo(()=>{var e,t,n;const i=c.findIndex((e,t)=>e.phase===og.LOCAL_TOOL&&e.mcp_results&&t>o),a=null==(t=Object.values((null==(e=c[i])?void 0:e.mcp_results)||{}))?void 0:t[0],s="Tool call failed: User not authorized"===(null==(n=Object.values((null==a?void 0:a[0])||{}))?void 0:n[0]),r=Gx()&&h&&"prompt"===(null==l?void 0:l.local_mcp);return s?"denied":r?"prompt":void 0},[null==l?void 0:l.local_mcp,h,o,c]);return-1===o?(null==(i=null==(n=a.extra)?void 0:n.connectFailedMcp)?void 0:i.length)?an.jsx(Ge,{failedMcpNames:a.extra.connectFailedMcp,failedText:s.t("connecting failed.")}):null:(null==u?void 0:u.mcp_results)?null:an.jsxs(an.Fragment,{children:[an.jsx(Ve,{loading:d||h,mcpName:p,toolName:m,callingText:s.t("Call {{toolName}} from {{MCPName}}",{toolName:m,MCPName:p}),detailParamsTitle:s.t("Start calling tool {{toolName}}",{toolName:m}),detailParamsContent:f,detailResultTitle:s.t("Finished tool calling"),detailResultContent:g}),(null==u?void 0:u.phase)===og.LOCAL_TOOL&&c[c.length-1].status===sg.FINISHED&&an.jsx(We,{type:v,title:s.t("Allow {{toolName}} (local) running?",{toolName:m}),content:s.t("Malicious MCP servers or content may lead Qwen to perform harmful actions through your installed tools. Review all actions carefully before approval."),buttonTextDeny:s.t("Deny"),buttonTextGrantedOnce:s.t("Allow once"),buttonTextGranted:s.t("Allow in this chat"),deniedContent:s.t("Permission request denied, tool execution stopped."),onButtonClick:e=>{const t=xE.getChat(xE.currentId||"");t&&t.setLocalMcpPermission(e,{model:r.find(({id:e})=>e===a.model),responseMessageId:(null==a?void 0:a.id)||""})},style:["prompt","denied"].includes(v||"")?{marginTop:"0.75rem"}:void 0})]})},bW=e=>{const{editedContent:t,setEditedContent:n,handleSaveEditMessage:i,setIsEdit:a}=e,o=A.useRef(null),{i18n:s}=$();return A.useEffect(()=>{setTimeout(()=>{o.current&&o.current.scrollIntoView({behavior:"smooth",block:"end"})},100)},[]),an.jsx("div",{ref:o,children:an.jsx(Re,{value:t,open:!0,onOk:e=>{i(e||"")},onCancel:()=>{n(null),a(!1)},onExtra:e=>{i(e||"",!0)},okText:s.t("Save"),cancelText:s.t("Cancel"),extraText:s.t("Save As Copy")})})},xW=e=>{var t,n,i;const{message:a,phaseContentIndex:o=-1}=e,s=A.useMemo(()=>{var e;return null==(e=a.content_list)?void 0:e.some(e=>[og.THINK,og.WEB_SEARCH].includes(e.phase))},[a.content_list]),r=A.useMemo(()=>{var e;return!!(null==(e=null==a?void 0:a.feature_config)?void 0:e.thinking_enabled)},[null==(t=null==a?void 0:a.feature_config)?void 0:t.thinking_enabled]),l=A.useMemo(()=>{var e,t;return!(!Array.isArray(null==a?void 0:a.content_list)||!(null==(e=null==a?void 0:a.content_list)?void 0:e.length))&&(null==(t=a.content_list)?void 0:t.every(e=>e.phase===og.ANSWER))},[a.content_list]),c=A.useMemo(()=>null==a?void 0:a.is_stop_in_thinking,[null==a?void 0:a.is_stop_in_thinking]),u=A.useMemo(()=>{var e,t,n;return(null==(t=null==(e=null==a?void 0:a.feature_config)?void 0:e.mcp)?void 0:t.length)||(null==(n=null==a?void 0:a.feature_config)?void 0:n.local_mcp)},[null==(n=null==a?void 0:a.feature_config)?void 0:n.local_mcp,null==(i=null==a?void 0:a.feature_config)?void 0:i.mcp]);return!a||!s&&!r||l||-1!==o||c||u?an.jsx("div",{className:"response-loading",children:an.jsx("img",{src:"https://img.alicdn.com/imgextra/i2/O1CN01mIooQw1WN06zUoQHt_!!6000000002775-54-tps-100-20.apng",alt:""})}):an.jsx(ZV,{message:a})},wW=()=>an.jsx("div",{className:Y("function-call-loading")}),_W=e=>{var t;const{message:n}=e,i=Ex(e=>e.mobile),a=A.useMemo(()=>an.jsx(pt,{type:i?"icon-line-information-circle":"icon-line-x-circle-contained"}),[i]),{messageRender:o,descriptionRender:s}=A.useMemo(()=>{var e,t,i;const a=null!=(i=null!=(t=null==(e=null==n?void 0:n.error)?void 0:e.content)?t:null==n?void 0:n.content)?i:"",[o,s]=a.split("\n");return{messageRender:o,descriptionRender:s}},[n.content,null==(t=null==n?void 0:n.error)?void 0:t.content]);return an.jsx(Qe,{icon:a,description:an.jsxs("div",{children:[an.jsx("div",{children:o}),an.jsx("div",{children:s})]})})},SW="The current content is empty, please regenerate.",CW=e=>{const{emptyText:t=SW}=e,n=$();return an.jsx("div",{className:"response-message-empty",children:n.t(t)})},EW=e=>{const t=B(),n=Ty(),i=vx(e=>e.chatId),a=Ex(e=>e.mobile),o=Sx(e=>e.setWelcomeModalShow),s=MT(e=>e.onNativeCalling),r=MT(e=>e.setUnsupportedLanguageVoicePlayMessageIds),l=MT(e=>e.unsupportedLanguageVoicePlayMessageIds),c=MT(e=>e.voicePlayingMessageId),u=MT(e=>e.setVoicePlayingMessageId),d=zE(e=>e.setShowSettingsGeneralAudioList),[h,p]=A.useState(!1),[m,f]=A.useState(!1),[g,v]=A.useState(!localStorage.getItem("ttsGuideVisible")),y=A.useMemo(()=>l.includes(e.id),[e,l]),b=A.useMemo(()=>!$x()||((e,t=!1)=>{const n=Bx(),i=e.split(".").map(Number),a=n.split(".").map(Number);for(let o=0;o<3;o++){const e=i[o]||0,t=a[o]||0;if(t<e)return!1;if(t>e)return!0}return t})("1.6.0",!0),[]),x=A.useCallback(()=>{localStorage.getItem("ttsGuideVisible")||(localStorage.setItem("ttsGuideVisible","true"),v(!0))},[]),w=A.useCallback(t=>{switch(t){case oI.PLAYING:return f(!1),p(!0),void u(e.id);case oI.READY:case oI.STOPPED:case oI.PAUSED:f(!1),p(!1);break;case oI.UNSUPPORTED_LANGUAGE:r([...new Set([...l,e.id])]),f(!1),p(!1);break;default:f(!0),p(!1)}u("")},[e,r,u,l]),_=A.useCallback(()=>j(void 0,null,function*(){var n;if(y)a&&(ht.open({type:"warning",content:t.t("Currently, only Chinese and English are supported. More languages are coming soon.")}),x());else if(!m)if(h)bI.getInstance().stopAllPlayer();else{if($x()){let e=!s;if(e&&(null==window?void 0:window.QwenChat))try{const{result:t}=yield null==(n=null==window?void 0:window.QwenChat)?void 0:n.requestAudioFocus();e=t}catch(o){}if(!e)return ht.openOnce({type:"error",content:t.t("The media audio is in use and playback is not supported.")}),void x()}bI.getInstance().startTTS(i,e.id,w),x()}}),[w,x,i,t,e,a,s,y,h,m]),S=A.useCallback(()=>{v(!1)},[]),C=A.useCallback(()=>{if(S(),bI.getInstance().stopAllPlayer(),UT())$x()?kT.adapter.invoke({method:"showAlert",params:{type:"login"}}):o(!0);else if($x()){const e="qwen://settings/tts-speakers";kT.adapter.invoke({method:"openWindow",params:{uri:e}})}else a?n("/settings/voice"):(d(!0),n("/settings/general"))},[a,n,d,o,S]);return A.useEffect(()=>{c===e.id&&p(!0)},[e.id,c]),{voiceDisabled:y,voiceActive:h,setVoiceActive:p,voiceLoading:m,setVoiceLoading:f,voiceGuideVisible:g,setVoiceGuideVisible:v,voiceCallback:_,voiceGuideCloseClick:S,voiceGuideButtonClick:C,voiceGuideBtnVisible:b}},kW=(e,t)=>{var n,i,a,o,s,r,l,c,u;const d=vx(e=>e.chatId),h=EI(e=>e.models),p=vx(e=>e.history.currentId),m=vx(e=>e.setCallBackInfo),f=vx(e=>e.callBackInfo),g=$(),[v,y]=A.useState("1"===(null!=(i=null==(n=null==e?void 0:e.annotation)?void 0:n.rating)?i:"").toString()),[b,x]=A.useState("-1"===(null!=(o=null==(a=null==e?void 0:e.annotation)?void 0:a.rating)?o:"").toString()),[S,C]=A.useState(!1),[E,k]=A.useState((null==(r=null==(s=null==e?void 0:e.annotation)?void 0:s.reason)?void 0:r.split(","))||[]),[I,T]=A.useState((null==(l=null==e?void 0:e.annotation)?void 0:l.comment)||""),N=A.useMemo(()=>!(!t||!(null==f?void 0:f.id))||e.id===p,[t,null==f?void 0:f.id,e.id,p]),P=A.useMemo(()=>{var t,n;return(null==(t=null==e?void 0:e.annotation)?void 0:t.comment)||(null==(n=null==e?void 0:e.annotation)?void 0:n.reason)},[null==(c=null==e?void 0:e.annotation)?void 0:c.comment,null==(u=null==e?void 0:e.annotation)?void 0:u.reason]),M=A.useCallback(()=>j(void 0,null,function*(){const t={badFeedbackList:mg,defaultContents:E,inputText:I};kT.adapter.invoke({method:"storeInfo",params:{key:TI(ag.Feedback),value:JSON.stringify(t)}}),kT.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",content:`${jI(ag.Feedback)}?messageId=${e.id}`}})}),[E,I,e.id]),O=A.useCallback((t=null,n=null)=>j(void 0,null,function*(){var i,a,o,s,r,l,c,u,p,m,f;!n&&1!==t&&N&&($x()?M():C(!0));const v=yield R_({chat_id:d});if(!v)return;const y=_(w({},e),{annotation:w(w(w({type:"rating",rating:null!=(a=null!=t?t:null==(i=null==e?void 0:e.annotation)?void 0:i.rating)?a:0},null!=(o=null==e?void 0:e.annotation)?o:{}),null!==t?{rating:t}:{}),n||{})});1===t&&((null==(s=y.annotation)?void 0:s.comment)&&delete y.annotation.comment,(null==(r=y.annotation)?void 0:r.reason)&&delete y.annotation.reason);const b=v.data.chat.history,x=jC(e.id,b),S={type:"rating",data:w(_(w({},(null==y?void 0:y.annotation)?y.annotation:{}),{rating:null!=(c=null!=t?t:null==(l=null==e?void 0:e.annotation)?void 0:l.rating)?c:0,model_id:null!=(u=null==e?void 0:e.selectedModelId)?u:e.model}),b.messages[e.parentId].childrenIds.length>1?{sibling_model_ids:b.messages[e.parentId].childrenIds.filter(t=>t!==e.id).map(e=>{var t,n;return null!=(n=null==(t=b.messages[e])?void 0:t.selectedModelId)?n:b.messages[e].model})}:{}),meta:{model_id:e.model,message_id:e.id,message_index:x.length,chat_id:d},snapshot:{chat:v}},E=[S.data.model_id,...null!=(p=S.data.sibling_model_ids)?p:[]].reduce((e,t)=>{var n,i;const a=h.find(e=>e.id===t);return a&&(e[a.id]=null!=(i=null==(n=null==a?void 0:a.info)?void 0:n.base_model_id)?i:null),e},{});S.meta.base_models=E;let k=null;var I;(null==(m=b.messages[e.id])?void 0:m.feedbackId)?k=yield(I={id:null==(f=b.messages[e.id])?void 0:f.feedbackId,feedback:S},j(void 0,null,function*(){return yield ow(`/evaluations/feedback/${I.id}`,{method:"POST",data:I.feedback})})).catch(e=>{ht.open({type:"error",content:e})}):(k=yield(e=>j(void 0,null,function*(){return yield ow("/evaluations/feedback",{method:"POST",data:e.feedback})}))({feedback:S}).catch(e=>{ht.open({type:"error",content:e})}),k&&(y.feedbackId=k.id)),yield kT.updateMessage(e.id,y),n&&-1===t&&ht.open({type:"success",content:g.t("Thanks for your feedback!")})}),[d,g,N,e,h,M]),R=A.useCallback(()=>j(void 0,null,function*(){y(!0),x(!1),C(!1),k([]),T(""),p===e.id||(null==f?void 0:f.id)||!t?((null==f?void 0:f.id)&&m(null),yield O(1),window.setTimeout(()=>{var t;null==(t=document.getElementById(`message-feedback-${e.id}`))||t.scrollIntoView()},0)):m({name:"goodCallback",id:e.id})}),[O,null==f?void 0:f.id,p,t,e.id,m]),D=A.useCallback(()=>j(void 0,null,function*(){var n;if(x(!0),y(!1),p===e.id||(null==f?void 0:f.id)||!t){if(N&&P)return $x()?M():C(!0),window.setTimeout(()=>{var e;null==(e=document.getElementById(`message-feedback-${null==f?void 0:f.id}`))||e.scrollIntoView()},0),void m(null);yield O(-1),window.setTimeout(()=>{var t;null==(t=document.getElementById(`message-feedback-${e.id}`))||t.scrollIntoView()},0);try{cS("clickMessageStep",{params:{et:"CLK",c4:d,c5:e.id,c6:null==e?void 0:e.parentId,c7:null==(n=null==e?void 0:e.content_list[0])?void 0:n.content}})}catch(i){}}else m({name:"badCallback",id:e.id})}),[O,null==f?void 0:f.id,d,P,p,N,t,null==e?void 0:e.content_list,e.id,null==e?void 0:e.parentId,M,m]),L=A.useCallback(()=>{C(!1)},[]),F=A.useCallback((t,n)=>j(void 0,null,function*(){var i,a,o,s,r;k(t),T(n);const l={comment:n,reason:t.join(",")};try{yield O(-1,l),cS("submitMessageFeedback",{params:{et:"CLK",c4:d,c5:e.id,c6:null==e?void 0:e.parentId,c7:(null==(a=null==(i=null==e?void 0:e.content_list)?void 0:i[0])?void 0:a.content)||(null==e?void 0:e.content),c8:l}})}catch(c){cS("submitMessageFeedbackErr",{params:{et:"OTHER",c4:d,c5:e.id,c6:null==e?void 0:e.parentId,c7:(null==(s=null==(o=null==e?void 0:e.content_list)?void 0:o[0])?void 0:s.content)||(null==e?void 0:e.content),c8:l,c9:c||""}})}$x()?null==(r=null==window?void 0:window.QwenChat)||r.closeHalfWindow():C(!1)}),[O,d,null==e?void 0:e.content,null==e?void 0:e.content_list,e.id,null==e?void 0:e.parentId]),z=A.useCallback(e=>{F(e.feedbackInfo.detail.content,e.feedbackInfo.detail.text)},[F]);return A.useEffect(()=>{$x()&&kT.firstOn(dE.MESSAGE_FEEDBACK_SUBMIT,z)},[z]),{clickedGood:v,clickedBad:b,badFeedbackVisible:S&&(!!t||N),defaultContents:E,inputText:I,goodCallback:R,badCallback:D,onCloseFeedback:L,onSubmitFeedback:F}},IW=e=>{const{chatId:t,messageId:n,setShow:i,show:a,onClose:o}=e,s=$(),[r,l]=A.useState(null),[c,u]=A.useState(""),[d,h]=A.useState(""),[p,m]=A.useState(!1),f=A.useRef(!1),g=Ex(e=>e.mobile),v=Sx(e=>e.taskRunning),y=A.useCallback(()=>j(void 0,null,function*(){let e="";var a;(yield(a={chatId:t,messageId:n},j(void 0,null,function*(){return yield ow("/share/message/new",{method:"POST",data:{chat_id:a.chatId,message_id:a.messageId}})})).then(t=>{e=t.data.share_url,u(t.data.share_url),h(t.data.share_id)}).catch(e=>{ht.open({type:"error",content:s.t(e.message)})}))||i(!1);const o=yield R_({chat_id:t});return l(o.data),e}),[t,s,n,i,c]),b=A.useCallback(e=>!r||!!e&&((null==r?void 0:r.id)!==e.id||(null==r?void 0:r.share_id)!==e.share_id),[r]),x=A.useCallback(()=>j(void 0,null,function*(){if(v)return void ht.openOnce({type:"error",content:s.t("The current chat is not yet complete, please wait for a while and retry.")});if(f.current)return;f.current=!0;const e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);try{if(Rx()||e||Px())yield navigator.clipboard.write([new ClipboardItem({"text/plain":new Promise((e,n)=>j(void 0,null,function*(){try{let n=yield y();n+=`?${Vk}=${Qk()}`,e(new Blob([n],{type:"text/plain"})),dS("clkShareCopyLink",{params:{et:"CLK",c6:n},paramsExtend:{chat_id:t}})}catch(i){n(i)}}))})]);else{let e=yield y();if(!e)return;e+=`?${Vk}=${Qk()}`,dS("clkShareCopyLink",{params:{et:"CLK",c6:e},paramsExtend:{chat_id:t}}),setTimeout(()=>{WS(e),f.current=!1},10)}ht.open({type:"success",content:s.t("Copied shared chat URL to clipboard!")}),o()}catch(n){}f.current=!1}),[t,s,o,y,v]),w=A.useRef(!1);return A.useEffect(()=>{a&&!w.current?j(void 0,null,function*(){const e=yield R_({chat_id:t});b(e)&&(l(e.data),w.current=!0)}):a||(l(null),w.current=!1)},[a,t,b]),A.useEffect(()=>{var e,t,i,a,o;if(r&&n&&(null==(e=null==r?void 0:r.chat)?void 0:e.history)&&(null==(i=null==(t=null==r?void 0:r.chat)?void 0:t.history)?void 0:i.messages)){const e=r.chat.history.messages[n],t=null==(o=null==(a=null==e?void 0:e.extra)?void 0:a.meta)?void 0:o.share;t&&t.shareId?(m(!0),u(t.shareUrl),h(t.shareId)):m(!1)}else m(!1)},[r,n]),r?g?an.jsx(mt,{visible:a,header:!1,footer:!1,closable:!1,size:"small",maskClosable:!0,onCancel:o,children:an.jsxs("div",{className:"mobile-share-modal",children:[an.jsx("div",{className:"mobile-share-modal-title",children:s.t("Share Conversation")}),an.jsxs("div",{className:"mobile-share-modal-content",children:[an.jsx("div",{className:"mobile-share-modal-content-main",children:p?an.jsxs(an.Fragment,{children:[zx()&&!Yx("1.0.0")?an.jsxs(an.Fragment,{children:[s.t("You have shared this chat"),an.jsx("span",{children:s.t("before")}),"."]}):an.jsx(an.Fragment,{children:an.jsxs("a",{href:c,target:"_blank",children:[s.t("You have shared this chat"),an.jsxs("span",{children:[s.t("before"),"."]})]})}),s.t("Click here to"),an.jsx("button",{onClick:()=>j(void 0,null,function*(){if(yield Y_({id:d}).then(()=>{ht.open({type:"success",content:s.t("The shared link has been successfully deleted!")})}).catch(e=>(ht.open({type:"error",content:s.t(e.message)}),o(),null))){const e=yield R_({chat_id:t});l(e.data)}o()}),children:s.t("delete this link")}),s.t("and create a new shared link.")]}):s.t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")}),an.jsx("div",{className:"mobile-share-modal-content-end",children:an.jsx("div",{className:"mobile-share-modal-content-end-content",children:an.jsx("div",{})})})]}),an.jsxs("div",{className:"mobile-share-modal-footer",children:[an.jsx(ft,{onClick:x,children:p?s.t("Update and Copy Link"):s.t("Copy Link")}),an.jsx(ft,{type:"link",onClick:o,children:s.t("Cancel")})]})]})}):an.jsx(mt,{className:"web-share-modal",size:"small",title:s.t("Share Conversation"),onCancel:o,visible:a,headerBorderNone:!0,onOk:x,okText:p?s.t("Update and Copy Link"):s.t("Copy Link"),cancelButtonProps:{hidden:!0},okButtonProps:{iconFontType:"icon-Link1",iconFontStyle:{fontSize:12},type:"brandprimary",size:"middle",buttonStyle:{height:"36px"},rounded:"circle"},children:an.jsx("div",{children:an.jsx("div",{className:"share-modal-main",children:an.jsx("div",{className:"share-modal-main-content",children:p?an.jsxs(an.Fragment,{children:[Gx()?an.jsxs("a",{className:"share-modal-main-conten-link",children:[s.t("You have shared this chat"),an.jsx("span",{onClick:e=>Jx(e,c),children:s.t("before")}),"."]}):an.jsxs("a",{href:c,className:"share-modal-main-conten-link",target:"_blank",children:[s.t("You have shared this chat"),an.jsxs("span",{children:[s.t("before"),"."]})]}),s.t("Click here to"),an.jsx("button",{onClick:()=>j(void 0,null,function*(){if(yield Y_({id:d}).then(()=>{ht.open({type:"success",content:s.t("The shared link has been successfully deleted!")})}).catch(e=>(ht.open({type:"error",content:s.t(e.message)}),o(),null))){const e=yield R_({chat_id:t});l(e.data)}o()}),children:s.t("delete this link")}),s.t("and create a new shared link.")]}):s.t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")})})})}):null},TW=ZG(e=>{var t,n,i,a,o,s,r,l,c,u,d;const{message:h,error:p,showMenu:m,setEditedContent:f,setCanHideMenu:g,setNativeEditing:v,editSaveHandler:y,isEdit:b,setIsEdit:x,isOldMessageInNewBranch:S,isMultiChat:C,active:E,podcastAsyncLoading:k}=e,I=vx(e=>e.chatMode),T=Ex(e=>e.mobile),N=vx(e=>e.allSearchAndThinkLists),P=Sx(e=>e.setCurrentShowControl),M=vx(e=>e.setCurrentInputSubType),O=vx(e=>e.setCurrentCitationInfo),R=zE(e=>e.setShowControls),D=vx(e=>e.setEmitSendPromptType),{i18n:L}=$(),F=vx(e=>e.chatId),[z,U]=A.useState(!1),[H,B]=A.useState(!1),q=Ex(e=>e.config),G=Sx(e=>e.visionGenerating),V=Sx(e=>e.taskRunning),W=vx(e=>e.history.messages),Q=TT(e=>e.setFiles),K=Sx(e=>e.setWelcomeModalShow),Y=vx(e=>e.callBackInfo),X=vx(e=>e.setCallBackInfo),J=A.useMemo(()=>(!b||b&&T&&F)&&!h.isShare,[b,T,F,h]),Z=Sx(e=>e.setCurrentActionMessageId),{voiceDisabled:ee,voiceActive:te,voiceLoading:ne,voiceGuideVisible:ie,voiceGuideBtnVisible:ae,voiceCallback:oe,voiceGuideCloseClick:se,voiceGuideButtonClick:re}=EW(h),{clickedGood:le,goodCallback:ce,clickedBad:ue,badCallback:de,badFeedbackVisible:he,defaultContents:pe,inputText:me,onCloseFeedback:fe,onSubmitFeedback:ge}=kW(h,C),[ve,ye]=A.useState(""),[be,xe]=A.useState(!1),we=vx(e=>e.currentInputFeature),_e=vx(e=>e.branchInfo),Se=Sx(e=>e.setLocateTheSearchSource),{openNativePopup:Ce}=UV({message:h}),Ee=A.useCallback(e=>{kT.setSelectLocalLanguageCode(e),ye(e)},[]),ke=A.useCallback(()=>j(void 0,null,function*(){if(null==q?void 0:q.language){const e=yield kT.getSelectLocalLanguageCode(q,L.language);Ee(e)}}),[q,L.language,Ee]);A.useEffect(()=>{(null==q?void 0:q.language)&&ke()},[q,ke]);const Ie=A.useMemo(()=>{var e;return $x()&&!Yx("1.4.0",!1)||(null==h?void 0:h.chat_type)===ng.DeepResearch||!(null==(e=null==q?void 0:q.language)?void 0:e.length)||h.isMultiResponse?[{key:De.copy,text:L.t("Copy")}]:[{key:De.copy,text:L.t("Copy")},{key:De.translate,text:L.t("Translate")}]},[null==h?void 0:h.chat_type,null==(t=null==q?void 0:q.language)?void 0:t.length,L]),Te=A.useMemo(()=>(null==q?void 0:q.language)||[],[q]),je=A.useMemo(()=>(null==h?void 0:h.siblings)||WC(h.id||h.fid),[h]),Ne=A.useMemo(()=>(null==je?void 0:je.indexOf((null==h?void 0:h.id)||(null==h?void 0:h.fid)||""))+1,[h.fid,h.id,je]),Pe=A.useMemo(()=>null==je?void 0:je.length,[je]),Me=A.useMemo(()=>mg.map(e=>({title:L.t(e.title),content:e.content.map(e=>_(w({},e),{label:L.t(e.label)}))})),[L]),Ae=A.useMemo(()=>{var e;return(null==(e=null==N?void 0:N[(null==h?void 0:h.id)||""])?void 0:e.webSearchInfo)||[]},[N,null==h?void 0:h.id]),Re=A.useMemo(()=>{var e;return["RateLimited","ParallelLimited","quotaLimited"].includes((null==(e=null==h?void 0:h.error)?void 0:e.errorCode)||"")},[null==(n=null==h?void 0:h.error)?void 0:n.errorCode]),Le=A.useMemo(()=>{var e;return"NetworkError"===(null==(e=null==h?void 0:h.error)?void 0:e.errorCode)},[null==(i=null==h?void 0:h.error)?void 0:i.errorCode]),ze=A.useMemo(()=>{var e;return"data_inspection_failed"===(null==(e=null==h?void 0:h.error)?void 0:e.errorCode)},[null==(a=null==h?void 0:h.error)?void 0:a.errorCode]),Ue=A.useMemo(()=>{var e,t;return"Bad_Request"===(null==(e=null==h?void 0:h.error)?void 0:e.errorCode)&&"The chat is in progress!"===(null==(t=null==h?void 0:h.error)?void 0:t.errorMessage)},[null==(o=null==h?void 0:h.error)?void 0:o.errorCode,null==(s=null==h?void 0:h.error)?void 0:s.errorMessage]),He=A.useMemo(()=>{var e;return h.chat_type===ng.ImageGeneration&&!(null==(e=null==h?void 0:h.content_list)?void 0:e.find(e=>e.phase===og.IMAGE_GEN))},[h.chat_type,null==h?void 0:h.content_list]),Be=A.useMemo(()=>{var e;return h.chat_type===ng.ImageGeneration&&!He||!!(null==(e=h.content_list)?void 0:e.find(e=>[og.IMAGE_GEN_THINK,og.IMAGE_GEN_WEB_SEARCH,og.IMAGE_GEN].includes(e.phase)))},[He,h.chat_type,h.content_list]),$e=A.useMemo(()=>h.chat_type===ng.VideoGeneration,[h.chat_type]),qe=A.useMemo(()=>He||Be||$e,[He,Be,$e]),Ge=A.useMemo(()=>{var e,t,n,i;return((null==h?void 0:h.sub_chat_type)||h.chat_type)===ng.Txt2Txt&&((null==(n=null==(t=null==(e=null==h?void 0:h.content_list)?void 0:e[0])?void 0:t.content)?void 0:n.includes("```html"))||(null==(i=null==h?void 0:h.content)?void 0:i.includes("```html")))},[h.chat_type,null==h?void 0:h.content,null==h?void 0:h.content_list,null==h?void 0:h.sub_chat_type]),Ve=A.useMemo(()=>{var e;return h.chat_type===ng.Artifacts&&!(null==(e=null==h?void 0:h.content_list)?void 0:e.find(e=>{var t,n;return(null==(t=null==e?void 0:e.content)?void 0:t.includes("```html"))||(null==(n=null==e?void 0:e.content)?void 0:n.includes("```jsx"))}))},[h.chat_type,null==h?void 0:h.content_list]),We=A.useMemo(()=>{var e,t,n,i,a;if(!(null==(e=null==q?void 0:q.function_entry)?void 0:e.community))return!1;const o=JG((null==h?void 0:h.content_list)||[]);if(h.chat_type===ng.DeepResearch){if((null==h?void 0:h.sub_chat_type)===ng.Podcast&&!$x())return!0;if((null==h?void 0:h.sub_chat_type)===ng.DeepResearch)return!1;if(!(null==(t=null==h?void 0:h.content_list)?void 0:t.some(e=>{var t,n,i;return null==(i=null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.deep_research)?void 0:n.pdf)?void 0:i.link}))&&!Ge&&(null==h?void 0:h.sub_chat_type)!==ng.DeepResearchWebDev||o)return!1}if(Ge&&!(null==(n=null==h?void 0:h.content_list)?void 0:n.find(e=>VG(null==e?void 0:e.content)&&e.phase===og.ANSWER)))return!1;if(h.chat_type===ng.Travel){if((null==h?void 0:h.sub_chat_type)===ng.TRAVEL_RESEARCH)return!1;if(!(null==(i=null==h?void 0:h.content_list)?void 0:i.some(e=>{var t,n,i;return null==(i=null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.travel_research)?void 0:n.pdf)?void 0:i.link}))&&!Ge||o)return!1}return!(h.chat_type===ng.Artifacts&&(h.is_stop||Ve||!(null==(a=null==h?void 0:h.content_list)?void 0:a.find(e=>VG(null==e?void 0:e.content)&&e.phase===og.ANSWER))))&&(![ng.VideoGeneration,ng.Image2Video].includes(null==h?void 0:h.chat_type)||!$x())},[null==(r=null==q?void 0:q.function_entry)?void 0:r.community,Ve,Ge,h.chat_type,null==h?void 0:h.content_list,h.is_stop,null==h?void 0:h.sub_chat_type]),Qe=A.useMemo(()=>{var e,t;return null==(t=null==(e=null==q?void 0:q.permissions)?void 0:e.chat)?void 0:t.tts},[null==(c=null==(l=null==q?void 0:q.permissions)?void 0:l.chat)?void 0:c.tts]),Ye=A.useCallback(e=>j(void 0,null,function*(){C&&(yield kT.updateMultiChatHistory({messageId:h.id})),e()}),[C,h.id]),Xe=A.useMemo(()=>!("assistant"!==h.role||!h.parentId)&&QC(h.parentId),[h.parentId,h.role]),Je=A.useMemo(()=>!h.done||Re||Le||ze||Ue,[h.done,Re,Le,ze,Ue]),Ze=A.useMemo(()=>!!h.error||qe&&!!(null==p?void 0:p.media),[h.error,qe,null==p?void 0:p.media]),et=A.useMemo(()=>Be&&(null==h?void 0:h.chat_type)!==ng.ImageEdit,[Be,null==h?void 0:h.chat_type]),tt=A.useMemo(()=>{var e,t;return h.sub_chat_type||(null==(t=null==(e=null==h?void 0:h.extra)?void 0:e.meta)?void 0:t.subChatType)},[null==(d=null==(u=null==h?void 0:h.extra)?void 0:u.meta)?void 0:d.subChatType,h.sub_chat_type]),nt=A.useMemo(()=>{var e;const t=((e,t,n,i,a,o,s,r)=>{if(e)return BG.disable;let l=a?"VLO":(null==GG?void 0:GG[n])||"TW";switch(s&&(l="A"),r){case ng.Podcast:l="DP";break;case ng.INTERRUPT:l="RUPT";break;case ig.OmniAudio:case ig.OmniVideo:l="OMNI"}const c=(null==qG?void 0:qG[i])||"N";if(t){l="ALL";const e=`error_${l}_${c}`;if(e in BG)return BG[e]}if(a&&o)return BG[`normal_VLO_${c}_STOP`];const u=`normal_${l}_${c}`;return u in BG?BG[u]:BG.normal_TW_N})(Je,Ze,h.chat_type,I,et,null!=(e=null==h?void 0:h.is_stop)&&e,Ge,tt);let n=jt(t);return h.done&&Array.isArray(t)?(S&&(n=t.filter(e=>!(null==_e?void 0:_e.isTemp)&&!["edit","branch_new","regenerate","translation"].includes(e))),Xe&&(n=t.filter(e=>"branch_new"!==e))):n=[],tt===ng.Podcast&&G&&k?[]:n},[Je,Ze,h,I,et,Ge,tt,G,S,Xe,null==_e?void 0:_e.isTemp,k]),it=A.useMemo(()=>{const e=[];return ee&&e.push("voice"),e},[ee]),at=A.useMemo(()=>{const e=[];return le&&e.push("good"),ue&&e.push("bad"),te&&e.push("voice"),e},[ue,le,te]),ot=A.useMemo(()=>{const e=[];return ne&&e.push("voice"),e},[ne]),st=A.useMemo(()=>{const e=((e,t,n,i,a)=>{if(e||t)return[];let o=i?"VLO":(null==GG?void 0:GG[n])||"TW";a===ng.Podcast&&(o="DP");const s=`normal_${o}`;return $G[s]?$G[s]:[]})(Je,Ze,h.chat_type,et,tt);let t=jt(e);return S&&(t=e.filter(e=>!(null==_e?void 0:_e.isTemp))),t},[Je,Ze,h.chat_type,et,tt,S,null==_e?void 0:_e.isTemp]),rt=A.useMemo(()=>!0===h.edited,[h.edited]),lt=A.useCallback(()=>{var e,t;if(g(!0),bI.getInstance().stopAllPlayer(),C){if(!(null==Y?void 0:Y.id))return void X({name:"regenerateCallback",id:h.id});X(null)}let n=null;if("translate"===(null==h?void 0:h.sub_chat_type)&&(n={meta:w({},null==(e=null==h?void 0:h.extra)?void 0:e.meta)}),(null==h?void 0:h.sub_chat_type)===ng.Podcast){if(G||V)return void ht.open({type:"warning",content:L.t("In the conversation, please wait a moment.")});if(KC(W)>=5)return void ht.open({type:"warning",content:L.t("Youve reached the limit for podcast requests.")})}[ng.DeepResearch,ng.Travel].includes(h.chat_type)&&(M(h.sub_chat_type),n=_(w({},n),{meta:_(w({},null==(t=null==h?void 0:h.extra)?void 0:t.meta),{subChatType:h.sub_chat_type,user_action:"retry"})})),kT.closeShowControls(),kT.regenerateResponse(h,n)},[g,null==Y?void 0:Y.id,C,X,h,G,V,W,L]),ct=A.useCallback(e=>{g(!0),dS("clkCopyAnswer",{params:{et:"CLK"},aesParams:{c4:F,c5:null==h?void 0:h.id},paramsExtend:{chat_id:F,msg_id:null==h?void 0:h.id}});const t=e||(e=>{var t,n,i;return(null==e?void 0:e.content_list)&&(null==(t=null==e?void 0:e.content_list)?void 0:t.length)?null==(i=null==(n=null==e?void 0:e.content_list)?void 0:n.filter(e=>[og.ANSWER,og.INTERRUPT].includes(null==e?void 0:e.phase)))?void 0:i.map(e=>e.content).join("\n"):""})(h);QS(we===ng.WebSearch?Ev(t):t)},[F,we,h,g]),ut=A.useCallback(()=>{$x()?kT.adapter.invoke({method:"openHalfWindow",params:{type:"selectText",content:we===ng.WebSearch?Ev(XG(h)):XG(h),ext:`{"disable_translate": ${(null==h?void 0:h.chat_type)===ng.DeepResearch||h.chat_type===ng.Travel||h.isMultiResponse}}`,windowSize:100}}):U(!0)},[we,h]),dt=A.useCallback(()=>j(void 0,null,function*(){if(C){if(!(null==Y?void 0:Y.id))return void X({name:"shareCallback",id:h.id});X(null)}B(!0),dS("clkShareBtn",{params:{et:"CLK",c5:"chat"},paramsExtend:{chat_id:F,msg_id:h.id||""}})}),[null==Y?void 0:Y.id,F,C,h.id,X]),pt=A.useCallback(()=>j(void 0,null,function*(){const e=(null==(i=null==(n=(t=h).content_list)?void 0:n.findLast(e=>e.phase===og.IMAGE_GEN&&!!e.content))?void 0:i.content)||t.content;var t,n,i;g(!0),yield yC({role:"assistant",url:e}),dS("clkdownloadBtn",{params:{et:"CLK",c5:"chat",c6:e},paramsExtend:{chat_id:F,msg_id:h.id||""}})}),[L,h,g]),ft=A.useCallback(()=>{var e,t,n;if(x(!0),g(!0),C){if(!(null==Y?void 0:Y.id))return void X({name:"editCallback",id:h.id});X(null)}const i=[h.chat_type,h.sub_chat_type,null==(t=null==(e=null==h?void 0:h.extra)?void 0:e.meta)?void 0:t.subChatType].includes(ng.WebSearch),a=null==(n=h.content_list)?void 0:n.some(e=>e.phase===og.IMAGE_ZOOM_IN_TOOL);let o;o=i||a?YG(h):XG(h),$x()?(kT.firstOn(dE.MESSAGE_EDIT_SAVE,y),v(!0),kT.adapter.invoke({method:"openHalfWindow",params:{type:"edit",content:o,ext:""}})):f(o),dS("clkReviseMsg",{params:{et:"CLK",c4:"answer"},aesParams:{c5:F,c6:`${null==h?void 0:h.id}`},paramsExtend:{chat_id:F,msg_id:`${null==h?void 0:h.id}`}})},[null==Y?void 0:Y.id,F,y,C,h,X,g,f,x,v]),vt=A.useCallback(()=>{if(C){if(!(null==Y?void 0:Y.id))return void X({name:"voiceCallback",id:h.id});X(null)}oe(),T&&g(!0)},[null==Y?void 0:Y.id,C,h.id,T,X,g,oe]),yt=A.useCallback((e=ve,t)=>{var n,i;if(g(!0),Ee(e),U(!1),!q)return;const a=t||XG(h),o=q.language,s={type:"translate",messageId:h.id,extra:Sk(e),content:{text:Ck(L.t("Translate the following text into {{lang}}.",{lang:null!=(i=null==(n=o.find(t=>t.code===e))?void 0:n.title)?i:""}),`${L.t("TextTranslate")}${a}`,o.find(t=>t.code===e))}};D(Yf.TRANSLATE),kT.seleteOperation(s)},[ve,g,Ee,q,h,L,D]),bt=A.useCallback(()=>{kT.openArtifacts(h.id),$x()&&kT.nativeArtifactsShow(h)},[h]),xt=A.useCallback(()=>j(void 0,null,function*(){var e,t;if(UT())return void($x()?yield kT.adapter.invoke({method:"showAlert",params:{type:"login"}}):K(!0));const n=null==(t=null==(e=h.content_list)?void 0:e.findLast(e=>e.phase===og.IMAGE_GEN&&!!e.content))?void 0:t.content;$x()?(yield kT.openNewChat(),yield kT.adapter.invoke({method:"openMainChat",params:{inputText:"",modelId:h.model,actionScene:{type:ng.VideoGeneration,ext:{size:"16:9"}},imageList:[{imageUrl:n}]}})):yield kT.makeVideoOrImageByImageGen({chatType:ng.VideoGeneration,files:[{type:"image",name:"example.png",file_type:"image/png",showType:"image",file_class:"vision",url:n}]})}),[h.content_list,h.model,K]),wt=A.useCallback(()=>j(void 0,null,function*(){var e,t;const n=(null==(t=null==(e=h.content_list)?void 0:e.find(e=>e.phase===og.IMAGE_GEN&&!!e.content))?void 0:t.content)||"",i=[{type:"image",name:"example.png",file_type:"image/png",showType:"image",file_class:"vision",status:"uploaded",url:n}];h.chat_type===ng.ImageEdit?$x()?yield kT.adapter.invoke({method:"editImage",params:{url:n}}):Q(i):h.chat_type===ng.ImageGeneration&&($x()?(yield kT.openNewChat(),yield kT.adapter.invoke({method:"openMainChat",params:{inputText:"",modelId:h.model,actionScene:{type:ng.ImageEdit},imageList:[{imageUrl:n}]}}),kT.adapter.invoke({method:"setSendButtonEnabled",params:{value:!0}})):yield kT.makeVideoOrImageByImageGen({chatType:ng.ImageEdit,subChatType:ng.ImageEdit,files:i}))}),[h.chat_type,h.content_list,h.model,Q]),_t=A.useCallback(()=>{$x()?kT.adapter.invoke({method:"openPublishingRightsWindow",params:{from:"chat",chatId:F,msgId:h.id||""}}):xe(!0)},[F,h.id]),St=A.useCallback(()=>{V?ht.openOnce({type:"error",content:L.t("The current chat is not yet complete, please wait for a while and retry.")}):(bI.getInstance().stopAllPlayer(),kT.newChatBranch(h.id))},[L,h.id,V]),Ct=A.useCallback(()=>{if($x())Ce({type:ag.WebSearch,currentTab:Fe.sources});else{if(R(!0),T||h.chat_type===ng.DeepResearch)return P(ag.WebSearch),void O({messageId:h.id||"",citationIndex:0,tab:Fe.sources});Se(!0),P(ag.ThinkingAndSources),Z(null==h?void 0:h.id)}},[h.chat_type,h.id,T,Ce,Z,O,P,Se,R]),Et=A.useMemo(()=>({visible:rt,text:L.t("Edited")}),[L,rt]),kt=A.useMemo(()=>({visible:(null==je?void 0:je.length)>1,curSiblingsIndex:Ne,maxSiblings:Pe,onPreviousClick:e=>{e.stopPropagation(),kT.navigateToSiblingMessage(h,je,"previous")},onNextClick:e=>{e.stopPropagation(),kT.navigateToSiblingMessage(h,je,"next")}}),[Ne,Pe,h,je]);A.useEffect(()=>{!E&&C&&(fe(),x(!1),f(null))},[E,C,fe,h.id,f,x]),A.useEffect(()=>{C&&(null==Y?void 0:Y.id)&&h.id===(null==Y?void 0:Y.id)&&("badCallback"===(null==Y?void 0:Y.name)&&de(),"goodCallback"===(null==Y?void 0:Y.name)&&ce(),"editCallback"===(null==Y?void 0:Y.name)&&ft(),"shareCallback"===(null==Y?void 0:Y.name)&&dt(),"voiceCallback"===(null==Y?void 0:Y.name)&&vt(),"regenerateCallback"===(null==Y?void 0:Y.name)&&lt())},[null==Y?void 0:Y.id]);const It=A.useMemo(()=>({visible:h.done&&!!Ae.length&&!h.error,sourceListLogos:Ae,sourceListName:L.t("Sources"),sourceListCallback:Ct}),[L,h.done,h.error,Ct,Ae]),Tt=A.useMemo(()=>({controls:nt,disableControls:it,activeControls:at,loadingControls:ot,list:[{key:"artifacts",label:L.t("Preview"),controlType:T?"label-icon-primary":"label-icon-secondary",callback:bt,visible:!0},{key:"image_edit",label:L.t("Edit"),callback:wt,visible:!0},{key:"publish",label:L.t("Publish to community"),defaultToolTip:L.t("Publish to community"),callback:_t,visible:We},{key:"good",defaultToolTip:L.t("Good Response"),callback:()=>{Ye(ce)}},{key:"bad",defaultToolTip:L.t("Bad Response"),callback:()=>{Ye(de)}},{key:"regenerate",defaultToolTip:L.t("Regenerate"),callback:()=>{Ye(lt)}},{key:"copy",defaultToolTip:L.t("Copy"),callback:()=>{Ye(ct)}},{key:"edit",defaultToolTip:L.t("Edit"),callback:()=>{Ye(ft)}},{key:"share",defaultToolTip:L.t("Share"),callback:()=>{Ye(dt)}},{key:"download",defaultToolTip:L.t("Download"),callback:pt},{key:"create_video",label:L.t("Create video"),callback:xt},{key:"branch_new",label:L.t("Branch in new chat"),defaultToolTip:L.t("Branch in new chat"),callback:St},{key:"replay",label:L.t("Replay"),defaultToolTip:L.t("Replay"),visible:!1,callback:()=>{}},{key:"voice",visible:Qe,label:L.t("Read aloud"),defaultToolTip:L.t("Read aloud"),disabledTooltip:L.t("Currently, only Chinese and English are supported. More languages are coming soon."),activeTooltip:L.t("Stop"),callback:()=>{Ye(vt)},guideInfo:{visible:ie,buttonVisible:ae,buttonText:L.t("Choose voice"),title:L.t("New! Text-to-Speech"),content:L.t("Tap the play icon, and turn text into speech effortlessly. Make your reading experience more dynamic!"),onCloseClick:se,onButtonClick:re,onOpenChange:e=>{e||se()}}}]}),[nt,it,at,ot,L,T,bt,wt,_t,We,pt,xt,St,ie,ae,se,re,Ye,ce,de,lt,ct,ft,dt,vt,Qe]),Nt=A.useMemo(()=>({controls:st,disableControls:it,activeControls:at,loadingControls:ot,list:[{key:"artifacts",label:L.t("Preview"),callback:bt},{key:"image_edit",label:L.t("Image Edit"),callback:wt},{key:"publish",label:L.t("Publish"),callback:_t,visible:We},{key:"good",label:L.t("Good Response"),callback:ce},{key:"bad",label:L.t("Bad Response"),callback:de},{key:"regenerate",label:L.t("Regenerate"),callback:lt},{key:"copy",label:L.t("Copy"),callback:ct},{key:"edit",label:L.t("Edit"),callback:ft},{key:"select",label:L.t("Select text"),callback:ut},{key:"share",label:L.t("Share"),callback:dt},{key:"download",label:L.t("Download"),callback:pt},{key:"translation",label:L.t("Translate"),callback:yt,dropdown:{options:Te.map(e=>({key:e.code,label:e.title,value:e.translate})),value:ve,onChange:yt}},{key:"voice",label:L.t("Read aloud"),callback:vt,visible:Qe}]}),[st,it,at,ot,L,bt,wt,_t,We,ce,de,lt,ct,ft,ut,dt,pt,yt,Te,ve,vt,Qe]);return an.jsxs("div",{className:"response-message-footer",onClick:e=>e.stopPropagation(),children:[!m&&J&&an.jsx(wV,{editedData:Et,siblingsData:kt,sourceListData:It,controlData:Tt,moreText:L.t("More actions")}),an.jsx("button",{className:`${Vf.COPY_RESPONSE_BUTTON} response-message-footer-none`,onClick:()=>ct()}),T&&an.jsx(SV,{className:"response-message-footer-vertical",controlData:Nt}),!T&&he&&!C&&!$x()&&an.jsx("div",{className:"response-message-footer-bad-feedback",id:`message-feedback-${h.id}`,children:an.jsx(Ke,{title:L.t("Provide additional feedback"),defaultContents:pe,contentsWithGroup:Me,placeholder:L.t("(Optional) Feel free to add specific details"),submitBtnText:L.t("Submit"),defaultText:me,onCancel:fe,onSubmit:ge})}),!T&&C&&!$x()&&an.jsx(mt,{title:L.t("Provide additional feedback"),visible:he,onCancel:fe,headerBorderNone:!0,size:"large",footer:null,children:an.jsx(Ke,{className:"qwen-chat-response-message-footer-bad-feedback-multi-chat",header:!1,defaultContents:pe,contentsWithGroup:Me,placeholder:L.t("(Optional) Feel free to add specific details"),submitBtnText:L.t("Submit"),defaultText:me,feedbackAreaProps:{minRows:4},submitButtonProps:{size:"middle"},onCancel:fe,onSubmit:ge})}),T&&he&&!$x()&&an.jsx(gt,{open:he,title:L.t("Provide additional feedback"),heightType:"auto",onClose:fe,className:"mobile-feedback-popup",children:an.jsx(Ke,{header:!1,title:"",defaultContents:pe,contentsWithGroup:Me,placeholder:L.t("(Optional) Feel free to add specific details"),submitBtnText:L.t("Submit"),defaultText:me,onCancel:fe,onSubmit:ge})}),z&&ve&&an.jsx(Oe,{contentText:we===ng.WebSearch?Ev(XG(h)):XG(h),title:L.t("Select text"),languageCode:ve,languages:Te,menuList:Ie,show:z,onClose:()=>{U(!1)},onCopyHandler:ct,onTranslateHandler:yt}),an.jsx(IW,{chatId:F,show:H,setShow:B,messageId:h.id,onClose:()=>{B(!1)}}),an.jsx(IG,{open:be,onCancel:()=>{xe(!1)},messageId:h.id})]})}),jW=({children:e,onLongPress:t,menuRef:n,setCanHideMenu:i,canHideMenu:a=!0,setShowMenu:o,message:s})=>{const r=A.useRef(null),[l,c]=A.useState(null),u=A.useRef(null),d=A.useRef(!1),h=Lx();let p=null;const m=()=>{h&&(i(!1),o(!1),document.querySelectorAll(".user-message-footer-vertical").forEach(e=>{e.style.left="0",e.style.top="0",e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex=-1}),document.querySelectorAll(".qwen-chat-package-comp-action-control-vertical").forEach(e=>{e.style.left="0",e.style.top="0",e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex=-1}))},f=A.useCallback(e=>{var t;(null==(t=null==n?void 0:n.current)?void 0:t.contains(e.target))&&!a||(d.current=!1,m())},[a,n]);A.useEffect(()=>{a&&(d.current=!1,m())},[a]);const g=(e,t,i,a,o)=>{try{const s=document.querySelector(`#${bg}`);p&&clearTimeout(p),p=setTimeout(()=>{i||g(e,s,n,a,o);const r=null==s?void 0:s.getBoundingClientRect(),l=null==t?void 0:t.getBoundingClientRect(),c=null==i?void 0:i.getBoundingClientRect();if(c&&r&&l){const{height:t,width:n}=c,{x:i,width:s,y:u,height:d}=r,{x:h,y:p}=l;let m=a+h;m+n>i+s&&(m=i+s-n-10,a=m-h);o+t>u+d&&(o=o-t-20>0?o-t-20:0);const f=e.target.closest(".chat-response-message-right").querySelector(".response-message-footer").querySelector(".qwen-chat-package-comp-action-control-vertical");f&&(f.style.left=a+"px",f.style.top=o+"px",f.style.display="block",f.style.visibility="visible",f.style.position="fixed",f.style.zIndex=9)}},100)}catch(s){}},v=A.useCallback((e,i,a)=>{d.current=!0,o(!0);const s=document.querySelector(`#${bg}`),r=e.target.closest(".qwen-chat-message"),l=e.target.closest(".chat-response-message-right").querySelector(".response-message-footer").querySelector(".qwen-chat-package-comp-action-control-vertical");l.style.display="block",n.current=l;const c=a;let u=i;u=(null==l?void 0:l.offsetWidth)+u+50>(null==s?void 0:s.offsetWidth)?Math.max(0,i-(null==l?void 0:l.offsetWidth)-50):i+50,h&&l&&g(e,r,l,u,c),h&&(setTimeout(()=>{window.addEventListener("click",f)},500),null==t||t())},[f,h,t]),y=e=>{if(s.done&&e.touches){const t=e.touches[0],n=t.clientX,i=t.clientY;c({x:n,y:i}),u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{m(),e.target&&v(e,n,i)},500)}};return A.useEffect(()=>{if(!h||!s.done)return;const e=setTimeout(()=>{document.addEventListener("click",f)},300);return window.addEventListener("click",f),window.addEventListener("touchStart",f),window.addEventListener("touchmove",f),()=>{clearTimeout(e),document.removeEventListener("click",f),window.removeEventListener("click",f),window.removeEventListener("touchStart",f),window.removeEventListener("touchmove",f)}},[f,h,s.done]),an.jsxs(an.Fragment,{children:[h&&an.jsx("div",{ref:r,onClick:e=>e.stopPropagation(),className:h?"chat-response-message-right-touch":"",onPointerDownCapture:y,onTouchStartCapture:y,onTouchMoveCapture:e=>{if(!l||!s.done)return;const t=e.touches[0],n=t.clientX,i=t.clientY,a=n-l.x,o=i-l.y;Math.sqrt(b(a,2)+b(o,2))>5&&(f(e),u.current&&(clearTimeout(u.current),u.current=null),c(null))},onTouchEndCapture:()=>{u.current&&(window.clearTimeout(u.current),u.current=null),c(null)},style:{position:"relative"},children:e}),!h&&an.jsx("div",{children:e})]})},NW="index-module__resp-recommend-prompt___kh4Uy",PW=({message:e})=>{var t;const n=null==(t=null==e?void 0:e.info)?void 0:t.suggest,{onPromptSend:i}=TT();return Array.isArray(n)&&0!==n.length?an.jsx("div",{className:NW,children:an.jsx(Ye,{prompts:n,onClick:e=>{i({inputText:e})}})}):null},MW=A.memo(e=>{var t,n,i;const{message:a,detail:o,isStop:s}=e,r=zE(e=>e.realTheme),[l,c]=A.useState(!1),u=$(),d=A.useMemo(()=>(null==o?void 0:o.status)===sg.FINISHED?"finished":a.is_stop?"stoped":"loading",[a.is_stop,null==o?void 0:o.status]),h=A.useCallback(e=>j(void 0,null,function*(){(yield WS(e))&&ht.openOnce({type:"success",content:u.t("Copying to clipboard was successful!")})}),[u]),p=A.useCallback(e=>an.jsxs(an.Fragment,{children:[an.jsx(vt,{title:u.t("Copy"),children:an.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>h(e.text),children:an.jsx(pt,{type:"icon-line-copy-right"})})}),an.jsx(vt,{title:u.t("Download"),children:an.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>BV(e.text,"Qwen","python"),children:an.jsx(pt,{type:"icon-line-download-02"})})})]}),[u,h]),m=(null==(t=null==o?void 0:o.extra)?void 0:t.code_interpreter_info)||"",f=KS(null==(n=null==o?void 0:o.function_call)?void 0:n.arguments,{}),g=(e=>{if(!e)return"";const t=e.match(/```[^\n]*\n([\s\S]+?)```/);return t?`\`\`\`python\n${t[1]}\`\`\``:`\`\`\`python\n${e}\n\`\`\``})(null==f?void 0:f.code),v=(y=m,Array.from(y.matchAll(/!\[.*?\]\((.*?)\)/g),e=>e[1]));var y;v.map(e=>`![](${e})`).join("\n");const b=(x=null==o?void 0:o.status,w=s,"error"===d||x===sg.ERROR?u.t("Code Interpreter executed failed"):w||x===sg.PAUSE?u.t("Code Interpreter has been stopped"):x===sg.TYPING?u.t("Code Interpreter is running"):u.t("Code Interpreter executed successfully"));var x,w;const _=[sg.TYPING,sg.FINISHED].includes(null==o?void 0:o.status);return an.jsx("div",{children:an.jsxs("div",{className:"code-interpreter",children:[an.jsxs("div",{className:"image-reasoning-card",onClick:e=>{e.stopPropagation(),c(e=>!e)},children:[an.jsx("div",{className:"image-reasoning-card-icon",children:an.jsx(pt,{className:"iconfont",type:"icon-line-code-01",style:{color:_?"var(--character-brandprimary-text)":"var(--character-tertiary-text)"}})}),an.jsx("div",{className:"image-reasoning-card-title "+((null==o?void 0:o.status)===sg.TYPING?"image-reasoning-card-title-animate":""),children:b}),an.jsx("div",{className:"image-reasoning-card-open",children:l?an.jsx(pt,{type:"icon-line-chevron-down",className:"iconfont"}):an.jsx(pt,{type:"icon-line-chevron-right",className:"iconfont"})})]}),l&&an.jsxs("div",{className:"image-reasoning-detail "+((null==o?void 0:o.status)===sg.TYPING?"content-typing":""),children:[an.jsx(ze,{content:g,tokenProps:{code:{theme:r,headerActionsRender:p}}}),m&&Pt(v)&&an.jsxs(an.Fragment,{children:[an.jsx("div",{className:"image-reasoning-detail-status",children:null!=(i=null==u?void 0:u.t("Result"))?i:"Result"}),an.jsx(ze,{content:m,tokenProps:{code:{theme:r,headerActionsRender:p}}})]})]})]})})}),AW=z.memo(e=>{var t,n;const{detail:i,status:a=WV.RESULT_STATE}=e,o=zE(e=>e.realTheme),s=$(),[r,l]=A.useState(!1),[c,u]=A.useState(!1),d=A.useRef(!1),h=A.useRef(!1),p=A.useRef(null),m=A.useRef(200),f=A.useRef(null),g=A.useCallback(e=>j(void 0,null,function*(){(yield WS(e))&&ht.openOnce({type:"success",content:s.t("Copying to clipboard was successful!")})}),[s]),v=A.useCallback(e=>an.jsxs(an.Fragment,{children:[an.jsx(vt,{title:s.t("Copy"),children:an.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>g(e.text),children:an.jsx(pt,{type:"icon-line-copy-right"})})}),an.jsx(vt,{title:s.t("Download"),children:an.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>BV(e.text,"Qwen","python"),children:an.jsx(pt,{type:"icon-line-download-02"})})}),r&&an.jsx(vt,{title:s.t(c?"View Results":"Collapse Code"),children:an.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>{d.current=!c,h.current=!0,u(d.current)},children:an.jsx(pt,{type:"icon-line-maximise"})})})]}),[s,c,r,g]),y=(null==(t=null==i?void 0:i.extra)?void 0:t.code_interpreter_info)||"",b=KS(null==(n=null==i?void 0:i.function_call)?void 0:n.arguments,{}),x=(e=>{var t,n;if(!e)return"";const a=e.match(/```[^\n]*\n([\s\S]+?)```/);if(a)return`\`\`\`python\n${a[1]}\`\`\``;return`\`\`\`python${e}\n# Result ${(null==(n=null==(t=null==i?void 0:i.extra)?void 0:t.code_interpreter_info)?void 0:n.replace(/```/g,""))||""} \`\`\``})(null==b?void 0:b.code),w=(_=y,Array.from(_.matchAll(/!\[.*?\]\((.*?)\)/g),e=>e[1]));var _;const S=w.map(e=>`![](${e})`).join("\n"),C=A.useCallback(()=>{p.current&&setTimeout(()=>{if(p.current){const e=p.current.querySelectorAll(".qwen-markdown-code");if(e.length>0){const t=e[0];f.current=new ResizeObserver(()=>{t.getBoundingClientRect().height>m.current?(l(!0),d.current||h.current||u(!0)):l(!1)}),f.current.observe(t)}}},0)},[]);return A.useEffect(()=>{if(a===WV.RESULT_STATE)return requestAnimationFrame(()=>{C()}),()=>{f.current&&f.current.disconnect()}},[a,C]),an.jsxs("div",{className:"code-interpreter code-interpreter-single",children:[an.jsx("div",{className:`image-reasoning-detail image-reasoning-detail-single ${(null==i?void 0:i.status)===sg.TYPING&&a!==WV.RESULT_STATE?"content-typing":""} ${c?"image-reasoning-detail-collapse":""}`,ref:p,children:an.jsx(ze,{content:x,tokenProps:{code:{theme:o,headerActionsRender:v}}})}),(null==w?void 0:w.length)>0&&an.jsx(ze,{content:S,tokenProps:{image:{preview:{mask:null}},code:{theme:o}}})]})}),OW={[sg.TYPING]:"Analyzing image",[sg.FINISHED]:"Analyzing image completed",[sg.PAUSE]:"Analyzing image stopped",[sg.ERROR]:"Analyzing image failed"},RW=A.memo(({className:e=""})=>an.jsx("svg",{className:e,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",fill:"none",version:"1.1",width:"18",height:"18.000001907348633",viewBox:"0 0 18 18.000001907348633",children:an.jsx("g",{transform:"matrix(1,0,0,-1,0,36.000003814697266)",children:an.jsx("path",{d:"M0,35.00000190734863L0,31.000001907348633Q0,25.615231907348633,3.80761,21.807611907348633Q7.61523,18.000001907348633,13,18.000001907348633L17,18.000003218648633C17.5523,18.000003218648633,18,18.447718907348634,18,19.000001907348633C18,19.552291907348632,17.5523,20.000001907348633,17,20.000001907348633L13,20.000001907348633Q8.44365,20.000001907348633,5.22183,23.221831907348633Q2,26.44365190734863,2,31.000001907348633L2,35.00000190734863C2,35.552301907348635,1.55228,36.00000190734863,1,36.00000190734863C0.447715,36.00000190734863,0,35.552301907348635,0,35.00000190734863Z",fillRule:"evenodd",fill:"currentColor",fillOpacity:"0.5"})})})),DW=A.memo(({imageUrl:e,messageId:t})=>{const[n,i]=A.useState(!1),[a,o]=A.useState(0),s=A.useCallback(e=>j(void 0,null,function*(){i(!0);try{const{width:n,height:i}=yield(t=e,new Promise((e,n)=>{const i=new Image;i.crossOrigin="Anonymous",i.src=t,i.onload=function(){const t=i.width,n=i.height,a=i.naturalWidth,o=i.naturalHeight;e({width:t,height:n,naturalWidth:a,naturalHeight:o})},i.onerror=function(e){n(new Error(""+e))}}));n>i?o(264):n<i&&o(66)}catch(n){}var t;i(!1)}),[]),r=TG({mediaType:"image",messageId:t||"",preview:{actions:["download","share"],tip:""}});return A.useEffect(()=>{e&&s(e)},[e]),e?an.jsx("div",{className:"card-image-info",style:{background:n?"linear-gradient(90deg, rgba(216, 218, 227, 0.2) 20%, rgba(160, 162, 177, 0.32) 42%, rgba(216, 218, 227, 0.2) 67%)":`url(${e}) no-repeat center center / cover`,animation:n?"gradient-shift 3s ease infinite":"none",backgroundSize:n?"400% 400%":"cover"},children:an.jsx("div",{className:"card-image-info-wrapper",children:n?null:an.jsxs(an.Fragment,{children:[an.jsx(RW,{className:"card-image-info-icon card-image-info-icon-bl"}),an.jsx(RW,{className:"card-image-info-icon card-image-info-icon-br"}),an.jsx(RW,{className:"card-image-info-icon card-image-info-icon-tl"}),an.jsx(RW,{className:"card-image-info-icon card-image-info-icon-tr"}),an.jsx("div",{style:{width:`${a}px`,backgroundImage:`url(${e})`},className:"card-image-info-content",children:an.jsx(Ne,w({url:e},r))})]})})}):null}),LW=e=>{var t;const{detail:n,message:i,isStop:a}=e,o=$(),s=Ex(e=>e.mobile),r=vx(e=>e.setImageReasonData),l=vx(e=>e.chatId),c=zE(e=>e.setShowControls),u=Sx(e=>e.setCurrentShowControl),d=Sx(e=>e.taskRunning),[h,p]=A.useState(!1),m=A.useMemo(()=>(null==i?void 0:i.error)?"error":(null==i?void 0:i.done)?"done":d?"loading":"pause",[null==i?void 0:i.done,null==i?void 0:i.error,d]),f=A.useMemo(()=>n.status===sg.FINISHED?o.t("Thinking with image completed"):"error"===m||n.status===sg.ERROR?o.t("Thinking with image failed"):a||n.status===sg.PAUSE?o.t("Thinking with image stopped"):n.status===sg.TYPING?o.t("Thinking with image is running"):"",[n.status,o,a,m]),g=A.useMemo(()=>{var e,t,i;return(null==(i=null==(t=null==(e=null==n?void 0:n.extra)?void 0:e.image_zoom_in_tool_info)?void 0:t[0])?void 0:i.image)||""},[null==(t=null==n?void 0:n.extra)?void 0:t.image_zoom_in_tool_info]),v=A.useMemo(()=>[sg.TYPING,sg.FINISHED].includes(null==n?void 0:n.status),[null==n?void 0:n.status]),y=A.useMemo(()=>(null==n?void 0:n.status)===sg.TYPING&&"loading"===m,[null==n?void 0:n.status,m]),b=A.useCallback(e=>{if(e.stopPropagation(),p(!h),$x())return kT.adapter.invoke({method:"storeInfo",params:{key:"chatNativeImageReason",value:JSON.stringify({status:null==n?void 0:n.status,imageUrl:g,messageId:i.id})}}),void kT.adapter.invoke({method:"openHalfWindow",params:{type:"openUrl",windowSize:50,content:`${location.origin}/mobile/chatcontrols/imageReason?id=${l}`}});s&&(c(!0),u(ag.ImageReason),r({status:(null==n?void 0:n.status)||"",imageUrl:g,messageId:i.id}))},[l,null==n?void 0:n.status,g,i.id,s,u,r,c,h]);return A.useEffect(()=>{h&&[sg.TYPING,sg.FINISHED].includes(null==n?void 0:n.status)&&(s&&r({status:(null==n?void 0:n.status)||"",imageUrl:(null==n?void 0:n.imageUrl)||g,messageId:i.id}),$x()&&kT.adapter.invoke({method:"storeInfo",params:{key:"chatNativeImageReason",value:JSON.stringify({status:null==n?void 0:n.status,imageUrl:g})}}))},[n,null==n?void 0:n.status,g,i.id,s,r,h]),an.jsxs("div",{className:"qwen-chat-comp-chat-mage-reasoning",children:[an.jsxs("div",{className:"qwen-chat-comp-chat-mage-reasoning-card",onClick:b,children:[!s&&an.jsx("div",{className:"qwen-chat-comp-chat-mage-reasoning-card-icon",children:an.jsx(pt,{type:"icon-line-image-reason",style:{color:`var(${v?"--character-brandprimary-text":"--character-tertiary-text"})`}})}),an.jsx("div",{className:"qwen-chat-comp-chat-mage-reasoning-card-title "+(y?"qwen-chat-comp-chat-mage-reasoning-card-title-animate":""),children:f}),an.jsx("div",{className:"qwen-chat-comp-chat-mage-reasoning-card-open",children:an.jsx(pt,{type:h&&!s?"icon-line-chevron-down":"icon-line-chevron-right"})})]}),!s&&h&&an.jsxs("div",{className:"qwen-chat-comp-chat-mage-reasoning-detail",children:[an.jsx("div",{className:"qwen-chat-comp-chat-mage-reasoning-detail-status",children:o.t(OW[(null==n?void 0:n.status)||sg.TYPING]||"")}),(null==n?void 0:n.status)===sg.FINISHED&&an.jsx(DW,{imageUrl:g})]})]})},FW=A.memo(({message:e,isDeepResearch:t,isLastMessage:n})=>{var i,a;const o=Ex(e=>e.mobile),s=Sx(e=>e.visionGenerating),r=Sx(e=>e.taskRunning),l=$(),c=A.useMemo(()=>s||r,[s,r]),u=A.useRef(e),d=A.useRef(null);A.useEffect(()=>{u.current=e},[e]);const[h,p]=A.useState(Xe.GEN_PROCESS),m=A.useRef(h),f=A.useMemo(()=>ZS(null==e?void 0:e.timestamp),[null==e?void 0:e.timestamp]),g=A.useMemo(()=>{var t,n;let i="";return(null==e?void 0:e.chat_type)===ng.Artifacts||(null==e?void 0:e.chat_type)===ng.WebDev?(i=((null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.meta)?void 0:n.subChatType)||e.sub_chat_type)===ng.WebDev?l.t("Web Dev"):l.t("Artifacts"),i):(Array.isArray(null==e?void 0:e.content_list)&&e.content_list.map(e=>{var t;return e.phase!==og.ANSWER&&e.phase!==og.DEEPTHINKING||(i=null==(t=e.extra)?void 0:t.topic),i}),i)},[null==e?void 0:e.content_list,null==e?void 0:e.chat_type,null==(a=null==(i=null==e?void 0:e.extra)?void 0:i.meta)?void 0:a.subChatType,e.sub_chat_type,l]),v=A.useMemo(()=>({loadingText:l.t("Youll be informed immediately upon completion."),errorText:l.t("Generation failed. Please try again.")}),[l]);A.useEffect(()=>{if(e){let t=Xe.GEN_PROCESS;(null==e?void 0:e.error)?t=Xe.GEN_ERROR:(!c||(null==e?void 0:e.done)||(null==e?void 0:e.is_stop))&&(t=Xe.FINISH),p(t)}},[e,c]);const y=t=>{var n;$x()?kT.nativeArtifactsUpdata(u.current,!e.done&&!e.error&&!(null==e?void 0:e.is_stop)):kT.updataArtifacts(null==(n=u.current)?void 0:n.id,t)},b=t=>{d.current=setInterval(()=>{e.done||e.error||(null==e?void 0:e.is_stop)?(y(t),clearInterval(d.current),d.current=null):y(t)},200)},x=({open:t}={})=>{var n,i;if($x())return Sx.setState({currentShowControl:ag.Artifacts}),kT.nativeArtifactsShow(u.current,void 0,!e.done&&!e.error&&!(null==e?void 0:e.is_stop)),void(e.done||e.error||(null==e?void 0:e.is_stop)?kT.emit(dE.MESSAGE_STOP_ARTIFACTS_LOOP):(clearInterval(d.current),b(!0)));if(kT.getCurrentChatCurrentId()===(null==(n=u.current)?void 0:n.id)||!t){const n=kT.openArtifacts(null==(i=u.current)?void 0:i.id,t);e.done||e.error||(null==e?void 0:e.is_stop)||!n?kT.emit(dE.MESSAGE_STOP_ARTIFACTS_LOOP):(clearInterval(d.current),b(o))}};A.useEffect(()=>{m.current=h,(e.done||e.error||(null==e?void 0:e.is_stop))&&d.current&&(d.current&&y(o),kT.emit(dE.MESSAGE_STOP_ARTIFACTS_LOOP))},[e]);return A.useEffect(()=>{if(!t&&!o&&e.id&&n)return e.done||e.error||(null==e?void 0:e.is_stop)||x({open:!0}),()=>{clearInterval(d.current)}},[]),A.useEffect(()=>{const e=()=>{clearInterval(d.current),d.current=null};return kT.on(dE.MESSAGE_STOP_ARTIFACTS_LOOP,e),()=>{kT.off(dE.MESSAGE_STOP_ARTIFACTS_LOOP,e)}},[]),an.jsx(Be,{className:"pdf-card",onCardClick:()=>{(t&&h!==Xe.GEN_PROCESS||!t)&&(kT.emit(dE.MESSAGE_STOP_ARTIFACTS_LOOP),x())},info:{time:f,name:g},tipTexts:v,status:h,type:$e.WEBPAGE,toolsOption:{loofOver:{visible:!t,onLookOver:()=>{kT.emit(dE.MESSAGE_STOP_ARTIFACTS_LOOP),x()}}}})}),zW=e=>{var t,n,i,a,o,s,r;const{message:l,isOldMessageInNewBranch:c,isMultiChat:u,active:d,isModelComparison:h,boxId:p}=e,{i18n:m}=$(),f=zE(e=>e.isSharePage),{chatId:g,historyCurrentId:v}=vx(_j(e=>({chatId:e.chatId,historyCurrentId:e.history.currentId}))),{voicePlayingMessageId:y,unsupportedLanguageVoicePlayMessageIds:b,setUnsupportedLanguageVoicePlayMessageIds:x}=MT(_j(e=>({voicePlayingMessageId:e.voicePlayingMessageId,unsupportedLanguageVoicePlayMessageIds:e.unsupportedLanguageVoicePlayMessageIds,setUnsupportedLanguageVoicePlayMessageIds:e.setUnsupportedLanguageVoicePlayMessageIds}))),[S,C]=A.useState(!0),[E,k]=A.useState(!1),[I,T]=A.useState({}),[N,P]=A.useState(null),[M,O]=A.useState(!1),R=A.useRef(!1),[D,L]=A.useState(!1),F=A.useRef(null),z=A.useMemo(()=>{var e,t;return l.sub_chat_type===ng.Podcast||(null==(t=null==(e=null==l?void 0:l.extra)?void 0:e.meta)?void 0:t.subChatType)===ng.Podcast},[l.sub_chat_type,null==l?void 0:l.extra]),U=A.useMemo(()=>{var e;const t=!!(null==(e=l.content_list)?void 0:e.find(e=>[og.IMAGE_GEN].includes(e.phase)));return[ng.ImageGeneration,ng.ImageEdit,ng.VideoGeneration].includes(l.chat_type)||t||z},[l.content_list,l.chat_type,z]),H=A.useMemo(()=>{var e;return"data_inspection_failed"===(null==(e=null==l?void 0:l.error)?void 0:e.errorCode)},[null==l?void 0:l.error]),B=A.useMemo(()=>{var e,t;return!!l.id&&(!(H||l.sub_chat_type!==ng.DeepResearchWebDev&&l.chat_type!==ng.Artifacts&&l.chat_type!==ng.WebDev)||(l.sub_chat_type&&[ng.DeepResearchWebDev].includes(l.sub_chat_type)||[ng.DeepResearchWebDev].includes(null==(t=null==(e=null==l?void 0:l.extra)?void 0:e.meta)?void 0:t.subChatType)))},[H,l.id,l.sub_chat_type,l.chat_type,null==(n=null==(t=null==l?void 0:l.extra)?void 0:t.meta)?void 0:n.subChatType]),q=A.useMemo(()=>!U&&!B,[U,B]),G=A.useMemo(()=>{var e;return!(null==l?void 0:l.is_stop_in_thinking)&&(null==(e=l.content_list)?void 0:e.some(e=>{var t;return[og.THINK,og.TOOL,og.LOCAL_TOOL,og.DEEPTHINKING,og.CODE_INTERPRETER,og.INTERRUPT].includes(e.phase)||e.phase===og.ANSWER&&(null==(t=e.content)?void 0:t.length)}))},[null==l?void 0:l.is_stop_in_thinking,l.content_list]),V=A.useMemo(()=>{var e;return(null==l?void 0:l.is_stop_in_thinking)&&(null==(e=l.content_list||[])?void 0:e.filter(e=>{var t;return e.phase===og.ANSWER&&(null==(t=e.content)?void 0:t.length)}).length)>0},[null==l?void 0:l.is_stop_in_thinking,l.content_list]),W=vg((null==l?void 0:l.sub_chat_type)||(null==(a=null==(i=null==l?void 0:l.extra)?void 0:i.meta)?void 0:a.subChatType))&&(null==(o=l.content_list)?void 0:o.find(e=>[og.RESEARCHPLANNING].includes(e.phase))),Q=A.useMemo(()=>!(null==l?void 0:l.done)&&!G&&!V&&!W&&q,[null==l?void 0:l.done,G,V,W,q]),K=A.useMemo(()=>!(l.done||!(null==l?void 0:l.functionCallType)||![Zf.CODE_INTERPRETER].includes(null==l?void 0:l.functionCallType)),[l]),X=A.useMemo(()=>!!(null==l?void 0:l.error),[null==l?void 0:l.error]),J=A.useMemo(()=>{var e;return(!l.is_stop_in_thinking&&JG((null==l?void 0:l.content_list)||[])||!!(null==l?void 0:l.is_stop_in_thinking)&&JG(null==(e=(null==l?void 0:l.content_list)||[])?void 0:e.filter(e=>e.phase===og.ANSWER)))&&(null==l?void 0:l.done)&&!U&&!X},[l.is_stop_in_thinking,null==l?void 0:l.content_list,null==l?void 0:l.done,U,X]),Z=(e,t,n=!0)=>j(void 0,null,function*(){const i=vx.getState().history;kT.editMessage({messageId:e,content:t,history:i,submit:n})}),ee=(e,t=!1)=>j(void 0,null,function*(){var n,i;if(L(!1),$x()&&!R.current)return;O(!1);const a=e.replace(/\s+/g,"");if(""===e||0===a.length)return ht.open({type:"error",content:m.t("The content cannot be empty!")}),!1;let o;y===l.id&&bI.getInstance().stopAllPlayer();o=[l.chat_type,l.sub_chat_type,null==(i=null==(n=null==l?void 0:l.extra)?void 0:n.meta)?void 0:i.subChatType].includes(ng.WebSearch)?YG(l):XG(l);const{success:s,data:r}=yield K_({origin_content:o,new_content:e});if(!s&&"data_inspection_passed"!==r.message)return;const c=((e,t)=>{const{thinkingQuoteText:n}=KG((null==t?void 0:t.content)||""),i=(null==n?void 0:n.length)?`<think>${n}</think>`:"";return(null==i?void 0:i.length)?i+e:e})(e,l);t?Z(l.id,e?c:""):Z(l.id,e?c:"",!1),P(null),bI.getInstance().destroyTTS(g,l.id||""),x(b.filter(e=>e!==l.id))}),te=A.useCallback(()=>{T(e=>_(w({},e),{media:!0}))},[]);A.useEffect(()=>{R.current=M},[M]);const ne=A.useMemo(()=>l.id===v,[v,l.id]),[ie,ae]=A.useState(!1);return an.jsx("div",{className:Y("chat-response-message"),id:`chat-response-message-${l.id||""}`,children:an.jsxs("div",{className:"chat-response-message-right",children:[!Q&&!X&&null===N&&an.jsx(an.Fragment,{children:U?an.jsx(zV,{message:l,onMediaError:te,podcastAsyncLoading:ie,setPodcastAsyncLoading:ae}):an.jsxs(jW,{menuRef:F,canHideMenu:S,setCanHideMenu:C,setShowMenu:k,message:l,children:[an.jsx(eW,{message:l}),an.jsx(dW,{message:l}),an.jsx(yW,{message:l}),B&&an.jsx(FW,{message:l,isDeepResearch:l.sub_chat_type===ng.DeepResearchWebDev||(null==(r=null==(s=l.extra)?void 0:s.meta)?void 0:r.subChatType)===ng.DeepResearchWebDev,isLastMessage:ne}),q&&(l.content_list||[]).map((e,t)=>{var n,i,a,o,s;switch(e.phase){case og.INTERRUPT:case og.ANSWER:case og.DEEPTHINKING:return an.jsx(TV,{message:l,boxId:p,phase:e.phase,children:an.jsx(GV,{message:l,phaseContentIndex:t},t)});case og.THINK:return an.jsx(vW,{message:l,phaseContentIndex:t},t);case og.WEB_SEARCH:return an.jsx(eW,{message:l,phaseContentIndex:t},t);case og.PdfMdGen:return an.jsx(gW,{timestamp:l.timestamp,info:_(w({},(null==(n=null==e?void 0:e.extra)?void 0:n.deep_research)||(null==(i=null==e?void 0:e.extra)?void 0:i.travel_research)||{}),{messageId:l.id}),subChatType:(null==l?void 0:l.sub_chat_type)||(null==(o=null==(a=null==l?void 0:l.extra)?void 0:a.meta)?void 0:o.subChatType)},t);case og.RESEARCHPLANNING:return null;case og.TOOL:case og.LOCAL_TOOL:return an.jsx(yW,{message:l,phaseContentIndex:t},t);case og.IMAGE_ZOOM_IN_TOOL:return an.jsx(LW,{detail:e,message:l,isStop:l.is_stop});case og.CODE_INTERPRETER:return(null==(s=null==l?void 0:l.feature_config)?void 0:s.thinking_enabled)?null:an.jsx(MW,{detail:e,isStop:l.is_stop,message:l});default:return null}})]})}),null!==N&&an.jsx(bW,{editedContent:N||"",setEditedContent:P,setIsEdit:L,handleSaveEditMessage:ee}),Q&&an.jsx(xW,{message:l}),K&&an.jsx(wW,{}),X&&an.jsx(_W,{message:l}),J&&q&&an.jsx(CW,{}),!h&&an.jsx(TW,{isMultiChat:u,active:d,setCanHideMenu:C,showMenu:E,message:l,isOldMessageInNewBranch:c,isEdit:D,setIsEdit:L,error:I,isRenderEmpty:J,setEditedContent:P,setNativeEditing:O,editSaveHandler:e=>ee(e),podcastAsyncLoading:ie},l.fid||l.id),ne&&!f&&!h&&an.jsx(PW,{message:l})]})})},UW=e=>{const{messageId:t,boxId:n}=e,i=Ex(e=>e.mobile),a=Sx(e=>e.temporaryChatEnabled),o=zE(e=>e.isSharePage),s=vx(e=>e.chatId),r=vx(e=>e.history.currentId),l=A.useRef(null),[c,u]=A.useState(0),[d,h]=A.useState(!1),[p,m]=A.useState(0),[f,g]=A.useState(0),{groupedMessageIds:v,groupedMessageIdsIdx:y}=((e,t)=>{const[n,i]=A.useState({}),[a,o]=A.useState({});return A.useEffect(()=>{if(!e||!t)return;const n=vx.getState().history,a=n.messages[e].parentId?n.messages[n.messages[e].parentId]:null,s=null==a?void 0:a.models.reduce((e,t,i)=>{let o=null==a?void 0:a.childrenIds.map(e=>n.messages[e]).filter(e=>(null==e?void 0:e.modelIdx)===i).map(e=>e.id);if(0===o.length){const e=null==a?void 0:a.childrenIds.map(e=>n.messages[e]).filter(e=>(null==e?void 0:e.model)===t);e.forEach(e=>{e.modelIdx=i}),o=e.map(e=>e.id)}return _(w({},e),{[i]:{messageIds:o}})},{}),r=null==a?void 0:a.models.reduce((t,n,i)=>{var a;const o=null==(a=null==s?void 0:s[i])?void 0:a.messageIds,r=o.findIndex(t=>t===e);return _(w({},t),-1!==r?{[i]:o[r]}:{[i]:o[o.length-1]})},{});i(s),o(r)},[e,t]),{groupedMessageIds:n,groupedMessageIdsIdx:a}})(t,r),b=A.useMemo(()=>Object.keys(v).length,[v]),x=A.useCallback(e=>{var n;if(e&&t!==e){let t=e;const i=vx.getState().history;let a=i.messages[t||""].childrenIds;for(;0!==a.length;)t=a.slice(-1)[0],a=(null==(n=i.messages[t||""])?void 0:n.childrenIds)||[];kT.updateChatHistory({currentId:t})}},[t,o,a]),S=A.useCallback(e=>{i&&(e.preventDefault(),h(!0),m(e.touches[0].clientX))},[i]),C=A.useCallback(e=>{var t;if(!i||!d)return;e.preventDefault(),e.stopPropagation();const n=e.touches[0].clientX,a=100*-c+(n-p)/((null==(t=l.current)?void 0:t.offsetWidth)||1)*100,o=100*-(b-1);g(Math.max(o,Math.min(0,a)))},[i,d,p,c,b]),E=A.useCallback(e=>{if(!i||!d)return;e.preventDefault(),h(!1);const t=e.changedTouches[0].clientX-p;let n=c;if(Math.abs(t)>50&&(t>0&&c>0?n=c-1:t<0&&c<b-1&&(n=c+1)),u(n),g(100*-n),n!==c){const e=y[n];e&&x(e)}},[i,d,p,c,b,y,x]);A.useEffect(()=>{if(i){const e=Object.entries(y).findIndex(([e,n])=>n===t);-1!==e&&e!==c&&(u(e),g(100*-e))}},[t,y,i,c]),A.useEffect(()=>{if(i&&d)return document.body.style.overflow="hidden",document.body.style.touchAction="none",()=>{document.body.style.overflow="",document.body.style.touchAction=""}},[i,d]);const k=()=>an.jsx(an.Fragment,{children:Object.keys(v).map(Number).map(e=>{var i;const a=y[e];let o=vx.getState().history.messages[a||""];const r=null==(i=v[e])?void 0:i.messageIds;return o=_(w({},o),{siblings:r}),an.jsx("div",{className:Y("chat-multi-response-message-card",{active:t===a,"one-response-share":s.startsWith("t_")}),onClick:()=>x(a),children:an.jsx(zW,{isMultiChat:!0,boxId:n,active:t===a,message:o})},a)})});return an.jsx("div",{className:Y("chat-multi-response-message",{mobile:i,swiping:d,"chat-multi-response-message-mac":"MACOS"===Wx(),"chat-multi-response-message-windows":"MACOS"!==Wx()}),children:i?an.jsx("div",{ref:l,className:"chat-multi-response-message-container",style:{transform:`translateX(${f}%)`},onTouchStart:S,onTouchMove:C,onTouchEnd:E,children:k()}):k()})},HW=({line:e=!0,children:t})=>an.jsxs("div",{className:"message-divider",children:[an.jsx("div",{className:"message-divider-line",style:{opacity:e?1:0}}),an.jsx("div",{className:"message-divider-text",children:t}),an.jsx("div",{className:"message-divider-line",style:{opacity:e?1:0}})]}),BW=e=>{const{multiResponseMessagesLength:t,messageIds:n,parentId:i,currentIndex:a,className:o,setCurrentIndex:s}=e,r=Ex(e=>e.mobile),l=A.useRef(null),[c,u]=A.useState(!1),[d,h]=A.useState(0),[p,m]=A.useState(0),f=A.useCallback(e=>{r&&(e.preventDefault(),u(!0),h(e.touches[0].clientX))},[r]),g=A.useCallback(e=>{var n;if(!r||!c)return;e.preventDefault(),e.stopPropagation();const i=e.touches[0].clientX,o=100*-a+(i-d)/((null==(n=l.current)?void 0:n.offsetWidth)||1)*100,s=100*-(t-1);m(Math.max(s,Math.min(0,o)))},[r,c,d,a,t]),v=A.useCallback(e=>{var o,h;if(!r||!c)return;u(!1);const p=e.changedTouches[0].clientX-d;let f=a;Math.abs(p)>50&&(p>0&&a>0?f=a-1:p<0&&a<t-1&&(f=a+1)),s(f);const g=(null==(o=l.current)?void 0:o.offsetWidth)||0,v=(null==(h=document.getElementById(i))?void 0:h.offsetWidth)||0;m(g&&v&&f?-f*Math.floor((g-(v-g-15))/g*100):100*-f),f!==a&&n[f]},[r,c,d,a,t,i,n]);return A.useEffect(()=>{if(r&&c)return document.body.style.overflow="hidden",document.body.style.touchAction="none",()=>{document.body.style.overflow="",document.body.style.touchAction=""}},[r,c]),an.jsx("div",{ref:l,className:o,style:{transform:`translateX(${p}%)`},onTouchStart:f,onTouchMove:g,onTouchEnd:v,children:e.children})},$W=({message:e,regenerateResponse:t,boxId:n})=>{const{t:i,i18n:a}=$(),o=A.useRef(null),s=A.useRef([]);zE(e=>e.showSidebar);const r=vx(e=>e.chatId),l=Ex(e=>e.mobile),[c,u]=A.useState(0),d=vx(e=>e.history.messages),h=A.useMemo(()=>{var t;const n=e.id?null==(t=d[e.id])?void 0:t.parentId:void 0;return n?d[n]:null},[d,e]),p=A.useMemo(()=>{var e;return(null==(e=null==h?void 0:h.childrenIds.filter(e=>e))?void 0:e.slice(-2))||[]},[h]),m=A.useMemo(()=>p.map(e=>d[e]).filter(e=>e),[d,p]),{scrollStates:f,updateScrollState:g}=(e=>{const[t,n]=A.useState(Array(e).fill({showUp:!1,showDown:!1}));return{scrollStates:t,updateScrollState:A.useCallback((e,t,i)=>{n(n=>{var a,o;if((null==(a=n[e])?void 0:a.showUp)!==t||(null==(o=n[e])?void 0:o.showDown)!==i){const a=[...n];return a[e]={showUp:t,showDown:i},a}return n})},[])}})(m.length),v=A.useCallback(e=>{const t=s.current[e];if(!t)return;const{scrollTop:n,scrollHeight:i,clientHeight:a}=t;g(e,n>1,n<i-a-1)},[g]),y=A.useCallback(e=>{var t;null==(t=s.current[e])||t.scrollTo({top:0,behavior:"smooth"})},[]),b=A.useCallback(e=>{const t=s.current[e];t&&t.scrollTo({top:t.scrollHeight,behavior:"smooth"})},[]);A.useEffect(()=>{const e=[];return s.current.forEach((t,n)=>{if(t){v(n);const i=new ResizeObserver(()=>v(n));i.observe(t.getElementsByClassName("chat-response-message")[0]),e.push(i)}}),()=>{e.forEach(e=>e.disconnect())}},[v]);const x=A.useCallback(e=>j(void 0,null,function*(){var t,n,i,a;const s=m[e].id;if(!s)return;const l=null==(t=d[s])?void 0:t.parentId;if(!l)return;var c;yield(c={id:r,messageIds:[s]},j(void 0,[c],function*({id:e,messageIds:t}){return yield ow(`/chats/${e}/messages/select`,{method:"POST",data:{ids:t}})}));const u=(null==(n=d[l])?void 0:n.childrenIds)||[],h=u.find(e=>e!==s),p=jt(d);(null==(i=p[s])?void 0:i.parentId)&&(p[null==(a=p[s])?void 0:a.parentId].childrenIds=u.filter(e=>e!==h)),u.forEach(e=>{p[e].isMultiResponse=!1}),h&&Reflect.deleteProperty(p,h),kT.updateChatHistory({messages:p,currentId:s,currentResponseIds:[s]}),requestAnimationFrame(()=>{var e;null==(e=o.current)||e.scrollIntoView({behavior:"smooth",block:"nearest"})})}),[m,d,r]),w=A.useCallback((e,a)=>{var o,r,l,c;const u="data_inspection_failed"===(null==(o=null==e?void 0:e.error)?void 0:o.errorCode);return an.jsxs("div",{className:"response-message-box",id:`${e.id}-response-message-box`,children:[an.jsx("div",{className:"smulti-o-header",children:i("Response {{num}}",{num:a+1})}),an.jsx("div",{className:"smulti-o-content",ref:e=>{s.current[a]=e},onScroll:()=>v(a),children:an.jsx(zW,{isModelComparison:m.length>1,message:e,regenerateResponse:t,boxId:n})}),(null==(r=f[a])?void 0:r.showDown)&&an.jsx("div",{className:"smuti-o-content-mask"}),(null==(l=f[a])?void 0:l.showDown)&&an.jsx("div",{className:"smuti-o-content-scroll-bottom",onClick:()=>b(a),children:an.jsx(pt,{type:"icon-line-arrow-down"})}),(null==(c=f[a])?void 0:c.showUp)&&an.jsx("div",{className:"smuti-o-content-scroll-top",onClick:()=>y(a),children:an.jsx(pt,{type:"icon-line-arrow-up"})}),!u&&an.jsx("div",{className:"smulti-o-footer",children:an.jsx(ft,{type:"brandsecondary",rounded:"circle",className:"smulti-make-better",onClick:()=>x(a),disabled:!(null==e?void 0:e.done),children:i("{{param}} is better",{param:0===a?"A":"B"})})})]},e.id||a)},[f,v,b,y,x,i,t,m.length,n]),_=A.useCallback(()=>an.jsx(an.Fragment,{children:m.map((e,t)=>w(e,t))}),[m,w]),S=A.useCallback(()=>an.jsx(BW,{className:"smulti-o-response-message-container",multiResponseMessagesLength:2,messageIds:m.map(e=>e.id),parentId:C,setCurrentIndex:u,currentIndex:c,children:_()}),[m,_,c]),C=A.useMemo(()=>"smulti-o-response-message",[]);return an.jsxs("div",{className:"smulti-o-response-message",ref:o,id:C,children:[m.length>1&&an.jsxs("div",{className:"smulti-o-prefer-choice-tip",children:[an.jsx("p",{className:"tip-title",children:i("This feedback will help us evaluate and enhance Qwen Chats performance.")}),an.jsx("p",{className:"tip-text",children:i("Which response do you prefer? Select one to continue.")})]}),m.length?an.jsx("div",{className:Y("smulti-o-response-message-wrapper",{"smulti-o-response-message-mac":"MACOS"===Wx()&&!l,"smulti-o-response-message-windows":"MACOS"!==Wx()&&!l}),children:l?S():_()}):an.jsx(zW,{message:e,regenerateResponse:t,boxId:n}),m.length>1&&l&&an.jsx("div",{className:"smulti-o-response-message-pagination",children:m.map((e,t)=>an.jsx("div",{className:Y("smulti-o-response-message-pagination-dot",{"smulti-dot-active":t===c})},t))})]})},qW=A.memo(({message:e,handleDeleteMessage:t,isOldMessageInNewBranch:n})=>{const i=$(),a=Ex(e=>e.mobile),o=vx(e=>e.branchInfo),s=Ty(),r=A.useMemo(()=>`qwen-chat-message-${"user"===e.role?"user":"assistant"}-${e.id}`,[e]),l=vx(e=>e.history.messages),c=A.useMemo(()=>!("assistant"!==e.role||!e.parentId)&&QC(e.parentId),[e.parentId,e.role]),u=A.useMemo(()=>{var t;const n=e.id?null==(t=l[e.id])?void 0:t.parentId:void 0;if(n)return l[n]},[e,l]),d=A.useMemo(()=>{var t,n;return e.id&&u&&(null==(t=null==u?void 0:u.childrenIds)?void 0:t.length)>1&&(null==(n=l[e.id])?void 0:n.isMultiResponse)},[l,u,e.id]),h=()=>{if(!o)return null;if((null==o?void 0:o.branch_message_id)===e.id){const e=(null==o?void 0:o.origin_chat_title)||"",t=i.t("Branched from {{chat_title}}",{chat_title:e}),n=t.split(e)[0],r=t.split(e)[1];return an.jsxs(HW,{line:!a,children:[n?an.jsx("div",{className:"message-divider-new-branch-label",style:{marginRight:a?"4px":"12px"},children:n.trim()}):null,an.jsx("div",{className:"message-divider-new-branch-text",onClick:()=>{$x()?kT.adapter.invoke({method:"openHistoryChat",params:{chatId:(null==o?void 0:o.origin_chat_id)||""}}):s(`/c/${(null==o?void 0:o.origin_chat_id)||""}`)},children:e}),r?an.jsx("div",{className:"message-divider-new-branch-label",style:{marginLeft:a?"4px":"12px"},children:r.trim()}):null]})}return null},p=A.useMemo(()=>{if(!c)return 1;const t=vx.getState().history,n=e.parentId?t.messages[e.parentId]:null,i=null==n?void 0:n.models.reduce((e,i,a)=>{let o=null==n?void 0:n.childrenIds.map(e=>t.messages[e]).filter(e=>(null==e?void 0:e.modelIdx)===a).map(e=>e.id);if(0===o.length){const e=null==n?void 0:n.childrenIds.map(e=>t.messages[e]).filter(e=>(null==e?void 0:e.model)===i);e.forEach(e=>{e.modelIdx=a}),o=e.map(e=>e.id)}return _(w({},e),{[a]:{messageIds:o}})},{});return Object.keys(i).length},[c,e]);return an.jsxs("div",{className:Y("qwen-chat-message",{"qwen-chat-message-user":"user"===e.role,"qwen-chat-message-assistant":"assistant"===e.role,"qwen-chat-message-dual-message":"assistant"===e.role&&(c&&2===p||d&&!a),"qwen-chat-message-multi-message":"assistant"===e.role&&c&&p>2}),id:r,children:["user"===e.role&&an.jsx(IV,{message:e,handleDeleteMessage:t,isOldMessageInNewBranch:n}),"assistant"===e.role&&(c?an.jsx(UW,{messageId:e.id||e.fid,boxId:r}):an.jsxs(an.Fragment,{children:[d?an.jsx($W,{message:e,boxId:r}):an.jsx(zW,{message:e,boxId:r,isOldMessageInNewBranch:n}),h()]}))]})},(e,t)=>Ot(e,t)),GW=({children:e,onVisible:t=()=>{}})=>{const n=A.useRef(null),i=A.useRef(null),a=A.useRef(null);return A.useEffect(()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?a.current=setInterval(()=>{t()},1e3):a.current&&(clearInterval(a.current),a.current=null)})},{root:null,rootMargin:"0px",threshold:.1});return i.current=e,n.current&&e.observe(n.current),()=>{i.current&&i.current.disconnect(),a.current&&clearInterval(a.current)}},[]),an.jsx("div",{ref:n,children:e})},VW=e=>{const{onVisible:t}=e,{i18n:n}=$();return an.jsx(GW,{onVisible:t,children:an.jsxs("div",{className:"more-messages-loading",children:[an.jsx(wt,{className:"size-4"}),an.jsx("div",{children:n.t("Loading...")})]})})},WW=Math.floor(3*Math.random())+1,QW=({chatIdProp:e})=>{const t=Ex(e=>e.config),n=vx(e=>e.setChatLoaded),i=vx(e=>e.setChatId),a=vx(e=>e.chatId),o=vx(e=>e.history),s=vx(e=>e.chatMode),r=vx(e=>e.setChatMode),l=NT(e=>e.settings),c=Sx(e=>e.visionGenerating),u=Sx(e=>e.setVisionGenerating),d=vx(e=>e.isChat);vx(e=>e.setIsChat);const h=vx(e=>e.currentInputFeature),p=Sx(e=>e.webSearchEnabled),m=Sx(e=>e.setWebsearchLoading),f=Ex(e=>e.mobile);Sx(e=>e.taskRunning);const g=Sx(e=>e.setTaskRunning),v=Sx(e=>e.temporaryChatEnabled),y=Sx(e=>e.setThinkingEnabled),b=Sx(e=>e.setMcpEnabled),x=Sx(e=>e.setResearchMode),S=Sx(e=>e.setWebSearchEnabled),C=zE(e=>e.isSharePage),E=Sx(e=>e.setWelcomeModalShow),k=Sx(e=>e.setDeepResearchVersion),I=Sx(e=>e.setPodcastCount),[T,N]=A.useState(20),P=vx(e=>e.branchInfo),M=HE(e=>e.user),O=Ty();A.useEffect(()=>{I(KC(o.messages)),k((e=>{var t,n,i,a,o,s,r,l,c,u,d,h,p,m,f,g,v,y,b,x;const w=(e?Object.values((null==e?void 0:e.messages)||{}):[]).find(e=>{var t;return"assistant"===e.role&&e.sub_chat_type===ng.INTERRUPT&&!!(null==(t=null==e?void 0:e.content_list)?void 0:t.find(e=>e.phase===og.PdfMdGen))});if(w){const e=null==(t=null==w?void 0:w.content_list)?void 0:t.find(e=>e.phase===og.PdfMdGen),a=(null==(i=null==(n=null==e?void 0:e.extra)?void 0:n.deep_research)?void 0:i.version)||"";if(a)return a}const _=e=>{var t,n;return(null==e?void 0:e.sub_chat_type)===ng.DeepResearch||(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.meta)?void 0:n.subChatType)===ng.DeepResearch},S=(e?Object.values((null==e?void 0:e.messages)||{}):[]).filter(e=>"assistant"===e.role&&_(e)&&!(null==e?void 0:e.error)),C=null==e?void 0:e.currentId;if(C){const t=jC(C,e).find(e=>"assistant"===(null==e?void 0:e.role)&&_(e)&&!(null==e?void 0:e.error));if(t)return(null==(r=null==(s=null==(o=null==(a=null==t?void 0:t.content_list)?void 0:a[0])?void 0:o.extra)?void 0:s.deep_research)?void 0:r.version)||""}return C&&(null==(c=null==(l=null==e?void 0:e.messages)?void 0:l[C])?void 0:c.sub_chat_type)===ng.DeepResearch?(null==(f=null==(m=null==(p=null==(h=null==(d=null==(u=null==e?void 0:e.messages)?void 0:u[C])?void 0:d.content_list)?void 0:h[0])?void 0:p.extra)?void 0:m.deep_research)?void 0:f.version)||"":(null==(g=null==S?void 0:S[0])?void 0:g.content_list)&&(null==(x=null==(b=null==(y=null==(v=S[0])?void 0:v.content_list[0])?void 0:y.extra)?void 0:b.deep_research)?void 0:x.version)||""})(o))},[o,k,I]);const R=A.useMemo(()=>{const e=[];let t=o.messages[(null==o?void 0:o.currentId)||""]||null;for(;t&&e.length<=T;){if(["user","assistant"].includes(t.role)){const n=t;e.push(n)}t=o.messages[(null==t?void 0:t.parentId)||""]||null}return e.reverse()},[o,T]),D=A.useMemo(()=>{var e;if(!(null==(e=R[0])?void 0:e.parentId))return!1;const t=o.messages[R[0].parentId];return!!t&&["user","assistant"].includes(t.role)},[R,o.messages]),L=A.useCallback(()=>j(void 0,null,function*(){if(!e)return;if(["local","guest","new-branch"].includes(e))return void(xE.currentId||O("/",{replace:!0}));if("normal"!==s){const e=xE.currentId||"",t=xE.getChat(e);t&&i(t.chatId||"")}else i(e);kT.createChat({id:xE.currentId||void 0,chatId:e});(yield kT.loadChat(e))||C?n(!0):O("/")}),[e,n,s,i,O,C]),F=e=>j(void 0,[e],function*({chatMode:e,id:t,userMessageLength:n,responseMessage:i}){var a;t===xE.currentId&&(c&&(i.extra&&(null==(a=i.extra.wanx)?void 0:a.task_id)||u(!1)),n>=WW&&UT()&&($x()?kT.adapter.invoke({method:"showAlert",params:{type:"login"}}):E(!0))),"normal"===e&&(AC(),OC())}),z=()=>{var e,n,i,a,o,s,r,l,c;const u=kT.getChatOptions();if(!u)return;const d=null==u?void 0:u.history,h=d.messages[d.currentId||""];y(null!=(a=null==(e=null==h?void 0:h.feature_config)?void 0:e.thinking_enabled)?a:3===(null==(i=null==(n=null==t?void 0:t.permissions)?void 0:n.chat)?void 0:i.thinking)),b(!!(null==(o=null==h?void 0:h.feature_config)?void 0:o.local_mcp)||((null==(s=null==h?void 0:h.feature_config)?void 0:s.mcp)||[]).length>0),S([h.chat_type,h.sub_chat_type,null==(l=null==(r=null==h?void 0:h.extra)?void 0:r.meta)?void 0:l.subChatType].includes(ng.WebSearch)),x("normal"!==(null==(c=null==h?void 0:h.feature_config)?void 0:c.research_mode))},U=()=>{},H=A.useCallback(t=>{g(t);const n=location.pathname.length>=36||UT()||location.pathname.includes("local");zx()&&n&&kT.adapter.invoke({method:"updateChatInfo",params:{chatId:VC(a||e||"",v),status:t?"running":"finished"}})},[a,e,v,g]),B=A.useCallback((t,n,i)=>{if($x()){const{status:o,errorMsg:s="",errorCode:r=""}=i,l={};jC(t,n).slice(-2).forEach(e=>{l[(null==e?void 0:e.id)||""]=e});const c=VC(a||e||"",v);let u={chatId:c,messages:l,status:o,errorMsg:s,errorCode:r,messageId:t};"error"===o&&(u=_(w({},u),{errorMsg:s,errorCode:r})),(UT()||"temporary"===c)&&kT.adapter.invoke({method:"updateChatInfo",params:u})}},[a,e,v]),$=A.useCallback(({responseMessage:e,responseMessageId:t,history:n})=>{var i,a,o;if(p&&m(!1),e.chat_type===ng.Artifacts&&!f&&zE.getState().largeScreen&&kT.openArtifacts(e.id,!0),l.ui.responseAutoCopy){let t=e.content;(null==e?void 0:e.content_list)&&(null==(i=null==e?void 0:e.content_list)?void 0:i.length)&&(t=(null==(o=null==(a=null==e?void 0:e.content_list)?void 0:a.find(e=>(null==e?void 0:e.phase)===og.ANSWER||(null==e?void 0:e.phase)===og.DEEPTHINKING))?void 0:o.content)||""),WS(h===ng.WebSearch?Ev(t):t)}kT.shareHistory=null,B(t,n,{status:"finished"})},[h,B,f,m,l.ui.responseAutoCopy,p]),q=()=>{},G=({id:e,errorType:t,responseMessageId:n,history:i,errorMessage:a})=>{e===xE.currentId&&B(n,i,{status:"error",errorMsg:a,errorCode:t})},V=e=>j(void 0,null,function*(){yield kT.deleteMessage(e,a)});return A.useEffect(()=>(yE.on(uE.CHAT_SSE_BEGIN,q),yE.on(uE.CHAT_SSE_PROCESS,U),yE.on(uE.CHAT_MESSAGE_END,F),yE.on(uE.CHAT_HISTORY_LOADED,z),yE.on(uE.CHAT_SSE_END,$),yE.on(uE.CHAT_SSE_ERROR,G),()=>{yE.off(uE.CHAT_MESSAGE_END,F),yE.off(uE.CHAT_HISTORY_LOADED,z),yE.off(uE.CHAT_SSE_PROCESS,U),yE.off(uE.CHAT_SSE_END,$),yE.off(uE.CHAT_SSE_BEGIN,q),yE.off(uE.CHAT_SSE_ERROR,G)}),[e]),A.useEffect(()=>{const e=location.pathname,t=e.length>=36||UT()||e.includes("local");H(d||c),zx()&&t&&kT.adapter.setNativeStopButton(d||c)},[e,d,H,c]),A.useEffect(()=>{N(20),e&&!["new-chat"].includes(e)&&L()},[e]),A.useEffect(()=>{r(C?"share":void 0===M?"guest":v?"local":"normal")},[v,C,r,M]),A.useEffect(()=>{const e=vx.subscribe(({chatId:e},{chatId:t})=>{e!==t&&bI.getInstance().destroyAllTTS()});return()=>{e()}},[a]),an.jsxs("div",{id:"chat-message-container",className:"chat-container",children:[D&&an.jsx(VW,{onVisible:()=>(N(e=>e+20),void Promise.resolve().then(()=>{const e=document.querySelector(`#${bg}`);e.scrollTop=e.scrollTop+100}))}),R.map((e,t)=>{const n=o.messages[e.parentId||""]||{};return an.jsx(qW,{message:e,isOldMessageInNewBranch:!!(P&&t<=R.findLastIndex(e=>e.id===(null==P?void 0:P.branch_message_id))),handleDeleteMessage:V},n?n.fid||n.id:"root")})]})},KW=({show:e=!1,publicSuccess:t=!1,methodValue:n="Public",methodValueChange:i=()=>{},children:a,onOpenChange:o=()=>{}})=>{const{t:s}=$(),r=Ex().mobile,[l,c]=A.useState(0),[u,d]=A.useState(e),[h,p]=A.useState(n),m=[{value:"Public",label:s("Public"),icon:"icon-line-public",desc:s("Anyone with the link can access")},{value:"Private",label:s("Private"),icon:"icon-line-lock",desc:s("Only you can access")}];return A.useEffect(()=>{var e;const t=null==(e=document.querySelector(".qwen-modal-body"))?void 0:e.clientWidth;t&&c(t-32)},[]),an.jsx(ie,{options:m,defaultValue:"Public",popupMatchSelectWidth:r?void 0:328,open:u,value:h,className:"deploy-method-select",getPopupContainer:e=>e.parentNode,onChange:e=>{p(e),i(e)},prefix:an.jsx(pt,{type:m.filter(e=>e.value===h)[0].icon,className:"deploy-method-select-icon"}),onDropdownVisibleChange:e=>{d(e),o(e)},disabled:t,suffixIcon:an.jsx(pt,{type:"icon-line-chevron-down",onClick:()=>{d(!u)}}),optionRender:e=>an.jsxs("div",{className:"deploy-method-item "+(h===e.data.value?"deploy-method-item-active":""),children:[an.jsxs("div",{className:"left",children:[an.jsx(pt,{type:e.data.icon,style:{fontSize:"20px"},className:"icon-font-deploy-method"}),an.jsxs("div",{className:"method-introduce",children:[an.jsx("div",{className:"method-name",children:s(e.data.label)}),an.jsx("div",{className:"method-desc",children:s(e.data.desc)})]})]}),n===e.data.value&&an.jsx("div",{className:"right",children:an.jsx(pt,{type:"icon-line-check-02",style:{fontSize:"20px"},className:"deploy-method-icon-active"})})]})})},YW=({show:e=!1,deployLoading:t=!1,className:n="",onDeploy:i=e=>{},currentDeployData:a})=>{const{i18n:o}=$();zE().theme;const s=Sx().setShowDeleteDeployConfirm,r=Ex().mobile,[l,c]=A.useState(void 0===a||a.isPublic?"Public":"Private"),[u,d]=A.useState(!1),[h,p]=A.useState(!!(null==a?void 0:a.shareUrl)),[m,f]=A.useState((null==a?void 0:a.shareUrl)||"");A.useEffect(()=>{p(!!(null==a?void 0:a.shareUrl)),f((null==a?void 0:a.shareUrl)||""),c(void 0===a||a.isPublic?"Public":"Private")},[a]);const g=o.t('By clicking "Deploy", you acknowledge and agree to use this feature in compliance with the {{UsagePolicy}} and applicable laws and regulations.',{UsagePolicy:`<a href='/legal-agreement/usage-policy' target="_blank" class="deploy-desc-btn"> ${o.t("Usage Policy")} </a>`});return an.jsxs("div",{className:"deploy-container "+(r?"deploy-container-mobile":""),children:[an.jsxs("div",{className:"deploy-artifacts",children:[an.jsxs("div",{className:"title",children:[an.jsx("div",{className:"name",children:o.t("Deploy")}),an.jsx("div",{className:"undeployed "+(h?"deployed":""),children:o.t(h?"Deployed":"Undeployed")})]}),an.jsx("div",{className:"description",children:"Public"===l?o.t("Anyone with the link can access. Your chat messages will not be shared."):o.t("Only you can access")})]}),an.jsxs("div",{className:"deploy-groups",children:[t?an.jsx(_t,{className:"deploy-url "+(m?"":"text-decoration-none"),placeholder:o.t("example.qwen.site"),readOnly:!0,value:"",prefix:an.jsx(wt,{fontSize:20}),noBorder:!0}):h?an.jsx(_t,{className:"deploy-url "+(m?"":"text-decoration-none"),value:m,readOnly:!0,onClick:()=>{window.open(m)},noBorder:!0,prefix:an.jsx(pt,{type:"icon-line-globe-01",className:"icon-font icon-line-globe-01"}),suffix:an.jsx("div",{className:"deploy-copy",onClick:()=>{WS(m),d(!0),setTimeout(()=>{d(!1)},3e3)},children:u?an.jsx(pt,{type:"icon-line-check-02",className:"icon-font "}):an.jsx(vt,{title:o.t("Copy"),children:an.jsx(pt,{type:"icon-line-copy-right",className:"icon-font "})})})},`${m}_success`):an.jsx(_t,{className:"deploy-url "+(m?"":"text-decoration-none"),placeholder:o.t("example.qwen.site"),readOnly:!0,value:"",noBorder:!0,prefix:an.jsx(pt,{type:"icon-line-globe-01",className:"icon-font"})},`${m}_none`),an.jsx(KW,{methodValue:l,methodValueChange:e=>{c(e)},publicSuccess:h})]}),an.jsx("div",{className:"deploy-desc",dangerouslySetInnerHTML:{__html:g}}),h?an.jsx(ft,{size:r?"large":"middle",rounded:"circle",className:"deploy-btn",type:"tertiary",onClick:()=>{s(!0)},children:o.t("Undeploy")}):an.jsx(ft,{size:r?"large":"middle",rounded:"circle",className:"deploy-btn",type:"brandprimary",loading:t,onClick:()=>{i("Public"===l)},children:t?o.t("Deploying"):o.t("Deploy")})]})},XW=e=>{const{isMobile:t}=e,{i18n:n}=$();return an.jsx(an.Fragment,{children:t?an.jsxs("div",{className:"artifact-error-container",children:[an.jsx("div",{className:"artifact-error-icon-wrap",children:an.jsx(pt,{type:"icon-line-package-fail-02",className:"artifact-error-icon"})}),an.jsx("div",{className:"artifact-error-title",children:n.t("Preview failed")}),an.jsx("div",{className:"artifact-error-text",children:n.t("No HTML, CSS, or JavaScript content found.")})]}):an.jsx("div",{className:"artifact-error-container",children:an.jsx("div",{className:"artifact-error-content",children:an.jsx("div",{className:"error-message",children:n.t("No HTML, CSS, or JavaScript content found.")})})})})},JW=e=>{var t,n;const{message:i,phaseContentIndex:a,currentContent:o}=e,s=null==(t=i.content_list)?void 0:t[a],{i18n:r}=$(),{openNativePopup:l}=UV({message:i}),c=zE(e=>e.realTheme),u=Ex(e=>e.mobile),d=Sx(e=>e.setCurrentShowControl),h=vx(e=>e.setCurrentCitationInfo),p=zE(e=>e.setShowControls),m=A.useMemo(()=>i.done?"iframe"===o.type?`\`\`\`${o.iframeType||"html"}\n${o.content}\n\`\`\``:"svg"===o.type?`\`\`\`svg\n${o.content}\n\`\`\``:`\`\`\`plaintext\n${(null==s?void 0:s.content)||""}\n\`\`\``:Array.isArray(null==s?void 0:s.content)?"":(null==s?void 0:s.content)||"",[s,o]),f=TG({mediaType:"image",messageId:i.id}),g=A.useCallback(e=>j(void 0,null,function*(){(yield WS(e))&&ht.openOnce({type:"success",content:r.t("Copying to clipboard was successful!")})}),[r]),v=A.useCallback((e,t="")=>{const n=new Date,i=`Qwen_${t}_${`${n.getFullYear()}${String(n.getMonth()+1).padStart(2,"0")}${String(n.getDate()).padStart(2,"0")}`}_${Math.random().toString(36).slice(-9)}${HV(t)}`;Tx.saveAs(new Blob([e],{type:"text/plain;charset=utf-8"}),i)},[]),y=A.useMemo(()=>{var e;return!!(null==(e=null==i?void 0:i.feature_config)?void 0:e.thinking_enabled)},[null==(n=null==i?void 0:i.feature_config)?void 0:n.thinking_enabled]),b=A.useCallback(e=>{if(i.chat_type===ng.DeepResearch)kT.emit(hE.SOURCE_CILCK,{Tab:Fe.sources,citationIndex:Number(e)||0});else{if($x())return void l({type:y?ag.ThinkingAndSearch:ag.WebSearch,currentTab:Fe.sources,citationIndex:Number(e)});p(!0),d(y?ag.ThinkingAndSearch:ag.WebSearch),h({messageId:i.id||"",citationIndex:Number(e),tab:Fe.sources})}},[i.chat_type,i.id,l,h,d,p,y]),x=A.useMemo(()=>({code:{headerActionsRender:e=>an.jsxs(an.Fragment,{children:[an.jsx(vt,{title:r.t("Copy"),children:an.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>g(e.text),children:an.jsx(pt,{type:"icon-line-copy-right"})})}),!u&&an.jsx(vt,{title:r.t("Download"),children:an.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>v(e.text,e.lang),children:an.jsx(pt,{type:"icon-line-download-02"})})})]}),theme:c},codespan:{onClick:e=>j(void 0,[e],function*({text:e}){(yield WS(e))&&ht.openOnce({type:"success",content:r.t("Copying to clipboard was successful!")})})},image:w({defaultWidth:1,defaultHeight:1,sizeScope:u?{width:[114,300],height:[126,380]}:[400,448],onError:()=>({errorMessage:r.t("Image Load Error")})},f),table:{headerActionsRender:zx()?void 0:e=>an.jsx(an.Fragment,{children:an.jsx(xt,{placement:"bottomRight",menu:{items:[{key:"csv",label:an.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${i.id||""}.csv`;XS(e,t)},children:r.t("Export to CSV")})},{key:"excel",label:an.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${i.id||""}.xlsx`;JS(e,t)},children:r.t("Export to Excel")})}]},getPopupContainer:e=>e||document.body,children:an.jsx("div",{className:"qwen-markdown-table-header-action-item",children:an.jsx(pt,{type:"icon-line-download-02"})})})})},citation:{onClick:e=>b(e)}}),[r,f,i.id,u,b,g,v,c]);return an.jsx(an.Fragment,{children:""===m?an.jsx(XW,{isMobile:u}):an.jsx(ze,{content:m,loose:!["ja-JP","ko-KR","zh-CN","zh-TW"].includes(r.language),tokenProps:x})})},ZW=e=>{const{message:t,currentContent:n}=e;return((null==t?void 0:t.content_list)||[]).map((e,i)=>[og.ANSWER,og.DEEPTHINKING].includes(e.phase)?an.jsx(JW,{message:t,phaseContentIndex:i,currentContent:n},i):null)},eQ=e=>{var t,n,i,a,o,s;const{message:r={},nativeLoading:l}=e,c=Sx(e=>e.temporaryChatEnabled),u=Sx(e=>e.showDeleteDeployConfirm),d=Ex(e=>e.mobile),h=zE(e=>e.isSharePage),p=vx(e=>e.currentInputFeature),m=vx(e=>e.chatId),f=Sx(e=>e.visionGenerating),g=Sx(e=>e.taskRunning),v=vx(e=>e.branchInfo),y=HE(e=>e.user),b=Sx(e=>e.setShowDeleteDeployConfirm),x=A.useMemo(()=>l||!(kT.getCurrentChatCurrentId()!==(null==r?void 0:r.id)&&!$x())&&(f||g),[f,g,r,l]),{i18n:S}=$(),{qArtifactsDeployArtifacts:C,qArtifactsDeployDeepResearch:E,qArtifactsDeployWebDev:k,checkEquityPassByEquity:I}=m$(),T=A.useMemo(()=>{var e,t;return p===ng.Artifacts?"artifacts"===(null==(t=null==(e=null==r?void 0:r.extra)?void 0:e.meta)?void 0:t.subChatType)?C:k:E},[p,null==(n=null==(t=null==r?void 0:r.extra)?void 0:t.meta)?void 0:n.subChatType,C,E,k]),N=A.useRef(null),[P,M]=A.useState(!0),[O,R]=A.useState(!1),[D,L]=A.useState(!1),[F,z]=A.useState(!1),[U,H]=A.useState(!1),[B,q]=A.useState(!1),[G,V]=A.useState({content:"",type:"iframe",iframeType:"html",id:"",done:!0}),[W,Q]=A.useState(void 0),[K,X]=A.useState(!1),[J,Z]=A.useState(""),[ee,te]=A.useState(!1),[ie,ae]=A.useState(!1),[oe,se]=A.useState(!0),[re,le]=A.useState(!1);jj();const ce=A.useRef(0),ue=A.useRef(!1),de=A.useRef(!1);A.useEffect(()=>{if(x)R(!0);else{const e="1"===localStorage.getItem("artifactsShowCode");R(e)}},[x]),A.useEffect(()=>{if(r){const t=document.getElementById("artifact-content-scroll");e=t,!ue.current&&!de.current&&O&&x&&e&&(null==e||e.scrollTo({top:e.scrollHeight,behavior:"smooth"}))}var e},[r]);const he=e=>{me(e.message),se(!0)},pe=e=>{var t,n;Q(e),void 0!==e?kT.updateChatHistory({messages:_(w({},(null==(t=null==kT?void 0:kT.getChatOptions())?void 0:t.history.messages)||{}),{[r.id]:_(w({},r),{extra:_(w({},r.extra),{meta:_(w({},r.extra.meta),{deploy:e})})})})}):kT.updateChatHistory({messages:_(w({},(null==(n=null==kT?void 0:kT.getChatOptions())?void 0:n.history.messages)||{}),{[r.id]:_(w({},r),{extra:_(w({},r.extra),{meta:_(w({},r.extra.meta),{deploy:void 0})})})})})};A.useEffect(()=>{const e=document.getElementById("artifact-content-scroll"),t=e=>{1===e.touches.length&&(ce.current=e.touches[0].clientY)},n=e=>{if(1===e.touches.length){const t=e.touches[0].clientY;Math.abs(t-ce.current)>10&&(ue.current=!0)}},i=()=>{if(!e)return;const{scrollTop:t,scrollHeight:n,clientHeight:i}=e;t+i>=n-5&&(ue.current=!1)},a=()=>{de.current=!0},o=()=>{if(e){if(de.current){const{scrollTop:t,scrollHeight:n,clientHeight:i}=e,a=t+i>=n-5;ue.current=!a}de.current=!1}};return null==e||e.addEventListener("touchstart",t,{passive:!0}),null==e||e.addEventListener("touchmove",n,{passive:!0}),null==e||e.addEventListener("touchend",i,{passive:!0}),null==e||e.addEventListener("wheel",a),null==e||e.addEventListener("scrollend",o),kT.firstOn(dE.MESSAGE_ARTIFACT_DEPLOY_CHANGE,pe),yE.on(dE.MESSAGE_EDIT_ARTIFACTS,he),()=>{null==e||e.removeEventListener("touchstart",t),null==e||e.removeEventListener("touchmove",n),null==e||e.removeEventListener("touchend",i),null==e||e.removeEventListener("wheel",a),null==e||e.removeEventListener("scrollend",o),yE.off(dE.MESSAGE_EDIT_ARTIFACTS,he),kT.off(dE.MESSAGE_ARTIFACT_DEPLOY_CHANGE,pe)}},[]);const me=e=>{var t,n;se(!0),(null==(n=null==(t=null==e?void 0:e.extra)?void 0:t.meta)?void 0:n.deploy)&&Object.keys(e.extra.meta.deploy).length>0?Q(e.extra.meta.deploy):Q(void 0),Z(_k(e));const i=(e=>{var t,n;const i=_k(e);if((null==e?void 0:e.error)||"data_inspection_failed"===(null==(t=null==e?void 0:e.error)?void 0:t.errorMessage)||"data_inspection_failed"===(null==(n=null==e?void 0:e.error)?void 0:n.errorCode))return{type:"error",iframeType:"html",id:e.id,content:"",done:!0};let a;return"user"!==(null==e?void 0:e.role)&&i&&(null==i?void 0:i.length)&&(a=_(w({id:e.id},kk(i)),{done:!0})),a})(e);"svg"!==(null==i?void 0:i.type)&&"error"!==(null==i?void 0:i.type)||se(!1),V(i||_(w({},G),{type:"error"}))};A.useEffect(()=>{me(r)},[r]),A.useEffect(()=>{q(P||c||UT()||oe||!(null==W?void 0:W.shareUrl)&&(null===(null==T?void 0:T.remains)||0===(null==T?void 0:T.remains)))},[null==W?void 0:W.shareUrl,oe,P,null==T?void 0:T.remains,c,y]),A.useEffect(()=>{L(void 0!==G&&"error"!==G.type&&""!==G.content)},[G]);A.useEffect(()=>{const e=e=>{"Escape"===e.key&&re&&le(!1)},t=()=>{document.fullscreenElement||le(!1)};return document.addEventListener("keydown",e),document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("fullscreenchange",t)}},[re]);const fe=A.useCallback(e=>{var t,n,i,a;dS(e?"artifactsPreviewFailed":"artifactsPreviewSuccess",{params:{et:"OTHER"},aesParams:{c5:m,c6:`${null==r?void 0:r.id}`,c7:null==(n=null==(t=null==r?void 0:r.extra)?void 0:t.meta)?void 0:n.subChatType,c8:null==r?void 0:r.chat_type},paramsExtend:{chat_id:m,msg_id:`${null==r?void 0:r.id}`,msg_type:null==r?void 0:r.chat_type,sub_chat_type:null==(a=null==(i=null==r?void 0:r.extra)?void 0:i.meta)?void 0:a.subChatType}})},[m,null==r?void 0:r.chat_type,null==(a=null==(i=null==r?void 0:r.extra)?void 0:i.meta)?void 0:a.subChatType,null==r?void 0:r.id]);A.useEffect(()=>{z(!d&&!h&&D&&[ng.WebDev,ng.Artifacts,ng.DeepResearch].includes(p)&&!(null==v?void 0:v.isTemp))},[p,D,h,d,v]),A.useEffect(()=>{H(d&&!h&&D&&[ng.WebDev,ng.Artifacts,ng.DeepResearch].includes(p)&&!(null==v?void 0:v.isTemp)&&(!$x()||!Yx("1.3.0")))},[p,D,h,d,v]);const ge=(e=!1)=>j(void 0,null,function*(){var t,n,i;if(B)return;X(!0);const a=p===ng.DeepResearch?p:null==(n=null==(t=null==r?void 0:r.extra)?void 0:t.meta)?void 0:n.subChatType;Q({shareId:"",shareUrl:"",type:a,isPublic:e});const o=yield(s={chat_id:m,message_id:r.id,content:J,type:a,public:e},j(void 0,null,function*(){return yield ow("/share/artifacts/new",{method:"POST",data:s})}));var s;if(o.success){const t=_(w({},W),{shareId:o.data.share_id,shareUrl:o.data.share_url,type:a,isPublic:e});Q(t),kT.updateChatHistory({messages:_(w({},(null==(i=null==kT?void 0:kT.getChatOptions())?void 0:i.history.messages)||{}),{[r.id]:_(w({},r),{extra:_(w({},r.extra),{meta:_(w({},r.extra.meta),{deploy:t})})})})})}X(!1),yield KE.getState().updateEquity()}),ve=A.useMemo(()=>UT()?S.t("Deployment is unavailable in guest mode"):-1!==(null==T?void 0:T.remains)?LE({remains:(null==T?void 0:T.remains)||0,unit:null==T?void 0:T.unit,capability:"Deploy",allowHtml:!0,currentI18n:S}):c?S.t("Deployment is unavailable in temporary chat."):"",[S,null==T?void 0:T.remains,null==T?void 0:T.unit,c,y]),ye=A.useMemo(()=>{var e,t,n,i,a,o,s;return(null==(t=null==(e=null==r?void 0:r.extra)?void 0:e.meta)?void 0:t.subChatType)===ng.DeepResearchWebDev?(null==(a=null==(i=null==(n=(null==r?void 0:r.content_list)||[])?void 0:n.find(e=>e.phase===og.ANSWER||e.phase===og.DEEPTHINKING))?void 0:i.extra)?void 0:a.topic)||S.t("Web Dev"):"artifacts"===(null==(s=null==(o=null==r?void 0:r.extra)?void 0:o.meta)?void 0:s.subChatType)?S.t("Artifacts"):S.t("Web Dev")},[r,d]),be={code:S.t("Code"),preview:S.t("Preview"),disabledPreview:S.t("Please wait until the generation is complete.")};return an.jsxs(an.Fragment,{children:[an.jsxs("div",{className:"artifact-wrapper",children:[an.jsxs("div",{className:"artifacts-header",children:[an.jsxs("div",{className:"artifact-header-title-header",children:[!d&&an.jsx(pt,{type:"artifacts"===(null==(s=null==(o=null==r?void 0:r.extra)?void 0:o.meta)?void 0:s.subChatType)?"icon-a-line-package-0211":"icon-line-web-dev",className:"chat-artifact-header-icon"}),d?an.jsx(an.Fragment,{children:an.jsx(Je,{showCode:O,setShowCode:e=>{localStorage.setItem("artifactsShowCode",e?"1":"0"),R(e)},isLoading:x,tabsTitles:be})}):an.jsx("div",{className:"artifact-header-title",children:ye})]}),an.jsxs("div",{className:"artifact-header-right",children:[F?an.jsx(ne,{placement:"bottom",title:"",arrow:!1,trigger:"click",className:"deploy-dropdown-menu",getPopupContainer:e=>e.parentNode,align:{offset:[-40,12]},open:ie,onOpenChange:ae,content:an.jsx("div",{className:"deploy-dropdown-menu-content",children:an.jsx(YW,{onDeploy:ge,currentDeployData:W,deployLoading:K})}),children:(null==W?void 0:W.shareUrl)?an.jsx(ft,{rounded:"circle",buttonClass:"chat-artifact-header-deploy",disabled:B,type:"brandtertiary",iconFontType:"icon-line-check-02",size:"small",children:S.t("Deployed")}):an.jsx(vt,{title:ve?an.jsx("span",{dangerouslySetInnerHTML:{__html:ve}}):"",children:an.jsx(ft,{disabled:B,rounded:"circle",buttonClass:"chat-artifact-header-deploy",type:"brandsecondary",iconFontType:"icon-line-upload-03",size:"small",children:S.t("Deploy")})})}):null,O&&!x&&d&&an.jsx("div",{onClick:()=>{var e;QS(null!=(e=null==G?void 0:G.content)?e:"")},className:"copy-code-button",children:an.jsx(pt,{type:"icon-line-copy-right",className:"copy-icon"})}),an.jsx("div",{className:"artifact-header-close",onClick:()=>{kT.closeShowControls()},children:an.jsx(pt,{type:"icon-line-x-02",className:"chat-artifact-header-close-icon"})})]})]}),U&&an.jsxs("div",{className:"header-tip",children:[an.jsx("div",{className:"header-tip-title",children:UT()?S.t("Deployment is unavailable in guest mode"):S.t("Share your creativity by deploying.")}),an.jsx("div",{onClick:()=>{var e,t;if(((null==W?void 0:W.shareUrl)||I(T))&&!B)if($x()){const n=p===ng.DeepResearch?p:null==(t=null==(e=null==r?void 0:r.extra)?void 0:e.meta)?void 0:t.subChatType,i=(null==W?void 0:W.shareUrl)?{method:"requestToUndeploy",params:{type:n,shareId:null==W?void 0:W.shareId,shareUrl:null==W?void 0:W.shareUrl,isPublic:!!(null==W?void 0:W.isPublic),chatId:m,msgId:null==G?void 0:G.id}}:{method:"requestToDeploy",params:{type:n,chatId:m,msgId:null==G?void 0:G.id}};kT.adapter.invoke(i)}else te(!0)},children:(null==W?void 0:W.shareUrl)?an.jsx(ft,{size:"small",rounded:"circle",buttonClass:"header-tip-button brandghost-button "+(B?"chat-artifact-header-deploy-brandtertiary-disabled":""),type:"brandghost",iconFontType:"icon-line-check-02",children:S.t("Deployed")}):an.jsx(ft,{buttonClass:"header-tip-button  "+(B?"chat-artifact-header-deploy-brandprimary-disabled":""),size:"small",rounded:"circle",type:"brandprimary",iconFontType:"icon-line-upload-03",children:S.t("Deploy")})})]}),an.jsxs("div",{className:"artifacts-body",children:[!d&&an.jsxs("div",{className:"artifacts-body-header",style:{height:re?"56px":"52px"},children:[re?an.jsx("div",{className:"artifacts-body-header-title",children:ye}):an.jsx(Je,{showCode:O,setShowCode:e=>{localStorage.setItem("artifactsShowCode",e?"1":"0"),R(e)},isLoading:x,tabsTitles:be}),O?!x&&an.jsx("div",{className:"artifacts-body-header-extra",onClick:()=>{var e;QS(null!=(e=null==G?void 0:G.content)?e:"")},children:an.jsx(pt,{type:"icon-line-copy-right",className:"artifacts-body-header-extra-icon"})}):an.jsx("div",{className:"artifacts-body-header-extra",onClick:()=>{var e;re?(document.exitFullscreen(),le(!1)):(null==(e=document.querySelector(".artifacts-body"))||e.requestFullscreen(),le(!0))},children:an.jsx(pt,{type:re?"icon-line-minimise":"icon-line-maximise",className:"artifacts-body-header-extra-icon"})})]}),an.jsxs("div",{className:"artifact-content",children:[an.jsx("div",{className:Y("artifact-content-outer artifacts-body-code",{"artifact-content-hide":!O}),id:"artifact-content-scroll",children:an.jsx(ZW,{message:r,currentContent:G})}),an.jsx("div",{className:Y("artifact-content-outer",{"artifact-content-hide":O}),children:an.jsx(Ze,{currentContent:G,onIframeFull:e=>N.current=e,onPreviewStatusChange:e=>{M(e),se(!1),fe(e)},isIframeLoading:oe,previewIframeOrigin:Yg,failedText:S.t("Preview failed"),emptyText:S.t("No HTML, CSS, or JavaScript content found."),loadingText:S.t("Loading...")})})]})]})]}),an.jsx(mt,{bodyPaddingNone:!0,visible:ee,header:!1,footer:!1,onCancel:()=>te(!1),zIndex:9999,children:an.jsx(YW,{onDeploy:ge,currentDeployData:W,deployLoading:K})}),an.jsx(mt,{visible:u,title:S.t("Undeploy?"),headerBorderNone:!0,className:"deploy-delete-modal",onCancel:()=>b(!1),getPopupContainer:()=>document.body,actions:[{text:S.t("Close"),type:"tertiary",onClick:()=>{b(!1)},size:"middle",rounded:"circle"},{text:S.t("Undeploy"),type:"dangerprimary",onClick:()=>j(void 0,null,function*(){var e,t;try{(yield(t={share_id:null==W?void 0:W.shareId},j(void 0,null,function*(){return yield ow("/share/artifacts/cancel",{method:"POST",data:t})}))).success&&(Q(void 0),null!==(null==T?void 0:T.remains)&&0!==(null==T?void 0:T.remains)||(ae(!1),te(!1)))}catch(kX){}finally{X(!1),b(!1),kT.updateChatHistory({messages:_(w({},(null==(e=null==kT?void 0:kT.getChatOptions())?void 0:e.history.messages)||{}),{[r.id]:_(w({},r),{extra:_(w({},r.extra),{meta:_(w({},r.extra.meta),{deploy:void 0})})})})})}}),size:"middle",rounded:"circle"}],zIndex:9999,size:"small",children:S.t("Are you sure you want to undeploy? This will take effect immediately, and you can always redeploy it later if needed.")})]})},tQ=({onClose:e,onDownload:t,fileName:n,info:i})=>{var a,o,s,r,l;const{i18n:c}=$(),u=zE(e=>e.isSharePage),d=vx(e=>e.branchInfo),h=Sx(e=>e.taskRunning),p=Ex(e=>e.mobile),m=Ex(e=>e.config),[f,g]=A.useState(!1),v=A.useRef(null),y=zE(e=>e.setShowH5PodcastDetail),[b,x]=A.useState(!1),w=Sx(e=>e.deepResearchVersion),_=Sx(e=>e.pdfCardType),{qDeepResearchAipodcast:S,checkEquityPassByEquity:C}=m$(),E=Sx(e=>e.podcastCount),k=Sx(e=>e.visionGenerating),I=Sx(e=>e.temporaryChatEnabled),T=NT(e=>e.settings),j=vx(e=>e.history),N=A.useMemo(()=>{var e;return(null==(e=null==T?void 0:T.aipodcast)?void 0:e.host)||fg},[null==(a=null==T?void 0:T.aipodcast)?void 0:a.host]),P=A.useMemo(()=>{var e;return(null==(e=null==T?void 0:T.aipodcast)?void 0:e.guest)||fg},[null==(o=null==T?void 0:T.aipodcast)?void 0:o.guest]),M=h||k,O=!!(null==(r=null==(s=j.messages)?void 0:s[null==i?void 0:i.messageId])?void 0:r.isShare);A.useEffect(()=>{const e=e=>{const t=e.target;!v.current||v.current.contains(t)||t.closest(".pdf-header-menu-box")||g(!1)};return f&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[f]);const R=A.useMemo(()=>[ng.DeepResearch,ng.INTERRUPT].includes(_),[_]),D=A.useMemo(()=>_===ng.TRAVEL_RESEARCH||_===ng.Travel,[_]),L=A.useMemo(()=>!u&&"v4"===w,[w,u]),F=A.useMemo(()=>!u&&R,[u,R]),z=Sx(e=>e.currentDPLanguageCode),U=A.useMemo(()=>z||c.language||xx.en,[z,c]),H=A.useCallback(e=>{t&&t(e||Ce.pdf,i)},[t,i]),B=A.useMemo(()=>({icon:an.jsx(pt,{type:"icon-line-file-01",style:{fontSize:24}}),key:Ce.pdf,label:an.jsx("span",{className:"text",children:c.t("Download PDF")})}),[c]),q=A.useMemo(()=>({icon:an.jsx(pt,{type:"icon-line-markdown",style:{fontSize:24}}),key:Ce.md,label:an.jsx("span",{className:"text",children:c.t("Download Markdown")})}),[c]),G=A.useMemo(()=>({icon:an.jsx(pt,{type:"icon-line-image",style:{fontSize:20,paddingLeft:2}}),key:Ce.image,label:an.jsx("span",{className:"text",children:c.t("Download Long Image")})}),[c]),V=A.useMemo(()=>{if(p){const e=[B];return D&&e.push(G),e}return R?[q,B]:D?[B,G]:[B]},[R,q,G,B,D,p]),W=A.useMemo(()=>{var e;return!u&&!UT()&&(null==(e=null==m?void 0:m.function_entry)?void 0:e.community)&&!(null==d?void 0:d.isTemp)&&!I},[u,null==(l=null==m?void 0:m.function_entry)?void 0:l.community,null==d?void 0:d.isTemp,I]),[Q,K]=A.useState(!1);return p?an.jsxs("div",{className:"mb-pdf-container-header",children:[an.jsx("div",{className:"mb-pdf-viewer-header-title",children:n}),an.jsxs("div",{className:"mb-pdf-viewer-header-actions",children:[an.jsx("div",{className:"mb-pdf-viewer-header-actions-close",ref:v,children:an.jsx(xt,{menu:[],open:f,onOpenChange:g,popupRender:()=>{const e=null===(null==S?void 0:S.remains)||0===(null==S?void 0:S.remains),t=M||E>=5||O,n=M||O;return an.jsxs("div",{className:"pdf-header-menu-box",children:[(L||F)&&an.jsx("div",{className:"menu-item",children:an.jsx("span",{className:"text",children:c.t("Create")})}),L&&an.jsxs("div",{className:Y("menu-item enable-click",{"disable-click-item":n}),onClick:()=>{n||(kT.closeShowControls(),g(!1),vx.getState().setEmitSendPromptType(Yf.CHAT),$x()?kT.adapter.invoke({method:"postContentToMainChat",params:{content:c.t("Generate a web page preview"),name:ng.DeepResearchWebDev}}):(kT.closeShowControls(),kT.beforeSendMessage({inputText:c.t("Generate a web page preview"),subChatType:ng.DeepResearchWebDev})))},children:[an.jsx("span",{className:"text",children:c.t("Web Dev")}),an.jsx(pt,{type:"icon-Cube",style:{fontSize:"1.25rem",lineHeight:"1.75rem",fontWeight:"400"}})]}),F&&an.jsxs("div",{className:Y("menu-item enable-click",{"disable-click-item":e||t}),onClick:()=>{C(S)&&(O||(t?kT.toast({content:"Youve reached the limit for podcast requests."}):(kT.closeShowControls(),g(!1),$x()?kT.adapter.invoke({method:"openPodcastWindow",params:{content:{host:N,guest:P},languageCode:U}}):y(!0),kT.closeShowControls())))},children:[an.jsx("span",{className:"text",children:c.t("Podcast")}),an.jsx(pt,{type:"icon-line-Podcast",style:{fontSize:"1.25rem",lineHeight:"1.75rem",fontWeight:"400"}})]}),(L||F)&&an.jsx("div",{className:"menu-item",children:an.jsx("span",{className:"text",children:c.t("Download")})}),an.jsxs("div",{className:"menu-item enable-click",onClick:()=>{H(Ce.pdf),g(!1)},children:[an.jsx("span",{className:"text",children:c.t("PDF")}),an.jsx(pt,{type:"icon-line-file-01",style:{fontSize:"1.25rem",lineHeight:"1.75rem",fontWeight:"400"}})]}),D&&an.jsxs("div",{className:"menu-item enable-click",onClick:()=>{H(Ce.image),g(!1)},children:[an.jsx("span",{className:"text",children:c.t("Download Long Image")}),an.jsx(pt,{type:"icon-line-image",style:{fontSize:"1rem",paddingRight:"0.12rem",lineHeight:"1.75rem",fontWeight:"400"}})]})]})},trigger:["click"],children:an.jsx(pt,{type:"icon-line-more-01",style:{fontSize:"1.25rem",lineHeight:"1.75rem"}})})}),an.jsx("div",{className:"mb-pdf-viewer-header-actions-close",onClick:e,children:an.jsx(pt,{type:"icon-close1",className:"close-icon"})})]})]}):an.jsxs("div",{className:"pc-pdf-viewer-header",children:[an.jsx(IG,{open:b,onCancel:()=>x(!1),messageId:i.messageId}),an.jsxs("div",{className:"pc-pdf-viewer-header-title",children:[an.jsx(pt,{type:"icon-line-file-01",className:"pc-pdf-viewer-icon"}),an.jsx("div",{className:"pc-pdf-viewer-header-title-text",children:n})]}),an.jsxs("div",{className:"pc-pdf-viewer-header-actions",children:[!u&&R&&!O&&an.jsx(fW,{className:"pdf-header-button"}),an.jsx(ne,{arrow:!1,trigger:"click",classNames:{root:"pc-pdf-viewer-more-popover pc-pdf-viewer-more-popover-padding"},onOpenChange:e=>{e&&K(!1)},content:an.jsx("div",{className:"pc-pdf-viewer-more-content",children:Q?an.jsx(an.Fragment,{children:V.map(({icon:e,key:t,label:n})=>an.jsxs("div",{className:"pc-pdf-viewer-more-content-item",onClick:()=>H(t),children:[e,n]},t))}):an.jsxs(an.Fragment,{children:[an.jsxs(X,{className:"pc-pdf-viewer-more-content-item",align:"center",justify:"space-between",onClick:()=>K(!0),children:[an.jsxs(X,{align:"center",gap:8,children:[an.jsx(pt,{className:"pc-pdf-viewer-more-content-item-icon",type:"icon-line-download-02"}),c.t("Download")]}),an.jsx(pt,{type:"icon-MessageTipArrow",className:"pc-pdf-viewer-expand-download"})]}),W?an.jsxs("div",{onClick:()=>{O||x(!0)},className:Y("pc-pdf-viewer-more-content-item",{"pc-pdf-viewer-more-content-item-disabled":O}),children:[an.jsx(pt,{className:"pc-pdf-viewer-more-content-item-icon",type:"icon-line-Publish"}),c.t("Publish to community")]}):null]})}),children:an.jsx("div",{className:"pc-pdf-viewer-more-icon",children:an.jsx(pt,{type:"icon-line-more-01"})})}),an.jsx("div",{onClick:e,children:an.jsx(pt,{type:"icon-close1",className:"pc-pdf-viewer-icon"})})]})]})},nQ=e=>{const{status:t,imageUrl:n,messageId:i}=e,a=$();return an.jsxs("div",{className:"image-reason-popup",children:[an.jsxs("div",{className:"image-reason-popup-header",children:[an.jsx("div",{className:"image-reason-popup-title",children:a.t("Thinking with image")}),an.jsx("div",{className:"image-reason-popup-close",onClick:()=>kT.closeShowControls(),children:an.jsx(pt,{type:"icon-close-4"})})]}),an.jsxs("div",{className:"image-reason-popup-content",children:[an.jsx("div",{className:"image-reason-popup-content-status",children:a.t(OW[t||sg.TYPING]||"")}),t===sg.FINISHED&&an.jsx(DW,{imageUrl:n,messageId:i})]})]})},iQ=A.memo(e=>{const{cardStatus:t,stepList:n}=e,i=zE(e=>e.deepDetailTitle),a=Sx(e=>e.visionGenerating),o=Sx(e=>e.taskRunning),s=A.useRef(0),r=A.useRef(!1),l=A.useRef(!1),c=A.useMemo(()=>!!vg(null==kT?void 0:kT.getCurrentChatsubChatType())&&(a||o),[a,o]);const u=Lt(function(e){!r.current&&!l.current&&c&&e&&(null==e||e.scrollTo({top:e.scrollHeight,behavior:"smooth"}))},100);return A.useEffect(()=>{if(c){const e=document.getElementById("research-panel-detail-content");u(e)}},[c,n]),A.useEffect(()=>{const e=document.getElementById("research-panel-detail-content"),t=e=>{1===e.touches.length&&(s.current=e.touches[0].clientY)},n=e=>{if(1===e.touches.length){const t=e.touches[0].clientY;Math.abs(t-s.current)>10&&(r.current=!0)}},i=()=>{if(!e)return;const{scrollTop:t,scrollHeight:n,clientHeight:i}=e;t+i>=n-5&&(r.current=!1)},a=()=>{l.current=!0},o=()=>{if(e){if(l.current){const{scrollTop:t,scrollHeight:n,clientHeight:i}=e,a=t+i>=n-5;r.current=!a}l.current=!1}},c=()=>{l.current=!0};return kT.on(dE.MESSAGE_STOP_SCROLL_TO_BOTTOM,c),null==e||e.addEventListener("touchstart",t,{passive:!0}),null==e||e.addEventListener("touchmove",n,{passive:!0}),null==e||e.addEventListener("touchend",i,{passive:!0}),null==e||e.addEventListener("wheel",a),null==e||e.addEventListener("scrollend",o),()=>{kT.off(dE.MESSAGE_STOP_SCROLL_TO_BOTTOM,c),null==e||e.removeEventListener("touchstart",t),null==e||e.removeEventListener("touchmove",n),null==e||e.removeEventListener("touchend",i),null==e||e.removeEventListener("wheel",a),null==e||e.removeEventListener("scrollend",o)}},[]),A.useEffect(()=>()=>{kT.emit(dE.MESSAGE_DEEP_RESEARCH_CLOSE_DETAIL,!1)},[]),an.jsxs("div",{className:"research-panel-detail",children:[an.jsxs("div",{className:"research-panel-detail-header",children:[an.jsx("div",{className:"research-panel-detail-title",children:an.jsx(et,{loading:!1,searchTitle:i,className:"research-panel-detail-title-text"})}),an.jsx("div",{className:"research-panel-detail-close",onClick:()=>{kT.closeShowControls()},children:an.jsx(pt,{type:"icon-close-4",style:{fontSize:24}})})]}),an.jsx("div",{className:"research-panel-detail-content",id:"research-panel-detail-content",children:an.jsx(tt,{stepList:n,cardStatus:t,isCurrent:!0,linkCardType:"list",stepIdPrefix:"deepDetail",onLinkCard:({url:e})=>{e&&window.open(e,"_blank","noopener,noreferrer")},className:"research-panel-detail-content-markdown-steps"})})]})}),aQ=({detail:e})=>{var t,n;const i=$(),a=A.useMemo(()=>{var t;return(null==(t=null==e?void 0:e.extra)?void 0:t.code_interpreter_info)||""},[null==(t=null==e?void 0:e.extra)?void 0:t.code_interpreter_info]),o=A.useMemo(()=>{var t;return KS(null==(t=null==e?void 0:e.function_call)?void 0:t.arguments,{})},[null==(n=null==e?void 0:e.function_call)?void 0:n.arguments]),s=A.useMemo(()=>(e=>{if(!e)return"";const t=e.match(/```[^\n]*\n([\s\S]+?)```/);return t?`\`\`\`python\n${t[1]}\`\`\``:`\`\`\`python\n${e}\n\`\`\``})(null==o?void 0:o.code),[null==o?void 0:o.code]),r=A.useMemo(()=>{return e=a,Array.from(e.matchAll(/!\[.*?\]\((.*?)\)/g),e=>e[1]);var e},[a]),l=A.useMemo(()=>r.map(e=>`![](${e})`).join("\n"),[r]);return an.jsxs("div",{className:"message-inner-ci",children:[an.jsxs("div",{className:"image-reasoning-detail",children:[an.jsx(ze,{content:s}),a&&Pt(r)&&an.jsxs(an.Fragment,{children:[an.jsx("div",{className:"image-reasoning-detail-status",children:i.t("Result")}),an.jsx(ze,{content:a})]})]}),(null==r?void 0:r.length)>0&&an.jsx(ze,{content:l})]})},oQ={[og.WEB_SEARCH]:{[sg.TYPING]:{text:"Searching the web"},[sg.FINISHED]:{icon:"icon-line-globe-01",text:"Search web Completed"},pause:{icon:"icon-fill-stop",text:"Search web stopped"},error:{icon:"icon-fill-x-circle-contained",text:"Search web pages failed",class:"icon-fail"}},[og.THINK]:{[sg.FINISHED]:{icon:"icon-fill-check-contained"},pause:{icon:"icon-fill-stop",text:"Search web stopped"},error:{icon:"icon-fill-x-circle-contained",text:"Search web pages failed",class:"icon-fail"}},[og.IMAGE_ZOOM_IN_TOOL]:{[sg.TYPING]:{text:"Analyzing image"},[sg.FINISHED]:{icon:"icon-line-image-01",text:"Analyzed image"},pause:{icon:"icon-fill-stop",text:"Analyzed image stopped"},error:{icon:"icon-fill-x-circle-contained",text:"Analyzed image failed",class:"icon-fail"}},[og.CODE_INTERPRETER]:{[sg.TYPING]:{text:"Code Interpreter is running"},[sg.FINISHED]:{icon:"icon-line-code-01",text:"Code Interpreter executed successfully"}}},sQ={[nt.Running]:sg.TYPING,[nt.Finish]:sg.FINISHED,[nt.Stop]:sg.PAUSE,[nt.Error]:sg.ERROR},rQ=({detail:e,cardStatus:t})=>{var n,i;const a=$().t((null==(i=null==(n=null==oQ?void 0:oQ[null==e?void 0:e.phase])?void 0:n[sQ[t]])?void 0:i.text)||"");return an.jsxs("div",{children:[an.jsx("p",{children:a}),an.jsx(aQ,{detail:_(w({},e),{extra:_(w({},null==e?void 0:e.extra),{title:a})})})]})};function lQ(e){if(!e)return"";try{const t=e.trim().startsWith("http")?e.trim():`https://${e.trim()}`;return new URL(t).hostname}catch(kX){const n=e.trim().match(/^(?:https?:\/\/)?([^/\s]+)(?:\/|$)/i);return n?n[1]:""}}const cQ=z.memo(e=>{const{hostlogo:t,url:n="",onClick:i=()=>{},getRectHandler:a=()=>{}}=e,o=A.useRef(null);return A.useEffect(()=>{o.current&&a(o.current)},[a]),n?an.jsxs(X,{ref:o,gap:4,align:"center",justify:"center",className:"qwen-chat-search-card",onClick:i,children:[an.jsx(X,{justify:"center",align:"center",className:"qwen-chat-search-card-logo",children:an.jsx(eV,{src:t||""})}),an.jsx("div",{children:lQ(n)})]}):null}),uQ=z.memo(e=>{const{sources:t=[]}=e,n=A.useMemo(()=>Array.isArray(t)&&t.length?t.filter(({url:e})=>e):[],[t]),[i,a]=A.useState(!1),o=A.useRef(null),s=A.useMemo(()=>new Map,[]),r=A.useRef(0),[l,c]=A.useState(-1),u=A.useRef(-1);A.useEffect(()=>{if(!o.current)return;const e=new ResizeObserver(e=>{if(e.length>0){if(-1!==u.current)return;const t=e[0].contentRect.height;if(r.current!==t){r.current=t;const e=329;let n=0,i=0,a=0;c(a-1),Array.from(s.values()).forEach((t,o)=>{const s=t.offsetWidth;if(n>=2)return;a=o;const r=i?i+s+8:s;r>e?(i=s,n++):i=r}),u.current=a-1,c(a-1)}}});return e.observe(o.current),()=>{e.disconnect()}},[s]);const d=A.useCallback(e=>Array.isArray(e)&&e.length?an.jsx(an.Fragment,{children:e.map(({hostlogo:e,url:t},n)=>an.jsx(cQ,{url:t,hostlogo:e,onClick:()=>{window.open(t)},getRectHandler:e=>{s.set(n,e)}},`${n}-${t}`))}):null,[s]),h=A.useMemo(()=>i||-1===l?null:an.jsx(tV,{onClick:()=>{a(!0)},sources:n.slice(l)}),[i,l,n]);return an.jsxs(X,{ref:o,wrap:"wrap",gap:8,align:"flex-start",children:[d(-1===l||i?n:n.slice(0,l)),h]})}),dQ=e=>an.jsx("svg",_(w({xmlns:"http://www.w3.org/2000/svg",fill:"none",version:"1.1",width:"16",height:"16",viewBox:"0 0 16 16"},e),{children:an.jsx("g",{children:an.jsxs("g",{children:[an.jsxs("g",{style:{opacity:.23999999463558197},children:[an.jsx("ellipse",{cx:"7.9999799728393555",cy:"7.9997968673706055",rx:"6.6666669845581055",ry:"6.6666669845581055",fill:"#615CED",fillOpacity:"1"}),an.jsx("path",{d:"M14.66664698828125,7.9997968828125Q14.66664698828125,8.1634540828125,14.65861698828125,8.3269147828125Q14.65058598828125,8.4903754828125,14.63454498828125,8.653244982812499Q14.61850398828125,8.8161143828125,14.59448998828125,8.978000182812501Q14.57047698828125,9.1398858828125,14.53854798828125,9.3003987828125Q14.50661898828125,9.4609117828125,14.46685398828125,9.6196641828125Q14.42708998828125,9.7784175828125,14.37958198828125,9.9350280828125Q14.33207498828125,10.0916385828125,14.27693998828125,10.2457294828125Q14.22180598828125,10.3998202828125,14.15917598828125,10.5510196828125Q14.09654598828125,10.7022189828125,14.02657398828125,10.8501643828125Q13.95660198828125,10.9981078828125,13.87945498828125,11.1424417828125Q13.80230698828125,11.2867746828125,13.71816998828125,11.4271478828125Q13.63403298828125,11.5675218828125,13.54310998828125,11.7035978828125Q13.45218698828125,11.8396738828125,13.35469598828125,11.9711258828125Q13.25720598828125,12.1025768828125,13.15338298828125,12.2290858828125Q13.04956098828125,12.3555948828125,12.93965398828125,12.4768558828125Q12.82974798828125,12.5981188828125,12.71402598828125,12.7138428828125Q12.59830198828125,12.8295648828125,12.47703998828125,12.9394708828125Q12.35577798828125,13.0493778828125,12.22926898828125,13.1531998828125Q12.10275998828125,13.2570228828125,11.97130898828125,13.3545128828125Q11.83985698828125,13.4520038828125,11.70378098828125,13.5429268828125Q11.56770498828125,13.6338498828125,11.42733198828125,13.7179868828125Q11.28695678828125,13.8021238828125,11.14262388828125,13.8792728828125Q10.99829098828125,13.9564198828125,10.85034658828125,14.0263918828125Q10.70240208828125,14.0963648828125,10.55120178828125,14.1589938828125Q10.40000248828125,14.2216228828125,10.24591158828125,14.2767578828125Q10.09182068828125,14.3318928828125,9.93521018828125,14.3793998828125Q9.77859978828125,14.4269068828125,9.61984728828125,14.4666718828125Q9.46109388828125,14.5064368828125,9.30058148828125,14.5383648828125Q9.14006898828125,14.5702938828125,8.97818278828125,14.5943068828125Q8.81629658828125,14.6183208828125,8.65342758828125,14.6343618828125Q8.49055818828125,14.6504028828125,8.32709788828125,14.6584338828125Q8.16363718828125,14.6664638828125,7.99997998828125,14.6664638828125Q7.83632278828125,14.6664638828125,7.67286208828125,14.6584338828125Q7.50940178828125,14.6504028828125,7.34653238828125,14.6343618828125Q7.18366238828125,14.6183208828125,7.02177618828125,14.5943068828125Q6.85988998828125,14.5702938828125,6.69937708828125,14.5383648828125Q6.53886408828125,14.5064358828125,6.38011168828125,14.4666708828125Q6.22135828828125,14.4269068828125,6.06474828828125,14.3793988828125Q5.90813778828125,14.3318918828125,5.75404738828125,14.2767568828125Q5.59995648828125,14.2216228828125,5.44875668828125,14.1589928828125Q5.29755688828125,14.0963628828125,5.14961238828125,14.0263908828125Q5.00166798828125,13.9564188828125,4.85733508828125,13.8792718828125Q4.71300168828125,13.8021238828125,4.5726279882812495,13.7179868828125Q4.43225428828125,13.6338498828125,4.29617808828125,13.5429268828125Q4.16010188828125,13.4520038828125,4.02865078828125,13.3545128828125Q3.89720008828125,13.2570228828125,3.77069118828125,13.1531998828125Q3.64418218828125,13.0493778828125,3.52291988828125,12.9394708828125Q3.40165778828125,12.8295648828125,3.2859344882812502,12.7138428828125Q3.17021108828125,12.5981188828125,3.06030558828125,12.4768568828125Q2.9503998882812503,12.3555948828125,2.84657668828125,12.2290858828125Q2.74275348828125,12.1025768828125,2.64526268828125,11.9711258828125Q2.54777208828125,11.8396738828125,2.4568488882812503,11.7035978828125Q2.36592558828125,11.5675218828125,2.28178882828125,11.4271488828125Q2.19765209828125,11.2867736828125,2.12050443828125,11.1424407828125Q2.04335683828125,10.9981078828125,1.97338425828125,10.8501634828125Q1.90341168828125,10.7022189828125,1.84078269828125,10.5510186828125Q1.7781537182812501,10.3998193828125,1.72301917828125,10.2457284828125Q1.66788458828125,10.0916375828125,1.62037735828125,9.9350270828125Q1.57287010828125,9.7784166828125,1.53310461828125,9.6196641828125Q1.49333908828125,9.4609107828125,1.46141110828125,9.3003983828125Q1.42948311528125,9.1398858828125,1.40546958128125,8.9779996828125Q1.38145604728125,8.8161134828125,1.36541480928125,8.6532444828125Q1.34937357128125,8.4903750828125,1.34134327988125,8.3269147828125Q1.33331298828125,8.1634540828125,1.33331298828125,7.9997968828125Q1.33331298828125,7.8361396828125,1.34134327988125,7.6726789828125Q1.34937357128125,7.5092186828125,1.36541480928125,7.3463492828125Q1.38145604728125,7.1834792828125,1.40546958128125,7.0215930828125Q1.42948311528125,6.8597068828125,1.46141110828125,6.6991939828125Q1.49333908828125,6.5386809828125,1.5331045982812501,6.3799285828125Q1.57287013828125,6.2211751828125,1.62037738828125,6.0645651828125Q1.6678846182812501,5.9079546828125,1.72301914828125,5.7538642828125Q1.7781537182812501,5.5997733828125,1.84078269828125,5.4485735828125Q1.90341168828125,5.2973737828125,1.97338425828125,5.1494292828125Q2.04335689828125,5.0014848828125,2.12050449828125,4.8571519828125Q2.19765209828125,4.7128185828125,2.28178882828125,4.5724448828124995Q2.36592558828125,4.4320711828125,2.4568488882812503,4.2959949828125Q2.54777208828125,4.1599187828125,2.64526268828125,4.0284676828125Q2.74275348828125,3.8970169828125,2.84657668828125,3.7705080828125Q2.9503998882812503,3.6439990828125,3.06030558828125,3.5227367828125Q3.17021108828125,3.4014746828125,3.2859344882812502,3.2857513828125002Q3.40165778828125,3.1700279828125,3.52291988828125,3.0601224828125Q3.64418218828125,2.9502167828125003,3.77069118828125,2.8463935828125Q3.89719988828125,2.7425703828125,4.02865078828125,2.6450795828125Q4.16010168828125,2.5475889828125,4.29617788828125,2.4566657828125003Q4.43225428828125,2.3657424828125,4.57262778828125,2.2816057228125Q4.71300168828125,2.1974689928125,4.85733458828125,2.1203213328125Q5.0016674882812495,2.0431737328125,5.14961218828125,1.9732011528125Q5.29755688828125,1.9032285828125,5.44875668828125,1.8405995928125Q5.59995648828125,1.7779706128125001,5.75404738828125,1.7228360728125Q5.90813778828125,1.6677014828125,6.06474828828125,1.6201942528125Q6.22135878828125,1.5726870028125,6.38011168828125,1.5329215128125Q6.53886458828125,1.4931559828125,6.69937748828125,1.4612280028125Q6.85989048828125,1.4293000098125,7.02177618828125,1.4052864758125Q7.18366288828125,1.3812729418125,7.34653238828125,1.3652317038125Q7.50940178828125,1.3491904658125,7.67286208828125,1.3411601744125Q7.83632278828125,1.3331298828125,7.99997998828125,1.3331298828125Q8.16363718828125,1.3331298828125,8.32709788828125,1.3411601744125Q8.49055858828125,1.3491904658125,8.653428088281249,1.3652317038125Q8.81629748828125,1.3812729418125,8.978183288281251,1.4052864758125Q9.14006898828125,1.4293000098125,9.30058188828125,1.4612280028125Q9.46109488828125,1.4931559828125,9.61984728828125,1.5329214928125001Q9.77860068828125,1.5726870328125,9.93521118828125,1.6201942828125Q10.09182168828125,1.6677015128125001,10.24591258828125,1.7228360428125Q10.40000338828125,1.7779706128125001,10.55120278828125,1.8405995928125Q10.70240208828125,1.9032285828125,10.85034748828125,1.9732011528125Q10.99829098828125,2.0431737928125,11.14262488828125,2.1203213928125Q11.28695778828125,2.1974689928125,11.42733098828125,2.2816057228125Q11.56770498828125,2.3657424828125,11.70378098828125,2.4566657828125003Q11.83985698828125,2.5475889828125,11.97130898828125,2.6450795828125Q12.10275998828125,2.7425703828125,12.22926898828125,2.8463935828125Q12.35577798828125,2.9502167828125003,12.47703898828125,3.0601224828125Q12.59830198828125,3.1700279828125,12.71402598828125,3.2857513828125002Q12.82974798828125,3.4014746828125,12.93965398828125,3.5227367828125Q13.04956098828125,3.6439990828125,13.15338298828125,3.7705080828125Q13.25720598828125,3.8970167828125,13.35469598828125,4.0284676828125Q13.45218698828125,4.1599185828125,13.54310998828125,4.2959947828125Q13.63403298828125,4.4320711828125,13.71816998828125,4.5724446828125Q13.80230698828125,4.7128185828125,13.87945598828125,4.8571514828125Q13.95660298828125,5.0014843828124995,14.02657498828125,5.1494290828125Q14.09654798828125,5.2973737828125,14.15917698828125,5.4485735828125Q14.22180598828125,5.5997733828125,14.27694098828125,5.7538642828125Q14.33207598828125,5.9079546828125,14.37958298828125,6.0645651828125Q14.42708998828125,6.2211756828125,14.46685498828125,6.3799285828125Q14.50661998828125,6.5386814828125,14.53854798828125,6.6991943828125Q14.57047698828125,6.8597073828125,14.59448998828125,7.0215930828125Q14.61850398828125,7.1834797828125,14.63454498828125,7.3463492828125Q14.65058598828125,7.5092186828125,14.65861698828125,7.6726789828125Q14.66664698828125,7.8361396828125,14.66664698828125,7.9997968828125ZM12.96562698828125,7.9997968828125Q12.96562598828125,7.8778972828125,12.95964498828125,7.7561444828125Q12.95366298828125,7.6343912828125,12.94171498828125,7.5130786828125Q12.92976698828125,7.3917655828125,12.91188098828125,7.2711848828125Q12.89399298828125,7.1506042828125,12.87021298828125,7.0310468828125Q12.84643098828125,6.9114894828125,12.81681298828125,6.7932424828125Q12.78719198828125,6.6749963828125,12.75180698828125,6.5583452828125Q12.71642098828125,6.4416942828125,12.67535398828125,6.3269204828125Q12.63428698828125,6.2121462828125,12.58763798828125,6.0995254828125Q12.54098898828125,5.9869050828125,12.48886998828125,5.8767089828125Q12.43675098828125,5.7665128828125,12.37928898828125,5.6590070828125Q12.32182498828125,5.5515012828125,12.25915598828125,5.4469437828125Q12.19648698828125,5.3423871828125,12.12876298828125,5.2410308828125Q12.06103898828125,5.1396751828125,11.98842398828125,5.0417647828125Q11.91580898828125,4.943853882812499,11.83847598828125,4.8496241828125Q11.76114298828125,4.7553941828125,11.67927998828125,4.6650724828125Q11.59741798828125,4.5747503828125,11.51122198828125,4.4885544828125Q11.42502598828125,4.4023582828125,11.33470298828125,4.3204955828125Q11.24438188828125,4.2386326828125,11.15015218828125,4.161300382812501Q11.05592158828125,4.0839676828125,10.95801068828125,4.0113520828125Q10.86009978828125,3.9387364828125,10.75874428828125,3.8710126828125Q10.65738868828125,3.8032886828125,10.55283168828125,3.7406196828125Q10.44827458828125,3.6779508828125,10.34076878828125,3.6204876828125Q10.23326298828125,3.5630244828125,10.12306688828125,3.5109054828125Q10.01287078828125,3.4587866828125,9.90024948828125,3.4121374828125Q9.78762908828125,3.3654884828125,9.67285538828125,3.3244218828125Q9.55808158828125,3.2833552828125,9.44143108828125,3.2479695828125Q9.32477948828125,3.2125839828125002,9.20653298828125,3.1829647828125003Q9.08828638828125,3.1533455828125003,8.96872898828125,3.1295640828125Q8.849171688281249,3.1057825828125,8.728590988281251,3.0878961828125Q8.60801128828125,3.0700099828125,8.48669858828125,3.0580615828125Q8.36538598828125,3.0461132828124997,8.24363278828125,3.0401317828125Q8.12187958828125,3.0341504828125,7.99997998828125,3.0341504828125Q7.87808038828125,3.0341504828125,7.75632758828125,3.0401317828125Q7.63457438828125,3.0461132828124997,7.51326178828125,3.0580615828125Q7.39194868828125,3.0700099828125,7.27136798828125,3.0878963828124997Q7.15078738828125,3.1057825828125,7.03122998828125,3.1295640828125Q6.91167258828125,3.1533455828125003,6.79342558828125,3.1829647828125003Q6.67517948828125,3.2125839828125002,6.55852838828125,3.2479695828125Q6.44187738828125,3.2833552828125,6.32710358828125,3.3244219828125Q6.21232938828125,3.3654887828125,6.09970858828125,3.4121377828125Q5.98708818828125,3.4587869828125,5.87689208828125,3.5109057828125Q5.76669598828125,3.5630244828125,5.65919018828125,3.6204878828125Q5.55168438828125,3.6779508828125,5.44712688828125,3.7406196828125Q5.34257028828125,3.8032886828125,5.24121398828125,3.8710126828125Q5.13985828828125,3.9387364828125,5.04194788828125,4.0113520828125Q4.944036988281249,4.0839676828125,4.84980728828125,4.161300382812501Q4.75557728828125,4.2386326828125,4.66525558828125,4.3204953828125Q4.57493348828125,4.4023582828125,4.48873758828125,4.4885544828125Q4.40254138828125,4.5747503828125,4.32067868828125,4.6650724828125Q4.23881578828125,4.7553941828125,4.161483488281251,4.8496241828125Q4.08415078828125,4.943853882812499,4.01153518828125,5.0417647828125Q3.93891958828125,5.1396753828125,3.87119578828125,5.2410311828125Q3.80347178828125,5.3423871828125,3.74080278828125,5.4469442828125Q3.67813398828125,5.5515012828125,3.62067078828125,5.6590070828125Q3.56320758828125,5.7665128828125,3.51108858828125,5.8767089828125Q3.45896978828125,5.9869050828125,3.41232058828125,6.0995258828125Q3.36567158828125,6.2121467828125,3.32460498828125,6.3269209828125Q3.28353818828125,6.4416947828125,3.24815258828125,6.5583457828125Q3.2127668882812497,6.6749963828125,3.1831476882812497,6.7932428828125Q3.1535284882812498,6.9114894828125,3.1297468882812502,7.0310468828125Q3.10596548828125,7.1506042828125,3.0880791882812497,7.2711848828125Q3.07019278828125,7.3917655828125,3.0582444882812503,7.5130781828125Q3.0462962882812503,7.6343907828125,3.04031488828125,7.7561440828125Q3.03433358828125,7.8778972828125,3.03433358828125,7.9997968828125Q3.03433358828125,8.1216964828125,3.04031488828125,8.2434496828125Q3.0462963882812497,8.3652028828125,3.0582445882812497,8.4865154828125Q3.07019278828125,8.6078281828125,3.0880790882812503,8.728407882812501Q3.10596548828125,8.848988582812499,3.1297468882812502,8.9685458828125Q3.1535284882812498,9.0881032828125,3.1831476882812497,9.206350282812501Q3.2127668882812497,9.3245963828125,3.24815258828125,9.4412479828125Q3.28353818828125,9.5578984828125,3.32460498828125,9.6726722828125Q3.36567158828125,9.7874459828125,3.41232058828125,9.9000663828125Q3.45896978828125,10.0126876828125,3.51108888828125,10.1228837828125Q3.56320758828125,10.2330798828125,3.62067078828125,10.3405866828125Q3.67813398828125,10.4480924828125,3.74080278828125,10.5526485828125Q3.80347178828125,10.6572055828125,3.87119578828125,10.7585620828125Q3.93891958828125,10.8599185828125,4.01153518828125,10.9578284828125Q4.08415078828125,11.0557393828125,4.161483488281251,11.1499690828125Q4.23881578828125,11.2441987828125,4.32067848828125,11.3345198828125Q4.40254138828125,11.4248428828125,4.48873758828125,11.5110388828125Q4.57493348828125,11.5972348828125,4.66525558828125,11.6790968828125Q4.75557728828125,11.7609598828125,4.84980728828125,11.8382928828125Q4.944036988281249,11.9156258828125,5.04194788828125,11.9882408828125Q5.13985848828125,12.0608558828125,5.24121428828125,12.1285798828125Q5.34257028828125,12.1963038828125,5.44712738828125,12.2589738828125Q5.55168438828125,12.3216428828125,5.65919018828125,12.3791068828125Q5.76669598828125,12.4365688828125,5.87689208828125,12.4886888828125Q5.98708818828125,12.5408068828125,6.09970898828125,12.5874558828125Q6.21232988828125,12.6341048828125,6.32710408828125,12.6751718828125Q6.44187788828125,12.7162388828125,6.55852888828125,12.7516248828125Q6.67517948828125,12.7870098828125,6.79342598828125,12.8166298828125Q6.91167258828125,12.8462488828125,7.03122998828125,12.8700298828125Q7.15078738828125,12.8938098828125,7.27136798828125,12.9116978828125Q7.39194868828125,12.9295848828125,7.51326128828125,12.9415328828125Q7.63457388828125,12.9534808828125,7.75632718828125,12.9594618828125Q7.87808038828125,12.9654428828125,7.99997998828125,12.9654438828125Q8.12187958828125,12.9654428828125,8.24363278828125,12.9594618828125Q8.36538598828125,12.9534798828125,8.48669858828125,12.9415318828125Q8.60801128828125,12.9295838828125,8.728590988281251,12.9116978828125Q8.849171688281249,12.8938098828125,8.96872898828125,12.8700298828125Q9.08828638828125,12.8462478828125,9.206533388281251,12.8166298828125Q9.32477948828125,12.7870088828125,9.44143108828125,12.7516238828125Q9.55808158828125,12.7162378828125,9.67285538828125,12.6751708828125Q9.78762908828125,12.6341038828125,9.90024948828125,12.5874548828125Q10.01287078828125,12.5408058828125,10.12306688828125,12.4886868828125Q10.23326298828125,12.4365678828125,10.34076978828125,12.3791058828125Q10.44827558828125,12.3216418828125,10.55283168828125,12.2589728828125Q10.65738868828125,12.1963038828125,10.75874518828125,12.1285798828125Q10.86010168828125,12.0608558828125,10.95801158828125,11.9882408828125Q11.05592248828125,11.9156258828125,11.15015218828125,11.8382928828125Q11.24438188828125,11.7609598828125,11.33470298828125,11.6790968828125Q11.42502598828125,11.5972348828125,11.51122198828125,11.5110388828125Q11.59741798828125,11.4248428828125,11.67927998828125,11.3345198828125Q11.76114298828125,11.2441987828125,11.83847598828125,11.1499690828125Q11.91580898828125,11.0557384828125,11.98842398828125,10.9578275828125Q12.06103898828125,10.8599166828125,12.12876298828125,10.7585611828125Q12.19648698828125,10.6572055828125,12.25915698828125,10.5526485828125Q12.32182598828125,10.4480914828125,12.37928998828125,10.3405856828125Q12.43675198828125,10.2330798828125,12.48887198828125,10.1228837828125Q12.54098998828125,10.0126876828125,12.58763898828125,9.9000663828125Q12.63428798828125,9.7874459828125,12.67535498828125,9.6726722828125Q12.71642198828125,9.5578984828125,12.75180798828125,9.4412479828125Q12.78719298828125,9.3245963828125,12.81681298828125,9.2063498828125Q12.84643198828125,9.0881032828125,12.87021298828125,8.9685458828125Q12.89399298828125,8.848988582812499,12.91188098828125,8.728407882812501Q12.92976798828125,8.6078281828125,12.94171598828125,8.4865154828125Q12.95366398828125,8.3652028828125,12.95964498828125,8.2434496828125Q12.96562598828125,8.1216964828125,12.96562698828125,7.9997968828125Z",fill:"#615CED",fillOpacity:"1"})]}),an.jsx("g",{children:an.jsx("path",{d:"M8.00008546921875,1.4351806640625Q10.71931364921875,1.4351806640625,12.642097449218749,3.3579648640624997Q14.56488034921875,5.2807481640625,14.56488034921875,7.9999766640625L14.56488034921875,7.9999766640625C14.56437064921875,8.4694185640625,14.183812649218751,8.8499765640625,13.71437074921875,8.8499765640625C13.24492934921875,8.8499765640625,12.86437134921875,8.4694185640625,12.86437134921875,7.9999766640625L12.86437134921875,7.9999766640625Q12.86386064921875,5.9853343640625,11.43929434921875,4.5607678640625Q10.014727549218751,3.1362012640625,8.00008546921875,3.1362011640625003L8.00008546921875,3.1362011640625003C7.53064339921875,3.1356909640625,7.15008544921875,2.7551328640625,7.15008544921875,2.2856909040625C7.15008544921875,1.8162488340625,7.53064339921875,1.4356908798225,8.00008546921875,1.4351806640625L8.00008546921875,1.4351806640625Z",fillRule:"evenodd",fill:"#615CED",fillOpacity:"1"})})]})})})),hQ=z.memo(e=>{const{type:t=VV.THINKING,status:n=WV.PROCESS_STATE,hiddenContent:i=!1,customTitle:a="",customIcon:o="",children:s,controlConfig:r}=e,l=$(),c=A.useMemo(()=>[{label:{process:l.t("Thinking..."),completed:l.t("Thinking completed")},key:VV.THINKING,icon:"icon-fill-check-contained"},{label:{process:l.t("Analyzing"),completed:l.t("Analyzed")},key:VV.THINKING_AND_ANALYSING,icon:"icon-fill-check-contained"},{label:{process:l.t("Analyzing image"),completed:l.t("Analyzed image")},key:VV.ANALYZING_IMAGE,icon:"icon-line-image"},{label:{process:l.t("Searching the web"),completed:l.t("Searched the web")},key:VV.SEARCHING_WEB_PAGES,icon:"icon-line-globe-01"},{label:{process:l.t("Running code interpreter"),completed:l.t("Code interpreter finished")},key:VV.CALLING_CODE_INTERPRETER,icon:"icon-line-code-01"},{label:{process:l.t("Searching memory"),completed:l.t("Searched memory")},key:VV.SEARCHING_MEMORIES,icon:"icon-line-brain-02"},{label:{process:l.t("Updating memory"),completed:l.t("Updated memory")},key:VV.UPDATING_MEMORIES,icon:"icon-line-brain-02"},{label:{process:l.t("Reading sources"),completed:l.t("Sources read")},key:VV.READING_SOURCES,icon:"icon-fill-check-contained"}],[l]),u=A.useMemo(()=>c.find(({key:e})=>e===t),[c,t]);return u?an.jsxs(X,{className:Y("qwen-chat-thinking-status-card",{"qwen-chat-thinking-status-card-completed":n===WV.RESULT_STATE}),gap:8,children:[an.jsxs(X,{vertical:!0,gap:8,align:"center",justify:"space-between",children:[n===WV.PROCESS_STATE?an.jsx("div",{className:Y("qwen-chat-thinking-status-card-icon","qwen-chat-thinking-status-card-icon-processing"),children:an.jsx(dQ,{})}):an.jsx(pt,{className:"qwen-chat-thinking-status-card-icon",type:o||(null==u?void 0:u.icon)}),i?null:an.jsx("div",{className:"qwen-chat-thinking-status-card-border"})]}),an.jsxs(X,{vertical:!0,gap:8,align:"flex-start",className:"qwen-chat-thinking-status-card-content",children:[an.jsxs(X,{align:"center",justify:"space-between",className:"qwen-chat-thinking-status-card-title",children:[an.jsx("div",{className:"qwen-chat-thinking-status-card-title-text",children:n===WV.PROCESS_STATE?a||u.label.process:a||u.label.completed}),(null==r?void 0:r.visibly)?an.jsxs(X,{align:"center",gap:4,className:"qwen-chat-thinking-status-card-button",onClick:null==r?void 0:r.onClick,children:[an.jsx("div",{children:(null==r?void 0:r.label)||l.t("View")}),an.jsx(pt,{className:"qwen-chat-thinking-status-card-button-icon",type:"icon-line-chevron-right"})]}):null]}),s]})]}):null}),pQ=()=>an.jsx("div",{className:"web-search-skeleton",children:an.jsx("div",{className:"web-search-skeleton-main",children:an.jsxs("div",{className:"web-search-skeleton-main-content",children:[an.jsx("div",{className:"web-search-skeleton-main-content-list-1 web-search-skeleton-main-content-list-bg"}),an.jsx("div",{className:"web-search-skeleton-main-content-list-2 web-search-skeleton-main-content-list-bg"}),an.jsx("div",{className:"web-search-skeleton-main-content-list-3 web-search-skeleton-main-content-list-bg"}),an.jsx("div",{className:"web-search-skeleton-main-content-list-4 web-search-skeleton-main-content-list-bg"}),an.jsx("div",{className:"web-search-skeleton-main-content-list-5 web-search-skeleton-main-content-list-bg"}),an.jsx("div",{className:"web-search-skeleton-main-content-list-6 web-search-skeleton-main-content-list-bg"}),an.jsx("div",{className:"web-search-skeleton-main-content-list-7 web-search-skeleton-main-content-list-bg"})]})})}),mQ="https://img.alicdn.com/imgextra/i4/O1CN01XFV3QG1XsQyyaWqLS_!!6000000002979-55-tps-20-20.svg",fQ="https://img.alicdn.com/imgextra/i3/O1CN01VEjCND1WAdUW23ZML_!!6000000002748-55-tps-20-20.svg",gQ="https://img.alicdn.com/imgextra/i4/O1CN016bqlLa23NoCdx8Q06_!!6000000007244-55-tps-20-20.svg",vQ="https://img.alicdn.com/imgextra/i2/O1CN01LKZmDT1eWB2u31TnV_!!6000000003878-55-tps-20-20.svg",yQ="https://img.alicdn.com/imgextra/i3/O1CN01NEEWHV1nysPE7DHcJ_!!6000000005159-55-tps-20-20.svg",bQ="https://img.alicdn.com/imgextra/i1/O1CN010tEY0e1uRcxnebwGz_!!6000000006034-55-tps-20-20.svg",xQ="https://img.alicdn.com/imgextra/i2/O1CN01yMiryC1qg2yCYljWz_!!6000000005524-55-tps-20-20.svg",wQ="https://img.alicdn.com/imgextra/i4/O1CN01QSVe5u1wUUfpRdhYZ_!!6000000006311-55-tps-20-20.svg";function _Q(e){try{const t=new URL(e),n=t.pathname.split("/").pop(),i=null==n?void 0:n.split(".").pop();return i===n?"":null==i?void 0:i.toLowerCase()}catch(kX){return""}}const SQ=(e,t,n)=>{if(n)return"File Source";if("vision"===t)return"Image Source";if("txt"===t)return"TXT Source";if("doc"===t){switch(_Q(e)){case"pdf":return"PDF Source";case"doc":case"docx":default:return"File Source";case"xlsx":case"xls":return"EXCEL Source";case"md":return"MD Source"}}return"audio"===t?"Audio Source":"video"===t?"Video Source":void 0},CQ=(e,t)=>{const n=_Q(e);let i=e;if("vision"===t)return i=e,i;if(n)switch(t){case"audio":i=mQ;break;case"video":i=fQ;break;case"txt":i=vQ;break;case"doc":i=(e=>{switch(_Q(e)){case"pdf":return gQ;case"doc":case"docx":return wQ;case"xlsx":case"xls":return bQ;case"md":return xQ;default:return yQ}})(e);break;default:i=yQ}return i},EQ=e=>{var t=e,{src:n,alt:i,size:a,fallbackComponent:o,loadingComponent:s}=t,r=S(t,["src","alt","size","fallbackComponent","loadingComponent"]);const[l,c]=A.useState(!1),[u,d]=A.useState(!0);return l?o:an.jsxs(an.Fragment,{children:[u&&s,an.jsx("img",w({width:a,height:a,src:n,alt:i,onLoad:()=>{d(!1)},onError:()=>{d(!1),c(!0)},style:{display:u?"none":"block"}},r))]})},kQ=A.memo(e=>{const{isLoading:t,listData:n,citationIndex:i,webSourceOption:a}=e,{headerTitle:o="",noSourceText:s="",showHeader:r=!0,id:l="",style:c={},highlightClassName:u,theme:d,onClickItem:h=()=>{},onClose:p}=a,m=A.useRef(null),f=A.useRef(null),g=A.useRef(null),v=A.useRef(null),y=Ex(e=>e.mobile),[b,x]=A.useState(!1),{i18n:w}=$(),_=A.useCallback(e=>{const t=document.getElementById(`${e}-content`);if(t)if(void 0!==d)t.style.backgroundColor="";else{const e=u||"sources-item-highlight-bg";t.classList.remove(e)}},[d,u]),S=A.useCallback(e=>{v.current&&v.current!==e&&(_(v.current),f.current&&(clearTimeout(f.current),f.current=null));const t=document.getElementById(e);if(t){t.scrollIntoView({behavior:"smooth"});const n=document.getElementById(`${e}-content`);if(n){if(void 0!==d)n.style.backgroundColor="dark"===d?"#21204A":"#F3F2FF",f.current&&clearTimeout(f.current),f.current=setTimeout(function(){n.style.backgroundColor="",v.current=null},2e3);else{const e=u||"sources-item-highlight-bg";n.classList.add(e),f.current&&clearTimeout(f.current),f.current=setTimeout(function(){n.classList.remove(e),v.current=null},2e3)}v.current=e}}},[d,u,_]),C=A.useCallback(e=>{try{return decodeURIComponent(e)}catch(kX){return e}},[]),E=A.useMemo(()=>t&&!y?an.jsx(pQ,{}):null,[t,y]),k=A.useMemo(()=>{if(r)return an.jsxs("div",{className:"content-header",children:[an.jsxs("div",{className:"content-title",children:[!y&&an.jsx(pt,{type:"icon-line-globe-01",className:"title-icon"}),o]}),an.jsx("div",{className:"content-close",onClick:p,children:an.jsx(pt,{type:""+(y?"icon-close":"icon-line-x-02"),className:"close-icon"})})]})},[y,r,o,p]),I=A.useMemo(()=>0!==(null==n?void 0:n.length)&&(null==n?void 0:n.length)?null:an.jsx("div",{className:"no-sources-wrap",children:an.jsx("span",{className:"no-sources text-center",children:s})}),[s,null==n?void 0:n.length]),T=A.useMemo(()=>an.jsxs("div",{className:"content-list",children:[y?an.jsxs(X,{align:"center",gap:4,className:"web-search-origins-header",children:[an.jsx("div",{children:w.t("Search Sources")}),an.jsx("div",{className:"web-search-origins-header-point"}),an.jsx("div",{className:"web-search-origins-header-count",children:(null==n?void 0:n.length)||0})]}):null,null==n?void 0:n.map((e,t)=>an.jsxs(z.Fragment,{children:[t>0&&!y&&an.jsx("div",{className:"content-list-divider"}),an.jsx("div",{className:"sources-item-wrap",id:`${l}-${t+1}`,onClick:()=>{h(e)},children:an.jsx("div",{className:"sources-item content-list-item",id:`${l}-${t+1}-content`,children:an.jsxs("div",{className:"content-list-item-box",children:[an.jsx("div",{className:"content-list-item-title",children:e.fileType&&"web"!==e.fileType?an.jsxs("span",{className:"host-name-text",children:[an.jsxs("span",{children:[t+1,"."]}),an.jsx("span",{className:"host-name-text host-name-text-deep-research",children:SQ(e.url,e.fileType,b)})]}):an.jsxs("span",{className:"sources-item-index",children:[an.jsxs("span",{children:[t+1,"."]}),e.hostlogo&&an.jsx(EQ,{size:12,src:e.hostlogo,alt:"",className:"imgIcon ml-1 w-3",loadingComponent:an.jsx(pt,{className:"search-icon",type:"icon-line-globe-01"}),fallbackComponent:an.jsx(pt,{className:"search-icon",type:"icon-line-globe-01"})}),!e.hostlogo&&an.jsx(pt,{className:"search-icon",type:"icon-line-globe-01"}),an.jsx("span",{className:"host-name-text",children:e.hostname?e.hostname:C(e.url)}),!y&&e.date&&an.jsxs(an.Fragment,{children:[an.jsx("span",{className:"dot-separator",children:""}),an.jsx("span",{className:"date-text",children:e.date.replace(/[()\s]/g,"").replace(/[-]/g,"/")})]})]})}),e.fileType&&"web"!==e.fileType&&an.jsxs("div",{className:"deep-research-origins-item-file",children:[an.jsxs("div",{className:"deep-research-origins-item-icon",children:[an.jsx("img",{src:C(CQ(e.url,e.fileType)),alt:"",onError:()=>{x(!0)}}),"vision"===e.fileType&&!b&&!y&&an.jsx("div",{onClick:e=>{e.stopPropagation()},className:"deep-research-origins-item-img",style:{backgroundImage:`url(${e.url})`}})]}),an.jsx("div",{className:"deep-research-origins-item-link",children:e.url})]}),e.title&&("web"===e.fileType||!e.fileType)&&an.jsx("div",{className:"content-text content-item-des-title",children:e.title}),e.snippet&&("web"===e.fileType||!e.fileType)&&an.jsx("div",{className:"snippet-text content-item-des",children:e.snippet}),y&&e.date&&an.jsx("div",{className:"content-item-date",children:e.date.replace(/[()\s]/g,"").replace(/[-]/g,"/")})]})})})]},e.url))]}),[y,w,n,l,b,C,h]),j=A.useMemo(()=>t&&!y||!n?null:an.jsxs(an.Fragment,{children:[k,I,T]}),[t,n,y,k,I,T]);return A.useLayoutEffect(()=>{if(i&&l){const e={id:l,citationIndex:i},t=g.current;null===t||t.id!==e.id||t.citationIndex!==e.citationIndex?(clearTimeout(m.current),m.current=setTimeout(()=>{S(`${l}-${i}`)},500),g.current=e):t.id===e.id&&t.citationIndex===e.citationIndex&&(clearTimeout(m.current),m.current=setTimeout(()=>{S(`${l}-${i}`)},300),g.current=e)}}),A.useEffect(()=>()=>{clearTimeout(m.current)},[]),an.jsxs("div",{className:"custom-web-search-origins",style:c,children:[E,j]})}),IQ=z.memo(e=>{var t,n,i,a;const{searchMessageId:o,setUnfoldedHeight:s=()=>{}}=e,{i18n:r}=$(),l=vx(e=>e.history),c=Ex(e=>e.mobile),u=Sx(e=>e.currentActionMessageId),d=Sx(e=>e.setCurrentActionMessageId),h=Sx(e=>e.locateTheSearchSource),p=zE(e=>e.isSharePage),m=Sx(e=>e.setLocateTheSearchSource),f=qx(),g=zE(e=>e.realTheme),v=vx(e=>e.chatId),y=OT(e=>e.setMemoryNotification),b=zE(e=>e.setShowMemoryUpdatedModal),x=z.useRef(null),_=z.useRef(null),S=z.useRef(null),C=vx(e=>e.setCurrentCitationInfo),E=zE(e=>e.setShowControls),k=Sx(e=>e.setCurrentShowControl),I=vx(e=>e.allSearchAndThinkLists),T=A.useMemo(()=>u?l.messages[u]:null,[u,l.messages]),N=A.useMemo(()=>{var e,t;return vg((null==T?void 0:T.sub_chat_type)||(null==(t=null==(e=null==T?void 0:T.extra)?void 0:e.meta)?void 0:t.subChatType))},[null==(n=null==(t=null==T?void 0:T.extra)?void 0:t.meta)?void 0:n.subChatType,null==T?void 0:T.sub_chat_type]),P=A.useMemo(()=>null==T?void 0:T.is_stop,[null==T?void 0:T.is_stop]),M=A.useMemo(()=>{var e,t;if(N)return(null==(e=null==I?void 0:I[(null==T?void 0:T.id)||""])?void 0:e.webSearchInfo)||[];let n=[];return null==(t=null==T?void 0:T.content_list)||t.forEach(({phase:e,extra:t={}})=>{e===og.WEB_SEARCH&&(n=[...n,...(null==t?void 0:t.web_search_info)||[]])}),n},[I,N,null==T?void 0:T.content_list,null==T?void 0:T.id]),O=A.useCallback(()=>{E(!1),k(ag.None),m(!1),d("")},[d,k,m,E]);A.useEffect(()=>{var e;["Internal_Server_Error","data_inspection_failed"].includes((null==(e=null==T?void 0:T.error)?void 0:e.errorCode)||"")&&O()},[null==(i=null==T?void 0:T.error)?void 0:i.errorCode,O]);const R=A.useMemo(()=>{var e,t;return!!((null==(e=null==T?void 0:T.content_list)?void 0:e.some(({phase:e})=>e===og.ANSWER))&&(null==T?void 0:T.content_list)&&(null==(t=null==T?void 0:T.content_list)?void 0:t.length)>1||(null==T?void 0:T.done))},[T]),D=A.useMemo(()=>{var e;return!!T&&(null==(e=T.content_list)?void 0:e.some(e=>[og.WEB_SEARCH].includes(e.phase)))},[T]),L=A.useMemo(()=>{var e;return!!(null==(e=null==T?void 0:T.feature_config)?void 0:e.thinking_enabled)},[null==(a=null==T?void 0:T.feature_config)?void 0:a.thinking_enabled]);A.useEffect(()=>{if(!_.current||!S.current||c)return;const e=new ResizeObserver(e=>{e.length>0&&requestAnimationFrame(()=>{if(h&&S.current&&_.current&&x.current){const e=x.current.offsetHeight+20;S.current.scrollTo({top:e,behavior:"smooth"})}})});return e.observe(_.current),()=>{e.disconnect()}},[p,h,c]);const{openNativePopup:F}=UV({message:T}),U=A.useCallback(e=>j(void 0,null,function*(){(yield WS(e))&&ht.openOnce({type:"success",content:r.t("Copying to clipboard was successful!")})}),[r]),H=A.useCallback((e=0)=>{$x()?F({type:ag.WebSearch,currentTab:Fe.sources,citationIndex:e}):(E(!0),k(ag.WebSearch),C({messageId:(null==T?void 0:T.id)||"",citationIndex:e,tab:Fe.sources}))},[null==T?void 0:T.id,F,C,k,E]),B=A.useCallback((e,t="")=>{const n=new Date,i=`Qwen_${t}_${`${n.getFullYear()}${String(n.getMonth()+1).padStart(2,"0")}${String(n.getDate()).padStart(2,"0")}`}_${Math.random().toString(36).slice(-9)}${HV(t)}`;Tx.saveAs(new Blob([e],{type:"text/plain;charset=utf-8"}),i)},[]),q=TG({mediaType:"image",messageId:(null==T?void 0:T.id)||""}),G=A.useMemo(()=>({code:{headerActionsRender:e=>an.jsxs(an.Fragment,{children:[an.jsx(xe,{title:r.t("Copy"),children:an.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>U(e.text),children:an.jsx(pt,{type:"icon-line-copy-right"})})}),!c&&an.jsx(xe,{title:r.t("Download"),children:an.jsx("div",{className:"qwen-markdown-code-header-action-item",onClick:()=>B(e.text,e.lang),children:an.jsx(pt,{type:"icon-line-download-02"})})})]}),theme:g},codespan:{onClick:e=>j(void 0,[e],function*({text:e}){(yield WS(e))&&ht.openOnce({type:"success",content:r.t("Copying to clipboard was successful!")})})},image:w({defaultWidth:1,defaultHeight:1,sizeScope:c?{width:[114,300],height:[126,380]}:[400,448],onError:()=>({errorMessage:r.t("Image Load Error")})},q),table:{headerActionsRender:zx()?void 0:e=>an.jsx(an.Fragment,{children:an.jsx(xt,{placement:"bottomRight",menu:{items:[{key:"csv",label:an.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${(null==T?void 0:T.id)||""}.csv`;XS(e,t)},children:r.t("Export to CSV")})},{key:"excel",label:an.jsx("div",{className:"qwen-markdown-table-header-export-item",onClick:()=>{const t=`table-${(null==T?void 0:T.id)||""}.xlsx`;JS(e,t)},children:r.t("Export to Excel")})}]},getPopupContainer:e=>e||document.body,children:an.jsx("div",{className:"qwen-markdown-table-header-action-item",children:an.jsx(pt,{type:"icon-line-download-02"})})})})},citation:{contentRender:e=>{const t=e.map(e=>{if(!Array.isArray(M)||!M.length)return null;const t=M[Number(e)-1];if(!t)return null;const{snippet:n,icon:i,title:a,url:o,hostname:s}=t;return{description:n,icon:i,title:a,url:o,hostIndex:e,hostname:s}}).filter(e=>e);return c?t.map(e=>an.jsx("div",{className:"qwen-markdown-citation-item",children:an.jsx(qV,{hostList:[e],onHostNameClick:()=>{H(Number(null==e?void 0:e.hostIndex)||0)}})},null==e?void 0:e.url)):t.length?an.jsx(qV,{hostList:t,onClick:e=>window.open(e)}):null}}}),[g,c,q,r,U,B,null==T?void 0:T.id,M,H]),{chatStatusTitle:V}=XV(T),W=A.useMemo(()=>{if(!Array.isArray(null==T?void 0:T.content_list)||!T.content_list.length)return null;if(!L)return null;const e=T.content_list;return an.jsxs(an.Fragment,{children:[e.map(e=>{var t,n,i,a,o,s,l;const c=e.status;switch(e.phase){case og.THINKING_SUMMARY:{const i=e.extra,a=(null==(t=null==i?void 0:i.summary_thought)?void 0:t.content)||[],o=(null==(n=null==i?void 0:i.summary_title)?void 0:n.content)||[];return an.jsx(an.Fragment,{children:Array.isArray(o)&&o.length?o.map((e,t)=>an.jsx(hQ,{type:VV.THINKING_AND_ANALYSING,status:WV.RESULT_STATE,customTitle:e,children:an.jsx(ze,{content:a[t]||"",loose:!["ja-JP","ko-KR","zh-CN","zh-TW"].includes(r.language),tokenProps:G})},`${e}-${t}`)):null})}case og.THINK:{const t=e.content;return an.jsx(hQ,{type:VV.THINKING,status:"finished"===c||P?WV.RESULT_STATE:WV.PROCESS_STATE,children:an.jsx("div",{className:"qwen-chat-thinking-and-sources-summary",children:an.jsx(ze,{content:t||"",loose:!["ja-JP","ko-KR","zh-CN","zh-TW"].includes(r.language),tokenProps:G})})})}case og.WEB_SEARCH:{const t=(null==(i=e.extra)?void 0:i.web_search_info)||[];return an.jsx(hQ,{type:VV.SEARCHING_WEB_PAGES,status:"finished"===c||P?WV.RESULT_STATE:WV.PROCESS_STATE,children:an.jsx(uQ,{sources:t})})}case og.IMAGE_ZOOM_IN_TOOL:return an.jsx(LW,{detail:e,message:T,isStop:T.is_stop});case og.WEB_EXTRACTOR:{const t=Array.isArray(null==(a=null==e?void 0:e.extra)?void 0:a.web_extract_info)?null==(o=null==e?void 0:e.extra)?void 0:o.web_extract_info:[];return an.jsx(hQ,{type:VV.READING_SOURCES,status:"finished"===c||P?WV.RESULT_STATE:WV.PROCESS_STATE,children:an.jsx(X,{wrap:"wrap",gap:8,align:"flex-start",children:t.map(({url:e})=>an.jsx(cQ,{url:e,onClick:()=>{window.open(e)}},e))})})}case og.HISTORY_RETRIEVER:return an.jsx(hQ,{type:VV.SEARCHING_MEMORIES,status:"finished"===c||P?WV.RESULT_STATE:WV.PROCESS_STATE,children:"finished"===c?an.jsx("div",{className:"qwen-chat-thinking-and-sources-summary",children:r.t("Search completed.")}):null});case og.BIO:{const t=(null==(l=null==(s=null==e?void 0:e.extra)?void 0:s.tool_result)?void 0:l.memory_operation_result)||{},{updated_memories:n=[],new_memories:i=[],cleared_memories:a=[]}=t,o=[...n,...i],u=[...o,...a];y({notification_id:(null==e?void 0:e.function_id)||"",type:"functionCallType",detail:w({chat_id:v},t)});const d="finished"===c||P,h=!(!d||!u.length||p);return an.jsx(hQ,{type:VV.UPDATING_MEMORIES,status:d?WV.RESULT_STATE:WV.PROCESS_STATE,controlConfig:{visibly:h,label:r.t("View"),onClick:()=>{b(!0)}},children:an.jsxs(X,{vertical:!0,gap:8,className:"qwen-chat-thinking-and-sources-summary",children:[a.map(({content:e})=>an.jsxs(X,{gap:8,className:"qwen-chat-thinking-and-sources-summary-line-through",children:[an.jsx("div",{className:"qwen-chat-thinking-and-sources-summary-point "}),an.jsx("div",{className:"qwen-chat-thinking-and-sources-summary-text",children:e})]},e)),o.map(({content:e})=>an.jsxs(X,{gap:8,children:[an.jsx("div",{className:"qwen-chat-thinking-and-sources-summary-point"}),an.jsx("div",{className:"qwen-chat-thinking-and-sources-summary-text",children:e})]},e))]})})}case og.CODE_INTERPRETER:{const t="finished"===c||P||(null==T?void 0:T.is_stop_in_thinking);return an.jsx(hQ,{type:VV.CALLING_CODE_INTERPRETER,status:t?WV.RESULT_STATE:WV.PROCESS_STATE,children:an.jsx(AW,{status:t?WV.RESULT_STATE:WV.PROCESS_STATE,detail:e})})}case og.ANSWER:return an.jsx("div",{style:{marginBottom:24},children:an.jsx(hQ,{type:VV.THINKING,status:WV.RESULT_STATE,hiddenContent:!0,customTitle:r.t(L?"Thinking completed":"Search web Completed")})});default:return null}}),P?an.jsx("div",{style:{marginBottom:24},children:an.jsx(hQ,{type:VV.THINKING,status:WV.RESULT_STATE,hiddenContent:!0,customTitle:V,customIcon:"icon-line-lightbulb-031"})}):null]})},[r,v,T,V,G,p,P,L,y,b]),Q=A.useMemo(()=>c?null:(R||P||!L)&&(!L||D||M.length)?an.jsx("div",{ref:_,children:an.jsxs("div",{children:[an.jsxs(X,{align:"center",gap:4,className:"qwen-chat-web-search-origins-header",children:[an.jsx("div",{children:r.t("Search Sources")}),an.jsx("div",{className:"qwen-chat-web-search-origins-header-point"}),an.jsx("div",{className:"qwen-chat-web-search-origins-header-count",children:(null==M?void 0:M.length)||0})]}),an.jsx(kQ,{citationIndex:0,listData:M||[],webSourceOption:{id:o,noSourceText:r.t("no sources"),showHeader:!1,style:{width:f?"100%":340},onClickItem:e=>qC(e.url,e.fileType),theme:g}})]})}):null,[r,c,g,M,R,D,P,L,o,f]);return T?an.jsxs(X,{vertical:!0,className:Y("qwen-chat-thinking-and-sources",{"qwen-chat-thinking-and-sources-share":p}),children:[an.jsx(X,{align:"center",justify:c?"flex-end":"center",className:"qwen-chat-thinking-and-sources-header",children:an.jsx(pt,{type:c?"icon-line-x-01":"icon-line-x-03",onClick:O})}),an.jsxs("div",{className:"qwen-chat-thinking-and-sources-content",onTouchMove:()=>{s(!0)},ref:S,onScroll:()=>{s(!0)},children:[an.jsx("div",{ref:x,children:W}),Q]})]}):null}),TQ=A.memo(e=>{var t;const{showControlsType:n,setUnfoldedHeight:i}=e,a=$(),o=qx(),s=Ex(e=>e.mobile),r=Sx(e=>e.websearchLoading),l=Sx(e=>e.taskRunning),c=Sx(e=>e.PdfViewInfo),u=vx(e=>e.history),{messageId:d,citationIndex:h,tab:p}=vx(e=>e.currentCitationInfo),m=TT(e=>e.messageType),f=vx(e=>e.allSearchAndThinkLists),g=vx(e=>e.temporarySource),v=vx(e=>e.currentSearchSource),y=vx(e=>e.currentSearchLists),b=zE(e=>e.showControls),x=zE(e=>e.theme),_=zE(e=>e.setLargeScreen),S=vx(e=>e.currentArtifactsMessage),C=zE(e=>e.realTheme),E=vx(e=>e.imageReasonData),k=A.useMemo(()=>{const e=u.messages[d];return(null==e?void 0:e.error)?nt.Error:(null==e?void 0:e.done)&&!(null==e?void 0:e.is_stop)?nt.Finish:!l||(null==e?void 0:e.is_stop)?nt.Stop:nt.Running},[u.messages,d,l]),I=A.useMemo(()=>{var e;const t=null==(e=f[d])?void 0:e.webSearchInfo;if(b){if([ag.WebSearch,ag.ThinkingAndSearch,ag.ThinkingAndSources].includes(n))return g[d]||t||v[d]||[];if(v.type===ag.DeepResearch||v.type===ag.DeepResearchLinkSource)return it((null==v?void 0:v[d])||[],cC)}return g[d]||v[d]||[]},[f,v,d,b,n,g]),T=A.useMemo(()=>{var e;return n===ag.DeepResearchLinkSource||n===ag.DeepResearch||n===ag.DeepResearchDetail?y[d]||[]:(n===ag.ThinkingAndSearch||n===ag.Thinking)&&((null==(e=f[d])?void 0:e.contentList)||v[d])||[]},[f,v,d,n,y]),j=e=>{e.matches?_(!0):_(!1)};A.useEffect(()=>{const e=window.matchMedia("(min-width: 1024px)");return e.addEventListener("change",j),j(e),()=>{e.removeEventListener("change",j)}},[]);const N=e=>{Array.isArray(e)||window.open(e.url)};switch(n){case ag.WebSearch:return an.jsx(kQ,{isLoading:r,citationIndex:h,listData:I,webSourceOption:{id:d,noSourceText:a.t("no sources"),headerTitle:a.t("Sources"),style:{width:o?"100%":340},onClickItem:e=>qC(e.url,e.fileType),onClose:()=>kT.closeShowControls(),theme:C}});case ag.DeepResearch:return an.jsx(st,{isLoading:r,citationIndex:h,listData:I,webSourceOption:{id:d,noSourceText:a.t("no sources"),headerTitle:a.t("Search Source  {{Number}}",{Number:null==I?void 0:I.length}),style:{width:o?"100%":340},onClickItem:e=>qC(e.url,e.fileType),onClose:()=>kT.closeShowControls(),theme:C,triggerTimestamp:Date.now()}});case ag.ThinkingAndSearch:case ag.DeepResearchLinkSource:case ag.Thinking:{let e=n===ag.DeepResearchLinkSource?[{text:a.t("Research"),key:Fe.step},{text:a.t("Sources"),key:Fe.sources}]:[{text:a.t("Details"),key:Fe.step},{text:a.t("Sources"),key:Fe.sources}];return n===ag.Thinking&&(e=[{text:a.t("Details"),key:Fe.step}]),m===ng.Travel&&(e=[{text:a.t("Travel Research"),key:Fe.step}]),an.jsx(ot,{citationIndex:h,currentTab:p,cardStatus:k,isCurrent:s&&n===ag.DeepResearchLinkSource,sourceList:I,stepList:T,onLinkCard:N,tabs:e,webSourceOption:{headerTitle:a.t("Sources"),noSourceText:a.t("no sources"),id:d,onClickItem:e=>qC(e.url,e.fileType),theme:x},onClose:()=>kT.closeShowControls(),customPlugings:{code_interpreter:e=>an.jsx(rQ,{detail:e,cardStatus:k})}})}case ag.Artifacts:return an.jsx(eQ,{message:S});case ag.PdfViewer:return an.jsx(at,{info:c,header:an.jsx(tQ,{onClose:()=>kT.closeShowControls(),fileName:(null==(t=null==c?void 0:c.pdf)?void 0:t.name)||"",onDownload:Ek,info:c}),loadingText:`PDF ${a.t("Loading...")}`,onClose:()=>kT.closeShowControls(),errorInfo:{title:a.t("PDF preview failed"),content:a.t("Preview failed due to version compatibility issues. You can switch to a browser for preview.")}});case ag.ImageReason:return an.jsx(nQ,w({},E));case ag.DeepResearchDetail:return an.jsx(iQ,{cardStatus:k,stepList:T});case ag.ThinkingAndSources:return an.jsx(IQ,{searchMessageId:d,setUnfoldedHeight:i});default:return null}}),jQ=A.memo(e=>{const{open:t,showControlsType:n}=e,i=`calc(${window.innerHeight}px - ${Qx()} - ${Kx()} - 48px)`,[a,o]=A.useState(!1),s=zE(e=>e.setShowControls),r=Sx(e=>e.setCurrentShowControl),l=Sx(e=>e.setCurrentActionMessageId),c=Sx(e=>e.setLocateTheSearchSource);A.useEffect(()=>{o(n!==ag.ThinkingAndSources)},[n]);const u=A.useCallback(()=>{s(!1),r(ag.None),c(!1),l("")},[l,r,c,s]);return an.jsx(we,{placement:"bottom",height:a?i:488,open:!t,onClose:()=>{n===ag.ThinkingAndSources&&u()},drawerRender:()=>an.jsx("div",{className:"chat-mobile-drawer",style:{maxHeight:a?i:488},children:an.jsx(TQ,{showControlsType:n,setUnfoldedHeight:o})})})}),NQ=({closeModal:e})=>{const{t:t,i18n:n}=$(),i=Sx(e=>e.taskRunning),[a,o]=A.useState(""),s=zE(e=>e.setShowH5PodcastDetail),[r,l]=A.useState(!1),{hostMenu:c,guestMenu:u,guestItem:d,hostItem:h,Audio:p,audioWaiting:m,audioPlaying:f,updateSetting:g,setHostItem:v,setGuestItem:y,stopCurrentAudio:b,setActiveItemValue:x}=pW({id:"mobile-pdf-tts-audio"}),w=A.useMemo(()=>"host"===a?null==h?void 0:h.label:null==d?void 0:d.label,[a,d,h]),_=A.useMemo(()=>"host"===a?c:u,[a,c,u]);return A.useEffect(()=>()=>{null==b||b()},[]),an.jsxs(an.Fragment,{children:[p,an.jsxs("div",{className:"timbre-select-modal-content",children:[an.jsxs("div",{className:"timbre-select-modal-content-title",children:[an.jsx("span",{className:"content-title-text",children:t("Select the voice")}),an.jsx("div",{className:"content-title-close-button",onClick:()=>e(),children:an.jsx(pt,{type:"icon-close-4",className:"icon-close-button"})})]}),an.jsx("div",{className:"timbre-select-modal-content-list",children:an.jsxs("div",{className:"podcast-detail-content",children:[an.jsxs("div",{className:"podcast-detail-content-item",children:[an.jsx("div",{className:"podcast-detail-content-item-title",children:t("Host")}),an.jsxs("button",{className:"podcast-selector-button",onClick:()=>{o("host"),l(!0),x(h)},children:[null==h?void 0:h.label,an.jsx(pt,{type:"icon-line-chevron-down"})]})]}),an.jsxs("div",{className:"podcast-detail-content-item",children:[an.jsx("div",{className:"podcast-detail-content-item-title",children:t("Guest")}),an.jsxs("button",{className:"podcast-selector-button",onClick:()=>{o("guest"),l(!0),x(d)},children:[null==d?void 0:d.label,an.jsx(pt,{type:"icon-line-chevron-down"})]})]})]})}),an.jsx("div",{className:"timbre-select-modal-content-footer",children:an.jsx("button",{className:"create-podcast-button",onClick:()=>j(void 0,null,function*(){i||(s(!1),UT()||(yield g()),vx.getState().setEmitSendPromptType(Yf.CHAT),kT.beforeSendMessage({inputText:n.t("Create a podcast"),subChatType:ng.Podcast}))}),children:t("Create a podcast")})})]}),an.jsx(gt,{title:t("Select the voice"),open:r,heightType:"auto",className:"timbre-detail-modal",onClose:()=>{b(),l(!1)},children:an.jsx("div",{className:"timbre-detail-modal-content",children:an.jsx("div",{className:"timbre-detail-modal-content-list",children:_.map(e=>an.jsxs("div",{className:"timbre-detail-modal-content-list-item",onClick:()=>{"host"===a?v(e):y(e),x(e)},children:[an.jsxs("div",{className:"item-left",children:[an.jsx("div",{className:"list-item-title",children:e.label}),an.jsx("div",{className:"list-item-description",children:e.description})]}),an.jsxs("div",{className:"item-right",children:[an.jsx("img",{src:wx(m,mB()),alt:"speaking",className:Y("item-right-icon",{"item-right-icon-hidden":!(e.label===w&&(f||m))})}),e.label===w?an.jsx(pt,{type:"icon-fill-check-03",className:"icon-fill-check-03 item-right-icon"}):null]})]},e.value))})})})]})},PQ=({chatId:e})=>{const t=$x(),n=qx(),i=new URLSearchParams(window.location.search).get("shareId"),a=A.useRef(null),o=$(),[s,r]=A.useState(!0),l=Ex(e=>e.mobile),c=Sx(e=>e.currentShowControl),u=vx(e=>e.chatLoaded),d=vx(e=>e.history.currentId),h=vx(e=>e.isChat),p=vx(e=>e.currentInputFeature),m=A.useRef(null),f=vx(e=>e.history.messages),g=zE(e=>e.setShowHeaderBorder),v=zE(e=>e.showHeaderBorder),y=t||n,[b,x]=A.useState(!1),_=A.useRef(s),S=A.useRef(0),C=zE(e=>e.setShowH5PodcastDetail),E=zE(e=>e.showH5PodcastDetail),k=A.useRef(null),I=A.useMemo(()=>l?c:ag.None,[c,l]),T=A.useMemo(()=>I===ag.None,[I]),j=A.useCallback(e=>{$x()&&kT.adapter.invoke({method:"setSendButtonEnabled",params:{value:e}})},[]),N=A.useMemo(()=>[ng.Artifacts,ng.WebDev,ng.ImageGeneration,ng.VideoGeneration,ng.DeepResearch,ng.ImageEdit,ng.LEARN].includes(p),[p]),P=Object.keys(f).length>0,M=A.useMemo(()=>null==f?void 0:f[d||""],[f,d]),O=A.useCallback(e=>{_.current=e,r(e)},[]),R=A.useMemo(()=>!!(M&&"error"in M&&M.error),[M]),D=A.useCallback(e=>{a.current&&a.current.scrollTo(w({top:a.current.scrollHeight},e))},[]),L=A.useCallback(e=>{a.current&&a.current.scrollTo(w({top:0},e))},[]),F=A.useCallback(()=>{O(!0),D({behavior:"smooth"})},[D,O]),z=A.useCallback(()=>{O(!0),L({behavior:"smooth"})},[L,O]),U=()=>{if(a.current){const{scrollTop:e,clientHeight:t,scrollHeight:n}=a.current;return n-e-t<100}return!1},H=A.useCallback(()=>{if(a.current){const{clientHeight:e,scrollHeight:t}=a.current;return Math.abs(t-e)>0}},[]),B=()=>{if(!a.current||!H())return;const{scrollTop:e,scrollHeight:t,clientHeight:n}=a.current;if(!v&&e>45?g(!0):v&&e<=45&&g(!1),e+n>t)return;S.current+n>t&&(S.current=e);e<S.current?O(!1):U()&&O(!0),S.current=e},q=A.useMemo(()=>{var e;return t?!!i:!!(null==(e=kT.shareHistory)?void 0:e.currentId)},[t,i]);return A.useEffect(()=>{h&&x(!1)},[h]),A.useEffect(()=>{const e=()=>{a.current&&!h&&x(!0);m.current=setTimeout(()=>{a.current&&(O(!H()||!U()),k.current=setTimeout(()=>{a.current&&(D(),requestAnimationFrame(()=>{x(!1)}))},200))},300)},t=()=>{requestAnimationFrame(()=>{_.current&&D({behavior:"smooth"})})},n=()=>{O(!0),D({behavior:"smooth"})};return yE.on(uE.CHAT_HISTORY_LOADED,e),yE.on(uE.CHAT_SSE_BEGIN,n),yE.on(uE.CHAT_SSE_PROCESS,t),()=>{yE.off(uE.CHAT_HISTORY_LOADED,e),yE.off(uE.CHAT_SSE_BEGIN,n),yE.off(uE.CHAT_SSE_PROCESS,t)}},[D,O,H,h]),A.useEffect(()=>()=>{k.current&&(clearTimeout(k.current),k.current=null),m.current&&(clearTimeout(m.current),m.current=null)},[]),A.useEffect(()=>{var t;if($x())return(u||P)&&!b&&e||R||!e||(null==(t=kT.shareHistory)?void 0:t.currentId)?j(!0):j(!1),()=>{j(!0)}},[e,u,R,b,j,P]),A.useEffect(()=>{g(!1)},[e,g]),an.jsx(an.Fragment,{children:an.jsxs("div",{className:Y("chat-layout",{"chat-desktop":!y,"chat-mobile":y}),children:[t&&an.jsx("div",{className:"chat-content",children:an.jsxs("div",{className:"chat-messages",id:bg,ref:a,onScroll:B,children:[an.jsx(QW,{chatIdProp:e}),!s&&an.jsx("div",{className:"scroll-down-button-container",children:an.jsx("div",{className:"scroll-down-button",onClick:F,children:an.jsx(pt,{type:"icon-line-arrow-down",className:"scroll-down-button-icon"})})}),s&&an.jsx("div",{className:"scroll-down-button-container",children:an.jsx("div",{className:"scroll-down-button",onClick:z,children:an.jsx(pt,{type:"icon-line-arrow-down",className:"scroll-down-button-icon up-button-icon"})})})]})}),n&&an.jsxs(an.Fragment,{children:[an.jsxs("div",{className:"chat-content",children:[an.jsx("div",{className:"chat-messages",id:bg,ref:a,onScroll:B,children:an.jsx(QW,{chatIdProp:e})}),an.jsx("div",{className:"chat-layout-input-container",children:an.jsx(iq,{inDetail:!0,chatId:e,onScrollDown:F,onScrollTop:z,scrollDownBtnVisible:!s,permissions:{functionButtonsVisible:!N}})})]}),an.jsx(mt,{className:"timbre-select-modal",visible:E,header:!1,footer:!1,closable:!1,children:an.jsx(NQ,{closeModal:()=>C(!1)})}),an.jsx(jQ,{open:T,showControlsType:I})]}),!t&&!n&&an.jsx(an.Fragment,{children:an.jsx("div",{className:"chat-content",id:"dropzone-container",children:an.jsx(Jq,{direction:"horizontal",className:"panel-group",children:an.jsx(xq,{className:"chat-left-panel",children:an.jsxs("div",{className:Y("chat-left",{"chat-left-border":!T}),children:[an.jsx("div",{className:"chat-messages",id:bg,ref:a,onScroll:B,children:an.jsx(QW,{chatIdProp:e})}),an.jsx("div",{className:"chat-layout-input-container",children:an.jsx(iq,{inDetail:!0,chatId:e,onScrollDown:F,onScrollTop:z,scrollDownBtnVisible:!s,permissions:{functionButtonsVisible:!N&&p!==ng.DeepResearch}})}),an.jsx("div",{className:"chat-container-statement",children:o.t("AI-generated content may not be accurate.")})]})})})})}),an.jsx(Yk,{fixed:!1,absolute:!0,loaded:(u||P)&&!b&&!!e||R||!e||q})]})})},MQ=()=>{const{id:e}=Ny();return an.jsx(PQ,{chatId:e||""})},AQ=({leftPanel:e,rightPanel:t,open:n,draggable:i,miniSplitScreen:a})=>{const o=A.useRef(null),s=A.useRef(null),r=A.useRef(null),l=A.useRef(!0),c=A.useRef(null),u=A.useRef(null),d=A.useRef(!1),[h,p]=A.useState(!1),[m,f]=A.useState(!1),[g,v]=A.useState(!1),y=zE(e=>e.setShowSidebar),b=zE(e=>e.setIsSmallScreen),x=zE(e=>e.setIsMiddleScreen),w=zE(e=>e.setSidebarFloatingPlaceholder),_=e=>{if(!o.current||!r.current)return;const t=o.current.getBoundingClientRect(),n=e.clientX-t.left,i=t.width-480,a=Math.min(Math.max(n,440),i);r.current.style.width=t.width-a+"px"},S=()=>{v(!1),document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",S)},C=()=>{u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{u.current=null,r.current&&r.current.style.removeProperty("transition")},500)},E=A.useCallback(()=>n?window.innerWidth>=(a?1100:1180):window.innerWidth>=760,[a,n]),k=A.useCallback(()=>{var e,t;const n=E(),i=null==(e=document.querySelector("#sidebar"))?void 0:e.getBoundingClientRect();return n&&null!=(t=null==i?void 0:i.width)?t:60},[E]),I=A.useCallback(()=>{const e=E();QT()||y(e),w(!e);const t=window.innerWidth<760;b(t),x(!t&&window.innerWidth<1100)},[E,y,w,b,x]),T=A.useCallback(()=>{const e=E();if(d.current||!e?I():w(!e),!o.current||!r.current||!s.current)return;if(d.current&&(r.current.style.transition="none"),!i)return r.current&&(r.current.style.width="400px",l.current=!0,setTimeout(()=>{r.current.style.minWidth="400px"},300)),void C();if(f(window.innerWidth>980),window.innerWidth<980)return s.current.style.display="none",r.current.style.width=window.innerWidth-60+"px",void C();const t=window.innerWidth-k();if(l.current&&t/2>Math.max(440,480))return l.current=!1,r.current.style.width=t/2+"px",void C();const n=s.current.getBoundingClientRect(),c=Math.max(n.width,440),u=Math.max(t-c,480);r.current.style.width=`${a?400:u}px`,s.current.style.display="block",C()},[i,a,I,E,k,w]);return A.useEffect(()=>{n?(c.current&&clearTimeout(c.current),p(!0)):(r.current&&(r.current.style.width=r.current.style.minWidth="0px"),s.current&&s.current.style.removeProperty("display"),l.current=!0,c.current=setTimeout(()=>{c.current=null,p(!1)},300))},[n]),A.useLayoutEffect(()=>{n&&h&&setTimeout(()=>T(),50),n||w(!E());const e=()=>{d.current=!0,n?T():I(),d.current=!1};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[h,n,E,T,I,w]),an.jsxs("div",{className:Y("splitter-container",{"splitter-container-dragging":g}),ref:o,children:[an.jsx("div",{className:"splitter-container-left-panel",ref:s,children:e}),h&&an.jsxs("div",{className:"splitter-container-right-panel",ref:r,children:[t,i&&m&&an.jsx("div",{className:"resize-bar",onMouseDown:()=>{document.addEventListener("mousemove",_),document.addEventListener("mouseup",S),v(!0)}})]})]})},OQ=({showProjectChatInsModal:e,onCloseModal:t,inputValue:n})=>{const{getNewProjectList:i}=vN(),a=$(),o=Ex(e=>e.mobile),[s,r]=z.useState(n||""),[l,c]=z.useState(!1),u=DT(e=>e.projectInfo),d=DT(e=>e.setProjectInfo),h=()=>j(void 0,null,function*(){try{(yield kS({custom_instruction:s},u.id)).data.status&&(i(),d(_(w({},u),{custom_instruction:s})),ht.openOnce({type:"success",content:a.t("Instruction saved successfully.")}),t(),c(!1))}catch(e){}}),p=()=>{t(),c(!1)},m=()=>an.jsx(LN,{props:{value:s||"",onChange:e=>{r(e),l||c(!0)},minRows:o?10:1,maxRows:10,maxLength:1e3,placeholder:a.t("What should the AI know about this project? (e.g., specific rules, tone, or formatting)")}});return o?an.jsx(gt,{open:e,title:a.t("Instructions"),heightType:"auto",onClose:t,size:"large",className:"mobile-project-ins-popup",children:an.jsx("div",{className:"qwen-chat-comp-project-ins-popup",children:an.jsxs("div",{className:"qwen-chat-comp-project-ins-popup-content",children:[m(),an.jsxs("div",{className:"qwen-chat-comp-project-ins-popup-footer",children:[an.jsx(ft,{type:"tertiary",size:"large",rounded:"circle",className:"qwen-chat-comp-project-ins-popup-footer-btn",onClick:p,children:a.t("Cancel")}),an.jsx(ft,{type:"brandprimary",size:"large",rounded:"circle",className:"qwen-chat-comp-project-ins-popup-footer-btn",disabled:s===n,onClick:h,children:a.t("Save")})]})]})})}):an.jsxs(mt,{size:"medium",visible:e,className:"qwen-chat-comp-project-ins-modal",title:a.t("Instructions"),headerBorderNone:!0,onCancel:p,onOk:h,footer:!1,okText:a.t("Save"),cancelText:a.t("Cancel"),children:[m(),an.jsxs("div",{className:"qwen-chat-comp-project-ins-modal-footer",children:[an.jsx(ft,{type:"ghost",rounded:"circle",className:"qwen-chat-comp-project-ins-modal-footer-btn",onClick:p,children:a.t("Cancel")}),an.jsx(ft,{type:"brandprimary",rounded:"circle",className:"qwen-chat-comp-project-ins-modal-footer-btn",onClick:h,disabled:s===n,children:a.t("Save")})]})]})},RQ=({showProjectChatFileModal:e,onCloseModal:t,projectId:n})=>{const{getProjectFilesList:i}=vN(),a=$(),o=Ex(e=>e.mobile),s=DT(e=>e.operationProjectFiles),r=DT(e=>e.deleteFiles),l=DT(e=>e.setDeleteFiles),c=DT(e=>e.setOperationProjectFiles),[u,d]=A.useState(!1),h=A.useRef(null),p=e=>j(void 0,null,function*(){var t,n,i,a;e&&"failed"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)?null==(a=null==h?void 0:h.current)||a.startParse(e,!0):e&&e.uploadTaskId&&(yield ME.resumeUpload(e.uploadTaskId))}),m=A.useMemo(()=>s.filter(e=>!r.includes(e.itemId)).some(e=>{var t,n,i;return"uploading"===e.status||"running"===(null==(i=null==(n=null==(t=null==e?void 0:e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)}),[r,s]);A.useEffect(()=>{n&&i(n)},[n]);const f=e=>{var t;null==(t=null==h?void 0:h.current)||t.removeFile(e),l([...r,e.file_id||e.itemId])},g=()=>{d(!1),j(void 0,null,function*(){const e=s.filter(e=>"uploading"===e.uploadStatus).map(e=>e.itemId);if(m)return s.forEach(e=>{var t,n,i,a;"running"===(null==(i=null==(n=null==(t=e.file)?void 0:t.meta)?void 0:n.parse_meta)?void 0:i.parse_status)&&(null==(a=null==h?void 0:h.current)||a.removeFile(e))}),void l(e);const t=s.filter(e=>!e.file_id&&"success"===e.uploadStatus&&"success"===e.greenNet).filter(e=>!r.includes(e.itemId));(yield kS({add_files:t,delete_files:r},n)).success&&(l(e),qN(n))}),t(),c([])},v=()=>{m?d(!0):g()},y=()=>an.jsx(zN,{files:s,actions:["download","delete"],onReUpload:p,onDownload:e=>{const{path:t,url:n}=e,i=t||n;i.includes("img.alicdn.com")?gC(i):yC({role:"user",url:i})},onDelete:f,isMobileProjectDetail:o});return an.jsxs(an.Fragment,{children:[o?an.jsxs(gt,{open:e,title:a.t("Files"),heightType:"full",onClose:v,className:"mobile-project-ins-popup",children:[an.jsx("div",{className:"qwen-chat-comp-project-file-popup-list",children:y()}),an.jsx(BN,{styles:{width:"calc(100% - 30px)",height:"48px",margin:"0 15px"},ref:h})]}):an.jsxs(mt,{size:"medium",visible:e,className:"qwen-chat-comp-project-file-modal",footer:!1,header:!1,bodyPaddingNone:!0,onCancel:v,children:[an.jsxs("div",{className:"qwen-chat-comp-project-file-modal-herder",children:[an.jsx("div",{className:"qwen-chat-comp-project-file-modal-title",children:a.t("Files")}),an.jsxs("div",{className:"qwen-chat-comp-project-file-modal-action",children:[an.jsx(BN,{styles:{width:"88px"},ref:h}),an.jsx("button",{onClick:v,className:"qwen-chat-comp-project-file-modal-close",children:an.jsx(pt,{type:"icon-line-x-01"})})]})]}),an.jsx("div",{className:"qwen-chat-comp-project-file-modal-list",children:y()})]}),u&&an.jsx(VN,{onCancel:()=>{d(!1)},onConfirm:()=>{g()}})]})},DQ=({showEditProjectNameModal:e,onCloseModal:t,projectTitle:n})=>{const{getNewProjectList:i}=vN(),a=$(),o=Ex(e=>e.mobile),[s,r]=z.useState(n||""),l=DT(e=>e.projectInfo),c=DT(e=>e.setProjectInfo),u=()=>j(void 0,null,function*(){if(localStorage.getItem("token")&&(null==l?void 0:l.id))try{(yield kS({name:s},l.id)).data.status&&(i(),c(_(w({},l),{name:s})),t())}catch(e){}}),d=()=>{t()},h=()=>o?an.jsx(LN,{props:{value:s||"",onChange:e=>{r(e)},minRows:3,maxRows:3,maxLength:150,placeholder:a.t("Project Name")}}):an.jsx(_t,{value:s,onChange:e=>{r(e)},maxLength:150,placeholder:a.t("Project Name"),className:"project-new-name-edit-input"});return o?an.jsx(gt,{open:e,title:a.t("Edit Project Name"),heightType:"auto",onClose:t,size:"large",className:"mobile-project-name-popup",children:an.jsx("div",{className:"qwen-chat-comp-project-name-popup",children:an.jsxs("div",{className:"qwen-chat-comp-project-name-popup-content",children:[h(),an.jsx("div",{className:"qwen-chat-comp-project-name-popup-footer",children:an.jsx(ft,{type:"brandprimary",size:"large",rounded:"circle",className:"qwen-chat-comp-project-name-popup-footer-btn",onClick:u,disabled:!s.trim()||s===n,children:a.t("Save")})})]})})}):an.jsxs(mt,{size:"small",visible:e,className:"qwen-chat-comp-project-name-modal",title:a.t("Edit Project Name"),headerBorderNone:!0,onCancel:d,onOk:u,footer:!1,children:[h(),an.jsxs("div",{className:"qwen-chat-comp-project-name-modal-footer",children:[an.jsx(ft,{type:"ghost",rounded:"circle",className:"qwen-chat-comp-project-name-modal-footer-btn",onClick:d,children:a.t("Cancel")}),an.jsx(ft,{type:"brandprimary",rounded:"circle",className:"qwen-chat-comp-project-name-modal-footer-btn",onClick:u,disabled:!s.trim()||s===n,children:a.t("Save")})]})]})},LQ=({projectTitle:e,projectIns:t})=>{const n=DT(e=>e.projectInfo),i=DT(e=>e.projectChats),a=DT(e=>e.setInstructionValue),o=$(),s=Ex(e=>e.mobile),[r,l]=A.useState(!1),[c,u]=A.useState(!1),[d,h]=A.useState(!1),p=DT(e=>e.setProjectInfo),{getNewProjectList:m}=vN();return an.jsxs("div",{className:"project-title "+(s&&i.length<1?"project-title-full-center":""),children:[an.jsxs("div",{className:"project-title-left",children:[an.jsx(AN,{data:n,setData:e=>j(void 0,null,function*(){(yield kS({icon:e.icon},n.id)).data.status&&(m(),p(_(w({},n),{icon:e.icon})))}),isProjectDetail:!0}),an.jsx("div",{className:"project-title-text",onClick:()=>{l(!r)},children:e})]}),an.jsxs("div",{className:"project-title-right",children:[n.fileLength>0&&an.jsx(vt,{title:o.t("{{count}}  Files",{count:n.fileLength}),children:an.jsxs("button",{className:"project-title-button",style:s?{}:{transform:"translateX(10px)"},onClick:()=>{h(!d)},children:[an.jsx(pt,{type:"icon-line-file-02",className:"project-title-action-icon"}),s?o.t("{{count}}  Files",{count:n.fileLength}):""]})}),t&&(null==t?void 0:t.length)>0&&an.jsx(vt,{title:o.t("Projects Instructions"),children:an.jsxs("button",{className:"project-title-button",onClick:()=>{u(!c),a(n.custom_instruction)},children:[an.jsx(pt,{type:"icon-line-customize",className:"project-title-action-icon"}),s?o.t("Projects Instructions"):""]})})]}),s&&i.length<1&&an.jsxs("div",{className:"project-placeholder",children:[an.jsx(pt,{type:"icon-line-package-empty",className:"project-placeholder-icon"}),an.jsx("div",{className:"project-placeholder-text",children:o.t("All project-related chats will be displayed here.")})]}),c&&an.jsx(OQ,{showProjectChatInsModal:c,onCloseModal:()=>{u(!1)},inputValue:t}),d&&an.jsx(RQ,{projectId:n.id,showProjectChatFileModal:d,onCloseModal:()=>{h(!1)}}),r&&an.jsx(DQ,{showEditProjectNameModal:r,onCloseModal:()=>{l(!1)},projectTitle:e})]})},FQ=A.createContext({dragDropManager:void 0});function zQ(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var UQ="function"==typeof Symbol&&Symbol.observable||"@@observable",HQ=function(){return Math.random().toString(36).substring(7).split("").join(".")},BQ={INIT:"@@redux/INIT"+HQ(),REPLACE:"@@redux/REPLACE"+HQ()};function $Q(e,t,n){var i;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(zQ(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(zQ(1));return n($Q)(e,t)}if("function"!=typeof e)throw new Error(zQ(2));var a=e,o=t,s=[],r=s,l=!1;function c(){r===s&&(r=s.slice())}function u(){if(l)throw new Error(zQ(3));return o}function d(e){if("function"!=typeof e)throw new Error(zQ(4));if(l)throw new Error(zQ(5));var t=!0;return c(),r.push(e),function(){if(t){if(l)throw new Error(zQ(6));t=!1,c();var n=r.indexOf(e);r.splice(n,1),s=null}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(zQ(7));if(void 0===e.type)throw new Error(zQ(8));if(l)throw new Error(zQ(9));try{l=!0,o=a(o,e)}finally{l=!1}for(var t=s=r,n=0;n<t.length;n++){(0,t[n])()}return e}return h({type:BQ.INIT}),(i={dispatch:h,subscribe:d,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error(zQ(10));a=e,h({type:BQ.REPLACE})}})[UQ]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(zQ(11));function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[UQ]=function(){return this},e},i}function qQ(e,t,...n){if("undefined"!=typeof process&&void 0===t)throw new Error("invariant requires an error message argument");if(!e){let e;if(void 0===t)e=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let i=0;e=new Error(t.replace(/%s/g,function(){return n[i++]})),e.name="Invariant Violation"}throw e.framesToPop=1,e}}function GQ(e){return"object"==typeof e}const VQ="dnd-core/INIT_COORDS",WQ="dnd-core/BEGIN_DRAG",QQ="dnd-core/PUBLISH_DRAG_SOURCE",KQ="dnd-core/HOVER",YQ="dnd-core/DROP",XQ="dnd-core/END_DRAG";function JQ(e,t){return{type:VQ,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}const ZQ={type:VQ,payload:{clientOffset:null,sourceClientOffset:null}};function eK(e){return function(t=[],n={publishSource:!0}){const{publishSource:i=!0,clientOffset:a,getSourceClientOffset:o}=n,s=e.getMonitor(),r=e.getRegistry();e.dispatch(JQ(a)),function(e,t,n){qQ(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach(function(e){qQ(n.getSource(e),"Expected sourceIds to be registered.")})}(t,s,r);const l=function(e,t){let n=null;for(let i=e.length-1;i>=0;i--)if(t.canDragSource(e[i])){n=e[i];break}return n}(t,s);if(null==l)return void e.dispatch(ZQ);let c=null;if(a){if(!o)throw new Error("getSourceClientOffset must be defined");!function(e){qQ("function"==typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(o),c=o(l)}e.dispatch(JQ(a,c));const u=r.getSource(l).beginDrag(s,l);if(null==u)return;!function(e){qQ(GQ(e),"Item must be an object.")}(u),r.pinSource(l);const d=r.getSourceType(l);return{type:WQ,payload:{itemType:d,item:u,sourceId:l,clientOffset:a||null,sourceClientOffset:c||null,isSourcePublic:!!i}}}}function tK(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nK(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){tK(e,t,n[t])})}return e}function iK(e){return function(t={}){const n=e.getMonitor(),i=e.getRegistry();!function(e){qQ(e.isDragging(),"Cannot call drop while not dragging."),qQ(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(n);const a=function(e){const t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(n);a.forEach((a,o)=>{const s=function(e,t,n,i){const a=n.getTarget(e);let o=a?a.drop(i,e):void 0;(function(e){qQ(void 0===e||GQ(e),"Drop result must either be an object or undefined.")})(o),void 0===o&&(o=0===t?{}:i.getDropResult());return o}(a,o,i,n),r={type:YQ,payload:{dropResult:nK({},t,s)}};e.dispatch(r)})}}function aK(e){return function(){const t=e.getMonitor(),n=e.getRegistry();!function(e){qQ(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);const i=t.getSourceId();if(null!=i){n.getSource(i,!0).endDrag(t,i),n.unpinSource()}return{type:XQ}}}function oK(e,t){return null===t?null===e:Array.isArray(e)?e.some(e=>e===t):e===t}function sK(e){return function(t,{clientOffset:n}={}){!function(e){qQ(Array.isArray(e),"Expected targetIds to be an array.")}(t);const i=t.slice(0),a=e.getMonitor(),o=e.getRegistry();return function(e,t,n){for(let i=e.length-1;i>=0;i--){const a=e[i];oK(t.getTargetType(a),n)||e.splice(i,1)}}(i,o,a.getItemType()),function(e,t,n){qQ(t.isDragging(),"Cannot call hover while not dragging."),qQ(!t.didDrop(),"Cannot call hover after drop.");for(let i=0;i<e.length;i++){const t=e[i];qQ(e.lastIndexOf(t)===i,"Expected targetIds to be unique in the passed array.");qQ(n.getTarget(t),"Expected targetIds to be registered.")}}(i,a,o),function(e,t,n){e.forEach(function(e){n.getTarget(e).hover(t,e)})}(i,a,o),{type:KQ,payload:{targetIds:i,clientOffset:n||null}}}}function rK(e){return function(){if(e.getMonitor().isDragging())return{type:QQ}}}class lK{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:t}=this.store;const n=function(e){return{beginDrag:eK(e),publishDragSource:rK(e),hover:sK(e),drop:iK(e),endDrag:aK(e)}}(this);return Object.keys(n).reduce((i,a)=>{const o=n[a];var s;return i[a]=(s=o,(...n)=>{const i=s.apply(e,n);void 0!==i&&t(i)}),i},{})}dispatch(e){this.store.dispatch(e)}constructor(e,t){this.isSetUp=!1,this.handleRefCountChange=()=>{const e=this.store.getState().refCount>0;this.backend&&(e&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!e&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=t,e.subscribe(this.handleRefCountChange)}}function cK(e,t){return{x:e.x-t.x,y:e.y-t.y}}const uK=[],dK=[];uK.__IS_NONE__=!0,dK.__IS_ALL__=!0;class hK{subscribeToStateChange(e,t={}){const{handlerIds:n}=t;qQ("function"==typeof e,"listener must be a function."),qQ(void 0===n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");let i=this.store.getState().stateId;return this.store.subscribe(()=>{const t=this.store.getState(),a=t.stateId;try{const o=a===i||a===i+1&&!function(e,t){if(e===uK)return!1;if(e===dK||void 0===t)return!0;const n=(i=e,t.filter(e=>i.indexOf(e)>-1));var i;return n.length>0}(t.dirtyHandlerIds,n);o||e()}finally{i=a}})}subscribeToOffsetChange(e){qQ("function"==typeof e,"listener must be a function.");let t=this.store.getState().dragOffset;return this.store.subscribe(()=>{const n=this.store.getState().dragOffset;n!==t&&(t=n,e())})}canDragSource(e){if(!e)return!1;const t=this.registry.getSource(e);return qQ(t,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()&&t.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const t=this.registry.getTarget(e);if(qQ(t,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;return oK(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}isDragging(){return Boolean(this.getItemType())}isDraggingSource(e){if(!e)return!1;const t=this.registry.getSource(e,!0);if(qQ(t,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;return this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}isOverTarget(e,t={shallow:!1}){if(!e)return!1;const{shallow:n}=t;if(!this.isDragging())return!1;const i=this.registry.getTargetType(e),a=this.getItemType();if(a&&!oK(i,a))return!1;const o=this.getTargetIds();if(!o.length)return!1;const s=o.indexOf(e);return n?s===o.length-1:s>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return function(e){const{clientOffset:t,initialClientOffset:n,initialSourceClientOffset:i}=e;return t&&n&&i?cK((o=i,{x:(a=t).x+o.x,y:a.y+o.y}),n):null;var a,o}(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return function(e){const{clientOffset:t,initialClientOffset:n}=e;return t&&n?cK(t,n):null}(this.store.getState().dragOffset)}constructor(e,t){this.store=e,this.registry=t}}const pK="undefined"!=typeof global?global:self,mK=pK.MutationObserver||pK.WebKitMutationObserver;function fK(e){return function(){const t=setTimeout(i,0),n=setInterval(i,50);function i(){clearTimeout(t),clearInterval(n),e()}}}const gK="function"==typeof mK?function(e){let t=1;const n=new mK(e),i=document.createTextNode("");return n.observe(i,{characterData:!0}),function(){t=-t,i.data=t}}:fK;class vK{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}const yK=new class{enqueueTask(e){const{queue:t,requestFlush:n}=this;t.length||(n(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,n=e.length-this.index;t<n;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=gK(this.flush),this.requestErrorThrow=fK(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}},bK=new class{create(e){const t=this.freeTasks,n=t.length?t.pop():new vK(this.onError,e=>t[t.length]=e);return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}(yK.registerPendingError);const xK="dnd-core/ADD_SOURCE",wK="dnd-core/ADD_TARGET",_K="dnd-core/REMOVE_SOURCE",SK="dnd-core/REMOVE_TARGET";function CK(e,t){t&&Array.isArray(e)?e.forEach(e=>CK(e,!1)):qQ("string"==typeof e||"symbol"==typeof e,t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var EK,kK;(kK=EK||(EK={})).SOURCE="SOURCE",kK.TARGET="TARGET";let IK=0;function TK(e){const t=(IK++).toString();switch(e){case EK.SOURCE:return`S${t}`;case EK.TARGET:return`T${t}`;default:throw new Error(`Unknown Handler Role: ${e}`)}}function jK(e){switch(e[0]){case"S":return EK.SOURCE;case"T":return EK.TARGET;default:throw new Error(`Cannot parse handler ID: ${e}`)}}function NK(e,t){const n=e.entries();let i=!1;do{const{done:e,value:[,a]}=n.next();if(a===t)return!0;i=!!e}while(!i);return!1}class PK{addSource(e,t){CK(e),function(e){qQ("function"==typeof e.canDrag,"Expected canDrag to be a function."),qQ("function"==typeof e.beginDrag,"Expected beginDrag to be a function."),qQ("function"==typeof e.endDrag,"Expected endDrag to be a function.")}(t);const n=this.addHandler(EK.SOURCE,e,t);return this.store.dispatch(function(e){return{type:xK,payload:{sourceId:e}}}(n)),n}addTarget(e,t){CK(e,!0),function(e){qQ("function"==typeof e.canDrop,"Expected canDrop to be a function."),qQ("function"==typeof e.hover,"Expected hover to be a function."),qQ("function"==typeof e.drop,"Expected beginDrag to be a function.")}(t);const n=this.addHandler(EK.TARGET,e,t);return this.store.dispatch(function(e){return{type:wK,payload:{targetId:e}}}(n)),n}containsHandler(e){return NK(this.dragSources,e)||NK(this.dropTargets,e)}getSource(e,t=!1){qQ(this.isSourceId(e),"Expected a valid source ID.");return t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return qQ(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return qQ(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return qQ(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return jK(e)===EK.SOURCE}isTargetId(e){return jK(e)===EK.TARGET}removeSource(e){var t;qQ(this.getSource(e),"Expected an existing source."),this.store.dispatch(function(e){return{type:_K,payload:{sourceId:e}}}(e)),t=()=>{this.dragSources.delete(e),this.types.delete(e)},yK.enqueueTask(bK.create(t))}removeTarget(e){qQ(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function(e){return{type:SK,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const t=this.getSource(e);qQ(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}unpinSource(){qQ(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,t,n){const i=TK(e);return this.types.set(i,t),e===EK.SOURCE?this.dragSources.set(i,n):e===EK.TARGET&&this.dropTargets.set(i,n),i}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const MK=(e,t)=>e===t;function AK(e=uK,t){switch(t.type){case KQ:break;case xK:case wK:case SK:case _K:return uK;default:return dK}const{targetIds:n=[],prevTargetIds:i=[]}=t.payload,a=function(e,t){const n=new Map,i=e=>{n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(i),t.forEach(i);const a=[];return n.forEach((e,t)=>{1===e&&a.push(t)}),a}(n,i);if(!(a.length>0||!function(e,t,n=MK){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!n(e[i],t[i]))return!1;return!0}(n,i)))return uK;const o=i[i.length-1],s=n[n.length-1];return o!==s&&(o&&a.push(o),s&&a.push(s)),a}function OK(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const RK={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function DK(e=RK,t){const{payload:n}=t;switch(t.type){case VQ:case WQ:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case KQ:return i=e.clientOffset,a=n.clientOffset,!i&&!a||i&&a&&i.x===a.x&&i.y===a.y?e:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){OK(e,t,n[t])})}return e}({},e,{clientOffset:n.clientOffset});case XQ:case YQ:return RK;default:return e}var i,a}function LK(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FK(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){LK(e,t,n[t])})}return e}const zK={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function UK(e=zK,t){const{payload:n}=t;switch(t.type){case WQ:return FK({},e,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case QQ:return FK({},e,{isSourcePublic:!0});case KQ:return FK({},e,{targetIds:n.targetIds});case SK:return-1===e.targetIds.indexOf(n.targetId)?e:FK({},e,{targetIds:(i=e.targetIds,a=n.targetId,i.filter(e=>e!==a))});case YQ:return FK({},e,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case XQ:return FK({},e,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}var i,a}function HK(e=0,t){switch(t.type){case xK:case wK:return e+1;case _K:case SK:return e-1;default:return e}}function BK(e=0){return e+1}function $K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qK(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){$K(e,t,n[t])})}return e}function GK(e={},t){return{dirtyHandlerIds:AK(e.dirtyHandlerIds,{type:t.type,payload:qK({},t.payload,{prevTargetIds:(n=e,i="dragOperation.targetIds",a=[],i.split(".").reduce((e,t)=>e&&e[t]?e[t]:a||null,n))})}),dragOffset:DK(e.dragOffset,t),refCount:HK(e.refCount,t),dragOperation:UK(e.dragOperation,t),stateId:BK(e.stateId)};var n,i,a}function VK(e,t=void 0,n={},i=!1){const a=function(e){const t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return $Q(GK,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(i),o=new hK(a,new PK(a)),s=new lK(a,o),r=e(s,t,n);return s.receiveBackend(r),s}function WK(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}let QK=0;const KK=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var YK=A.memo(function(e){var{children:t}=e,n=WK(e,["children"]);const[i,a]=function(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}const t=function(e,t=XK(),n,i){const a=t;a[KK]||(a[KK]={dragDropManager:VK(e,t,n,i)});return a[KK]}(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}(n);return A.useEffect(()=>{if(a){const e=XK();return++QK,()=>{0===--QK&&(e[KK]=null)}}},[]),an.jsx(FQ.Provider,{value:i,children:t})});function XK(){return"undefined"!=typeof global?global:window}const JK=H(function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,a,o;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(a=i;0!==a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(o=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=i;0!==a--;)if(!Object.prototype.hasOwnProperty.call(n,o[a]))return!1;for(a=i;0!==a--;){var s=o[a];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}),ZK="undefined"!=typeof window?A.useLayoutEffect:A.useEffect;function eY(e,t,n){const[i,a]=function(e,t,n){const[i,a]=A.useState(()=>t(e)),o=A.useCallback(()=>{const o=t(e);JK(i,o)||(a(o),n&&n())},[i,e,n]);return ZK(o),[i,o]}(e,t,n);return ZK(function(){const t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(a,{handlerIds:[t]})},[e,a]),i}function tY(e,t,n){return eY(t,e||(()=>({})),()=>n.reconnect())}function nY(e,t){const n=[...t||[]];return null==t&&"function"!=typeof e&&n.push(e),A.useMemo(()=>"function"==typeof e?e():e,n)}function iY(e){return A.useMemo(()=>e.hooks.dragSource(),[e])}function aY(e){return A.useMemo(()=>e.hooks.dragPreview(),[e])}let oY=!1,sY=!1;class rY{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){qQ(!oY,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return oY=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{oY=!1}}isDragging(){if(!this.sourceId)return!1;qQ(!sY,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return sY=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{sY=!1}}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,t){return this.internalMonitor.isOverTarget(e,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}function lY(e,t,n){const i=n.getRegistry(),a=i.addTarget(e,t);return[a,()=>i.removeTarget(a)]}function cY(e,t,n,i){let a;if(void 0!==a)return!!a;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;const o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;const r=Object.prototype.hasOwnProperty.bind(t);for(let l=0;l<o.length;l++){const n=o[l];if(!r(n))return!1;const i=e[n],s=t[n];if(a=void 0,!1===a||void 0===a&&i!==s)return!1}return!0}function uY(e){return null!==e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function dY(e){return(t=null,n=null)=>{if(!A.isValidElement(t)){const i=t;return e(i,n),i}const i=t;!function(e){if("string"==typeof e.type)return;const t=e.type.displayName||e.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${t} into a <div>, or turn it into a drag source or a drop target itself.`)}(i);return function(e,t){const n=e.ref;return qQ("string"!=typeof n,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?A.cloneElement(e,{ref:e=>{pY(n,e),pY(t,e)}}):A.cloneElement(e,{ref:t})}(i,n?t=>e(t,n):e)}}function hY(e){const t={};return Object.keys(e).forEach(n=>{const i=e[n];if(n.endsWith("Ref"))t[n]=e[n];else{const e=dY(i);t[n]=()=>e}}),t}function pY(e,t){"function"==typeof e?e(t):e.current=t}class mY{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId?e?(t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),t):(this.lastConnectedDragSource=e,t):t}reconnectDragPreview(e=!1){const t=this.dragPreview,n=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();n&&this.disconnectDragPreview(),this.handlerId&&(t?n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions)):this.lastConnectedDragPreview=t)}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!cY(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!cY(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=hY({dragSource:(e,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,uY(e)?this.dragSourceRef=e:this.dragSourceNode=e,this.reconnectDragSource()},dragPreview:(e,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,uY(e)?this.dragPreviewRef=e:this.dragPreviewNode=e,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}function fY(){const{dragDropManager:e}=A.useContext(FQ);return qQ(null!=e,"Expected drag drop context"),e}class gY{beginDrag(){const e=this.spec,t=this.monitor;let n=null;return n="object"==typeof e.item?e.item:"function"==typeof e.item?e.item(t):{},null!=n?n:null}canDrag(){const e=this.spec,t=this.monitor;return"boolean"==typeof e.canDrag?e.canDrag:"function"!=typeof e.canDrag||e.canDrag(t)}isDragging(e,t){const n=this.spec,i=this.monitor,{isDragging:a}=n;return a?a(i):t===e.getSourceId()}endDrag(){const e=this.spec,t=this.monitor,n=this.connector,{end:i}=e;i&&i(t.getItem(),t),n.reconnect()}constructor(e,t,n){this.spec=e,this.monitor=t,this.connector=n}}function vY(e,t,n){const i=fY(),a=function(e,t,n){const i=A.useMemo(()=>new gY(e,t,n),[t,n]);return A.useEffect(()=>{i.spec=e},[e]),i}(e,t,n),o=function(e){return A.useMemo(()=>{const t=e.type;return qQ(null!=t,"spec.type must be defined"),t},[e])}(e);ZK(function(){if(null!=o){const[e,s]=function(e,t,n){const i=n.getRegistry(),a=i.addSource(e,t);return[a,()=>i.removeSource(a)]}(o,a,i);return t.receiveHandlerId(e),n.receiveHandlerId(e),s}},[i,t,n,a,o])}function yY(e,t){const n=nY(e,t);qQ(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const i=function(){const e=fY();return A.useMemo(()=>new rY(e),[e])}(),a=function(e,t){const n=fY(),i=A.useMemo(()=>new mY(n.getBackend()),[n]);return ZK(()=>(i.dragSourceOptions=e||null,i.reconnect(),()=>i.disconnectDragSource()),[i,e]),ZK(()=>(i.dragPreviewOptions=t||null,i.reconnect(),()=>i.disconnectDragPreview()),[i,t]),i}(n.options,n.previewOptions);return vY(n,i,a),[tY(n.collect,i,a),iY(a),aY(a)]}(new Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=";const bY=A.memo(e=>{const{id:t,pinned:n,title:i,folders:a,className:o,selected:s=!1,isActive:r=!1,onEditChatChange:l=()=>{},onChange:c=()=>{},onSelect:u=()=>{},onUnSelect:d=()=>{},isProjectDetailChat:h=!1,projectDetailChat:p=null,projectChatPined:m,time:f,projectChat:g=!1,projectId:v}=e,y=$(),b=Ty(),[x,w]=A.useState(!1),[_,S]=A.useState(!1),[C,E]=A.useState(!1),[k,I]=A.useState(!1),[T,N]=A.useState(i||""),[P,M]=A.useState(""),[O,R]=A.useState([]),D=A.useRef(null),L=A.useRef(0),F=A.useRef(0),z=A.useRef(null),U=DT(e=>e.setActiveChatDetails),H=zE(e=>e.activeChatMenuId),B=zE(e=>e.setActiveChatMenuId),q=DT(e=>e.setActiveProjectId),G=Ex(e=>e.mobile),V=vx(e=>e.chatId),W=vx(e=>e.setChatTitle),Q=bx(e=>e.chats),K=bx(e=>e.pinnedChats),Y=bx(e=>e.setPinnedChats),X=zE(e=>e.setShowSidebar),J=Sx(e=>e.setTaskRunning),Z=Sx(e=>e.setTemporaryChatEnabled),ee=Sx(e=>e.temporaryChatEnabled);Sx(e=>e.setCurrentShowControl);const[te,ne]=A.useState(!1),[{isDragging:ie},ae]=yY(()=>({type:"chat",item:{id:t,type:"chat"},collect:e=>({isDragging:!!e.isDragging()})})),oe=A.useMemo(()=>G?H===t:h?H===`${t}_project_detail_chat`:H===t,[H,h,t,G]),se=A.useCallback((t,n)=>j(void 0,null,function*(){if(0!==n.trim().length)if(""===n)ht.open({type:"error",content:y.t("Title cannot be an empty string.")});else{if(!(yield D_({chat_id:t,chat:{title:n}}).catch(e=>{ht.open({type:"error",content:y.t(e.message)})})).success)return void N(e.title||"");t===V&&W(n),c()}else N(e.title||"")}),[V,y,c,e.title,W]),re=A.useCallback(e=>j(void 0,null,function*(){const t=yield W_(e).catch(e=>(ht.open({type:"error",content:y.t(e.message)}),null));if(null==t?void 0:t.success){kT.shareHistory=null,b(`/c/${t.data.id}`),yield AC();const e=yield A_();Array.isArray(e.data)&&Y(e.data),OC()}else ht.open({type:"error",content:y.t(null==t?void 0:t.data.message)})}),[y,Y]),le=A.useCallback(()=>j(void 0,null,function*(){G&&X(!1),kT.openNewChat()}),[G,X]),ce=A.useCallback(e=>{let t=[];if(e)for(const n in e)e[n].items&&Array.isArray(e[n].items.chats)&&(t=t.concat(e[n].items.chats));return t},[]),ue=A.useCallback(e=>j(void 0,null,function*(){var t,n,i;E(!1),e===V&&J(!1);const o=yield G_(e).catch(e=>(ht.open({type:"error",content:y.t(e.message)}),null)),s=1===(null==(t=null==Q?void 0:Q.filter(e=>e.id===V))?void 0:t.length),r=1===(null==(n=null==K?void 0:K.filter(e=>e.id===V))?void 0:n.length),l=ce(a),u=1===(null==(i=null==l?void 0:l.filter(e=>e.id===V))?void 0:i.length);o&&(V!==e&&(s||u||r)||h||(V===e&&v?b(`/p/${v}`,{replace:!0}):yield le()),c())}),[V,Q,a,ce,le,y,h,b,c,K,v,J]),de=A.useCallback(e=>j(void 0,null,function*(){(yield q_(e).catch(e=>{ht.open({type:"error",content:y.t(e.message)})}))&&(V===e&&(J(!1),v?b(`/p/${v}`,{replace:!0}):yield le()),c())}),[V,le,y,b,c,v,J]),he=A.useCallback((e,t)=>e.length>t?e.slice(0,t-3)+"...":e,[]),pe=A.useCallback(()=>{t!==V&&(J(!1),u(),kT.closeShowControls(),G&&(X(!1),B(null)),ET.reset(["inputValue","files"]),kT.shareHistory=null,h&&U(p),d(),b(`/c/${t}`))},[t,V,J,u,G,h,d,b,X,B,U,p]),me=A.useCallback(e=>{if(!G)return;e.stopPropagation(),e.preventDefault();const n=e.touches[0];L.current=n.clientX,F.current=n.clientY,clearTimeout(z.current),z.current=setTimeout(()=>{B(oe?null:t),q(null)},500)},[t,G,B,q,oe]),fe=A.useCallback(()=>{G&&clearTimeout(z.current)},[G]),ge=A.useCallback(()=>{ht.openOnce({type:"caution",content:an.jsxs("div",{className:"temporary-chat-close-toast-content",children:[y.t("You are now in temporary chat"),an.jsx("span",{onClick:()=>{Z(!1),pe()},children:y.t("Exit")})]}),className:"temporary-chat-close-toast"})},[pe,y,Z]),ve=A.useCallback(()=>j(void 0,null,function*(){var e;B(null),M(i||""),S(!0),null==(e=D.current)||e.focus()}),[B,i]),ye=A.useCallback(e=>j(void 0,null,function*(){const t=yield(n=e,j(void 0,null,function*(){return yield ow("/share/artifacts/query",{method:"POST",data:{chat_id:n}})}));var n;I(!1),R(t.data.share_list.map(e=>e.share_url))}),[O]),be=A.useMemo(()=>ee&&G?an.jsx("div",{className:"chat-item-drag-main",onClick:ge}):null,[G,ge,ee]),xe=A.useMemo(()=>G||_&&r?null:an.jsx(vt,{title:y.t("More"),placement:"top",arrow:!1,children:an.jsx("button",{"aria-label":"Chat Menu",className:"chat-item-drag-web-default-btn",onClick:()=>{B(h?`${t}_project_detail_chat`:t),u()},children:an.jsx(pt,{type:"icon-line-more-01",className:"chat-item-drag-web-default-btn-icon"})})}),[G,_,r,y,B,h,t,u]),we=A.useMemo(()=>an.jsx(_N,{show:oe,chatId:t,projectChat:g,projectId:v,cloneChatHandler:()=>{B(null),re(t),dS("clkCloneChat",{params:{et:"CLK"},aesParams:{c4:t},paramsExtend:{chat_id:t}})},shareHandler:()=>{B(null),w(!0)},archiveChatHandler:()=>{de(t)},renameHandler:ve,deleteHandler:()=>{B(null),E(!0)},onClose:()=>{B(null),d()},onChange:c,children:null,projectChatPined:m,tagsDropdownOffsetAuto:h}),[h,oe,t,g,v,ve,c,m,B,re,de,d]),_e=A.useMemo(()=>!n||te||t===V||s?null:an.jsx(pt,{type:"icon-line-pin-01",className:"chat-item-title-pined-icon"}),[n,V,t,te,s]),Se=A.useMemo(()=>ee?null:an.jsxs("div",{className:"chat-item-drag-web "+(t===V||oe||h?"chat-item-drag-web-active":""),children:[xe,we]}),[ee,t,V,oe,h,xe,we]),Ce=A.useMemo(()=>an.jsx(gN,{show:x,chatId:t,onClose:()=>w(!1)}),[t,x]),Ee=A.useMemo(()=>h?an.jsx("div",{className:"project-chat-item",onClick:pe,onDoubleClick:()=>{G||(M(i||""),null==l||l(t),S(!0))},onTouchStart:me,onTouchEnd:fe,onTouchCancel:fe,children:an.jsxs("div",{className:"project-chat-item-content",children:[an.jsxs("div",{className:"project-chat-item-content-top",children:[an.jsx("div",{className:"project-chat-item-title",children:i}),m&&an.jsx(pt,{type:"icon-line-pin-01",className:"project-chat-item-title-pined-icon"})]}),an.jsx("div",{className:"project-chat-item-time",children:f})]})}):an.jsx("a",{"aria-label":"chat-item",className:`chat-item-drag-link  ${t===V&&location.pathname.includes("/c/")?"chat-item-drag-active":s&&location.pathname.includes("/c/")||ee&&G?"chat-item-drag-selected "+(G?ee?"chat-item-mobile-temporary":"chat-item-mobile-not-temporary":""):""} ${ee?"chat-item-temporary":""}\n          `,onClick:pe,onDoubleClick:()=>{G||(M(i||""),null==l||l(t),S(!0))},onTouchStart:me,onTouchEnd:fe,onTouchCancel:fe,children:an.jsxs("div",{className:"chat-item-drag-link-content",children:[an.jsx(vt,{open:!ee&&!G&&void 0,title:T,placement:"bottom",className:"chat-item-drag-link-content-tip",children:an.jsx("div",{className:"chat-item-drag-link-content-tip-text",style:oe?{paddingRight:"16px"}:{},children:he(T||"",100)})}),_e]})}),[h,t,V,s,ee,G,pe,me,fe,me,_e,t,G,l,s,ee,T,he,i,m,f,l]),ke=A.useMemo(()=>an.jsxs(mt,{visible:C,title:y.t("Delete chat"),className:"chat-item-delete-confirm",closable:!1,headerBorderNone:!0,maskClosable:!0,onCancel:()=>E(!1),size:"small",actions:[{text:y.t("Cancel"),type:"tertiary",size:"large",rounded:"circle",onClick:()=>{E(!1)}},{text:y.t("Delete"),type:"dangerprimary",size:"large",rounded:"circle",onClick:()=>{ue(t)}}],children:[!(k||!O.length)&&an.jsxs(an.Fragment,{children:[y.t("The chat contains the following deployed content. Once the chat is deleted, the associated links will no longer be accessible. Please confirm to proceed."),an.jsx("div",{className:"deploy-url-container",children:O.map(e=>an.jsx("div",{className:"deploy-url-item",children:e},e))})]}),!k&&y.t("This action will permanently delete all the chats you've created and cannot be undone. Please confirm to proceed.")]}),[ue,k,O,y,t,C]),Ie=A.useMemo(()=>an.jsx(mt,{visible:_,className:"qwen-chat-comp-item-rename-modal",title:y.t("Rename Chat"),headerBorderNone:!0,closable:!G,size:"small",cancelText:y.t("Cancel"),onCancel:()=>{S(!1),M("")},okText:y.t("Confirm"),actions:[{text:y.t("Cancel"),type:"tertiary",rounded:"circle",onClick:()=>{S(!1),M("")}},{text:y.t("Confirm"),rounded:"circle",disabled:!P.trim(),onClick:()=>j(void 0,null,function*(){yield se(t,P),c(),S(!1)})}],children:an.jsx("div",{className:"rename-confirm",children:an.jsx("div",{className:"rename-confirm-content",children:an.jsx(SN,{showMaxLength:!1,value:P,onChange:M,maxLength:100,maxRows:4,placeholder:y.t("Enter your message"),autoFocus:!0})})})}),[se,y,t,G,c,P,_]);return A.useEffect(()=>{C&&ye(t)},[C]),an.jsxs(an.Fragment,{children:[Ce,ke,Ie,an.jsxs("div",{ref:G||h?null:ae,draggable:!G&&!h,className:`chat-item-drag ${o}`,style:{opacity:ie?.5:1},onMouseEnter:()=>ne(!0),onMouseLeave:()=>ne(!1),children:[be,Ee,Se]})]})});function xY(){}class wY{profile(){return{}}setup(){this.didCallSetup=!0}teardown(){this.didCallTeardown=!0}connectDragSource(){return xY}connectDragPreview(){return xY}connectDropTarget(){return xY}simulateBeginDrag(e,t){this.actions.beginDrag(e,t)}simulatePublishDragSource(){this.actions.publishDragSource()}simulateHover(e,t){this.actions.hover(e,t)}simulateDrop(){this.actions.drop()}simulateEndDrag(){this.actions.endDrag()}constructor(e,t){this.didCallSetup=!1,this.didCallTeardown=!1,this.manager=e,this.context=t,this.actions=e.getActions()}}const _Y=function(e,t={},n={}){const i=new wY(e,t);return(null==n?void 0:n.onCreate)&&n.onCreate(i),i},SY=({projectId:e,projectChats:t=[]})=>{const n=$(),i=DT(e=>e.setProjectChats),{getProjectChatList:a}=vN(),[o,s]=A.useState(null),{getPinnedChatListData:r}=yN(),l=bx(e=>e.setPinnedChats),c=()=>j(void 0,null,function*(){const t=yield a(e);Array.isArray(t)&&i(t),OC();const n=yield r();Array.isArray(n)&&l(n)});return an.jsx("div",{className:"project-chats",children:an.jsxs(YK,{backend:_Y,children:[(null==t?void 0:t.length)>0,an.jsx("div",{className:"project-chats-title",children:n.t("Chats")}),t.map(e=>an.jsx(bY,{id:e.id,projectId:e.project_id,time:n.t(WT(1e3*e.created_at)),title:e.title,selected:!0,onSelect:()=>{},onUnSelect:()=>{},onChange:c,isActive:o===e.id,onEditChatChange:()=>s(e.id),className:"project-chat-list",projectChatPined:e.pinned,isProjectDetailChat:!0,projectDetailChat:e,projectChat:!0},e.id+"project_detail_chat"))]})})},CY=({projectId:e=""})=>{const t=Ty(),n=DT(e=>e.projectInfo),i=DT(e=>e.setChatProjectId),a=DT(e=>e.setProjectInfo),o=DT(e=>e.setProjectChats),s=DT(e=>e.setShowEditModal),r=DT(e=>e.setOperationProjectFiles),l=DT(e=>e.projectChats),c=DT(e=>e.setProjectName),u=Ex(e=>e.mobile),[d,h]=A.useState(!1),{getProjectChatList:p,getNewProjectList:m}=vN(),[f,g]=A.useState(1),[v,y]=A.useState(!1),b=A.useRef(null),x=A.useCallback(n=>j(void 0,null,function*(){if(localStorage.getItem("token"))try{const i=yield IS(e);if(!i.success&&"Not_Found"===i.data.code)return m(),s(!1),void t("/");const o=i.data.files.map(e=>_(w({},e),{uploadStatus:"success"}));a(_(w({},n),{fileLength:o.length})),r(o),h(!1)}catch(i){}}),[e,a,r,m,s,t]),S=A.useCallback(()=>j(void 0,null,function*(){if(localStorage.getItem("token"))try{const t=yield NS(e);x(t.data)}catch(t){}}),[e,x]),C=t=>j(void 0,null,function*(){const n=yield p(e,t);0===n.length&&y(!0),1===t?Array.isArray(n)&&o(n):Array.isArray(n)&&o([...l,...n])});A.useEffect(()=>{e&&(h(!0),S(),C(1),i(null),c(""),g(1),y(!1))},[e]);const E=Ft(e=>{const t=e.target,{scrollTop:n,scrollHeight:i,clientHeight:a}=t;i-n-a<=50&&(g(f+1),C(f+1))},200),k=A.useMemo(()=>an.jsx(LQ,{projectTitle:n.name,projectIns:n.custom_instruction}),[n.custom_instruction,n.name]),I=A.useMemo(()=>d&&u?an.jsxs("div",{className:"project-content-chats-skeleton",children:[an.jsx(Ct,{className:"project-content-chats-skeleton-item",style:{width:"100%",height:"60px"}}),an.jsx(Ct,{className:"project-content-chats-skeleton-item",style:{width:"100%",height:"60px"}}),an.jsx(Ct,{className:"project-content-chats-skeleton-item",style:{width:"70%",height:"60px"}})]}):an.jsx(SY,{projectChats:l,projectId:e}),[d,u,l,e]);return d&&!u?an.jsx(Yk,{fixed:!1,absolute:!0}):an.jsxs("div",{className:"qwen-project-content "+(l.length>0?"":"qwen-project-content-center"),children:[an.jsxs("div",{className:"qwen-project-content-top "+(l.length>0&&!u?"project-content-top-sticky":""),style:l.length<1&&!u?{transform:"translateY(-10px)"}:{},children:[k,u&&l.length>0&&an.jsx("div",{ref:b,onScroll:e=>{v||E(e)},className:"project-content-chats",children:I}),an.jsx(iq,{projectId:e,permissions:{recommendWordsVisible:!u,functionButtonsVisible:u,recommendDetailHide:!0}})]}),!u&&l.length>0&&an.jsx("div",{ref:b,onScroll:e=>{v||E(e)},className:"project-content-chats",children:I})]})},EY=({projectId:e})=>{const t=Sx(e=>e.setTaskRunning),n=Sx(e=>e.setVisionGenerating),i=TT(e=>e.setShowDetail);return A.useEffect(()=>{t(!1),n(!1),i(!1),kT.createChat(),kT.initSelectedModels(),kT.resetChatState(),kT.closeShowControls()},[]),an.jsx("div",{className:"project-layout",children:an.jsx(CY,{projectId:e})})},kY=[ag.Artifacts,ag.PdfViewer,ag.DeepResearchDetail,ag.WebDev],IY=[ag.WebSearch,ag.DeepResearch],TY=()=>{const e=zE(e=>e.isSmallScreen),{pathname:t}=ky(),{id:n}=Ny(),i=A.useMemo(()=>t.includes("/p/"),[t]),a=Sx(e=>e.currentShowControl),o=Ex(e=>e.mobile),s=Sx(e=>e.temporaryChatEnabled),{messageId:r}=vx(e=>e.currentCitationInfo),l=vx(e=>e.allSearchAndThinkLists),c=A.useMemo(()=>i?n:"",[i,n]),u=A.useMemo(()=>{var e;if(o)return ag.None;if(a===ag.ThinkingAndSources)return a;const t=null==(e=l[r])?void 0:e.type;return[ag.ThinkingAndSearch].includes(t)?ag.WebSearch:a},[l,a,r,o]),d=A.useMemo(()=>u===ag.None,[u]);return A.useMemo(()=>d?{display:"none"}:u===ag.Artifacts||u===ag.PdfViewer||u===ag.DeepResearchDetail||u===ag.WebDev?{display:"block"}:{flex:"none",display:"block"},[d,u]),an.jsx("div",{className:"chat-page-container "+(s&&!o?"chat-page-container-temporary":""),children:an.jsx("div",{className:"layout-main",children:an.jsx(AQ,{leftPanel:an.jsxs("div",{className:"layout-main-chat-panel",children:[an.jsx(WN,{}),i?an.jsx(EY,{projectId:c||""}):an.jsxs(an.Fragment,{children:[an.jsx("main",{className:"main-content "+(e?"small-layout-main-content":""),children:an.jsx(MQ,{})}),an.jsx(tq,{})]})]}),rightPanel:an.jsx(TQ,{showControlsType:u}),open:u!==ag.None&&!i,draggable:kY.includes(u),miniSplitScreen:IY.includes(u),chatId:n})})})},jY=()=>{const{id:e}=Ny();return an.jsx(PQ,{chatId:e||""})};function NY(){return Fx()?an.jsx(TY,{}):an.jsx(jY,{})}const PY=({title:e,operation:t})=>an.jsxs("div",{className:"setting-content-title",children:[an.jsx("div",{className:"setting-content-title-title",children:e}),t&&an.jsx("div",{className:"setting-content-title-operation",children:t})]}),MY=({className:e})=>an.jsx("div",{className:Y(`voice-player-loading ${e}`)}),AY=({voiceUrl:e,voiceName:t,loading:n,error:i})=>{const{i18n:a}=$(),o=A.useRef(null),[s,r]=A.useState(!1),[l,c]=A.useState(0),[u,d]=A.useState(0),h=e=>{const t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`};return A.useEffect(()=>{e&&(r(!1),c(0),o.current&&(o.current.pause(),o.current.currentTime=0))},[e]),an.jsx("div",{className:"voice-player-wrapper",children:an.jsxs("div",{className:"recorder-wrapper",children:[an.jsxs("div",{className:"left-container",children:[an.jsx("div",{className:"record-title",children:n?an.jsx(MY,{className:"voice-player-title-loading"}):t||a.t("Audio")}),an.jsxs("div",{className:"record-time",children:[i&&!n&&an.jsxs("div",{className:"record-time-left record-error",children:[an.jsx(pt,{type:"icon-line-alert-circle"})," ",a.t(i)]}),!i&&!n&&an.jsxs(an.Fragment,{children:[an.jsx("div",{className:"record-time-left",children:h(l)}),an.jsxs("div",{className:"record-time-right",children:[" / ",h(u)]})]}),n&&an.jsx(MY,{className:"voice-player-item-loading"})]})]}),an.jsx("div",{className:"right-container",children:!i&&!n&&an.jsx(vt,{title:s?a.t("Pause"):a.t("Play"),children:an.jsx(ft,{type:"brandprimary",rounded:"circle",onClick:()=>{o.current&&e&&(s?o.current.pause():o.current.play(),r(!s))},buttonClass:"circle-button pause-button",disabled:!e,children:s?an.jsx(pt,{type:"icon-line-waveform",className:"circle-icon"}):an.jsx(pt,{type:"icon-fill-play-03",className:"circle-icon",style:{marginLeft:2}})})})}),e&&an.jsx("audio",{ref:o,src:e,onLoadedMetadata:()=>{o.current&&d(o.current.duration)},onTimeUpdate:()=>{o.current&&c(o.current.currentTime)},onEnded:()=>{r(!1),c(0)},onError:()=>{}})]})})},OY=()=>{const{i18n:e}=$(),t=Ty(),n=Ex(e=>e.mobile),i=NT(e=>e.settings.ui.voiceLanguage),[a,o]=z.useState(300),[s,r]=z.useState(10),[l,c]=z.useState(20),[u,d]=z.useState(300),[h,p]=z.useState(""),[m,f]=z.useState(""),[g,v]=z.useState(""),[y,b]=z.useState({}),[x,w]=z.useState([]),[_,S]=z.useState([]),[C,E]=z.useState(""),[k,I]=z.useState(""),[T,N]=z.useState(!1),[P,M]=z.useState(!1),[O,R]=z.useState(!1),[D,L]=z.useState(!1),[F,U]=z.useState(!1),[H,B]=z.useState(""),[q,G]=z.useState(""),[V,W]=z.useState("https://download.qwen.ai/resources/tts/tibmres3/Cherry_zh.mp3"),[Q,K]=z.useState(""),[Y,X]=z.useState(1),[J,Z]=z.useState(!1),[ee,te]=A.useState(!1),ne=A.useRef(null),[ie,ae]=A.useState(!1),oe=e.language,se=i||e.language,re=(e,t=5)=>{const n=[...e];for(let a=n.length-1;a>0;a--){const e=Math.floor(Math.random()*(a+1));[n[a],n[e]]=[n[e],n[a]]}const i=n.slice(0,t);S(i),Z(!1)},le=()=>j(void 0,null,function*(){var e,t;const n=yield j(void 0,null,function*(){return yield ow("/configs/?code=voiceDesignStyles",{method:"GET"})});n.success&&(r(n.data.promptMin),o(n.data.promptMax),c(n.data.textPreviewMin),d(n.data.textPreviewMax),b(n.data.language),E(null==(e=n.data.language[oe])?void 0:e.promptPlaceholder),I(null==(t=n.data.language[oe])?void 0:t.previewTextPlaceholder),w(n.data.voiceStyles),re(n.data.voiceStyles))});A.useEffect(()=>{le()},[]);const ce=()=>j(void 0,null,function*(){if(N(!1),M(!1),v(""),!h||h.length<s)return void(h.length<s&&N(!0));R(!0),v("");const t=yield(n={prompt:h,spoken_language:se||"en-US",language:e.language},j(void 0,null,function*(){return yield ow("/tts/design/prompt",{method:"POST",headers:{"Accept-Language":`${n.language},${n.language.split("-")[0]};q=0.9`},data:n})}));var n;t.success?(R(!1),f(t.data.text)):(R(!1),v(t.data.message),N(!0),ht.openOnce({type:"error",content:e.t("Preview text generation failed. Please try again later.")}))}),ue=()=>j(void 0,null,function*(){if(N(!1),M(!1),v(""),!h||!m||h.length<s||m.length<l)return h.length<s&&N(!0),void(m.length<l&&M(!0));L(!0),B("");const t=yield(n={text:m,prompt:h,spoken_language:se||"en-US",language:e.language},j(void 0,null,function*(){return yield ow("/tts/design/voice",{method:"POST",headers:{"Accept-Language":`${n.language},${n.language.split("-")[0]};q=0.9`},data:n})}));var n;t.success?(K(t.data.voice_id),W(t.data.voice_url),G(t.data.voice_name),L(!1),location.pathname.includes("/voice/design")&&ht.openOnce({type:"success",content:e.t("Voice created successfully.")})):(L(!1),B(t.data.message),"RateLimited"===t.data.code&&te(!0),t.data.message?ht.openOnce({type:"error",content:e.t(t.data.message)}):ht.openOnce({type:"error",content:e.t("Failed to generate voice. Please try again.")}))}),de=()=>j(void 0,null,function*(){U(!0);const n=yield(i={voice_id:Q},j(void 0,null,function*(){return yield ow("/tts/design/save",{method:"POST",data:i})}));var i;n.success?n.data.status?(U(!1),ae(!0),ht.openOnce({type:"success",content:e.t("Voice saved successfully.")}),t(-1),setTimeout(()=>{t(-1)},0)):(U(!1),X(0),ht.openOnce({type:"error",content:e.t("Failed to save voice.")})):(U(!1),ht.openOnce({type:"error",content:e.t("Failed to save voice.")}))}),he=A.useCallback(()=>an.jsxs("div",{className:"voice-design-rercord-item-shuffle",children:[an.jsx(ft,{type:"ghost",rounded:"circle",size:"small",iconFontType:n?"":"icon-line-Shuffle",onClick:()=>re(x),children:n?an.jsx(pt,{type:"icon-line-Shuffle"}):e.t("Shuffle")}),an.jsx("div",{className:"voice-design-rercord-item-shuffle-list",children:an.jsx("div",{className:"voice-design-rercord-item-shuffle-list-item",ref:ne,children:_.map(e=>an.jsx(ft,{type:"ghost",rounded:"circle",size:"small",className:h===y[oe][e.prompt]&&J?"active":"",onClick:()=>{p(y[oe][e.prompt]),f(y[se][e.previewText]),Z(!0),v(""),N(!1),M(!1)},children:y[oe][e.name]},e.name))})})]}),[x,e,y,n,h,_,se]),[pe,me]=A.useState(!1),fe=A.useRef(!0);A.useEffect(()=>{const e=window.history.state;(null==e?void 0:e.isBlockerEntry)||window.history.pushState({isBlockerEntry:!0},"",window.location.href);const n=e=>{fe.current&&(h||m)&&!ie?(window.history.pushState({isBlockerEntry:!0},"",window.location.href),me(!0)):t(-1)};return window.addEventListener("popstate",n),()=>window.removeEventListener("popstate",n)},[t,ie,m,h]);const ge=A.useCallback(()=>{me(!1),fe.current=!1,setTimeout(()=>{t(-1)},10)},[t]),ve=A.useCallback(()=>{me(!1)},[]);A.useEffect(()=>{const e=e=>{if(h||m)return e.preventDefault(),e.returnValue="",""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[h,m]);const ye=[{text:e.t("Cancel"),type:"tertiary",rounded:"circle",onClick:()=>{ve()}},{text:e.t("Discard"),type:"dangerprimary",rounded:"circle",onClick:()=>{ge()}}];return an.jsxs(an.Fragment,{children:[se&&an.jsxs("div",{className:"voice-design-rercord",children:[an.jsxs("div",{className:"voice-design-rercord-item",children:[an.jsx("div",{className:"voice-design-rercord-item-title",children:e.t("Prompt")}),an.jsxs("div",{className:"voice-design-rercord-item-content",children:[an.jsx(St,{rows:3,maxRows:3,minRows:3,maxLength:a,minLength:s,value:h,onChange:e=>{v(""),N(!1),M(!1),p(e)},placeholder:C,footerOperations:!!_.length&&n&&!!Object.keys(y).length&&an.jsx(he,{}),error:!n&&T?0===h.length?g?e.t(g):e.t("Invalid input: The prompt should not be empty."):g?e.t(g):e.t("Prompt must be at least {{num}} characters.",{num:s}):void 0}),!!_.length&&!n&&!!Object.keys(y).length&&an.jsx(he,{})]}),n&&an.jsx("div",{className:"qwen-textarea-error",children:T?0===h.length?g?e.t(g):e.t("Invalid input: The prompt should not be empty."):g?e.t(g):e.t("Prompt must be at least {{num}} characters.",{num:s}):void 0})]}),an.jsxs("div",{className:"voice-design-rercord-item",children:[an.jsxs("div",{className:"voice-design-rercord-item-title",children:[e.t("Preview Text"),n&&an.jsx(ft,{className:"voice-design-rercord-btn",iconFontType:O?"":"icon-line-star-01",rounded:"circle",type:"ghost",size:"small",onClick:ce,loading:O,children:O?e.t("Generating..."):e.t("Generate Text")})]}),an.jsx(St,{rows:3,maxRows:3,minRows:3,maxLength:u,minLength:l,value:m,onChange:e=>{v(""),N(!1),M(!1),f(e)},placeholder:k,operations:!n&&an.jsx(ft,{className:"voice-design-rercord-btn",iconFontType:O?"":"icon-line-star-01",rounded:"circle",type:"ghost",size:"small",onClick:ce,loading:O,disabled:D,children:O?e.t("Generating..."):e.t("Generate Text")})}),P&&m.length<l&&an.jsx("div",{className:"qwen-textarea-error",children:e.t("Prompt must be at least {{num}} characters.",{num:l})})]}),an.jsx("div",{className:"voice-design-rercord-button",children:an.jsx(ft,{className:"voice-design-rercord-button-btn",rounded:"circle",type:Q||H?"brandghost":"brandprimary",size:"large",iconFontType:D?"":"icon-a-lianji8",onClick:ue,loading:D,disabled:D||ee,children:Q||H?e.t("Regenerate"):e.t("Generate")})}),(Q||D||H)&&an.jsxs(an.Fragment,{children:[an.jsxs("div",{className:"voice-design-rercord-item",children:[an.jsx("div",{className:"voice-design-rercord-item-title",children:e.t("Voice Preview")}),an.jsx(AY,{voiceUrl:V,loading:D,error:H,voiceName:q})]}),an.jsx("div",{className:"voice-design-rercord-button",children:an.jsx(ft,{className:"voice-design-rercord-button-btn",rounded:"circle",type:"brandprimary",size:"large",onClick:de,loading:F,disabled:!(Q&&!D&&!H&&Y),children:e.t("Save Voice")})})]})]}),an.jsxs("div",{className:"voice-design-rercord-buttons",children:[(!Q&&!H||D)&&an.jsx(ft,{className:"voice-design-rercord-button-btn",rounded:"circle",type:"brandprimary",size:"large",iconFontType:D?"":"icon-a-lianji8",onClick:ue,loading:D,disabled:D||ee,children:Q?e.t("Regenerate"):e.t("Generate")}),(Q||H)&&!D&&an.jsxs(an.Fragment,{children:[an.jsx(ft,{className:"voice-design-rercord-button-btn",rounded:"circle",type:Q||H||D?"ghost":"brandprimary",size:"large",onClick:ue,loading:D,disabled:!h||!m||D||ee,children:e.t("Regenerate")}),an.jsx(ft,{className:"voice-design-rercord-button-btn",rounded:"circle",type:"brandprimary",size:"large",onClick:de,loading:F,disabled:!(Q&&!D&&!H&&Y),children:e.t("Save Voice")})]})]}),an.jsx(mt,{title:e.t("Discard changes?"),size:"small",visible:pe,className:"block-message-modal",actions:ye,headerBorderNone:!0,onCancel:ve,children:an.jsx("p",{children:e.t("If you leave now, your changes will be lost.")})})]})},RY=()=>{const{i18n:e}=$(),t=Ex(e=>e.mobile);return an.jsx(an.Fragment,{children:an.jsxs("div",{className:"voice-design-content",children:[!t&&an.jsx(PY,{title:e.t("Design voice")}),an.jsx(OY,{})]})})},DY=A.lazy(()=>Se(()=>import("./index47.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),LY=A.lazy(()=>Se(()=>import("./index31.js"),__vite__mapDeps([24,1,5,25,26,4,27,28,12,13,29,30,20,10,11,21,22,19,31]))),FY=A.lazy(()=>Se(()=>import("./index43.js"),__vite__mapDeps([32,1,4,5,33,34,35,36,3,6,12,13,37,25,26,27,28,38,20,10,11,21,22,19,39]))),zY=A.lazy(()=>Se(()=>import("./index25.js"),__vite__mapDeps([40,1,41,4,5,3,6,37,25,26,27,28,38,20,10,11,21,22,19,42]))),UY=A.lazy(()=>Se(()=>import("./index26.js"),__vite__mapDeps([43,1,3,4,5,6,37,25,26,27,28,38,20,10,11,21,22,19,44]))),HY=A.lazy(()=>Se(()=>import("./index.js"),__vite__mapDeps([45,1,5,20,10,4,11,21,22,19]))),BY=A.lazy(()=>Se(()=>import("./index2.js"),__vite__mapDeps([46,33,1,34,5,20,10,4,11,21,22,19]))),$Y=A.lazy(()=>Se(()=>import("./index4.js"),__vite__mapDeps([47,35,1,36,5,20,10,4,11,21,22,19]))),qY=A.lazy(()=>Se(()=>import("./index27.js"),__vite__mapDeps([48,1,5,20,10,4,11,21,22,19,49]))),GY=A.lazy(()=>Se(()=>import("./index28.js"),__vite__mapDeps([50,1,4,5,20,10,11,21,22,19,51]))),VY=A.lazy(()=>Se(()=>import("./index6.js"),__vite__mapDeps([52,53,1,4,5,54,20,10,11,21,22,19]))),WY=A.lazy(()=>Se(()=>import("./index29.js"),__vite__mapDeps([55,4,1,5,20,10,11,21,22,19,56]))),QY=A.lazy(()=>Se(()=>import("./index38.js"),__vite__mapDeps([57,1,4,5,14,9,15,20,10,11,21,22,19,58]))),KY=A.lazy(()=>Se(()=>import("./index33.js"),__vite__mapDeps([59,1,60,4,5,16,17,61,20,10,11,21,22,19,62])).then(e=>({default:e.General}))),YY=A.lazy(()=>Se(()=>import("./index46.js"),__vite__mapDeps([63,4,1,5,10,64,65,20,11,21,22,19,66])).then(e=>({default:e.Mcp}))),XY=A.lazy(()=>Se(()=>import("./index11.js"),__vite__mapDeps([67,1,16,17,4,5,20,10,11,21,22,19,68])).then(e=>({default:e.Interface}))),JY=A.lazy(()=>Se(()=>import("./index13.js"),__vite__mapDeps([69,1,16,17,4,5,70,71,11,20,10,21,22,19,72])).then(e=>({default:e.Chats}))),ZY=A.lazy(()=>Se(()=>import("./index15.js"),__vite__mapDeps([73,1,4,5,60,18,20,10,11,21,22,19,74]))),eX=A.lazy(()=>Se(()=>import("./index36.js"),__vite__mapDeps([75,1,26,4,5,27,20,10,11,21,22,19,76]))),tX=A.lazy(()=>Se(()=>import("./index42.js"),__vite__mapDeps([77,1,4,5,20,10,11,21,22,19,78]))),nX=A.lazy(()=>Se(()=>import("./index34.js"),__vite__mapDeps([79,4,1,5,80,60,70,71,9,81,10,82,18,61,20,11,21,22,19,83]))),iX=A.lazy(()=>Se(()=>import("./index20.js"),__vite__mapDeps([84,1,4,5,80,20,10,11,21,22,19,85]))),aX=A.lazy(()=>Se(()=>import("./index30.js"),__vite__mapDeps([86,4,1,5,20,10,11,21,22,19,87])).then(e=>({default:e.UpdatePasswordForm}))),oX=A.lazy(()=>Se(()=>import("./index40.js"),__vite__mapDeps([88,1,4,5,89,11,20,10,21,22,19,90,91]))),sX=A.lazy(()=>Se(()=>import("./index37.js"),__vite__mapDeps([92,1,4,5,61,18,93,94,70,71,20,10,11,21,22,19,95]))),rX=A.lazy(()=>Se(()=>import("./index44.js"),__vite__mapDeps([96,1,4,5,12,13,20,29,30,41,10,11,21,22,19,97]))),lX=A.lazy(()=>Se(()=>import("./ModelsContainer.js"),__vite__mapDeps([98,1,53,4,5,54,20,10,11,21,22,19,99]))),cX=A.lazy(()=>Se(()=>import("./AccountContainer.js"),__vite__mapDeps([100,1,16,17,4,5,70,71,86,20,10,11,21,22,19,87,8,18,101]))),uX=A.lazy(()=>Se(()=>import("./index7.js"),__vite__mapDeps([102,4,1,5,20,10,11,21,22,19])).then(e=>({default:e.MemoryPersonalizationManage}))),dX=A.lazy(()=>Se(()=>import("./index41.js"),__vite__mapDeps([89,1,5,4,11,20,10,21,22,19,90]))),hX=A.lazy(()=>Se(()=>import("./index21.js"),__vite__mapDeps([103,1,4,5,9,81,10,82,20,11,21,22,19,104])).then(e=>({default:e.Subscription}))),pX=A.lazy(()=>Se(()=>import("./index35.js"),__vite__mapDeps([105,1,5,25,26,4,27,28,2,3,6,7,20,10,11,21,22,19,106]))),mX=A.lazy(()=>Se(()=>import("./index23.js"),__vite__mapDeps([107,1,61,4,5,16,17,93,94,70,71,20,10,11,21,22,19,108])).then(e=>({default:e.VoiceList}))),fX=A.lazy(()=>Se(()=>import("./index45.js"),__vite__mapDeps([109,1,4,5,20,10,11,21,22,19,110])).then(e=>({default:e.VoiceClone}))),gX=A.lazy(()=>Se(()=>import("./index8.js"),__vite__mapDeps([111,20,1,5,10,4,11,21,22,19]))),vX=()=>an.jsx(qy,{children:an.jsxs(By,{path:"/",element:an.jsx(vj,{}),children:[an.jsxs(By,{element:an.jsx(DY,{}),children:[an.jsx(By,{index:!0,element:an.jsx(aq,{})}),an.jsx(By,{path:"c/:id",element:an.jsx(NY,{})}),an.jsx(By,{path:"p/:id",element:an.jsx(NY,{})})]}),an.jsx(By,{path:"mobile/chatcontrols/:currentid",element:an.jsx(WY,{})}),an.jsx(By,{path:"native/webdev",element:an.jsx(gX,{})}),an.jsx(By,{path:"/s/:id",element:an.jsx(LY,{})}),an.jsx(By,{path:"/s/deploy/:id",element:an.jsx(rX,{})}),an.jsx(By,{path:"/authorize",element:an.jsx(pX,{})}),an.jsx(By,{path:"/auth",element:an.jsx(FY,{})}),an.jsx(By,{path:"/forget",element:an.jsx(zY,{})}),an.jsx(By,{path:"/reset",element:an.jsx(UY,{})}),an.jsx(By,{path:"/error",element:an.jsx(HY,{})}),an.jsx(By,{path:"/settings",element:an.jsx(QY,{}),children:an.jsxs(By,{element:an.jsx(tX,{}),children:[an.jsx(By,{index:!0,element:an.jsx(nX,{})}),an.jsx(By,{path:"languages",element:an.jsx(ZY,{})}),an.jsx(By,{path:"theme",element:an.jsx(iX,{})}),an.jsx(By,{path:"voice",element:an.jsx(sX,{})}),an.jsx(By,{path:"about",element:an.jsx(eX,{})}),an.jsx(By,{path:"terms-of-service",element:an.jsx(BY,{})}),an.jsx(By,{path:"privacy-policy",element:an.jsx($Y,{})}),an.jsx(By,{path:"contact-us",element:an.jsx(GY,{})}),an.jsx(By,{path:"account",element:an.jsx(cX,{})}),an.jsx(By,{path:"model",element:an.jsx(lX,{})}),an.jsx(By,{path:"change-password",element:an.jsx(aX,{})}),an.jsx(By,{path:"general",element:an.jsx(KY,{})}),an.jsx(By,{path:"general/voice",element:an.jsx(mX,{})}),an.jsx(By,{path:"general/voice/clone",element:an.jsx(fX,{})}),an.jsx(By,{path:"general/voice/design",element:an.jsx(RY,{})}),an.jsx(By,{path:"voice/clone",element:an.jsx(fX,{})}),an.jsx(By,{path:"voice/design",element:an.jsx(RY,{})}),an.jsx(By,{path:"mcp",element:an.jsx(YY,{})}),an.jsx(By,{path:"interface",element:an.jsx(XY,{})}),an.jsx(By,{path:"chats",element:an.jsx(JY,{})}),an.jsx(By,{path:"personalization",element:an.jsx(oX,{})}),an.jsx(By,{path:"personalization/memory",element:an.jsx(uX,{})}),an.jsx(By,{path:"personalization/custom-instr",element:an.jsx(dX,{})}),an.jsx(By,{path:"subscription",element:an.jsx(hX,{})})]})}),an.jsx(By,{path:"/legal-agreement/terms-of-service",element:an.jsx(BY,{})}),an.jsx(By,{path:"/legal-agreement/privacy-policy",element:an.jsx($Y,{})}),an.jsx(By,{path:"/legal-agreement/usage-policy",element:an.jsx(qY,{})}),an.jsx(By,{path:"/legal-agreement/contact-us",element:an.jsx(GY,{})}),an.jsx(By,{path:"/legal-agreement/models",element:an.jsx(VY,{})}),an.jsx(By,{path:"/legal-agreement/about",element:an.jsx(eX,{})})]})}),yX="//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/assets/editor.worker-6jafNAN9.js",bX=e=>{const t=`import ${JSON.stringify(new URL(e,import.meta.url))}`,n=new Blob([t],{type:"application/javascript"}),i=URL.createObjectURL(n),a=new Worker(i,{type:"module"});return a.addEventListener("error",()=>{URL.revokeObjectURL(i)}),a};function xX(){return an.jsx(Yy,{basename:"/",children:an.jsx(vX,{})})}self.MonacoEnvironment={getWorker(e,t){try{return bX("json"===t?"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/assets/json.worker-BqPgIoqM.js":"css"===t||"scss"===t||"less"===t?"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/assets/css.worker-BAnUvUvq.js":"html"===t||"handlebars"===t||"razor"===t?"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/assets/html.worker-0pmbLbCB.js":"typescript"===t||"javascript"===t?"//assets.alicdn.com/g/qwenweb/qwen-chat-fe/0.1.38/assets/ts.worker-DhL4jcP4.js":yX)}catch(n){return bX(yX)}}},_e(function(e,t){t._reactRoot||(t._reactRoot=zf.createRoot(t));var n=t._reactRoot;return n.render(e),function(){return new Promise(function(e){setTimeout(function(){n.unmount(),e()},0)})}});const wX=576,_X=768,SX=375;function CX(e,t){if(e>=(Lx()?wX:_X))return t+"px";const n=e/SX;return t*Math.min(n,2)+"px"}function EX(){if(!Lx())return;const e=CX(document.documentElement.clientWidth,16);document.documentElement.style.fontSize=e}EX(),window.addEventListener("resize",EX),!1!==window.shouldLoadViteApp&&(window.addEventListener("vite:preloadError",e=>{const t="preloadErrorRetryKey",n=sessionStorage.getItem(t);sessionStorage.setItem(t,"true"),n||(e.preventDefault(),window.location.reload())}),j(void 0,null,function*(){yield Nv(),zf.createRoot(document.getElementById("root")).render(an.jsx(xX,{}))}));export{QS as $,z_ as A,P_ as B,B_ as C,N_ as D,KE as E,LT as F,k_ as G,Ox as H,ng as I,Gx as J,Jx as K,EI as L,$x as M,JC as N,gI as O,Yk as P,bI as Q,hW as R,PY as S,MV as T,kT as U,fI as V,mI as W,I_ as X,tE as Y,ES as Z,Gf as _,Ty as a,hI as a$,Ny as a0,vx as a1,Sx as a2,ag as a3,BC as a4,$C as a5,lW as a6,cW as a7,eQ as a8,qC as a9,BT as aA,ow as aB,ky as aC,UT as aD,Bx as aE,Px as aF,fN as aG,Hy as aH,j_ as aI,E_ as aJ,SN as aK,Ux as aL,Lx as aM,Bf as aN,__ as aO,cS as aP,WE as aQ,S_ as aR,C_ as aS,XW as aT,hw as aU,dw as aV,Yg as aW,uB as aX,U$ as aY,RE as aZ,Lg as a_,Ek as aa,tQ as ab,nQ as ac,TI as ad,KS as ae,sg as af,zx as ag,Yx as ah,R_ as ai,Qx as aj,T_ as ak,Xf as al,ab as am,qx as an,gg as ao,yE as ap,uE as aq,QW as ar,jQ as as,Jq as at,xq as au,TQ as av,dS as aw,ET as ax,tG as ay,nG as az,HE as b,tj as b$,pI as b0,jT as b1,TC as b2,IC as b3,BS as b4,DS as b5,US as b6,zS as b7,LS as b8,HS as b9,vN as bA,TS as bB,q_ as bC,$_ as bD,G_ as bE,H_ as bF,V_ as bG,L_ as bH,bS as bI,jS as bJ,qT as bK,bx as bL,bN as bM,Sv as bN,EN as bO,xN as bP,GC as bQ,Cv as bR,gS as bS,Vf as bT,Qf as bU,dG as bV,GW as bW,YK as bX,QT as bY,Wf as bZ,jx as b_,fC as ba,qf as bb,OT as bc,Kx as bd,AS as be,qI as bf,FS as bg,qQ as bh,cY as bi,hY as bj,uY as bk,fY as bl,ZK as bm,lY as bn,nY as bo,tY as bp,jC as bq,gj as br,yN as bs,vS as bt,xS as bu,bY as bv,yY as bw,U_ as bx,yS as by,DT as bz,GE as c,oj as c0,aj as c1,ij as c2,sj as c3,Hg as c4,Vg as c5,Xx as c6,Bg as c7,X_ as c8,AC as c9,OC as ca,wT as cb,rT as cc,Gg as cd,Wg as ce,WN as cf,EY as cg,WS as ch,MT as d,MS as e,RS as f,mS as g,OS as h,$S as i,an as j,qS as k,zE as l,NT as m,pj as n,rj as o,PS as p,lj as q,hj as r,dj as s,uj as t,Ex as u,wS as v,_S as w,kk as x,Tx as y,Sj as z};
